
	
	
	


var $j = jQuery.noConflict();

// Getting BB's namespace
!function(a){"use strict";var b=a.stm;b.ns("bb.ns",function(c,d){b.ns.call(a,"bb."+c,d)}),b.ns("bbus.ns",function(c,d){b.ns.call(a,"bbus."+c,d)}),b.ns("bbuk.ns",function(c,d){b.ns.call(a,"bbuk."+c,d)})}(window);
//# sourceMappingURL=base.nano.js.map

// Now for the rest
!function(a){"use strict";var b=a.stm,c=a.document,d=a.navigator,e=700,f=function(a,b){var c=!1,d=!1;a=a.toLowerCase(),b=b?b.toLowerCase():"";var e=a.match(/(opera|ie|firefox|chrome|trident|crios|version)[\s\/:]([\w\d\.]+)?.*?(safari|(?:rv[\s\/:]|version[\s\/:])([\w\d\.]+)|$)/)||[null,"unknown",0];return"trident"===e[1]?(e[1]="ie",e[4]&&(e[2]=e[4])):"crios"===e[1]&&(e[1]="chrome"),c=a.match(/iphone/)?!0:!1,d=a.match(/android/i)&&a.match(/mobile/i)?!0:!1,b=a.match(/ip(?:ad|od|hone)/)?"ios":(a.match(/(?:webos|android)/)||b.match(/mac|win|linux/)||["other"])[0],"win"===b&&(b="windows"),{name:"version"===e[1]?e[3]:e[1],version:parseFloat("opera"===e[1]&&e[4]?e[4]:e[2]),platform:b,isIPhone:c,isAndroidPhone:d}},g=f(d.userAgent,d.platform);a.innerWidth&&a.innerWidth>=e&&(g.isAndroidPhone=!1),"ie"===g.name&&(g.version=c.documentMode),g[g.name]=!0,g[g.name+parseInt(g.version,10)]=!0;var h=g.platform;"windows"===h&&(h="win"),g.Platform={name:h,isTablet:!1},g.Platform[h]=!0,g.Platform.ios&&(g.Platform.ipod=!0);var i=d.userAgent.toLowerCase();g.Platform.ios?g.Platform.isTablet=!0:g.Platform.android&&-1===i.indexOf("mobile")?g.Platform.isTablet=!0:-1!==i.indexOf("tablet")&&(g.Platform.isTablet=!0),b.ns("Browser",g),b.ns("browser",g)}(this);
//# sourceMappingURL=browser.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=a._,e=b.define,f=b.functional,g=e({_backup:null,fns:null,keys:null,initialize:function(a){this._backup={},this.clear(),c.isPlainObject(a)&&(this._backup=a,this.restore()),this.run=this.runNext,f.bindAllMethods(this)},append:function(a,b){return this.insertAt(this.fns.length,a,b)},clear:function(){return this.fns=[],this.keys=[],this},insertAfter:function(a,b,c){var d=this.keys.indexOf(a)+1;return 1>d&&(d=this.keys.length),this.insertAt(d,b,c)},insertBefore:function(a,b,c){return this.insertAt(Math.max(0,this.keys.indexOf(a)),b,c)},insertAt:function(a,b,c){return this.keys.splice(a,0,b),this.fns.splice(a,0,c),this},prepend:function(a,b){return this.insertAt(0,a,b)},remove:function(a){var b=this.keys.indexOf(a);return b>-1&&(this.keys.splice(b,1),this.fns.splice(b,1)),this},restore:function(){return this.fns=d.values(this._backup),this.keys=d.keys(this._backup),this},save:function(){return this._backup=d.object(this.keys,this.fns),this},runNext:function(){return this.fns.length&&(this.keys.shift(),this.fns.shift().apply(this,d.toArray(arguments))),this},runAll:function(){var a,b,c=d.toArray(arguments);for(a=0,b=this.keys.length;b>a;a++)this.run.apply(this,c);return this},runUntil:function(a){var b,c,e=d.toArray(arguments).slice(1);for(arguments.length<1&&(a=!1),b=0,c=this.keys.length;c>b&&a!==this.run.apply(this,e);b++);return this}});b.ns("Chain",g),b.ns("chain",g)}(window);
//# sourceMappingURL=chain.nano.js.map
!function(a){"use strict";var b=a.stm,c=a._,d=["January","February","March","April","May","June","July","August","September","October","November","December"],e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],f=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],g=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],h="+10",i=24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,j=function(a,b){return 32-new Date(a,b,32).getDate()},k=function(a){return a?(a.setHours(a.getHours()>12?a.getHours()+2:0),a):null},l={parseDate:function(a,b){var c;if(null===a||null===b)throw"Invalid arguments";if(b="object"==typeof b?b.toString():b+"",""===b)return null;for(var l=-1,m=-1,n=-1,o=-1,p=!1,q=function(b){var c=v+1<a.length&&a.charAt(v+1)==b;return c&&v++,c},r=function(a){q(a);var c="@"==a||"u"==a?14:"!"==a?20:"y"==a?4:"o"==a?3:2,d=new RegExp("^\\d{1,"+c+"}"),e=b.substring(u).match(d);if(!e)throw"Missing number at position "+u;return u+=e[0].length,parseInt(e[0],10)},s=function(a,c,d){for(var e=q(a)?d:c,f=0;f<e.length;f++)if(b.substr(u,e[f].length)==e[f])return u+=e[f].length,f+1;throw"Unknown name at position "+u},t=function(){if(b.charAt(u)!=a.charAt(v))throw"Unexpected literal at position "+u;u++},u=0,v=0;v<a.length;v++)if(p)"'"!=a.charAt(v)||q("'")?t():p=!1;else switch(a.charAt(v)){case"d":n=r("d");break;case"D":s("D",g,f);break;case"o":o=r("o");break;case"m":m=r("m");break;case"M":m=s("M",e,d);break;case"y":l=r("y");break;case"@":c=new Date(r("@")),l=c.getFullYear(),m=c.getMonth()+1,n=c.getDate();break;case"u":c=new Date(r("u")),l=c.getUTCFullYear(),m=c.getUTCMonth()+1,n=c.getUTCDate();break;case"!":c=new Date((r("!")-i)/1e4),l=c.getFullYear(),m=c.getMonth()+1,n=c.getDate();break;case"'":q("'")?t():p=!0;break;default:t()}if(-1==l?l=(new Date).getFullYear():100>l&&(l+=(new Date).getFullYear()-(new Date).getFullYear()%100+(h>=l?0:-100)),o>-1)for(m=1,n=o;;){var w=j(l,m-1);if(w>=n)break;m++,n-=w}if(c=k(new Date(l,m-1,n)),c.getFullYear()!=l||c.getMonth()+1!=m||c.getDate()!=n)throw"Invalid date";return c},formatDate:function(a,b){if(!b)return"";var c=function(b){var c=l+1<a.length&&a.charAt(l+1)==b;return c&&l++,c},h=function(a,b,d){var e=""+b;if(c(a))for(;e.length<d;)e="0"+e;return e},i=function(a,b,d,e){return c(a)?e[b]:d[b]},j="",k=!1;if(b)for(var l=0;l<a.length;l++)if(k)"'"!=a.charAt(l)||c("'")?j+=a.charAt(l):k=!1;else switch(a.charAt(l)){case"d":j+=h("d",b.getDate(),2);break;case"D":j+=i("D",b.getDay(),g,f);break;case"o":j+=h("o",(b.getTime()-new Date(b.getFullYear(),0,0).getTime())/864e5,3);break;case"m":j+=h("m",b.getMonth()+1,2);break;case"M":j+=i("M",b.getMonth(),e,d);break;case"y":j+=c("y")?b.getFullYear():(b.getYear()%100<10?"0":"")+b.getYear()%100;break;case"@":j+=b.getTime();break;case"u":j+=b.getTime()+60*b.getTimezoneOffset()*1e3;break;case"!":j+=1e4*b.getTime()+this._ticksTo1970;break;case"'":c("'")?j+="'":k=!0;break;default:j+=a.charAt(l)}return j},todayUTC:function(){var a=new Date;return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate())},getDateFromOffset:function(a,b){var d=null;return c.isDate(a)&&(d=new Date(a.getTime()+24*b*60*60*1e3)),d}};b.ns("dates",l)}(window);
//# sourceMappingURL=dates.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.JSON;b.ns("parseJSON",function(a){var b;try{b=c.parse(a)}catch(d){b=!1}return b})}(window);
//# sourceMappingURL=json.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=a._,e=b.define,f=b.mixins.observable,g=b.strings,h=b.Browser,i="stonOnFalse",j="postpop",k="prepop",l=e(null,f,{STATIC:{popunderEvent:"click",prepareMultiPop:function(a){}},options:{allowRepeat:!1,center:!0,height:500,forcePopup:!0,left:null,name:null,otherFeatures:{scrollbars:1,resizable:1},popunder:!1,top:null,width:500},hasPopped:!1,popupWindow:null,url:null,initialize:function(a,b){this.url=a,this.options=c.extend(!0,{},this.options,b),this.options.name||(this.options.name=g.uniqueId()),h.chrome&&(this.addOnPrePop(this._bugFixChrome),this.addOnPostPop(this._bugFixChromePost)),h.ie&&9===h.version&&this.addOnPrePop(this._bugFixIe9),h.firefox&&(this.addOnPrePop(this._bugFixFirefoxPre),this.addOnPostPop(this._bugFixFirefoxPost)),h.safari&&(this.addOnPrePop(this._bugFixSafariPre),this.addOnPostPop(this._bugFixSafariPost))},addOnPostPop:function(a){return this.subscribe(j,a.bind(this),i)},addOnPrePop:function(a){return this.subscribe(k,a.bind(this),i)},removeOnPostPop:function(a){return this.unsubscribe(j,a.bind(this))},removeOnPrePop:function(a){return this.unsubscribe(k,a.bind(this))},getPositions:function(){var b={left:0,top:0};return this.options.center&&(b.left=a.screen.width/2-this.options.width/2,b.top=a.screen.height/2-this.options.height/2),null!==this.options.left&&(b.left=this.options.left),null!==this.options.top&&(b.top=this.options.top),b.left=Math.max(b.left,0),b.top=Math.max(b.top,0),b},tryPop:function(){var b,d,e,f=c.Event(k,{data:{popup:this}});return this.publish(k,f),f.isDefaultPrevented()?this:(b=c.Callbacks("once stopOnFalse"),(!this.hasPopped||this.options.allowRepeat)&&(e=this.getPositions(),d=c.extend({},this.options.otherFeatures,{height:this.options.height,width:this.options.width,left:e.left,top:e.top}),this.options.activeX&&h.ie?this.openActiveXWindow(this.url,this.options.name,d,1):this.popupWindow=a.open(this.url,this.options.name,c.param(d).replace(/&/g,",")),this.popupWindow&&(this.hasPopped=!0,this.options.popunder?b.add(function(){this.popupWindow.blur()}.bind(this),function(){try{a.document.focus()}catch(b){}a.focus()}.bind(this)):this.popupWindow.focus())),b.add(function(){var a=c.Event(j,{data:{popup:this}});this.publish(j,a)}).fireWith(this),this)},openActiveXWindow:function(a,b,d,e){var f,g,h,i,j=c.param(d).replace(/&/g,",");g=document.createElement("iframe"),g.style.display="none",g.innerHTML="<html><body></body></html>",c(g).appendTo("body"),h=new g.contentWindow.ActiveXObject("htmlFile"),h.open(),h.close(),g.contentDocument.open();try{i=new h.parentWindow.ActiveXObject("htmlFile"),f=i.parentWindow.open(a,b,j),f.focus()}catch(k){e>0&&(f=this.openActiveXWindow(a,b,j,--e))}finally{c(g).remove()}return f},useOptimalDimensions:function(b){var c=d.extend({maxHeight:1100,maxWidth:1500,minHeight:650,minWidth:950},b);return this.options.height=Math.min(Math.max(.8*a.screen.height,c.minHeight),c.maxHeight),this.options.width=Math.min(Math.max(.8*a.screen.width,c.minWidth),c.maxWidth),this},_bugFixChrome:function(c){if(this.options.popunder){if(h.version>40&&!h.Platform.ios&&!h.Platform.android)return this.options.origHeight||(this.options.origHeight=this.options.height,this.options.height=1),this.options.origWidth||(this.options.origWidth=this.options.width,this.options.width=1),this.options.origUrl||(this.options.origUrl=this.url,this.url=this.options.holdingWindowUrl?this.options.holdingWindowUrl:"about:blank"),!1;if(h.version>29){var d=document.createElement("a");d.href="about:blank",d.target=this.options.name,document.body.appendChild(d);var e=document.createEvent("MouseEvents");return e.initMouseEvent("click",!1,!0,a,0,0,0,0,0,!0,!1,!1,!0,0,null),d.dispatchEvent(e),void d.parentNode.removeChild(d)}}this.options.forcePopup&&(this.options.otherFeatures.scrollbars=0,this.options.otherFeatures.menubar=0,this.options.otherFeatures.toolbar=0),!b.pageData.isWatirTesting&&this.options.popunder&&a.open("javascript:window.focus()","_self","")},_bugFixIe9:function(){this.options.otherFeatures.resizable=0},_bugFixFirefoxPost:function(){if(this.options.popunder){var b=a.open("about:blank","ff_helper_win","toolbar=1,resizable=1,menubar=1,location=1,scrollbars=1,width=1,height=1,left=0,top=0");b&&b.close(),setTimeout(function(){a.focus()},200)}},_bugFixFirefoxPre:function(){this.options.popunder&&a.open("javascript:window.blur();","_self","")},_bugFixChromePost:function(){if(this.options.popunder){if(h.version>40&&!h.Platform.ios&&!h.Platform.android){var b=this;b.options.height=b.options.origHeight,b.options.width=b.options.origWidth,b.url=b.options.origUrl,this.pushToLowerRight();var e=function(c){var d=b.popupWindow;d&&document.hasFocus()&&(d.moveTo(a.screenX,a.screenY),d.resizeTo(b.options.width,b.options.height),d.location=b.url)},f=d.debounce(e,1,!0);return void d.defer(function(){c("html").one("click datepicker:beforeClose",f)})}if(!(h.version>29)){var g=document.createElement("a");g.href="/selfclosingPopup.html",document.body.appendChild(g);var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!1,!0,a,0,0,0,0,0,!0,!1,!1,!0,0,null),g.dispatchEvent(i),g.parentNode.removeChild(g)}}},_bugFixSafariPre:function(a){return this.options.popunder&&!h.Platform.ios?(a.preventDefault(),!1):void 0},_bugFixSafariPost:function(b){var c;this.options.popunder&&h.version>=7&&h.Platform.ios&&(c=a.name,c||(c=a.location.host.replace(/[-.]/g,""),a.name=c),a.open("",c,"width=1,height=1,scrollbars=0"),a.focus())},setLocation:function(a){return this.popupWindow.location=a,this},expand:function(){return this.popupWindow.moveBy(-9999,-9999),this.popupWindow.resizeBy(9999,9999),this},fauxExpand:function(){var a="windows"==h.platform?140:115;return this.popupWindow.moveTo(300,a),this.popupWindow.resizeTo(screen.width-300,screen.height-a),this},focus:function(){return this.popupWindow.focus(),this},pushToLowerRight:function(){return this.popupWindow.moveTo(screen.availLeft+screen.availWidth-this.popupWindow.outerWidth,screen.availTop+screen.availHeight-this.popupWindow.outerHeight),this}});b.ns("Popup",l),b.ns("popup",l)}(window);
//# sourceMappingURL=popup.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=b.define,e=b.functional,f=b.mixins.observable,g=b.strings,h=b.Browser,i=b.Popup,j="stonOnFalse",k="successfulPop",l=d(null,f,{options:null,left:370,leftInc:50,maxWindows:6,selectors:null,top:35,topInc:35,url:"/c/popunder/prepop.html",windows:[],initialize:function(a,b){(h.ie||h.chrome)&&(e.bindMethods(this,["prepopWindow","removeAllPrepops"]),this.selectors=a,this.options=b,this.attach())},addOnPopSuccess:function(a){return this.subscribe(k,a.bind(this),j)},removeOnPopSuccess:function(a){return this.unsubscribe(k,a.bind(this))},attach:function(){c("body").on(i.popunderEvent,this.selectors,this.prepopWindow),c(a).on("unload",this.removeAllPrepops)},removeAllPrepops:function(){return this.windows.forEach(function(a){a.popupWindow.close()}),this},prepopWindow:function(){if(b.pageData.noPrepops)return null;if(this.windows=this.windows.filter(function(a){return a.popupWindow&&!a.popupWindow.closed}),this.windows.length>=this.maxWindows)return null;var a=this.options||{};a.popunder=!0,a.name+=g.uniqueId(),a.left=this.left,a.top=this.top;var d=new i(this.url,a).tryPop();return d.hasPopped?(this.windows.push(d),this.left+=this.leftInc,this.top+=this.topInc,this.publish(k,c.Event(k,{data:{prepop:this,popup:d}})),d):null}});b.ns("PrepopWindows",l)}(window);
//# sourceMappingURL=prepop-windows.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=a.jQuery,e=c.cookies,f=c.define;d(function(){b=a.BBAd});var g=f({STATIC:{newCookieValue:{air:{},car:{},cruise:{},hotel:{},vacation:{},vacation_rental:{}}},cookieName:"ccap",cookieSettings:{offset:0},options:{cappedSourcePool:[],threshold:3},isCappedSource:function(){var a=e.get("ssource");return null!==a&&void 0!==a.id?-1!==this.options.cappedSourcePool.indexOf(a.id):!1},setupCookie:function(){var a=e.getJSONDecoded(this.cookieName);null===a&&(a=d.extend({},this.constructor.newCookieValue)),e.setJSONEncoded(this.cookieName,a,this.cookieSettings)},countClick:function(a){var c=b.singleton(a),d=c.getMetaData("display_name"),f=c.getMetaData("search_mode"),g=e.getJSONDecoded(this.cookieName);null!==g&&g[f]&&(void 0!==g[f][d]?g[f][d]=g[f][d]+1:g[f][d]=1,e.setJSONEncoded(this.cookieName,g,this.cookieSettings))},getClickCount:function(a){var c=b.singleton(a),d=c.getMetaData("display_name"),f=c.getMetaData("search_mode"),g=e.getJSONDecoded(this.cookieName);return null!==g&&g[f]&&g[f][d]?g[f][d]:0},hasAdReachedClickCap:function(a,b){var c=e.getJSONDecoded(this.cookieName);return c[b]&&c[b][a]?c[b][a]>this.options.threshold:!1},constructor:function(a){this.options=d.extend({},this.options,a),this.setupCookie()}});c.ns("ClickCapping",g)}(window);
//# sourceMappingURL=clickcapping.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=b.autoInitialize,e=b.define,f=b.functional,g=e({STATIC:{autoInitialize:function(a){d.loadClass(g,a?a:"stm-auto-resize-image",!0)}},options:{center:!0,height:null,imageSelector:"img",resizeMultiplier:1.5,width:null},element:null,image:null,constructor:function(a,b){f.bindMethods(this,["onImageLoad"]),this.element=c(a),this.options=c.extend({},this.options,b),this.image=this.element.find(this.options.imageSelector),this.attach()},onImageLoad:function(){this.run()},attach:function(){var a=this.image.attr("src");return this.image.removeAttr("src").on("load",this.onImageLoad).attr("src",a),this},calculateDimensions:function(){return this.options.height||(this.options.height=this.options.resizeMultiplier*this.element.height()),this.options.width||(this.options.width=this.options.resizeMultiplier*this.element.width()),this},centerImage:function(){var a=this.element.css("position");return"absolute"!==a&&"relative"!==a&&this.element.css("position","relative"),this.element.css("overflow","hidden"),this.image.css({position:"relative",left:(this.image.width()-this.element.width())/-2,top:(this.image.height()-this.element.height())/-2}),this},resizeImage:function(){return this.image.height()<this.image.width()?this.image.css("max-height",this.options.height+"px"):this.image.css("max-width",this.options.width+"px"),this},run:function(){return this.calculateDimensions().resizeImage(),this.options.center&&this.centerImage(),this}});g.autoInitialize(),b.ns("AutoResizeImage",g)}(window);
//# sourceMappingURL=auto-resize-image.nano.js.map
!function(a){"use strict";var b=a.jQuery,c=a._,d=a.stm,e=a.JSON,f=d.define,g=d.Browser,h=null;try{h=a.localStorage}catch(i){}!h&&a.globalStorage&&(h=a.globalStorage),!h&&g.ie&&!function(){var d=a.document.createElement("div"),e="stmStorageIELocalStorage";b(d).hide().appendTo("head"),d.addBehavior?(d.addBehavior("#default#userdata"),h={length:0,clear:function(){d.load(e),c.each(d.XMLDocument.documentElement.attributes,function(a){d.removeAttribute(a.name)}),d.save(e),this.length=0},getItem:function(a){return d.load(e),d.getAttribute(a)},removeItem:function(a){d.load(e),null===d.getAttribute(a)&&(d.removeAttribute(a),this.length--),d.save(e)},setItem:function(a,b){d.load(e),null===d.getAttribute(a)&&this.length++,d.setAttribute(a,b),d.save(e)}},d.load(e),h.length=d.XMLDocument.documentElement.attributes.length):b(d).remove()}();var j="stmStorage",k=f({readWriteSupported:null,clear:function(){return this.isSupported()&&h.clear(),this},get:function(a){var b;if(!this.isSupported())return null;try{return b=h.getItem(j+a),e.parse(b)}catch(c){return null}},isReadWriteSupported:function(){var a="stm_local_storage_check";if(null!==this.readWriteSupported)return this.readWriteSupported;try{h.setItem(a,a),h.removeItem(a),this.readWriteSupported=!0}catch(b){this.readWriteSupported=!1}return this.readWriteSupported},isSupported:function(){return h?this.isReadWriteSupported():!1},remove:function(a){return this.isSupported()&&h.removeItem(j+a),this},set:function(a,b){return this.isSupported()&&h.setItem(j+a,e.stringify(b)),this}});d.ns("storage",k),d.ns("localStorage",new k)}(this);
//# sourceMappingURL=storage.nano.js.map
!function(a){"use strict";var b=a.stm,c=a._,d=b.define,e=function(){return b.localStorage},f=d({initialize:function(a,b){this.data={},this.name=a,this.options=c.extend({},this.options,b);var d=e().get(this.name)||{keys:[],values:[]};this.history=d.keys,c.each(d.values,function(a,b){this.data[this.history[b]]=a}.bind(this))},options:{limit:20},data:null,history:null,name:null,get:function(a){return a in this.data?(this.flagUsage(a),this.data[a]):null},set:function(a,b){return this.data[a]=b,this.flagUsage(a)},setAll:function(a){return c.each(a,function(a,b){this.set(b,a)}.bind(this)),this},flagUsage:function(a){c.isString(a)||(a=""+a);var b=this.history.indexOf(a);-1!==b&&this.history.splice(b,1),this.history.unshift(a),this.history=this.history.slice(0,this.options.limit);var d={keys:this.history,values:c.map(this.history,function(a){return this.data[a]}.bind(this))};return e().set(this.name,d),this}});b.ns("LimitedStorage",f),b.ns("storage.limited",f)}(this);
//# sourceMappingURL=limited.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.define,e=c.cookies,f=c.strings,g=function(){return c.localStorage},h=":session_data:",i=d({initialize:function(a){this.sessionID=e.get(a),this.sessionID||(this.sessionID=f.uniqueId())},sessionID:null,get:function(a){var b=g().get(h+a);if(b&&b.sessionID){if(b.sessionID===this.sessionID)return b.value;this.remove(a)}return null},remove:function(a){return g().remove(h+a),this},set:function(a,b){return g().set(h+a,{value:b,sessionID:this.sessionID}),this},STATIC:{getInstance:function(){return b||(b=new i("uu")),b}}});c.ns("storage.session",i)}(this);
//# sourceMappingURL=session.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=a._,e=b.define,f=b.Chain,g=b.LimitedStorage,h=e({cache:null,constructor:function(){this.cache=new g("TAHotelImages")},getImages:function(a,b){var e=[],g=new f,h=this;return d.each(a,function(a){null===h.cache.get(a)&&e.push(a)}),e.length&&g.append("data-request",function(){c.ajax({url:"/api/stm/ta-hotel-images.html",dataType:"json",data:{hotelIds:e}}).done(function(a){h.cache.setAll(a),g.run()})}),g.append("execute-callback",function(){var c={};d.each(a,function(a){c[a]=h.cache.get(a)}),b(c)}),g.run(),h},insertImages:function(a,b){var e=[],f=c(a).filter(function(){var a=c(this);return!a.children().length||!a.find("img").length});return f.each(function(){var a=c(this),b=a.data("hotelId");b?e.push(b):a.hide()}),this.getImages(e,function(a){f.each(function(){var b=c(this),d=b.data("hotelId");d&&a[d]&&a[d].large&&b.append(c("<img />").attr("src",a[d].large))}),d.isFunction(b)&&b()}),this},getMultipleImagesByHotelId:function(a,b){var d=new f,e=this;return a&&a>1&&d.append("data-request",function(){c.ajax({url:"/api/stm/ta-hotel-images.html",dataType:"json",data:{hotelId:a,is_multiple:"1"}}).done(function(a){e.cache.setAll({hotelImages:a}),d.run()})}),d.append("execute-callback",function(){b(e.cache.get("hotelImages"))}),d.run(),e}});b.ns("TAHotelImages",new h)}(window);
//# sourceMappingURL=ta-hotel-images.nano.js.map
!function(a){"use strict";var b=a.stm||{};a.jQuery;b.TrackingPixel=b.define({mode:"",scrubStringForId:function(a){return a.replace(/[\s\.\-&\(\)\']*/g,"")},setMode:function(a){this.mode=a},constructor:function(){"undefined"!=typeof b&&b.pageData&&b.pageData.mode?this.setMode(b.pageData.mode):"undefined"!=typeof OT&&OT.PageData&&OT.PageData.searchMode?this.setMode(OT.PageData.searchMode):this.setMode("air")}}),b.TrackingPixel.Criteo=b.define(b.TrackingPixel,{verticalCampaignIds:{air:{campaign:"2866",se:"7713345",tr:"7713346"},hotel:{campaign:"7731",se:"7723328",tr:"7723329"},car:{campaign:"7327",se:"7723320",tr:"7723321"},vacation:{campaign:"7328",se:"7723322",tr:"7723323"},cruise:{campaign:"7329",se:"7723324",tr:"7723325"}},getVerticalCampaignIds:function(a){return this.verticalCampaignIds.hasOwnProperty(a)||(a="air"),this.verticalCampaignIds[a]},constructor:function(){b.TrackingPixel.call(this)}})}(window);var tingoTraffic=20;try{var SPLITTER=function(){var a={cookieName:"ts_uid",cookieDuration:30},b=function(b){for(var c,d,e=document.cookie.split(";"),f=e.length,g=0;f>g;g++)if(d=e[g].indexOf("="),c=e[g].substr(0,d).replace(/^\s+|\s+$/g,""),c==b){var h=new Date;return h.setDate(h.getDate()+a.cookieDuration),document.cookie=b+"="+e[g].substr(d+1)+";expires="+h.toUTCString(),unescape(e[g].substr(d+1))}},c=function(b){var c=Math.random()<=tingoTraffic/100?"0":"1",d=c+"-xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,b="x"==a?b:3&b|8;return b.toString(16)}),e=new Date;e.setDate(e.getDate()+a.cookieDuration);var f=escape(d)+";expires="+e.toUTCString();return document.cookie=b+"="+f,d},d=function(a){return a.charAt(0)};return{Tingo:function(){var e=b(a.cookieName);return e||(e=c(a.cookieName)),"0"==d(e)?!0:!1},BB:function(){var e=b(a.cookieName);return e||(e=c(a.cookieName)),"1"==d(e)?!0:!1}}}()}catch(err){}try{var CRITEO=function(){function a(){return v[0]}function b(){return v[1]}function c(){var a="";return"undefined"!=typeof v[2]&&""!=v[2]&&(a=v[2],"."!=a.charAt(a.length-1)&&(a+=".")),a}function d(){var a=v[3].charAt(0);return"undefined"!=typeof a&&1==a}function e(){var a=v[3].charAt(1);return"undefined"!=typeof a&&1==a}function f(){var a=v[3].charAt(2);return!y&&"undefined"!=typeof a&&1==a}function g(){return v[4]}function h(){return v[5]}function i(){return("https:"==document.location.protocol&&"https:"||"http:")+"//dis."+c()+"criteo.com/dis/dis.aspx"}function j(a){return("https:"==document.location.protocol?"https://sslwidget.":"http://widget.")+"criteo.com/"+b()+"/display.js?resptype="+a+"&"+l()}function k(a,b){switch(a){case"sendEvent":return b[0];case"transaction":return b[1]}}function l(){var a="",b=g();if(b.length>1)for(var c=1,d=0;d<b.length;d++)for(var e=w[d]&&w[d].length||0,f=b[d],h=0;e>h;h++)c>1&&(a+="&"),a+=m(w[d][h],c,f),c++;else for(var e=w&&w.length||0,f=g(),c=1,h=0;e>h;h++)for(var i=0;i<f.length;i++)c>1&&(a+="&"),a+=m(w[h],c,f[i]),c++;return a}function m(a,b,c){var d=z[a.pageType];if(d){var e=h(),f="",g="";for(var i in e)if(a.hasOwnProperty(i)){var j=e[i][0],l=e[i][1],m=e[i][2],n="";if(n="function"==typeof a[i]?a[i]():a[i])switch(l){case 0:g+="&"+j+"="+n;break;case 1:var o;"string"==typeof n?o=n.split(a.delimiter):"[object Array]"===Object.prototype.toString.apply(n)&&(o=n);var p=o.length;"undefined"!=typeof m&&p>m&&(p=m);for(var q=1;p>=q;q++)g+="&"+j+q+"="+o[q-1];break;case 2:1==b&&(f+="&"+j+"="+encodeURIComponent(n))}}return"t"+b+"="+d.eventType+"&p"+b+"="+encodeURIComponent(d.params+"&wi="+k(d.eventType,c)+g)+f}}function n(){var b=i()+"?p="+a()+"&cb="+Math.floor(99999999999*Math.random());try{b+="&ref="+encodeURIComponent(document.referrer)}catch(c){}try{b+="&sc_r="+encodeURIComponent(screen.width+"x"+screen.height)}catch(c){}try{b+="&sc_d="+encodeURIComponent(screen.colorDepth)}catch(c){}return b.substring(0,2e3)}function o(){var b=i()+"?p="+a();b+="&"+l(),b+="&cb="+Math.floor(99999999999*Math.random());try{b+="&ref="+encodeURIComponent(document.referrer)}catch(c){}try{b+="&sc_r="+encodeURIComponent(screen.width+"x"+screen.height)}catch(c){}try{b+="&sc_d="+encodeURIComponent(screen.colorDepth)}catch(c){}return b.substring(0,2e3)}function p(a){if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a);else{var b=window.onload;window.onload=function(){b&&"undefined"==typeof b.fired&&(b.fired=!0,b()),a()}}}function q(){var a=[];if(d()){if(document.createElement){var b=document.createElement("iframe");b&&(b.width="1px",b.height="1px",b.style.display="none",b.src=o()),a.push(b)}}else{var c=document.createElement("img");c&&(c.width="1px",c.height="1px",c.style.display="none",c.src=j("gif"));var e=document.createElement("iframe");e&&(e.width="1px",e.height="1px",e.style.display="none",e.src=n(),c.onload=function(){s(e)}),a.push(c)}return a}function r(){for(var a=q(),b=0;b<a.length;b++)s(a[b])}function s(a){var b;if(f())b=document.getElementById("cto_mg_div");else{if(b=document.getElementsByTagName("body"),!b||0==b.length)return;b=b[0]}null!=b&&b.appendChild&&b.appendChild(a)}function t(){f()&&document.write("<div id='cto_mg_div' style='display:none;'></div>")}function u(){e()?p(function(){r()}):r()}var v,w,x=!1,y=!1,z={home:{eventType:"sendEvent",params:"v=2&pt1=0&pt2=1"},product:{eventType:"sendEvent",params:"v=2&pt1=2"},list:{eventType:"sendEvent",params:"v=2&pt1=3"},basket:{eventType:"transaction",params:"v=2&s=0"},confirmation:{eventType:"transaction",params:"v=2&s=1"},search:{eventType:"sendEvent",params:"v=2&pt1=4"}};return{Load:function(a){"undefined"==typeof CRITEO_CONF||x&&"complete"!=document.readyState||(x=!0,y=a,v=CRITEO_CONF[1],w=CRITEO_CONF[0],t(),u())}}}()}catch(err){}CRITEO.Load(!0);
//# sourceMappingURL=STMPixelTracking.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=b.define,e=b.functional,f=b.strings,g=b.dates,h=b.Popup,i=b.PrepopWindows,j=b.Browser,k=d({prepop:null,searchWindows:[],options:{prepopWindowSelector:""},initialize:function(a){e.bindMethods(this,["launchCheckRates"]),this.options=c.extend(!0,{},this.options,a),this.attach()},attach:function(){this.prepop=new i(this.options.prepopWindowSelector,{name:"bb_prepop",popunder:!0,height:525,width:800})},launchCheckRates:function(a,b,d,e){var f=this.getSearchParams(b,d,e),g=0,h=[];return g=j.chrome||j.ie?Math.min(a.length,this.prepop.windows.length+1):a.length,this.searchWindows=this.openSearchWindows(this.prepop.windows,g),this.searchWindows.forEach(function(b){var d=a.shift();b.popupWindow.name="bb_search_"+d.getId(),b.popupWindow.location.href=d.getExternalUrl()+"&"+c.param(f),h.push(d),d.setOpened(!0)}),this.searchWindows.reverse(),this.searchWindows.forEach(function(a){a.popupWindow.focus()}),this.trackAds(h,b,d),a},openSearchWindows:function(a,b){for(var c=[];a.length>0;){var d=a.pop();d.popupWindow&&!d.popupWindow.closed&&c.push(d)}for(;c.length>b;)c.pop().popupWindow.close();c.reverse();for(var e=0;e<c.length;e++)c[e].popupWindow.focus();b-=c.length,h.prepareMultiPop(b);for(var g=this.prepop.left,i=this.prepop.top;b>0;){var j={name:"bb_search_"+f.uniqueId(),left:g,top:i,height:525,width:800},k=new h("",j).tryPop();if(!k.hasPopped)break;c.push(k),g+=this.prepop.leftInc,i+=this.prepop.topInc,b--}return c},trackAds:function(){throw new Error("Subclass needs to define this method!")},getSearchParams:function(a,b,c){return{inDay:a.getDate(),inMonth:g.formatDate("mm yy",a),outDay:b.getDate(),outMonth:g.formatDate("mm yy",b),adults:c}}});b.ns("SearchWindowHandler",k)}(window);
//# sourceMappingURL=search-window-handler.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.bb,e=a.jQuery,f=c.define,g=c.SearchWindowHandler;e(function(){b=a.BookingBuddy});var h=f(g,{options:e.extend({},g.prototype.options,{prepopWindowSelector:".some-non-existing-selector-since-without-one-it-matches-everything"}),constructor:function(a){g.call(this,a)},trackAds:function(a,c,d){var e=a.map(function(a){return a.getTrackingId()});b.Tracking.trackTACheckrates(e,c,d),b.trackingPixels&&a.forEach(function(a){b.trackingPixels.runAdClickPixels(a.getAuthorName())})}});e(function(){c.pageData&&"checkRatesMoreHotels"in c.pageData&&(c.windowManager=new h)}),d.ns("SearchWindowHandler",h)}(window);
//# sourceMappingURL=us-search-window-handler.nano.js.map


	


var BookingBuddy={abTests:{},domain:null,affiliateName:null,queryString:{},searchMode:null,slidingFactor:7,uniqueIDCounter:1,init:function(a){for(var b in a)BookingBuddy[b]=a[b];BookingBuddy.queryString.allow_framed||this.bustFrames()},bustFrames:function(){return BookingBuddy.allowFramed||top==self||top.location.replace(self.location.href),!0},getCookie:function(a){var b=document.cookie,c=a+"=",d=b.indexOf("; "+c);if(-1==d){if(d=b.indexOf(c),0!==d)return null}else d+=2;var e=document.cookie.indexOf(";",d);-1==e&&(e=b.length);try{return decodeURIComponent(b.substring(d+c.length,e))}catch(f){return null}},createCookie:function(a,b,c){var d;if(c){var e=new Date;e.setTime(e.getTime()+60*c*1e3),d="; expires="+e.toGMTString()}else d="";var f="";if(BookingBuddy.domain)f=BookingBuddy.domain;else{var g=document.domain.match(/.+(bookingbuddy.+|smartertravel.+)/);null!==g&&(f=g[1])}var h=window.stm&&window.stm.cookies?window.stm.cookies.getCookieDomain(null,f):window.location.host;return f!==h&&(document.cookie=a+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/; domain="+f),document.cookie=a+"="+b+d+"; path=/; domain="+h,!0},getESTHour:function(){var a;a=window.AWD&&window.AWD.Strings?new Date(AWD.Strings.ServerTime):new Date(BookingBuddy.Strings.ServerTime);var b=a.getTime(),c=-a.getTimezoneOffset()/60,d=new Date(b-c),e=d.getHours();return 0===e&&(e=24),e},handleEnterKey:function(a){a=a?a:window.event;var b=a.keyCode?a.keyCode:a.which;return 13==b?(Event.stop(a),!1):!0},toggleCovered:function(a,b){function c(a){var b=a.style.visibility;return b||(b=document.defaultView&&"function"==typeof document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(a,"").getPropertyValue("visibility"):a.currentStyle?a.currentStyle.visibility:""),b}function d(a){var b=BookingBuddy.getAbsolutePos(a);return[b.x,a.offsetWidth+b.x,b.y,a.offsetHeight+b.y]}if(!window.XMLHttpRequest)for(var e=["applet","iframe","select"],f=d(a),g=f[0],h=f[1],i=f[2],j=f[3],k=e.length;k>0;){--k;for(var l=document.getElementsByTagName(e[k]),m=null,n=l.length;n>0;){--n,m=l[n],f=d(m);var o=f[0],p=f[1],q=f[2],r=f[3];o>h||g>p||q>j||i>r?(m.__sl_save_visibility||(m.__sl_save_visibility=c(m)),m.style.visibility=m.__sl_save_visibility):(m.__sl_save_visibility||(m.__sl_save_visibility=c(m)),m.style.visibility=b)}}},getAbsolutePos:function(a){var b=0,c=0,d=/^div$/i.test(a.tagName);d&&a.scrollLeft&&(b=a.scrollLeft),d&&a.scrollTop&&(c=a.scrollTop);var e={x:a.offsetLeft-b,y:a.offsetTop-c};if(a.offsetParent){var f=BookingBuddy.getAbsolutePos(a.offsetParent);e.x+=f.x,e.y+=f.y}return e},getQSParam:function(a){return $j.isUndefined(BookingBuddy.queryString[a])?null:BookingBuddy.queryString[a]},isNumeric:function(a){return parseFloat(a)==a},generateUniqueID:function(a){if(a=$j("#"+a),a[0]){if(""!==a.attr("id"))return a.attr("id");BookingBuddy.uniqueIDCounter++;for(var b="generatedID_"+BookingBuddy.uniqueIDCounter;$j("#"+b)[0];)BookingBuddy.uniqueIDCounter++,b="generatedID_"+BookingBuddy.uniqueIDCounter;return a.attr("id",b),b}return""},popWindow:function(a,b,c,d){var e="height="+b+",width="+c+",scrollbars=yes",f="BBSurvey"+Math.floor(100*Math.random()),g=window.open(a,f,e);if(g){if(d)try{var h=(screen.height-b)/2,i=(screen.width-c)/2;g.moveTo(i,h)}catch(j){}return g}return!1}};
//# sourceMappingURL=BookingBuddy.nano.js.map
BookingBuddy.LE={defaultLocations:[],searchAdapterID:null,startTimestamp:null,endTimestamp:null,point1InputID:null,point2InputID:null,inited:!1,init:function(){$j(document).ready(function(){BookingBuddy.LE.updateLocations(1),BookingBuddy.LE.updateLocations(2)}),BookingBuddy.LE.inited=!0},loadDefaults:function(a){BookingBuddy.LE.inited&&BookingBuddy.LE.updateSelect(a,BookingBuddy.LE.defaultLocations)},updateLocations:function(a){if(BookingBuddy.LE.inited){var b=BookingBuddy.LE.searchAdapterID,c=BookingBuddy.LE.startTimestamp,d="point_"+(a%2+1),e="point_"+a;if($j("#"+d).val()){var f=$j("#"+d).val(),g=f.split("|"),h=g[0],i={selection_id:h,id:b,cf:a,start_date:c};$j.bbget("LocationError.locations",i,function(a){BookingBuddy.LE.__callback(a,h,d,e)})}}},__callback:function(a,b,c,d){a&&(BookingBuddy.LE.updateSelect(d,a),BookingBuddy.LE.setPointInput(BookingBuddy.LE.point1InputID,1),BookingBuddy.LE.setPointInput(BookingBuddy.LE.point2InputID,2))},updateSelect:function(a,b){if(BookingBuddy.LE.inited){var c=$j("#"+a);if(c[0]){var d=c.val()?c.val():"";c[0].options.length=0;var e,f,g,h,i=0;for(var j in b)e=j,f=b[j],g=e==d,h=new Option(f,e,g),c[0].options[c[0].options.length]=h,g&&(c[0].selectedIndex=i),++i}}},checkSubmitRoute:function(){var a=BookingBuddy.LE.point1InputID,b=BookingBuddy.LE.point2InputID,c=$j("#point_1"),d=$j("#point_2"),e=c.selectedIndex,f=d.selectedIndex;if(0>e||0>f)return alert(BookingBuddy.Strings.LE.ChooseArrivalAndDeparture),!1;var g=BookingBuddy.LE.setPointInput(a,1),h=BookingBuddy.LE.setPointInput(b,2);return g&&h?!0:(alert(BookingBuddy.Strings.LE.GenericError),!1)},checkSubmitSingle:function(){var a=BookingBuddy.LE.point1InputID,b=$j("#point_1"),c=b.selectedIndex;if(0>c)return alert(BookingBuddy.Strings.LE.ChooseLocation),!1;var d=BookingBuddy.LE.setPointInput(a,1);return d||alert(BookingBuddy.Strings.LE.GenericError),d},setPointInput:function(a,b){var c=$j("#point_"+b),d=$j("#"+a);if(!c[0]||!d[0]||!c.val())return!1;var e=c.val().split("|");return e[1]&&d.val(e[1]),!0}};
//# sourceMappingURL=LE.nano.js.map
BookingBuddy.User={source_cookie:"referrer",init:function(){},_sanitizeSource:function(a,b,c,d){return{source:a.replace(/[^\w\-\.]/,""),value:b.replace(/[^\w\-\.]/,""),value2:c.replace(/[^\w\-\.]/,""),timestamp:parseInt(d,10)}},getSource:function(a){var b=decodeURIComponent(BookingBuddy.getCookie(BookingBuddy.User.source_cookie));if(!b)return null;var c=b.split(":::");if(4>c.length)return null;var d=BookingBuddy.User._sanitizeSource(c[0],c[1],c[3],c[2]);return 5==c.length&&(d.sunique=c[4].replace(/[^\w\-\.]/,"")),"undefined"==typeof a?d:d[a]},session_cookie:"ssource",json_source:null,getSourceMeta:function(a){if(void 0==a)return null;if(null===BookingBuddy.User.json_source&&(BookingBuddy.User.json_source=decodeURIComponent(BookingBuddy.getCookie(BookingBuddy.User.session_cookie))),!BookingBuddy.User.json_source)return null;var b=stm.parseJSON(unescape(BookingBuddy.User.json_source));return null!=b&&b[a]?b[a]:null}};
//# sourceMappingURL=User.nano.js.map
BookingBuddy.PopUnder={searchesPerformed:0,popUnderArray:[],center:null,init:function(a){BookingBuddy.PopUnder.searchesPerformed=parseInt(BookingBuddy.getCookie("BBPopUnderNumOfSearches"),10),isNaN(BookingBuddy.PopUnder.searchesPerformed)&&(BookingBuddy.PopUnder.searchesPerformed=0);var b=$j("#"+a);b&&b.bind("submit",function(a){BookingBuddy.PopUnder.searchesPerformed++,BookingBuddy.createCookie("BBPopUnderNumOfSearches",BookingBuddy.PopUnder.searchesPerformed,30),setTimeout(BookingBuddy.PopUnder.call,500)})},register:function(a,b,c,d,e,f){BookingBuddy.PopUnder.popUnderArray.push({url:a,params:d,numOfSearches:b,center:c,height:e,width:f})},call:function(a){if("object"==typeof a&&a)return BookingBuddy.PopUnder.pop(a);for(var b=0;b<BookingBuddy.PopUnder.popUnderArray.length;b++){var c=BookingBuddy.PopUnder.popUnderArray[b];BookingBuddy.PopUnder.pop(c)}return!0},pop:function(a){if("object"!=typeof a&&!a)return!1;if(a.numOfSearches&&BookingBuddy.PopUnder.searchesPerformed!=a.numOfSearches)return!1;a.params+=",height="+a.height+",width="+a.width;var b=a.name?a.name:"BBPopUnder"+Math.floor(100*Math.random()),c=window.open("about:blank",b,a.params);if(!c)return!1;if(a.name&&$j(document).trigger("BookingBuddy:"+a.name+"Opened"),c.blur(),a.center){var d=(screen.width-(a.width+32))/2,e=(screen.height-(a.height+96))/2;c.moveTo(d,e)}else a.xpos&&a.ypos?c.moveTo(a.xpos,a.ypos):c.moveTo(0,0);return c.location.href=a.url,c},firstClick:function(a){if(a.popunderName&&a.getPopunderURL&&a.width&&a.height&&!($j("#searchModeName").length<1)){var b=$j("#searchModeName").text()||"air",c=new Array("google","msn","yahoo"),d=BookingBuddy.User.getSourceMeta("marketing_partner");d&&c.each(function(a){d.match(a)});var e=null;if("car"==b)e="pickup_city";else{if("cruise"==b||"vacation_rental"==b)return;e="arrival_city"}if(!($j("#"+e).length<1&&(e=b+"_"+e,$j("#"+e).length<1))){var f=cookie_name=a.popunderName,g=null;$j("#"+e).blur(function(){g&&!g.closed&&(g.location.href=a.getPopunderURL(e))});var h=navigator.userAgent.match("AOL"),i=BookingBuddy.User.getSourceMeta("unique_name");if(!h&&a.popOnExit&&source&&i.search(/^(BBS_TripMama_.*|bbs_tv_.*)/i)<0){var j=a.getPopunderURL(e);ExitPopup.init({url:j+(-1==j.search(/\?/)?"?":"&")+"exit=1",num_searches:0,windowOptions:"toolbar=1,location=1,directories=0,status=1,menubar=1,scrollbars=1,resizable=1",resizetoW:a.width,resizetoH:a.height,popCallback:function(){return!BookingBuddy.getCookie(cookie_name)},mode:"full"})}var k=!1;$j(document).bind("BookingBuddy:FirstClick",function(){k||BookingBuddy.getCookie(cookie_name)||(k=!0,setTimeout(function(){g=BookingBuddy.PopUnder.call({name:f,url:a.getPopunderURL(e),numOfSearches:null,center:"yes",params:"toolbar=1,location=1,directories=0,status=1,menubar=1,scrollbars=1,resizable=1",height:a.height,width:a.width})},1e3))}),$j(document).bind("click.first",function(b){var c=$j(b.target);c.hasClass("noFirstClick")||c.parents(".noFirstClick").length||a.waitForLocation&&""===$j("#"+e).val()||(c.trigger("BookingBuddy:FirstClick"),$j(this).unbind("click.first"))})}}}};
//# sourceMappingURL=PopUnder.nano.js.map

// include jQuery defaults
$j(function(){var a={dayNamesMin:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],minDate:new Date,numberOfMonths:2,onClose:function(a,b){b.input.blur()}};$j.datepicker.setDefaults(a)});
//# sourceMappingURL=jQueryDefaults.nano.js.map

function statusBar(a){return window.status=a||"",!0}Object.subClass||!function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;Object.subClass=function(c){function d(){!a&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;a=!0;var f=new this;a=!1;for(var g in c)f[g]="function"==typeof c[g]&&"function"==typeof e[g]&&b.test(c[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}}(g,c[g]):c[g];return d.prototype=f,d.constructor=d,d.subClass=arguments.callee,d}}(),function($){$.extend($,{tmpl:function(str,data){if("object"!=typeof data)return"";with(data)return str.replace(/\\?#\{([^{}]+)\}/g,function(match,name){if("\\"==match.charAt(0))return match.slice(1);try{return eval("data."+name)}catch(err){return""}})},getSize:function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},getValues:function(a){var b=[];for(var c in a)b.push(a[c]);return b},getKeys:function(a){var b=[];for(var c in a)b.push(c);return b},toQueryString:function(a){if("object"!=typeof a)return"";var b="";return $j.each(a,function(a,c){b+=a+"="+encodeURIComponent(c)+"&"}),b=b.slice(0,b.length-1)},toQueryObject:function(a){if(a.indexOf("=")<1)return{};var b="?"===a.substring(0,1)?a.slice(1):a,c={};return $j.each(b.split("&"),function(a,b){var d=b.split("=",2),e=unescape(d[0].replace(/\[\]$/,"")),f=unescape(d[1]);e in c?$j.isArray(c[e])?c[e].push(f):c[e]=[c[e],f]:c[e]=f}),c},isBoolean:function(a){return"object"==typeof a&&null!==a?"boolean"==typeof a.valueOf():"boolean"==typeof a},isNull:function(a){return null===a},isUndefined:function(a){return"undefined"==typeof a},isNullOrUndefined:function(a){return $.isNull(a)||$.isUndefined(a)},isString:function(a){return"string"==typeof a},isArray:function(a){return"object"==typeof a&&a instanceof Array},emptyString:function(a){return $.isNullOrUndefined(a)?!0:$.isString(a)?0===a.replace(/^\s+|\s+$/g,"").length:!1},startsWith:function(a,b){return $.isString(a)?0===a.indexOf(b):!1},stringFormat:function(){for(var a=arguments[0],b=0;b<arguments.length-1;b++){var c=new RegExp("\\{"+b+"\\}","gm");a=a.replace(c,arguments[b+1])}return a}})}(jQuery);var Utils={sleep:function(a){var b={seconds:a},c={service:"Sleep.fetch",args:JSON.stringify(b)};$j.ajax({url:"/ajax/",data:c,async:!1})},sameObj:function(a,b){if(0===$j.getSize(a)||0===$j.getSize(b))return!1;for(var c in a)if(a[c]){if("function"!=typeof a[c]&&a[c]!==b[c])return!1}else if(b[c])return!1;for(c in b)if("undefined"==typeof a[c])return!1;return!0},setRequiredDivs:function(a,b){$j.each(a,function(a,c){var d=b[c];if(b[c]=$j("#"+d),1!=b[c].length)throw{name:"InvalidId",message:"Invalid div ID: "+d}})},setDivs:function(a,b){$j.each(a,function(a,c){var d=b[c];b[c]=$j("#"+d)})},extend:function(a,b){for(var c in b)a[c]=b[c];return a},getCookie:function(a){var b=!1,c=document.cookie.indexOf(a+"=");if(-1!=c){var d=c+a.length+1,e=document.cookie.indexOf(";",d);-1==e&&(e=document.cookie.length),b=document.cookie.substring(d,e)}return b},getElement:function(a){return"string"===Utils.type(a)&&(a=$j("#"+a)[0]),a},getOption:function(a,b,c){return a?Utils.pick(a[b],c):c},merge:function(){for(var a=[{}],b=0,c=arguments.length;c>b;++b)a.push(arguments[b]);return Utils.mixin.apply(null,a)},mixin:function(a){for(var b=1,c=arguments.length;c>b;++b){var d=arguments[b];if("object"===Utils.type(d))for(var e in d){var f=d[e],g=a[e];a[e]=g&&"object"===Utils.type(f)&&"object"===Utils.type(g)?Utils.mixin(g,f):Utils.unlink(f)}}return a},pick:function(){for(var a=0;a<arguments.length;++a)if(void 0!==arguments[a])return arguments[a];return null},reset:function(a,b){if(Utils.type(b)===!1){for(var c in a)Utils.reset(a,c);return a}switch(delete a[b],Utils.type(a[b])){case"object":var d=function(){};d.prototype=a[b];var e=new d;a[b]=Utils.reset(e);break;case"array":a[b]=Utils.unlink(a[b])}return a},setCookie:function(a,b,c){var d="",e=c&&c.domain?c.domain:null,f=Utils.getOption(c,"domain",window.location.host),g=window.stm&&window.stm.cookies?window.stm.cookies.getCookieDomain(e,f):window.location.host;if(Utils.getOption(c,"offset",!1)){switch(c.type){case"years":c.offset*=365;case"days":c.offset*=24;case"hours":c.offset*=60;case"minutes":c.offset*=60;case"seconds":c.offset*=1e3}var h=new Date;h.setTime(h.getTime()+c.offset),d=";expires="+h.toGMTString()}f!==g&&(document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+f+";path=/"),document.cookie=a+"="+b+d+";domain="+g+";path=/"},splat:function(a){var b=Utils.type(a);return b?"array"!==b&&"arguments"!==b?[a]:a:[]},unlink:function(a){var b;switch(Utils.type(a)){case"object":b={};for(var c in a)b[c]=Utils.unlink(a[c]);break;case"array":b=[];for(var d=0,e=a.length;e>d;++d)b[d]=Utils.unlink(a[d]);break;default:return a}return b},type:function(a){if(void 0==a)return!1;if(a instanceof Array)return"array";if(a instanceof Date)return"date";if(a instanceof RegExp)return"regexp";if(a.nodeName)switch(a.nodeType){case 1:return"element";case 3:return/\S/.test(a.nodeValue)?"textnode":"whitespace"}else if("number"==typeof a.length){if(a.callee)return"arguments";if(a.item)return"collection"}return typeof a}};Object.size=function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},String.prototype.toQueryObject=function(){if(this.indexOf("=")<1)return{};var a="?"===this.substring(0,1)?this.slice(1):this,b={};return $j.each(a.split("&"),function(a,c){var d=c.split("=",2),e=unescape(d[0].replace(/\[\]$/,"")),f=unescape(d[1]);e in b?$j.isArray(b[e])?b[e].push(f):b[e]=[b[e],f]:b[e]=f}),b},Object.toQueryString=function(a){if("object"!=typeof a)return"";var b="";return $j.each(a,function(a,c){b+=a+"="+encodeURIComponent(c)+"&"}),b=b.slice(0,b.length-1)};
//# sourceMappingURL=Utility.nano.js.map
BBDebug={enabled:!1,console:null,initComplete:!1,init:function(){if(!BBDebug.initComplete){BBDebug.initComplete=!0;var a=window.location.toString();-1!=a.indexOf("mr_debug")&&(BBDebug.enable(!0),BBDebug.log("Enabling BBDebug from QS"))}},enable:function(a){BBDebug.enabled=a},log:function(a,b){BBDebug.init();var c=BBDebug.getConsole();null!==c&&("undefined"!=typeof b?c.log(a,b):c.log(a))},error:function(a,b){BBDebug.init();var c=BBDebug.getConsole();null!==c&&("undefined"!=typeof b?c.error(a,b):c.error(a))},dir:function(a){BBDebug.init();var b=BBDebug.getConsole();null!==b&&b.dir(a)},trace:function(){BBDebug.init();var a=BBDebug.getConsole();null!==a&&a.trace()},group:function(a,b){BBDebug.init();var c=this.getConsole();c&&(b&&c.groupCollapsed?c.groupCollapsed(a):c.group&&c.group(a))},groupEnd:function(a,b){BBDebug.init();var c=this.getConsole();c&&c.groupEnd&&c.groupEnd()},getConsole:function(){return BBDebug.init(),BBDebug.enabled?(null===BBDebug.console&&("undefined"!=typeof console?BBDebug.console=console:"undefined"!=typeof firebug&&(firebug.initConsole(),firebug.init(),"undefined"!=typeof console&&(BBDebug.console=firebug.console))),BBDebug.console):null},logError:function(a,b,c){return BBDebug.init(),"undefined"==typeof a&&(a=""),"undefined"==typeof c&&(c=""),"undefined"==typeof b&&(b=window.location),BBDebug.log("Error message:"+a+" | from "+b+" at line "+c),!1}},window.onerror=BBDebug.logError;
//# sourceMappingURL=BBDebug.nano.js.map
var BBMetaData=Object.subClass({init:function(a){this.metaData={id:a}},getID:function(){return this.getMetaData("id")},getMetaData:function(a){return $j.isUndefined(this.metaData[a])?null:this.metaData[a]},setMetaData:function(a,b){return this.metaData[a]=b,this},setMetaDataMulti:function(a){for(var b in a)this.setMetaData(b,a[b]);return this},display:function(a){return $j.tmpl(a,this.metaData)},getTrackingInfoAsQueryString:function(){var a=this.getMetaData("tracking_info");return a?$j.param(a):""}}),BBAd=BBMetaData.subClass({});BBAd.objectPool={},BBAd.singleton=function(a){return $j.isUndefined(BBAd.objectPool[a])&&(BBAd.objectPool[a]=new BBAd(a)),BBAd.objectPool[a]};var TACheckRates=BBMetaData.subClass({});TACheckRates.objectPool={},TACheckRates.singleton=function(a){return $j.isUndefined(TACheckRates.objectPool[a])&&(TACheckRates.objectPool[a]=new TACheckRates(a)),TACheckRates.objectPool[a]};
//# sourceMappingURL=BBAd.nano.js.map
!function(a){a.extend({bbget:function(b,c,d,e){"undefined"==typeof e&&(e="json");var f={service:b,args:JSON.stringify(c)};return a.get("/ajax/",f,d,e),!0}})}(jQuery);
//# sourceMappingURL=BBAJAX.nano.js.map
var BBIPLocation=Object.subClass({inputs:null,location:null,request_done:!1,service:"LocationSuggest.ip",type:null,init:function(a){this.type=a,this.inputs=[]},register:function(a,b){var c=$j("#"+a);if(c.length<=0)return!1;if(-1===$j.inArray(c,this.inputs)&&(c.data("overwrite",b),this.inputs.push(c)),this.location)return this.updateLocation(),!1;var d=BookingBuddy.getQSParam("icup"),e=BookingBuddy.getCookie("iploc");return!d&&e?(this.updateLocation(e,!0),!1):this.request_done?!1:(this.request_done=!0,this.serviceRequest(d))},updateLocation:function(a,b,c){$j.isNullOrUndefined(a)||(this.location=a),$j.each(this.inputs,$j.proxy(function(a,d){(!d.val()||d.data("overwrite"))&&(d.val(this.location),b||this.updateElementValidation(d,c),d.blur())},this)),BookingBuddy.createCookie("iploc",this.location,1440)},updateElementValidation:function(a,b){var c=a.data("smartElement");c&&c.locationSuggest&&c.locationSuggest.addValidLocation(this.location,{country:b})},serviceRequest:function(a){var b={type:this.type};return $j.isNullOrUndefined(a)||(b.icup=a),$j.bbget(this.service,b,$j.proxy(this.serviceCallback,this)),!0},serviceCallback:function(a){return a?(a.iplocation&&this.updateLocation(a.iplocation,!1,a.country),!0):!1}});BBIPLocation.object_pool={},BBIPLocation.populate=function(a,b,c){return $j.isNullOrUndefined(BBIPLocation.object_pool[a])&&(BBIPLocation.object_pool[a]=new BBIPLocation(a)),BBIPLocation.object_pool[a].register(b,c)};
//# sourceMappingURL=BBIPLocation.nano.js.map
!function(a){a.extend({asyncLoad:function(b,c,d,e){if(a(b).length>0)return d(b),!0;var f={id:c,af:BookingBuddy.affiliateName,extra:a.extend({},e)},g=function(c){return a("body").append(c),a(b).length?void d(b):void BBDebug.log("$.asyncLoad: Could not run callback, missing: "+b)};return a.bbget("ContentLoader.load",f,g),!0}})}(jQuery);
//# sourceMappingURL=BBAsyncContent.nano.js.map
function BBSearchData(a){var b={air:{l1:"departure_city",d1:"departure_date",t1:"departure_time",l2:"arrival_city",d2:"return_date",t2:"return_time",ntrv:"num_travelers",st:"search_type",sc:"service_class",ns:"non_stop"},hotel:{l2:"arrival_city",d1:"arrival_date",d2:"departure_date",prv:"provider",ntrv:"num_travelers",nrms:"num_rooms"},car:{l2:"pickup_city",d1:"pickup_date",t1:"pickup_time",d2:"dropoff_date",t2:"dropoff_time",da:"driver_age"},vacation:{l1:"departure_city",d1:"departure_date",l2:"arrival_city",d2:"return_date",ntrv:"num_travelers"},vacation_rental:{l2:"arrival_city",d1:"arrival_date",d2:"departure_date",nrms:"num_bedrooms"},cruise:{c3:"destination",d3:"travel_month",clin:"cruise_line",clen:"cruise_length",o55:"over_55"},holiday:{l1:"departure_city",l2:"arrival_city",d1:"departure_date",d2:"return_date",flx:"flex_days",ppp:"price_per_person",bb:"board_basis",ntrv:"num_travelers",nchl:"num_children"}},c={ac:"arrival_city",dc:"departure_city",pc:"pickup_city",dd:"departure_date",ad:"arrival_date",rd:"return_date",dt:"departure_time",rt:"return_time",ns:"non_stop",sc:"service_class",nt:"num_travelers",st:"search_type",dest:"destination",tm:"travel_month",cl:"cruise_line"};this.setData=function(a,d,e){"undefined"==typeof b[e]&&(e="air"),"undefined"!=typeof c[a]&&(a=c[a]);var f=b[e];for(var g in f)if(f[g]==a){this[g]=d,("d1"===g||"d2"===g)&&(this[g]=stm.dates.formatDate("u",new Date(d))),("l1"===g||"l2"===g)&&("object"==typeof d&&d.airport&&d.airport.name&&-1!==d.airport.name.indexOf("All Airports")?this["prev"+g]=d:this["prev"+g]=null);break}return this[g]},this.getData=function(a,d){"undefined"!=typeof c[a]&&(a=c[a]);var e=b[d];for(var f in e)if(e[f]==a&&"undefined"!=typeof this[f])return-1!==a.search(/_date$/)?stm.dates.parseDate("u",this[f]).getTime():this[f];return null},this.getDataByMode=function(a){var c=b[a],d=new BBSearchData;for(var e in c)"undefined"!=typeof this[e]&&(d[e]=this[e]);return d},this.getLocation1=function(a){return this.getLocation("l1",a)},this.getLocation2=function(a){return this.getLocation("l2",a)},this.getLocation=function(a,b){var c=this[a];if(!c||"object"!=typeof c)return null;b=$j.isArray(b)?b.slice(0):["airport","city","state","region"];for(var d=b.shift();d;){if(c[d])return c[d];d=b.shift()}return null},this.display=function(a,b){var c=this.getDataByMode(a);for(var d in c)if(-1!==d.search(/d\d/)){var e=new Date;if("d3"==d){var f=c[d].split("-");if(3!=f.length)break;e.setFullYear(f[0]),e.setMonth(f[1]-1),e.setDate(f[2])}else e.setTime(c[d]);c[d]={},c[d].month=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,c[d].day=e.getDate()<10?"0"+e.getDate():e.getDate(),c[d].year=e.getFullYear()}return $j.tmpl(b,c)}}
//# sourceMappingURL=BBSearchData.nano.js.map
function BBSavedSearchData(a,b){var c="undefined"!=typeof a?a:"cs",d={cs:{}},e={air:["airport"],hotel:["city"],car:["airport","city"],vacation:["airport"],vacation_rental:["city","region","state"],cruise:[],holiday:["city","state","country"]};this.getLocationSuggestTypesByMode=function(a){var b=[],c=e[a];return c&&(b=c.slice(0)),b},this.empty=function(){d.cs=new BBSearchData},this.getSavedSearches=function(){return d},this.getCurrentState=function(){return d.cs},this.addCurrentSearchData=function(a,b,c){a.indexOf("_city")>0&&"string"==typeof b&&("to"==b.toLowerCase()||"from"==b.toLowerCase())||d.cs.setData(a,b,c)&&(this.storeSearches(),BBDebug.log("-- added to current search ["+c+"]["+a+"]="+b,d.cs))},this.getCurrentSearchData=function(a,b){return d.cs.getData(a,b)},this.getStoredSearches=function(){var a=BookingBuddy.getCookie(c),b=null;if(a&&(b=stm.parseJSON(a)),b&&!_.isEmpty(b)){d=stm.usdCookieTranslator.translateCStoBBV2(b);var e;if("object"==typeof d.cs){var f=new BBSearchData;for(e in d.cs)f[e]=d.cs[e];d.cs=f,delete f}}else d.cs=new BBSearchData},this.storeSearches=function(){var a=stm.usdCookieTranslator.translateBBV2toCS(d),b=encodeURIComponent(JSON.stringify(a));BookingBuddy.createCookie(c,b,43200)},this.getStoredSearches()}BBSavedSearchData.prototype.objectPool={},BBSavedSearchData.singleton=function(a,b){var c=a||"____blank";return"undefined"==typeof BBSavedSearchData.prototype.objectPool[c]&&(BBSavedSearchData.prototype.objectPool[c]=new BBSavedSearchData(a,b)),BBSavedSearchData.prototype.objectPool[c]};
//# sourceMappingURL=BBSavedSearchData.nano.js.map
var BBTargeting=Object.subClass({adIDs:[],inputs:[],adsPerRow:4,adContainerDiv:"BBLTWrapper",adDisplayDiv:"BBLTAds",titleDisplayDiv:"BBLTHeader",adTemplate:"Default",titleTemplate:"Default",submittedArgs:{},searchMode:null,init:function(a,b){if("undefined"==typeof b){if("undefined"==typeof BookingBuddy.targetedAdIds)return!1;if(0===BookingBuddy.targetedAdIds.length)return!1;b=BookingBuddy.targetedAdIds}if("undefined"==typeof a||0===b)return!1;try{var c=["adDisplayDiv","adContainerDiv"];Utils.setRequiredDivs(c,this),$j.each(b,$j.proxy(function(a,b){this.addAdID(b)},this)),$j.each(a,$j.proxy(function(a,b){this.addInput(b)},this))}catch(d){return BBDebug.error(d.name+" EXCEPTION: "+d.message),!1}var e=!0;return $j.each(this.inputs,function(a,b){(b.hasClass("LSInvalid")||""===b.val())&&(e=!1)}),e&&this.updateHandler(),!0},addInput:function(a){var b=$j("#"+a);if(1!=b.length)throw{name:"InvalidId",message:"Invalid BBTargeting Input ID: "+a};var c=b.data("smartElement");if(this.searchMode=c.smartForm.mode,this.inputs.push(b),b.hasClass("TargetingNoUpdate"))return!0;if(b.hasClass("locationSuggest"))b.bind("LocationSuggest:valid",{obj:this,input:b},$j.proxy(this.updateHandler,this));else{var d=b.is("select,input[@type=radio]")?"change":"blur";b.bind(d,{obj:this,input:b},$j.proxy(this.updateHandler,this))}return!0},addAdID:function(a){var b=new Image;b.src=BBAd.singleton(a).getMetaData("logo"),this.adIDs.push(a)},updateHandler:function(a){var b={};$j.each(this.inputs,function(a,c){var d=c.attr("name");"radio"==c.attr("type")?c.is(":checked")&&(b[d]=c.val()):b[d]=c.val()}),b.m=this.searchMode,b.ids=this.adIDs.join(":"),Utils.sameObj(b,this.submittedArgs)||(this.adContainerDiv.is(":visible")&&this.adContainerDiv.slideUp("slow",function(){$j(this).trigger("BBTargeting:containerClosed")}),BBDebug.log("------ Updating targeting"),$j.bbget("LocationTargeting.targeted",b,$j.proxy(this.processAds,this)),this.submittedArgs=b)},processAds:function(a){if(BBDebug.log("BBTargeting data: ",a),a&&"undefined"!=typeof a.ids&&0!==a.ids.length){var b,c=[];$j.each(a.ids,function(a,d){b=BBAd.singleton(d.ad_id),"Y"!=d.is_priced&&c.push(b)}),delete b,c.length>0&&(this.updateAdDiv(c),this.updateTitleDiv(a.msg))}},updateAdDiv:function(a){BBDebug.log("-- updateAdDiv");for(var b,c="",d=this.adTemplate;a.length>0;)b=a.splice(0,this.adsPerRow),c+='<div class = "BBSearchLogos'+b.length+'">',$j.each(b,function(a,b){c+=b.display(BookingBuddy.Strings.LT.ad[d])}),c+="</div>";this.adDisplayDiv.html(c),this.adDisplayDiv.trigger("BBTargeting:adsUpdated"),this.showAdDiv()},updateTitleDiv:function(a){var b=$j("#"+this.titleDisplayDiv);if(1!=b.length)throw{name:"InvalidId",message:"Invalid BBTargeting title display div ID: "+this.titleDisplayDiv};var c=this.searchMode,d=this.titleTemplate;"air"==c?d+=a.point_1&&a.point_2?"_RoundTrip":a.point_1?"_From":"_To":"vacation"==c&&(!a.point_2&&a.point_1?d+="_From":a.point_2&&(d+="_To"));var e=$j.tmpl(BookingBuddy.Strings.LT[c][d],a);$j(b).html(e),$j(b).trigger("BBTargeting:titleUpdated")},showAdDiv:function(){this.adContainerDiv.slideDown("slow",function(){$j(this).trigger("BBTargeting:adContainerOpen")})}});
//# sourceMappingURL=BBTargeting.nano.js.map

BookingBuddy.submitHandlers={prepopWindows:[],searchWindows:[],checkedMultiWindowOptions:{winTop:35,winTopInc:35,winLeft:170,winHeight:788,winWidth:1200,winLeftInc:50},windowOptions:{safari:stm.Browser.safari,left:screen.width-925>0?screen.width-925:0,multiAdWidget:"status=1,toolbar=1,location=1,menubar=1,resizable=1,scrollbars=1,height=800,width=1024",options:function(){var a=(stm.Browser.ie||BookingBuddy.submitHandlers.windowOptions.safari?"toolbar=0":"toolbar=1")+",location=1,menubar=0,resizable=1,scrollbars=1,height=525,width=925,top=35,left="+BookingBuddy.submitHandlers.windowOptions.left;return a}},defaultHandler:function(a,b,c){c.stopPropagation(),c.preventDefault();var d=$j.data(a,"smartForm"),e=$j(a).attr("action"),f=e+(-1!=e.indexOf("?")?"&":"?")+$j(a).serialize();if(d.submitHandlerData.action=e,d.submitHandlerData.target=b,d.submitHandlerData.url=f,b&&"_top"===b)return d.settings.debug||(top.location.href=f),!1;var g="BBwin"+(new Date).getTime();if(d.submitHandlerData.window_name=g,!d.settings.debug){var h=window.open(f,g);if(!h)return!1;a.target=g,h.focus()}return!1},noHandler:function(a,b,c){return!0},multiAdWidgetHandler:function(a,b,c){c.stopPropagation(),c.preventDefault();var d=$j(a).find(".multi_site:checked");if(d.length<1)return BookingBuddy.submitHandlers.defaultHandler(a,b,c);var e=$j.data(a,"smartForm"),f=$j(a).attr("action"),g=f+(-1!=f.indexOf("?")?"&":"?")+$j(a).serialize(),h="BBwin"+(new Date).getTime(),i=window.open(g,h,this.windowOptions.multiAdWidget);if(!i)return!1;var j=new Array,k=$j("#siteDomainBase").html(),l=e.mode+"_arrival_city",m=this.windowOptions.multiAdWidget;return d.each(function(){var b=$j(this).attr("id"),c=$j("#blank_form_"+b).length>0?$j("#blank_form_"+b).html():!1,d=!1;$j("#"+l).length>0&&(d=$j.emptyString($j("#"+l).val()));var e="http://rd."+k+"?r="+b+"&"+$j(a).serialize();c&&d&&(e=c),h=b;var f=window.open(e,h,m);f&&(j.push(f),f.focus())}),i.focus(),!1},setFormRedirectUrl:function(a,b){var c;if(b?c=b:$j("#siteRedirectUrl").text()&&(c=$j("#siteRedirectUrl").text()),!c)return!1;a.attr("action",c);var d=c.split("?");if(d.length>1){qs=d[1],paramPairs=qs.split("&");for(var e=0;e<paramPairs.length;e++)param=paramPairs[e].split("="),2==param.length&&BookingBuddy.submitHandlers.setOrAddFormValue(param[0],decodeURIComponent(param[1]),a)}return!0},setOrAddFormValue:function(a,b,c){var d=c.find("input[name='"+a+"']");0===d.length?$j("<input />",{name:a,type:"hidden",value:b}).appendTo(c):d.val(b)},openMultiWindow:function(a,b){var c=BookingBuddy.submitHandlers,d=c.checkedMultiWindowOptions.winTop,e=c.checkedMultiWindowOptions.winTopInc,f=c.checkedMultiWindowOptions.winLeft,g=c.checkedMultiWindowOptions.winLeftInc,h=c.checkedMultiWindowOptions.winHeight,i=c.checkedMultiWindowOptions.winWidth,j=.75*screen.availHeight,k="",l=[];$j.isArray(b)&&$j.each(b,function(b,c){!c.win_obj.closed&&a>0&&(l.push({win_obj:c.win_obj,win_name:c.win_name}),a--,c.win_obj.focus())});var m=a>1;for(stm.Popup.prepareMultiPop(a);a>0;){k="bb_search_"+a+"_"+Number(new Date);var n=new stm.Popup("about:blank",{name:k,height:h,width:i,top:d,left:f});n.tryPop(),n.hasPopped?(l.push({win_obj:n.popupWindow,win_name:k}),f+=g,d=Math.min(d+e,j),a--):(a--,m&&(m=!1))}return m?c.resetCheckedMultiWindowOptions():(c.checkedMultiWindowOptions.winTop=d,c.checkedMultiWindowOptions.winLeft=f),l},resetCheckedMultiWindowOptions:function(){var a=BookingBuddy.submitHandlers;return a.checkedMultiWindowOptions.winTop=35,a.checkedMultiWindowOptions.winLeft=370,!0},deprecated_bbukSubmitCheckRates:function(a,b,c){c.stopPropagation(),c.preventDefault();var d=$j.data(a,"smartForm");if(d.submitHandlerData.trigger_id=$j(d.submitTrigger).attr("id"),d.submitHandlerData.submit_type=$j(d.submitTrigger).hasClass("runSearch")?"runSearch":"default",d.submitTrigger&&$j(d.submitTrigger).hasClass("runSearch")){var e=$j(a).find(".adIdCheckBox:visible"),f=$j(a).find(".adIdCheckBox:visible:checked");d.submitHandlerData.checked_ads=f.length,f.length>0?($j("#"+d.id+"_aderrors").hide(),d.settings.debug||BookingBuddy.UK.submitCheckedSearches(d.id,e),$j("#dhtml_hotel_search").hide()):(d.valid=!1,$j("#"+d.id+"_aderrors").show())}return!1}};
//# sourceMappingURL=SubmitHandlers.nano.js.map

!function(a){a.extend(a.fn,{dhtmlDropdownFactory:function(b,c){if(!this.length)return null;var d=a.data(this[0],"dhtmlDropdown");return d?d:(a.isNullOrUndefined(b)&&(b=[]),d=new a.dhtmlDropdown(this[0],b,c),a.data(this[0],"dhtmlDropdown",d),d.init(),d)}}),a.dhtmlDropdown=function(b,c,d){this.element=a("<div></div>").attr("class",a.dhtmlDropdown.constants.CLASS_MAIN).prependTo(b),this.entries_element=null,this.current_element=null,this.entry_order=a.merge([],c),this.entry_display={},a.each(this.entry_order,a.proxy(function(a,b){this.entry_display[b]=null!==BBAd.singleton(b)},this)),this.is_open=!1,this.options=a.extend({},a.dhtmlDropdown.defaults,d),this.value=null},a.extend(a.dhtmlDropdown,{constants:{EVENT_SHOW:"DHTMLDropdown:show",EVENT_HIDE:"DHTMLDropdown:hide",EVENT_READY:"DHTMLDropdown:ready",EVENT_SELECT:"DHTMLDropdown:select",CLASS_MAIN:"dropdown_display",CLASS_BUTTON:"dropdown_button",CLASS_CURRENT:"dropdown_text",CLASS_OPTION_LIST:"dropdown_options",CLASS_OPTION_ENTRY:"dropdown_option"},defaults:{list_position:"top",initialText:"Search More Sites...",tpt_premium:null,tpt_basic:null,tpt_placeholder:null},prototype:{init:function(){return this.element.click(a.proxy(this._handleMainClick,this)),a("<div></div>").attr("class",a.dhtmlDropdown.constants.CLASS_BUTTON).appendTo(this.element),this._setCurrent(this.options.initialText),this._buildEntries(),this.element.trigger(a.dhtmlDropdown.constants.EVENT_READY),this},val:function(b){return a.isUndefined(b)||(this.value=b),this.value},updateCurrent:function(a){this.val(a),this._setCurrent(),this.element.trigger($j.dhtmlDropdown.constants.EVENT_SELECT)},toggle:function(){return this.is_open?this._hideEntries():this._showEntries(),this},redraw:function(){return this.entries_element.each(function(b,c){a(c).unbind()}),this.entries_element.remove(),this._setCurrent(this.options.initialText),this._buildEntries(),this},insert:function(b,c){return this.entry_display[b]=null!==BBAd.singleton(b),-1===a.inArray(b,this.entry_order)&&(!a.isUndefined(c)&&c?this.entry_order.unshift(b):this.entry_order.push(b)),this},remove:function(a){return this.entry_display[a]=!1,this},reset:function(){return this.entry_display={},this},_showEntries:function(){this._positionEntries(),this.entries_element.show().focus(),this.is_open=!0,a(document).one("click.dhtmlDropdown",a.proxy(function(a){return a.stopPropagation(),a.preventDefault(),this._hideEntries(),!1},this)),this.element.trigger(a.dhtmlDropdown.constants.EVENT_SHOW)},_hideEntries:function(){this.entries_element.hide().blur(),this.is_open=!1,a(document).unbind("click.dhtmlDropdown"),this.element.trigger(a.dhtmlDropdown.constants.EVENT_HIDE)},_positionEntries:function(){var a=this.element.position();return this.entries_element.css("left",a.left+"px"),"top"===this.options.list_position?this.entries_element.css("top",a.top-this.entries_element.outerHeight()+"px"):"bottom"===this.options.list_position&&this.entries_element.css("top",a.top+this.element.outerHeight()+"px"),this.entries_element},_setCurrent:function(b){var c=this.val(),d=null;d=a.isNullOrUndefined(c)?a.isNullOrUndefined(b)?this._getAdElm():b:this._getAdElm(BBAd.singleton(c)),this.current_element||(this.current_element=a("<div></div>").attr({"class":a.dhtmlDropdown.constants.CLASS_CURRENT}),this.element.prepend(this.current_element)),this.current_element.html(d)},_buildEntries:function(){var b=a("<div></div>").hide().attr({"class":a.dhtmlDropdown.constants.CLASS_OPTION_LIST}),c=this,d=[],e=[],f=null,g=null;a.each(this.entry_order,function(a,b){return f=BBAd.singleton(b),c.entry_display[b]&&f.getMetaData("display_name")?(g={html:c._getEntryElm(f),display_name:f.getMetaData("display_name"),id:b},c._isPremiumAd(f)?d.push(g):e.push(g),!0):!0}),d.length>0&&(this._getEntryElm().appendTo(b),a.each(d,function(a,c){c.html&&c.html.appendTo(b)}),this._getEntryElm().appendTo(b)),a.each(e,function(a,c){c.html&&c.html.appendTo(b)}),this.entries_element=b,this.element.append(b)},_getEntryElm:function(b){var c=null;return a.isUndefined(b)||(c=b.getID()),a("<div></div>").attr({"class":a.dhtmlDropdown.constants.CLASS_OPTION_ENTRY}).bind("click",{id:c},a.proxy(this._handleEntryClick,this)).append(this._getAdElm(b))},_getAdElm:function(b){var c=null;if(a.isUndefined(b))c=$j.tmpl(this.options.tpt_placeholder,{});else{var d=this._isPremiumAd(b)?this.options.tpt_premium:this.options.tpt_basic,e=" height: 16px;";b.getMetaData("placement")&&-1===b.getMetaData("placement").indexOf("dropdown")&&(e=" height: 31px; background-position: 0 -65px;"),c=$j.tmpl(d,{ad_id:b.getID(),label:b.getMetaData("display_name"),logo_url:b.getMetaData("logo"),css:e})}return c},_isPremiumAd:function(b){return!a.emptyString(b.getMetaData("logo"))},_handleMainClick:function(a){return a.preventDefault(),a.stopPropagation(),this.toggle(),!1},_handleEntryClick:function(a){return a.preventDefault(),a.stopPropagation(),this.toggle(),this.updateCurrent(a.data.id),!1}}})}(jQuery),function(a){a.extend(a.dhtmlDropdown,{utils:{revSearch:function(b,c){var d=a(b).find(".dropdown_checkbox .BBInputCheckBox"),e=a(b).find(".dropdown_checkbox label");a(c).bind(a.dhtmlDropdown.constants.EVENT_SELECT+" "+a.dhtmlDropdown.constants.EVENT_READY,function(b){var f=a(c).data("dhtmlDropdown").val();if(null===f)return d.removeAttr("checked"),!0;var g=BBAd.singleton(f);return null!==g&&d.length?(d.attr({id:"check_"+g.getID(),name:g.getMetaData("tracking_name")}),b.type===a.dhtmlDropdown.constants.EVENT_SELECT&&d.prop("checked",!0).change(),e.attr("for","check_"+g.getID()),!0):!0})},oneSearch:function(b,c){var d=a(c).find(".BBInputButton");d.addClass("submitTrigger"),a(d).click(function(b){return a(c).data("dhtmlDropdown").val()?!0:(b.stopPropagation(),b.preventDefault(),!1)}),a(c).bind(a.dhtmlDropdown.constants.EVENT_SELECT,function(b){var e=BBAd.singleton(a(c).data("dhtmlDropdown").val());return null!==e&&d.length?(d.attr({id:"bb_dropdown_"+e.getID(),name:e.getMetaData("tracking_name")}),d.click(),!1):!1})},classicSearch:function(b,c){var d=a(c).find(".BBInputButton"),e=a(c).parent().find(".BBInputButton.runSearch");a(c).bind(a.dhtmlDropdown.constants.EVENT_SELECT,function(b){var f=BBAd.singleton(a(c).data("dhtmlDropdown").val());return null!==f&&d.length?(e.attr({id:"bb_dropdown_submit_"+f.getID(),name:f.getMetaData("tracking_name")}),!1):!1})},searchOptions:function(b,c){var d=null,e=new RegExp(c,"i"),f="."+a.dhtmlDropdown.constants.CLASS_OPTION_ENTRY;return a(b).find(f).filter(function(b){return e.test(a(this).text())?(d=a(this),!0):!1}),d}}})}(jQuery);
//# sourceMappingURL=stm_dhtml_dropdown.nano.js.map
var LocationSuggest=Object.subClass({input:null,hiddenTarget:null,hiddenIdTarget:null,hiddenTaIdTarget:null,suggestServiceName:"LocationSuggest.suggest",validateServiceName:"LocationSuggest.validate",suggestTimeout:200,suggestTimeoutID:null,suggestionTypes:null,maxSuggestions:15,defaultText:null,ajaxTransport:null,currentSuggestions:null,airportValidLocations:null,cityValidLocations:null,country:null,extra_data:null,locationDataStore:null,mismatchedText:[],shouldValidate:!0,init:function(a,b,c,d,e,f){this.airportValidLocations={},this.cityValidLocations={},this.extra_data=$j.extend({},d),this.locationDataStore=new stm.shared.models.locationDataStore,this.suggestionTypes=b,"object"==typeof a?this.input=a:this.input=$j("#"+a);try{if(this.suggestionTypes.length<1)throw{name:"SuggestionTypeRequired",message:"You must specify at least one type suggestion type"};if(1!=this.input.length)throw{name:"InvalidInput",message:"Invalid input given for location suggest: "+input_id}}catch(g){return BBDebug.log(g.name+" EXCEPTION: "+g.message),!1}return this.hiddenTarget=$j.emptyString(c)?null:$j("#"+c).length>0?$j("#"+c):null,e&&e[0]&&(this.hiddenIdTarget=e),f&&f[0]&&(this.hiddenTaIdTarget=f),this.input.attr("autocomplete","off"),this.input.on("keyup",{obj:this},this.keyUpHandler),this.input.on("blur",{obj:this},this.handleBlur),this.airportsOnly=-1!==$j.inArray("airport",this.suggestionTypes)&&-1===$j.inArray("city",this.suggestionTypes),this.citiesOnly=-1!==$j.inArray("city",this.suggestionTypes)&&-1===$j.inArray("airport",this.suggestionTypes),this.airportsOrCities=$j.inArray("airport",this.suggestionTypes)>-1&&$j.inArray("city",this.suggestionTypes)>-1,this},setMaxSuggestions:function(a){this.maxSuggestions=parseInt(a,10)},updateSuggestions:function(){var a=this.input.val().toLowerCase();if($j.trim(a).length<3)return void this.closeSuggest();null!==this.suggestTimeoutID&&clearTimeout(this.suggestTimeoutID);var b=function(a){try{a?this.showSuggestions(a):(this.closeSuggest(),this.currentSuggestions=null)}catch(b){return this.closeSuggest(),void(this.currentSuggestions=null)}},c=function(){var a=this.input.val();this.suggestTimeoutID=null;var c=$j.extend({input:a,types:this.suggestionTypes,limit:this.maxSuggestions},this.extra_data);null!==this.country&&(c.country=this.country),this.ajaxTransport=$j.bbget(this.suggestServiceName,c,jQuery.proxy(b,this))};this.suggestTimeoutID=setTimeout(jQuery.proxy(c,this),this.suggestTimeout)},addValidLocation:function(a,b){b||(b={}),/\(\w{3}\)/.test(a)?"undefined"==typeof this.airportValidLocations[a]&&(this.airportValidLocations[a]=b):"undefined"==typeof this.cityValidLocations[a]&&(this.cityValidLocations[a]=b)},isValidLocation:function(a,b){if("undefined"!=typeof this.mismatchedText[a]){if("undefined"!=typeof this.airportValidLocations[this.mismatchedText[a]])return this.airportValidLocations[this.mismatchedText[a]];if("undefined"!=typeof this.cityValidLocations[this.mismatchedText[a]])return this.cityValidLocations[this.mismatchedText[a]]}return"city"===b?"undefined"!=typeof this.cityValidLocations[a]?this.cityValidLocations[a]:!1:"airport"===b&&"undefined"!=typeof this.airportValidLocations[a]?this.airportValidLocations[a]:!1},validate:function(a){if(this.shouldValidate){var b="LocationSuggest:valid",c="LocationSuggest:invalid";if($j.emptyString(a)||(b=b+":"+a,c=c+":"+a),this.input.hasClass("LSNoValidate"))return this.input.addClass("LSValid"),this.input.removeClass("LSInvalid"),void this.input.trigger(b);var d=this.input.val();if($j.emptyString(d)||d.length<2)return this.input.addClass("LSInvalid"),this.input.removeClass("LSValid"),this.input.data("location-data",null),void this.input.trigger(c);if($j.emptyString(this.defaultText)||this.defaultText!==d){var e=!1;if(this.airportsOrCities?e=this.isValidLocation(d,"airport")||this.isValidLocation(d,"city"):this.airportsOnly?e=this.isValidLocation(d,"airport"):this.citiesOnly&&(e=this.isValidLocation(d,"city")),e)return this.input.removeClass("LSInvalid"),this.input.addClass("LSValid"),e.country&&this.input.data("country",e.country),void this.input.trigger(b);var f=$j.extend({input:d,types:this.suggestionTypes},this.extra_data);this.country&&(f.country=this.country);var g=this.validateServiceName+JSON.stringify(f),h=function(a){if($j.isNullOrUndefined(a))BBDebug.error("LocationSuggest.prototype.validate: no valid data response from ajax call to LocationSuggest.validate service");else if(1==a.valid){this.addValidLocation(a.value,{country:a.country});var d=a.value,e=this.locationDataStore.getFromLocalStorage(a.ta_id);e&&e.locationData&&e.locationData.displayName&&e.locationData.displayName.length>2&&e.locationData.displayName!=a.value&&(this.mismatchedText[e.locationData.displayName]=a.value,d=e.locationData.displayName),this.input.val(d);var f={};f[a.type]={id:a.stm_id,ta_id:a.ta_id},this.input.data("location-data",f),this.hiddenIdTarget&&this.hiddenIdTarget.val(a.stm_id),this.hiddenTaIdTarget&&this.hiddenTaIdTarget.val(a.ta_id),this.input.data("country",a.country),this.input.removeClass("LSInvalid"),this.input.removeClass("LSUnsupportedLocation"),this.input.addClass("LSValid"),this.input.trigger(b)}else{this.input.addClass("LSInvalid"),this.input.removeClass("LSValid"),this.input.data("location-data",null);var g=!1;for(index in a.suggestions)a.suggestions[index].supported===!0?this.addValidLocation(a.suggestions[index].value,{country:a.suggestions[index].country}):g=!0;this.input.removeClass("LSUnsupportedLocation"),("supported"in a&&!a.supported||g)&&this.input.addClass("LSUnsupportedLocation"),this.input.trigger(c,[a.suggestions])}};LocationSuggest.ValidationCache.addCallback(g,$j.proxy(h,this)),LocationSuggest.ValidationCache.cache[g]?LocationSuggest.ValidationCache.runCallbacks(g):LocationSuggest.ValidationCache.fetching[g]||(LocationSuggest.ValidationCache.fetching[g]=!0,this.ajaxTransport=$j.bbget(this.validateServiceName,f,function(a){LocationSuggest.ValidationCache.addResult(g,a)}))}}},convertAirportToCity:function(a){var b=a,c=a.indexOf("(");-1!=c&&(b=$j.trim(a.substring(0,c)));var d=a.indexOf("- All Airports");return-1!=d&&(b=$j.trim(a.substring(0,d))),b},suggestionIsAirport:function(a){var b=a.indexOf("("),c=a.indexOf("- All Airports");return b>0||c>0},showSuggestions:function(a){if(this.closeSuggest(),0!==a.length){var b={};b=$j(this.input).offset();var c=$j("<ul />",{id:"BBLocationSuggest",css:{position:"absolute",left:b.left+"px",top:b.top+$j(this.input).outerHeight()+"px"}}),d=this.input.val();$j.each(a,$j.proxy(function(a,b){if(!(-1!=this.maxSuggestions&&a>=this.maxSuggestions)){var e,f,g;"string"==typeof b?(e=b,f=b,g=null):(e=b.display,f=b.value,g=b.location),e=this.boldSuggestionText(e,d);var h=$j("<li></li>");h.append(e),h.attr("suggestValue",f),h.bind("mouseover",$j.proxy(function(){this.setSelectedIndex(a)},this)),h.data("location-data",g),c.append(h),this.addValidLocation(f,{country:b.country})}},this)),$j(document.body).append(c),BookingBuddy.toggleCovered(c,"hidden"),this.currentSuggestions=a}},closeSuggest:function(){var a=$j("#BBLocationSuggest");0!==a.length&&(a.remove(),BookingBuddy.toggleCovered(a.get(0),""))},boldSuggestionText:function(a,b){b=b.replace("(","\\("),b=b.replace(")","\\)");var c=new RegExp(b,"gi"),d=a.match(c);return d&&$j.each(d,function(b,c){a=a.replace(c,"<b>"+c+"</b>")}),a},setSelectedIndex:function(a){var b=$j("#BBLocationSuggest li");return a<b.length?(b.removeClass("selected"),$j("#BBLocationSuggest li:eq("+a+")").addClass("selected"),!0):!1},useSelected:function(){var a=this.getSelectedIndex();if(a>=0&&a<this.currentSuggestions.length){var b=this.currentSuggestions[a],c=b.value;if(b.ta_id){var d=this.locationDataStore.lookup(b.ta_id);d&&d.displayName&&d.displayName.length>2&&d.displayName!=b.value&&(this.mismatchedText[d.displayName]=b.value),c=d.displayName}return this.hiddenTarget?(this.input.val(c),this.hiddenTarget.val(b.value)):this.input.val(c),this.input.data("location-data",b.location),this.hiddenIdTarget&&this.hiddenIdTarget.val(b.stm_id),this.hiddenTaIdTarget&&this.hiddenTaIdTarget.val(b.ta_id),this.closeSuggest(),this.input.trigger("LocationSuggest:selection"),this.validate(),!0}return!1},manualSetSelected:function(a){this.hiddenTarget?(this.input.val(a),this.hiddenTarget.val(a)):this.input.val(a),this.input.trigger("LocationSuggest:selection"),this.validate()},handleArrowKey:function(a){var b,c=this.getSelectedIndex();switch(a){case"down":b=c+1;break;case"up":b=c-1;break;default:return}this.setSelectedIndex(b)},getSelectedIndex:function(){var a=$j("#BBLocationSuggest li"),b=-1;return $j.each(a,function(c,d){$j(a.get(c)).hasClass("selected")&&(b=c)}),b},handleBlur:function(a){if("undefined"!=typeof a.data.obj){obj=a.data.obj,null!==obj.suggestTimeoutID&&(clearTimeout(obj.suggestTimeoutID),obj.suggestTimeoutID=null),obj.ajaxTransport&&(obj.ajaxTransport=null);var b=obj.getSelectedIndex();return-1!=b||obj.setSelectedIndex(0)?void obj.useSelected():void obj.validate()}},keyUpHandler:function(a){if("undefined"==typeof a.data.obj)return!1;var b=a.data.obj;switch(a.keyCode){case 9:case 37:case 39:case 27:return!1;case 13:return b.useSelected();case 38:return b.handleArrowKey("up");case 40:return b.handleArrowKey("down");default:return b.updateSuggestions()}}});LocationSuggest.ValidationCache={cache:{},callbacks:{},fetching:{},addCallback:function(a,b){return LocationSuggest.ValidationCache.cache[a]?void b(LocationSuggest.ValidationCache.cache[a]):(LocationSuggest.ValidationCache.callbacks[a]||(LocationSuggest.ValidationCache.callbacks[a]=[]),void LocationSuggest.ValidationCache.callbacks[a].push(b))},addResult:function(a,b){LocationSuggest.ValidationCache.cache[a]=b,LocationSuggest.ValidationCache.runCallbacks(a)},runCallbacks:function(a){if(LocationSuggest.ValidationCache.cache[a]&&LocationSuggest.ValidationCache.callbacks[a])for(var b;LocationSuggest.ValidationCache.callbacks[a].length;)(b=LocationSuggest.ValidationCache.callbacks[a].shift())(LocationSuggest.ValidationCache.cache[a])}};
//# sourceMappingURL=LocationSuggest.nano.js.map
function InvalidLocationDropdown(a){if(this.input=$j("#"+a),1!=this.input.length)throw"Invalid input specificed for InvalidLocationDropdown: "+a;this.input.bind("LocationSuggest:invalid",$j.proxy(function(a,b){BBDebug.log("InvalidLocationDropdown caught LocationSuggest:invalid  on LocationSuggest:invalid "+a.currentTarget.id),this.invalidLocationEventHandler(b)},this)),this.input.bind("LocationSuggest:valid",$j.proxy(function(a){this.removeSelect()},this))}var AircodePopup={input:null,popup:null,aircodeUrl:"/aircodes.php",show:function(a){this.input=a;var b="scrollbars=yes,width=440,height=320,resizable=yes";this.popup=window.open(this.aircodeUrl,"aircodes",b)},populateInput:function(a){BBDebug.log("Setting LS field value from aircodes popup: "+a),this.input.val(a),this.input.blur(),this.input.trigger("LocationSuggest:selection"),this.popup&&this.popup.close(),this.popup=null}},HolidayPopup={locationInput:null,popup:null,show:function(a){var b=this;this.locationInput=$j("#"+a),$j.asyncLoad("#dhtml_holiday_options","holiday_options",function(a){if(b.popup)return void b.popup.show();b.popup=new DHTMLPopup($j(a).attr("id"),!0),b.popup.show();var c=$j(a);c.find("a.code_link").click(function(a){a.preventDefault();var c=$j(this).find("span.location_code").text();b.populateInput(c)}),c.find(".location_nav a").click(function(a){a.preventDefault(),$content=c.find(".location_content");var b=c.find('a[name="'+$j(this).text()+'"]'),d=$content.scrollTop();d+=b.position().top,$content.animate({scrollTop:d},700)})})},populateInput:function(a){BBDebug.log("Setting LS field value from holiday codes popup: "+a),this.locationInput.val(a),this.locationInput.blur(),this.popup&&this.popup.hide()}};$j(document).ready(function(){$j(".air_codes_link").click(function(a){var b=$j(this).attr("id").replace("_aircodes","");$j("#"+b).length>0?AircodePopup.show($j("#"+b)):BBDebug.log("Unable to find input for air code link: "+b),$j(this).blur()}),$j(".holiday_codes_link").click(function(a){a.stopPropagation(),a.preventDefault();var b=$j(this).attr("id").replace("_codes","");$j("#"+b)[0]?HolidayPopup.show(b):BBDebug.log("Unable to find input for air code link: "+b),$j(this).blur()})}),$j.extend(InvalidLocationDropdown,{prototype:{input:null,select:null,aircodeUrl:"/aircodes.php",aircodePopup:null,invalidLocationEventHandler:function(a){var b=$j.isNullOrUndefined(this.select)||null===this.select.css("display")?"none":this.select.css("display");this.removeSelect(),$j.isNullOrUndefined(a)||0===a.length||(this.select=$j("<select />",{css:{display:b},change:$j.proxy(function(){this.invalidLocationDropdownChangeHandler()},this)}),this.select.addClass("validation_select"),this.select.append($j("<option/>",{value:"",text:"Suggested locations"})),$j.each(a,$j.proxy(function(a,b){if(b.supported){var c=$j("<option/>",{value:b.value,text:b.display});this.select.append(c)}},this)),this.select.append($j("<option/>",{value:"",text:"----------------"})),this.select.append($j("<option/>",{value:"aircode_link",text:BookingBuddy.Strings.LS.ViewAirportList})),this.input.after(this.select))},invalidLocationDropdownChangeHandler:function(){var a=this.select.val();$j.emptyString(a)||("aircode_link"===a?this.showAircodes():(this.input.val(a),this.input.blur()))},showAircodes:function(){AircodePopup.show(this.input),$j.isNullOrUndefined(AircodePopup.popup)&&BookingBuddy.Search.showBlockedPopUpMessage()},removeSelect:function(){$j.isNullOrUndefined(this.select)||(this.select.remove(),this.select=null)}}});
//# sourceMappingURL=InvalidLocationDropdown.nano.js.map



BookingBuddy.Strings={ServerTime:"Fri, 26 Apr 2013 13:11:33 -0400",LS:{ChooseValidLocation:"Warning! Please choose a valid location.",AmbiguousLocation:"Warning! There may be more than one option for the location you entered",ViewAirportList:"Or view our airport list",NoSuggestions:"No suggestions"},Validation:{SearchTwoHoursAway:"The time you have chosen has passed or is less than 2 hours from now.\nSearch anyway?",CorrectFollowing:"Please correct the following:",SearchDatePast:"one of your search dates is in the past",PickUpAfterDropOff:"Pick-up Date cannot come after Drop-off Date",ChooseValidDropOff:"please choose a valid Drop-off Date",ChooseValidPickupOff:"please choose a valid Pick-up Date",ChoosePickupCity:"please select a Pick-up City",CheckInAfterCheckOut:"Check-out Date must come after Check-in Date",ChooseDepartureDate:"please choose a valid Departure Date",ChooseArrivalDate:"please choose a valid Arrival Date",ChooseDestinationCity:"please select a Destination City",DepartureDateAfterReturnDate:"Departure Date cannot come after Return Date",ChooseReturnDate:"please choose a valid Return Date",ChooseDepartureDate:"please choose a valid Departure Date",EnterArrivalCity:"please enter an Arrival City or Airport code",EnterDepartureCity:"please enter a Departure City or Airport code",OneLocationInvalid:"One of your locations is invalid",PleaseCorrectFollowing:"Please correct the following:",DifferentLocations:"please enter different arrival and departure locations",Beyond330Days:"Airline tickets go on sale up to 330 days in advance. Please enter a date before #{days_out} to find a flight."},LE:{GenericError:"Oops, there was a problem processing your request.",ChooseLocation:"Please choose a location.",ChooseArrivalAndDeparture:"Please choose both a Departure and an Arrival location."},LT:{air:{Default:"Going to #{point_1}? Try these searches:",Default_From:"Flying from #{point_1}? Try these searches:",Default_To:"Flying to #{point_2}? Try these searches:",Default_RoundTrip:"Flying from #{point_1} to #{point_2}? Try these searches:"},hotel:{Default:"Visiting #{point_1}? Try these searches:"},car:{Default:"Renting a car in #{point_1}? Try these searches:"},vacation:{Default:"Going to #{point_1}? Try these searches:",Default_From:"Vacation from #{point_1}? Try these searches:",Default_To:"Vacationing in #{point_2}? Try these searches:"},vacation_rental:{Default:"Visiting #{point_1}? Try these searches:"},cruise:{Default:"Taking a cruise to #{point_1}? Try these searches:"},ad:{Default:'<div class="ad_div"><div class="BBAdCell BBTabAdCell " id="BBAd#{id}" title="#{tracking_name}"><input	 id="bb_ad_image_#{id}"  type="button" value="" alt="Search #{display_name}" style="background-image: url(#{logo})" title="#{title}" class="BBInputImage submitTrigger" /><input id="bb_ad_button_#{id}" type="submit" value="Search" title="#{title}" class="BBInputButton submitTrigger" /></div></div>',UK_Default:'<div class="BBPricedAd"><div class="BBAdCell BBTabAdCell" id="BBAd#{id}"onmouseover="BookingBuddy.UK.toggleTooltip(\'BBAd#{id}\', true);" onmouseout="BookingBuddy.UK.toggleTooltip(\'BBAd#{id}\', false);"> <span class="adId hide">#{id}</span><input type="checkbox" id="check_#{id}" name="#{tracking_name}" class="ad_checkbox BBInputCheckBox adIdCheckBox toggleAdCheck smartElement" #{checked}/> <input id="bb_ad_image_#{id}" type="image" name="nojs_i#{id}" value="Search #{display_name}" alt="Search #{display_name}" src="#{logo}" title="#{title}" class="BBInputImage toggleAdCheck" /> </div></div>',UK_Default_Priced:'<div class="BBPricedAd"><div id="BBAd#{id}_tooltip" class="LTTooltip" style="display: none;" onmouseover="BookingBuddy.UK.toggleTooltip(\'BBAd#{id}\', true);" onmouseout="BookingBuddy.UK.toggleTooltip(\'BBAd#{id}\', false);"><div class="tooltip_arrow"> </div><div class="tooltip_top"> </div><div class="LTDesc"> <div class="LTDescContent">Travel dates:<br />Depart: #{depart_date_day}/#{depart_date_month}/#{depart_date_year}<br />Return: #{return_date_day}/#{return_date_month}/#{return_date_year}<br /><div class="price_found">#{last_updated}<br /></div><a class="LTPricedDeal" onclick="$j.publish(\'/page/featuredSearch\', [#{id}, this]);" href="#{redirect_url}r=i#{id}&amp;search_mode=air&amp;departure_date=#{depart_date_day}/#{depart_date_month}/#{depart_date_year}&amp;return_date=#{return_date_day}/#{return_date_month}/#{return_date_year}&amp;search_type=#{search_type}&amp;num_travelers=#{num_travelers}&amp;departure_city=#{air_departure_city}&amp;arrival_city=#{air_arrival_city}&amp;departure_month=#{depart_date_month} #{depart_date_year}&amp;departure_day=#{depart_date_day}&amp;departure_time=#{departure_time}&amp;return_month=#{return_date_month} #{return_date_year}&amp;return_day=#{return_date_day}&amp;return_time=#{return_time}&amp;service_class=#{service_class}" target="_blank"> Show me this deal</a><br /><span class="tt_disclaimer"> Note: fares found may no longer be available</span><br /><a href="" onclick="$j.publish(\'/click/search/orignalDates\', [#{id}, this]); return false;" target="_blank"> Search my original dates</a></div></div><div class="tooltip_bottom"></div></div> <div class="BBAdCell BBTargeted_pricedAdCell " id="BBAd#{id}" onmouseover="BookingBuddy.UK.toggleTooltip(\'BBAd#{id}\', true);" onmouseout="BookingBuddy.UK.toggleTooltip(\'BBAd#{id}\', false);"> <a target="_blank" class="LTPricedDeal" onclick="$j.publish(\'/page/featuredSearch\', [#{id}, this]);" href="#{redirect_url}r=i#{id}&amp;search_mode=air&amp;departure_date=#{depart_date_day}/#{depart_date_month}/#{depart_date_year}&amp;return_date=#{return_date_day}/#{return_date_month}/#{return_date_year}&amp;search_type=#{search_type}&amp;num_travelers=#{num_travelers}&amp;departure_city=#{air_departure_city}&amp;arrival_city=#{air_arrival_city}&amp;departure_month=#{depart_date_month} #{depart_date_year}&amp;departure_day=#{depart_date_day}&amp;departure_time=#{departure_time}&amp;return_month=#{return_date_month} #{return_date_year}&amp;return_day=#{return_date_day}&amp;return_time=#{return_time}&amp;service_class=#{service_class}"><img id="bb_ad_image_#{id}" name="nojs_i#{id}" value="Search #{display_name}" alt="Search #{display_name}" src="#{logo}" title="#{title}" class="BBInputImage" /></a><div class="LTPrice"><a class="lt_price" onclick="$j.publish(\'/page/featuredSearch\', [#{id}, this]);" href="#{redirect_url}r=i#{id}&amp;search_mode=air&amp;departure_date=#{depart_date_day}/#{depart_date_month}/#{depart_date_year}&amp;return_date=#{return_date_day}/#{return_date_month}/#{return_date_year}&amp;search_type=#{search_type}&amp;num_travelers=#{num_travelers}&amp;departure_city=#{air_departure_city}&amp;arrival_city=#{air_arrival_city}&amp;departure_month=#{depart_date_month} #{depart_date_year}&amp;departure_day=#{depart_date_day}&amp;departure_time=#{departure_time}&amp;return_month=#{return_date_month} #{return_date_year}&amp;return_day=#{return_date_day}&amp;return_time=#{return_time}&amp;service_class=#{service_class}" target="_blank">  #{price}</a></div> </div></div>',OMG_Default:'<div class="ad_div"><div class="BBAdCell BBTabAdCell" id="BBAd#{id}"><input type="checkbox" class="adIdCheckBox BBAdCheckBox" id="bb_ad_#{id}"/><p class="OMGPartnerName">#{display_name}</p></div></div>'}},RS:{air:{Default_roundtrip:"#{c1} to #{c2} (#{d1.month}/#{d1.day}/#{d1.year} - #{d2.month}/#{d2.day}/#{d2.year})",Default_oneway:"#{c1} to #{c2} (#{d1.month}/#{d1.day}/#{d1.year})",UK_roundtrip:'<li><a onclick="setTimeout(\'omnitureTrackBBRecentSearches()\',4000)" href="javascript:void(0)">#{c1} to #{c2}</a>&nbsp;&nbsp;#{d1.day} #{d1.month} - #{d2.day} #{d2.month}&nbsp;&nbsp;<a onclick="setTimeout(\'omnitureTrackBBRecentSearches()\',4000)" href="javascript:void(0)">View</a></li>',UK_oneway:'<li><a onclick="setTimeout(\'omnitureTrackBBRecentSearches()\',4000)" href="javascript:void(0)">#{c1} to #{c2}</a>&nbsp;&nbsp;#{d1.month} #{d1.day}&nbsp;&nbsp;<a onclick="setTimeout(\'omnitureTrackBBRecentSearches()\',4000)" href="javascript:void(0)">View</a></li>'},hotel:{Default:"#{c2} (#{d1.month}/#{d1.day}/#{d1.year} - #{d2.month}/#{day_2}/#{d2.year})",UK:'<li><a onclick="setTimeout(\'omnitureTrackBBRecentSearches()\',4000)" href="javascript:void(0)">#{c2}</a>&nbsp;&nbsp; #{d1.month} #{d1.day} - #{d2.month} #{d2.day}&nbsp;&nbsp;<a onclick="setTimeout(\'omnitureTrackBBRecentSearches()\',4000)" href="javascript:void(0)">View</a></li>'},car:{Default:"#{c2} (#{d1.month}/#{d1.day}/#{d1.year} - #{d2.month}/#{day_2}/#{d2.year})"},vacation:{Default:"#{c1} to #{c2} (#{d1.month}/#{d1.day}/#{d1.year} - #{d2.month}/#{day_2}/#{d2.year})"},vacation_rental:{Default:"#{c2} (#{d1.month}/#{d1.day}/#{d1.year} - #{d2.month}/#{day_2}/#{d2.year})"},cruise:{Default:"#{c3} (#{d3.month}/#{d3.day}/#{d3.year})"}},DHTMLDropdown:{PremiumAdTemplate:'<div class="premium"><div style="background: url(#{logo_url}) no-repeat; display: block; #{css}"></div></div>',BasicAdTemplate:'<div class="regular">#{label}</div>',PlaceholderAdTemplate:'<div class="regular">------------------------------</div>'},Deals:{DefaultTemplate:'<div class="BB-deal #{row_type}"><div class="dealType #{deal_type}">&nbsp;</div><div class="price">#{price}</div><div class="destinationName">#{destination_name}</div><div class="title"><a href="#{url}" rel="nofolllow" target="_blank"  title="#{title}">#{title}</a><br /><span class="source">#{source}</span></div></div>',RevSpanTemplate:'<div class="BB-deal"><span class="price">#{price}</span><span class="destination_name">#{destination_name_folded}</span><span class="span_deal_title"><a href="#{url}" rel="nofolllow" target="_blank"  title="#{title}">#{title}</a><br /><span class="deal_source">#{source}</span></span></div>',RevNarrowTemplate:'<div class="BB-deal"><span class="price">#{price}</span><span class="destination_name destination_name-narrow"><a href="#{url}" rel="nofolllow" target="_blank"  title="#{title}">#{title}</a> - <b>#{destination_name}</b>&nbsp;<span class="deal_source">#{source}</span><br /></span></div>',BottomFeederTemplate:'<div class="BB-deal #{row_type}"><div class="destinationName">#{destination_name}</div><div class="title"><a href="#{url}" target="_blank"  title="#{title}">#{price} -- #{title}</a></div><div class="source">#{source}</div><div class="rollover" style="display:none">Grab this deal! &gt;&gt;</div></div>',SponsoredTemplate:'<div class="BB-deal"><div class="price">#{price}</div><div class="destination_name">#{destination_name}</div><div class="deal_title"><a href="#{url}" target="_blank" title="#{title}">#{title}</a></div><div class="deal_source">#{source}</div></div>',TargetedHotelTemplate:'<div class="BB-deal"><div class="price">#{price}</div><div class="deal_title"><a href="#{url}" target="_blank" title="#{title}">#{title}</a></div><div class="deal_source">#{source}</div></div>'},NL:{inlineHeadline:"Find Out First When Fares Drop!",inlineWrapupHeader:"Thanks for Signing Up",inlineWrapupMsg:"Fare Alerts from #{dep_airport} will be on their way to you soon",inlineTTDWrapupMsg:"Top Travel Deals are on the way.",inlineWelcome:"Welcome Back!",inlineDepTeaser:'Alert me when fares drop <span class="nl_location">#{dep_airport}</span>',inlineRouteTeaser:'Alert me when fares drop <span class="nl_location">#{dep_airport} to #{arr_airport}</span>',inlineSATeaser:"Invite me to SniqueAway -- free access to top hotels for up to 40% off!",inlineSAHeadline:"Save Up to 50% on Top Hotels!",inlineSAWrapupHeader:"Your Invite is On the Way!",inlineSAWrapupMsg:"Check your inbox to accept the invitation from SniqueAway. You'll become a member of this exclusive site and save up to 50% on top hotels around the world.",inlineHotelWatchTeaser:"Send me top #{arrival_city} hotel deals",inlineHotelWatchAddTeaser:"Add #{arrival_city} to my Hotel Watch list",inlineHotelWatchWrapupHeader:"Hotel savings are on their way!",inlineHotelWatchWrapupMsg:"Thanks for signing up!",inlineSAPlusHWWrapupHeader:"Hotel savings are on their way!",inlineSAPlusHWWrapupMsg:"Thanks for signing up!",inlineSAPlusHWWrapupMsgSubText:"The freshest #{arrival_city} hotel deals plus your SniqueAway invitation are on their way to your inbox. Get ready to save big on your next hotel stay!"},CheckRates:{DefaultTemplate:'<div class="checkrates_provider check_rates_checkbox_ad ta_checkrates"><label><input id="#{name}" class="BBInputCheckBox adIdCheckBox taCheckRates" type="checkbox" name="#{name}" value="on" #{checked} /> #{vendor}</label></div>'}};
//# sourceMappingURL=BBStrings.nano.js.map

	
	
	


/***
 *     +-+-+-+-+-+-+ +-+-+-+ +-+-+-+-+-+-+-+-+-+-+
 *     |S|h|a|r|e|d| |S|T|M| |C|o|m|p|o|n|e|n|t|s|
 *     +-+-+-+-+-+-+ +-+-+-+ +-+-+-+-+-+-+-+-+-+-+
 */

// ===========================================
// Utilities
// ===========================================
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=a.jQuery,e=a._,f=b.strings,g=d(a),h=d(a.document),i=null,j={getBody:function(){return e.isNull(i)&&(i=d("body")),i},getDocument:function(){return h},getElementId:function(a,b){arguments.length<2&&(b="");var c=a.attr("id");return c||(c=b+f.uniqueId(),a.attr("id",c)),c},getHeight:function(a,b){switch(b){case"border":return a.outerHeight();case"margin":return a.outerHeight(!0);case"padding":return a.innerHeight();default:return a.height()}},getWidth:function(a,b){switch(b){case"border":return a.outerWidth();case"margin":return a.outerWidth(!0);case"padding":return a.innerWidth();default:return a.width()}},getWindow:function(){return g},setBackgroundImage:function(a,b){return a.css("background-image","url("+b+")")},fadeIn:function(a,b){var c=a.css("visibility");return c&&"hidden"===c.toLowerCase()&&a.hide(),a.css("visibility","visible").fadeIn(b)},fadeOut:function(a,b){var c=b&&b.done?b.done:d.noop;return b||(b={}),b.done=function(){a.show().css("visibility","hidden"),c&&c.apply(this,arguments)},a.fadeOut(b),a},getBackboneEvents:function(){var a={};return a.prototype=c.Events,function(){return a}}(),getCenterPositionOnDocumentForItem:function(a,b){var c=j.getWindow().height(),d=j.getWindow().width();return{left:Math.max(0,d-b)/2,top:Math.max(0,c-a)/2}},getDateFromToday:function(a){var b=j.getTodayDate(),c=b.getDate();return b.setDate(c+a),b},getTemplate:function(a,b){var c=j.getBody().find("[data-template-name='"+a+"']");return c.length?e.template(c.html()):b?null:d.noop},getTodayDate:function(){var a=new Date,b=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()));return b},globallyPublishEvent:function(a,b,c){e.isArray(c)||(c=[]),e.isFunction(b.publish)&&b.publish.apply(b,[a].concat(c)),e.isFunction(b.trigger)&&b.trigger.apply(b,[a].concat(c)),d.publish(a,c)},ns:function(a,c){b.ns("shared."+a,c)}};b.ns("shared",j)}(this);
//# sourceMappingURL=base.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=e({initialize:function(a){this.reset(),d.isArray(a)&&d.each(a,function(a){this.append(a[0],a[1])},this)},keys:null,values:null,append:function(a,b){return this.insertAt(this.keys.length,a,b)},contains:function(a){return d.contains(this.values,a)},each:function(a,b){arguments.length<2&&(b=!1);var c,d;for(c=0,d=this.keys.length;d>c&&a(this.values[c],this.keys[c])!==b;c++);return this},get:function(a){var b=this.keys.indexOf(a);return 0>b?null:this.values[b]},getAsArray:function(){var a=[];return this.each(function(b,c){a.push([c,b])}),a},getFirst:function(){return d.first(this.values)},getLast:function(){return d.last(this.values)},getSize:function(){return this.keys.length},hasKey:function(a){return d.contains(this.keys,a)},insertAfter:function(a,b,c){var d=this.keys.indexOf(b,a)+1;return 1>d&&(d=this.keys.length),this.insertAt(d,b,c)},insertBefore:function(a,b,c){return this.insertAt(Math.max(0,this.keys.indexOf(b,a)),b,c)},insertAt:function(a,b,c){return this.keys.splice(a,0,b),this.values.splice(a,0,c),this},invoke:function(){var a=d.toArray(arguments);return a.unshift(this.values),d.invoke.apply(null,a),this},prepend:function(a,b){return this.insertAt(0,a,b)},remove:function(a){var b=this.keys.indexOf(a);return b>-1&&(this.keys.splice(b,1),this.values.splice(b,1)),this},reset:function(){return this.keys=[],this.values=[],this},reverse:function(){return this.keys.reverse(),this.values.reverse(),this},set:function(a,b){var c=this.keys.indexOf(a);return c>-1?this.values[c]=b:this.append(a,b),this},STATIC:{}});c.ns("orderedHash",f)}(window);
//# sourceMappingURL=orderedHash.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.logger,g=b.strings,h=function(){return a.Metrics},i=e({timingStates:{},getTimingState:function(a){return d.isUndefined(this.timingStates[a])&&(this.timingStates[a]=i.STATE_INITIAL),this.timingStates[a]},setTimingState:function(a,b){return this.timingStates[a]=b,this},isClientReady:function(){return d.isObject(h())},clearTiming:function(a){var b;if(this.isClientReady())try{h().removeMark(a),this.setTimingState(a,i.STATE_INITIAL)}catch(b){f.logWarning(b.message)}return this},startTiming:function(a){var b;if(this.isClientReady()&&this.getTimingState(a)===i.STATE_INITIAL)try{h().setMark(a),this.setTimingState(a,i.STATE_TRACKING)}catch(b){f.logWarning(b.message)}return this},stopTiming:function(a){var b;if(this.isClientReady()&&this.getTimingState(a)===i.STATE_TRACKING)try{h().trackMark(a),this.setTimingState(a,i.STATE_COMPLETE)}catch(b){f.logWarning(b.message)}return this},STATIC:{STATE_COMPLETE:g.uniqueId(),STATE_INITIAL:g.uniqueId(),STATE_TRACKING:g.uniqueId()}});c.ns("metricsUtils",i)}(window);
//# sourceMappingURL=metricsUtils.nano.js.map
!function(a){"use strict";var b=a.stm,c=a._,d=b.shared.orderedHash,e={extendResults:function(a,b){var e=c.toArray(arguments).slice(2),f=new d;return c.each(e,function(a){a instanceof d?a.each(function(a,b){f.set(b,a)}):c.each(a,function(a,b){f.set(b,a)})}),f.each(function(d,e){b[e]=c.isFunction(d)?d.call(a):d}),b},injectDependencies:function(a){return e.injectDependenciesWith(a,a.getDependencies(),a.options.dependencies)},injectDependenciesWith:function(a){var b=c.toArray(arguments);return b.unshift(a),e.extendResults.apply(null,b)}};b.ns("dependenciesInjection",e)}(window);
//# sourceMappingURL=dependenciesInjection.nano.js.map
!function(a){"use strict";var b=a.stm,c={add:function(a,b){return a.addClass("s-"+b),c},clear:function(a){return a.removeClass(function(a,b){var c=b.match(/\bs-\w+\b/g)||[];return c.join(" ")}),c},isInState:function(a,b){return a.is(".s-"+b)}};b.ns("domState",c)}(window);
//# sourceMappingURL=domState.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery;if(!d.datepicker)return void c.ns("customJQueryDatepicker",!1);var e=d.datepicker._hideDatepicker,f=d.datepicker._showDatepicker,g=d.datepicker._tidyDialog;d.datepicker._hideDatepicker=function(a){var b=d.Event("datepicker:beforeClose");d(a).trigger(b,this._curInst),d.publish(b.type,[b,this._curInst]),b.isDefaultPrevented()||e.call(this,a)},d.datepicker._showDatepicker=function(a){a=a.target||a;var b=d.datepicker._getInst(a),c=d.Event("datepicker:afterShow"),e=d.Event("datepicker:beforeShow");d(a).trigger(e,b),d.publish(e.type,[e,b]),e.isDefaultPrevented()||(f.call(this,a),d(a).trigger(c,b),d.publish(c.type,[c,b]))},d.datepicker._tidyDialog=function(a){var b=d.Event("datepicker:afterClose");g.call(this,a),d(a.input).trigger(b,a),d.publish(b.type,[b,a])},c.ns("customJQueryDatepicker",!0)}(window);
//# sourceMappingURL=customJQueryDatepicker.nano.js.map
!function(a){"use strict";var b=a.stm,c=(b.dates,b.shared),d=a.jQuery,e=a._,f=b.strings,g={URL_DB5_TAB_BROWSING:"/c/tab-browsing/db5.html",URL_LANDER_FANCY_1C1W:"/c/lander/fancy.html",getDB5TabBrowsingUrl:function(a,b){var c=b&&b.pageUrl?b.pageUrl:g.URL_DB5_TAB_BROWSING,d=this.splitParamsIntoQSAndHash(a);return g.getFinalizedUrl(c,d.queryString,d.hash)},getFancyLanderOneClickOneWindowUrl:function(a,b){var c=b&&b.pageUrl?b.pageUrl:g.URL_LANDER_FANCY_1C1W,d=this.splitParamsIntoQSAndHash(a);return g.getFinalizedUrl(c,d.queryString,d.hash)},getFinalizedUrl:function(a,b,c){var f,h,i=g.parseUrlIntoParts(a),j=i.url;return e.extend(i.queryString,b),e.extend(i.hash,c),delete i.queryString[""],delete i.hash[""],e.each(i.queryString,function(a,b){i.queryString[b]=decodeURIComponent(a).replace(/\+/g," ")}),e.each(i.hash,function(a,b){i.hash[b]=decodeURIComponent(a).replace(/\+/g," ")}),f=d.param(i.queryString),h=d.param(i.hash),f.length&&(j+="?"+f),h.length&&(j+="#"+h),j},parseUrlIntoParts:function(a){var b,c,d=a,e="",g="";return b=d.indexOf("?"),-1!==b&&(e=d.substr(b+1),d=d.substr(0,b)),c=d.indexOf("#"),-1!==c&&(g=d.substr(c+1),d=d.substr(0,c)),c=e.indexOf("#"),-1!==c&&(g+=g.length?"&":"",g+=e.substr(c+1),e=e.substr(0,c)),{url:d,queryString:f.parseQueryString(e),hash:f.parseQueryString(g)}},splitParamsIntoQSAndHash:function(a){var b={},c={};return e.each(a,function(a,d){if(e.isString(a)||e.isNumber(a)||e.isBoolean(a))switch(d){case"sm":case"search_mode":case"mode":d="mode";case"af":case"ctm":case"oppLanderId":case"dtrk":case"dpop":b[d]=a;break;case"e1":break;default:c[d]=a}}),{queryString:b,hash:c}},HOTELS_DEFAULT_SUFFIX:"TA/hotels",getHotelsUrl:function(a,b,c){var d="/"+a+g.HOTELS_DEFAULT_SUFFIX;return g.getFinalizedUrl(d,b,c)},URL_HOTEL_LISTING:"/hotel_listings.php",HOTEL_LISTING_QUERY_KEY:"tid",getHotelListingUrl:function(a){var b="";return g.HOTEL_LISTING_QUERY_KEY in a&&(b=g.getFinalizedUrl(g.URL_HOTEL_LISTING,a,{})),b},URL_TAB_SEARCH_MOBILE:"/tabsearches.php",getMobileSearchResultPageForPhoneUrl:function(){var b=a.location.href,c=this.parseUrlIntoParts(b);c.queryString.isRedirectForMobile="true";var d=this.getFinalizedUrl(g.URL_TAB_SEARCH_MOBILE,c.queryString,c.hash);return d||g.URL_TAB_SEARCH_MOBILE},getMobileStep1Url:function(b){var c;switch(b){case"hotel":c="/hotel.php";break;case"car":c="/car.php";break;default:c="/flight.php"}var d=this.parseUrlIntoParts(a.location.href),f=e.extend(d.queryString,d.hash);return f.af&&delete f.af,this.getFinalizedUrl(c,f)}};c.ns("linkUtils",g)}(window);
//# sourceMappingURL=linkUtils.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=a.jQuery,f=a.console,g=function(){return b.cookies?b.cookies:null},h={endLoggingGroup:function(){var a=f&&d.isFunction(f.log)&&d.isFunction(f.groupEnd);return a?d.bind(f.groupEnd,f):function(){}}(),logException:function(b,c){if(!b||!c||!b.message||b.message.length<1||c.length<1)return this;try{var d=g()?g().get("ssource"):"CR_ERR",f={id:c,msg:b.message,source:d,page:a.location.href,t:(new Date).getTime()},i=h.ERROR_LOG_PATH+e.param(f);e.ajax({url:i})}catch(b){}return this},logInfo:function(){var a=f&&d.isFunction(f.info);return a?d.bind(f.info,f):function(){}}(),logMessage:function(){var a=f&&d.isFunction(f.log);return a?d.bind(f.log,f):function(){}}(),logObjectHierarchy:function(){var a=f&&d.isFunction(f.dir);return a?d.bind(f.dir,f):function(){}}(),logWarning:function(){var a=f&&d.isFunction(f.warn);return a?d.bind(f.warn,f):function(){}}(),startLoggingGroup:function(){var a=f&&d.isFunction(f.log)&&d.isFunction(f.group);return a?d.bind(f.group,f):function(){}}(),ERROR_LOG_PATH:"/t.gif?"};c.ns("logger",h)}(window);
//# sourceMappingURL=logger.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=b.define,e=b.Chain,f=d({constructor:function(){this.restart()},chain:null,restart:function(){return this.chain&&this.chain.clear(),this.chain=new e,this},run:function(){return this.chain&&this.chain.run(),this},STATIC:{}});c.ns("soleChain",f)}(window);
//# sourceMappingURL=soleChain.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=b.define,e=b.mixins.observable,f=d(null,e,{initialize:function(){}});c.ns("tracking",f)}(window);
//# sourceMappingURL=tracking.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=b.define,e=b.shared.tracking,f=d(e,{TA_META_CLICK:"stm_shared_tracking_clickstream:ta_meta_click",trackTAMetaClick:function(a,b,c,d){return this.publish(this.TA_META_CLICK,a,b,c,d),this}});c.ns("tracking.clickstream",f),b.ns("tracking.clickstream",new f)}(window);
//# sourceMappingURL=clickstream.nano.js.map
!function(a){"use strict";var b=a.stm,c=a._,d=b.define,e=b.shared,f=b.shared.tracking,g=d(f,{BBDN_CLICK:"stm_shared_tracking_omniture:bbdn_click",CONFIG_CHANGED:"stm_shared_tracking_omniture:config_changed",FEATURED_SEARCH_CLICK:"stm_shared_tracking_omniture:fetured_search_click",SPONSORED_DHTML_AD_CLICK:"stm_shared_tracking_omniture:sponsored_dhtml_ad_click",EXIT_DHTML_AD_IMPRESSION:"stm_shared_tracking_omniture:track_exit_dhtml_ad_impression",LOAD_DATA:"stm_shared_tracking_omniture:load_data",SEND_EVAR:"stm_shared_tracking_omniture:send_evar",TA_META_SEARCH_VISIT:"stm_shared_tracking_omniture:track_ta_meta_search_visit",TA_AIM_CLICK:"stm_shared_tracking_omniture:ta_aim_click",TA_META_CLICK:"stm_shared_tracking_omniture:ta_meta_click",TA_REVIEW_CLICK:"stm_shared_tracking_omniture:ta_review_click",SEND_EVENTS:"stm_shared_tracking_omniture:send_events",configs:null,getChannel:function(){return this.publish(this.LOAD_DATA),this.configs&&this.configs.vars?this.configs.vars.channel:null},getEvars:function(){var a={};return this.publish(this.LOAD_DATA),this.configs&&this.configs.vars?(c.each(this.configs.vars,function(b,c){-1!==c.indexOf("eVar")&&(a[c]=b)}),a):a},getEvents:function(){return this.publish(this.LOAD_DATA),this.configs&&this.configs.events?this.configs.events:[]},getPageName:function(){return this.publish(this.LOAD_DATA),this.configs&&this.configs.vars?this.configs.vars.pageName:null},setToBBOmnitureObject:function(a){return this.configs?(c.each(this.configs,function(b,d){switch(d){case"vars":return a.evars=[],void c.each(b,function(b,c){-1!==c.indexOf("eVar")?a.evars.push({name:"s_"+c,value:b}):a[c]=b});case"source":d="expediaSource";default:return void(a[d]=b)}}),this):this},setToOmnitureObject:function(a){var b={},d=[];return this.configs?(c.each(this.configs,function(a,e){switch(e){case"account":return void(b.un=a);case"adImpressionIds":return void(b.products=a&&a.length?";bb_"+a.join(",;bb_"):"");case"events":return void c.extend(d,a);case"vars":return void c.extend(b,a);case"trackingServer":return void(b.trackingServer=a);case"searchMode":case"source":case"substate":return}}),a.linkTrackEvents=d.join(","),a.events=a.linkTrackEvents,a.linkTrackVars=c.keys(b).join(","),c.extend(a,b),this):this},updateFromBBOmnitureObject:function(a){return a?(this.configs||(this.configs={}),this.configs.vars||(this.configs.vars={}),c.each(a,function(a,b){switch(b){case"evars":return void c.each(a,function(a){var b="eVar"+a.name.replace(/[^\d]+/,"");this.configs.vars[b]=a.value},this);case"expediaSource":b="source";case"account":case"adImpressionIds":case"events":case"searchMode":case"substate":case"trackingServer":return void(this.configs[b]=a);case"channel":case"pageName":default:return void(this.configs.vars[b]=a)}},this),this):this},updateFromOmnitureObject:function(a){return a?(this.configs||(this.configs={}),this.configs.events||(this.configs.events=[]),this.configs.vars||(this.configs.vars={}),c.each(a,function(a,b){switch(b){case"products":if(""===a)return;return void(this.configs.adImpressionIds=a.replace(/;bb_/g,"").split(","));case"trackingServer":this.configs.trackingServer=a;break;case"un":return void(this.configs.account=a);case"channel":case"pageName":return void(this.configs.vars[b]=a)}return b.match(/^eVar[\d]+$/)?void(this.configs.vars[b]=a):void 0},this),this):this},sendEvents:function(a,b,c){return this.publish(this.SEND_EVENTS,a,b,c),this},sendEvar:function(a,b,c){return this.publish(this.SEND_EVAR,a,b,c),this},triggerConfigChanged:function(a,b){return this.configs=a,this.publish(this.CONFIG_CHANGED,a,b),this},trackTAMetaSearchVisit:function(a){return this.publish(this.TA_META_SEARCH_VISIT,a),this},trackBBDNClick:function(a,b,c){return this.publish(this.BBDN_CLICK,a,b,c),this},trackFeaturedSearchClick:function(a,b){return this.publish(this.FEATURED_SEARCH_CLICK,a,b),this},trackSponsoredDHTMLAdClick:function(a,b){return this.publish(this.SPONSORED_DHTML_AD_CLICK,a,b),this},trackExitDHTMLAdImpression:function(a,b){return this.publish(this.EXIT_DHTML_AD_IMPRESSION,a,b),this},trackTAAimClick:function(a,b){return this.publish(this.TA_AIM_CLICK,a,b),this},trackTAMetaClick:function(a,b){return this.publish(this.TA_META_CLICK,a,b),this},trackTAReviewClick:function(a,b){return this.publish(this.TA_REVIEW_CLICK,a,b),this},STATIC:{getInstance:function(){return b.tracking.omniture}}});e.ns("tracking.omniture",g),b.ns("tracking.omniture",new g)}(window);
//# sourceMappingURL=omniture.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=e({initialize:function(a,b){this.element=a,this.options=d.extend({},d.result(this,"options"),b),1===this.options.maxWindow&&this.maximizeWindow()},options:function(){return{maxWindow:b.pageData&&b.pageData.queryString&&b.pageData.queryString.maxWindow&&1==b.pageData.queryString.maxWindow?1:0}},maximizeWindow:function(){if(!b.pageData.queryString||"true"!==b.pageData.queryString.iframe){var c=screen.availWidth,d=screen.availHeight,e=0,f=0;a.moveTo(e,f),a.resizeTo(c,d)}}});c.ns("controllers.windowAutoExpander",f)}(window);
//# sourceMappingURL=windowAutoExpander.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=a.jQuery,f=b.Popup,g=b.Browser,h=(b.shared.linkUtils,{QUERY_KEY_SHOW_INTERSTITIAL:"showInterstitial",SEARCH_MODE_CAR:"car",SEARCH_MODE_AIR:"air",SEARCH_MODE_HOTEL:"hotel",SEARCH_MODE_AIRFLEX:"airflex",SEARCH_MODE_VACATION_RENTAL:"vacation_rental",openTabBrowsingWindow:function(b,c){var e=d.extend({},{center:!1,name:"stmTabBrowsingWindow",otherFeatures:this.getOtherFeatures(c),useOptimalDimensions:!1,forcePopup:!1},c);if(a.opener&&"stmTabBrowsingWindow"===a.name)return void(a.location.href=b);if(e.openInSameWindow)return a.resizeTo(e.width,e.height),void(a.location.href=b);e.useOptimalDimensions||(e.height||(e.height=this.calculateNewWindowHeight()),e.width||(e.width=this.calculateNewWindowWidth())),e.center||(e.left||(e.left=this.calculateNewWindowLeftPositioning()),e.top||(e.top=this.calculateNewWindowTopPositioning()));var g=new f(b,e);e.useOptimalDimensions&&g.useOptimalDimensions(),g.tryPop()},calculateNewWindowHeight:function(){var b=d.isNumber(a.screenY)?a.screenY:a.screenTop;return g.ie?screen.availHeight:g.chrome?1e3:g.firefox?screen.availHeight-b:e(a).height()+10},calculateNewWindowWidth:function(){return g.ie?screen.availWidth:g.chrome?1040:e(a).width()+10},calculateNewWindowLeftPositioning:function(){var b=d.isNumber(a.screenX)?a.screenX:a.screenLeft;return g.ie?0:g.chrome?b+20:b},calculateNewWindowTopPositioning:function(){var b=d.isNumber(a.screenY)?a.screenY:a.screenTop;return g.ie?0:g.chrome?b+60:b},getOtherFeatures:function(a){var b={};return a=a||{},g.chrome?b={location:1,menubar:1,status:1,toolbar:1}:g.ie?(b={location:1,menubar:0,resizable:1,scrollbars:0,status:0,toolbar:0},a.width||a.height||(b.fullscreen=1),a.scrollbars&&(b.scrollbars=a.scrollbars)):(b={location:1,menubar:0,resizable:1,scrollbars:0,status:0,toolbar:1},a.scrollbars&&(b.scrollbars=a.scrollbars)),b},shouldUseFauxTab:function(a){return g.safari&&(g.Platform.ios||g.Platform.mac||g.Platform.win)?!0:g.ie&&a&&d.contains(a,"ie")?!0:a&&d.contains(a,"always")?!0:!1},shouldOpenOneClickOneWindow:function(a){return g.Platform.ios&&a!==this.SEARCH_MODE_VACATION_RENTAL&&a!==this.SEARCH_MODE_AIRFLEX},shouldSendToMobileSearchResultPage:function(a){return"desktop"!==b.cookies.get("site_format")&&(g.isIPhone||g.isAndroidPhone)&&(a===this.SEARCH_MODE_CAR||a===this.SEARCH_MODE_AIR||a===this.SEARCH_MODE_HOTEL)}});c.ns("featuredSearchUtils",h)}(window);
//# sourceMappingURL=featuredSearchUtils.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a._,f=b.define,g=f({initialize:function(a,b){this.options=e.extend({},e.result(this,"options"),b),this.closeWindow()},closeWindowSelector:null,options:function(){return{closeWindowSelector:".closeWindowOnInit"}},closeWindow:function(){var b=d(this.options.closeWindowSelector);b.length>0&&a.close()}});c.ns("controllers.closeWindow",g)}(window);
//# sourceMappingURL=closeWindow.nano.js.map
!function(a){"use strict";var b=stm.define({STATIC:{getHotelIDs:function(){return _.pluck(this.recommendations||[],"hotel_id")},fetchForLocation:function(b){var c=this;a.SmarterTravelNetwork_ready=a.SmarterTravelNetwork_ready||[],c.recommendations=[],a.SmarterTravelNetwork_ready.push(function(a){var d=stm.pageData.smarterAdsAPIKey;if(d){a.init(d,{adVertical:"hotel"});var e=a.Spotlight.buildHotelRecommendation({locationIdType:"TRIP",destinationName:b});e&&e.getRecommendations(function(a,b){c.recommendations=a.recommendations})}})}}});stm.shared.ns("recommendationsClient",b)}(window);
//# sourceMappingURL=recommendationsClient.nano.js.map

// ===========================================
// Page Mask
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a._,f=b.functional,g=d.View.extend({initialize:function(){this.bindMethods().attach().render()},options:function(){return{backgroundColor:"#000",height:"100%",left:0,opacity:"0.5",position:"fixed",top:0,width:"100%"}},onClick:function(){this.hide()},attach:function(){return this.$el.on("click",this.onClick),this},bindMethods:function(){return f.bindMethods(this,["onClick"]),this},hide:function(){return this.$el.hide(),c.globallyPublishEvent(g.EVENT_HIDE,this,[this]),this},render:function(){var a=this,b=["position","backgroundColor","opacity","height","width","left","top"];return a.$el.appendTo("body").hide(),e.each(b,function(b){e.isNull(a.options[b])||e.isUndefined(a.options[b])||a.$el.css(b,a.options[b])}),a},show:function(a){return a&&a.length&&this.$el.css("z-index",a.css("z-index")-1),this.$el.show(),c.globallyPublishEvent(g.EVENT_SHOW,this,[this]),this}},{EVENT_HIDE:"stm-shared-views-pageMask:event_hide",EVENT_SHOW:"stm-shared-views-pageMask:event_show"});c.ns("views.pageMask",g)}(window);
//# sourceMappingURL=pageMask.nano.js.map

// ===========================================
// Awesome Form
// ===========================================
!function(a){"use strict";var b,c=a.stm,d=a.Backbone,e=a.jQuery;e(function(){b=a.BBAd});var f=d.Model.extend({initialize:function(){this.loadOldBBAd()},defaults:function(){return{id:0,affiliate_id:0,display_name:null,display_placement:null,display_tier:null,placement:null,tier:null,tracking_hash:null,url:"",universal_logo:null,_tab:!1,_tab_focused:!1,_tracked:!1,_popup:null}},getPopup:function(){return this.get("_popup")},setPopup:function(a){this.set("_popup",a)},isTab:function(){return this.get("_tab")},setTab:function(a){this.set("_tab",a)},isTabFocused:function(){return this.get("_tab_focused")},setTabFocused:function(a){this.set("_tab_focused",a)},isTracked:function(){return this.get("_tracked")},setTracked:function(a){this.set("_tracked",a)},getId:function(){return this.get("id")},getAffiliateId:function(){return this.get("affiliate_id")},getDisplayName:function(){return this.get("display_name")},getDisplayPlacement:function(){return null!==this.get("display_placement")?this.get("display_placement"):this.get("display_tier")},getPlacement:function(){return null!==this.get("placement")?this.get("placement"):this.get("tier")},getDisplayTier:function(){return this.getDisplayPlacement()},getTier:function(){return this.getPlacement()},getLogo:function(){return this.get("logo")},getUrl:function(){return this.get("url")},isFauxTabsEnabled:function(){return this.get("faux_tabs_enabled")},getTrackingHash:function(){return this.get("tracking_hash")},setTrackingHash:function(a,b){return this.set("tracking_hash",a,b)},setUrl:function(a){this.set("url",a)},getUniversalLogo:function(){return this.get("universal_logo")},setUniversalLogo:function(a,b){return this.set("universal_logo",a,b),this},isFeatured:function(){return this.getPlacement().match(/dropdown(?!_premium)/)?!1:!0},isDropdownAd:function(){return this.getPlacement().match(/dropdown/)?!0:!1},isUkAffiliate:function(){return this.getAffiliateId()===f.BBUK_AFFILIATE_ID||this.get("site")===f.BBUK_SITE_NAME},loadOldBBAd:function(){var a=this,c=b.singleton(a.getId());return c.setMetaDataMulti(a.attributes),a},sync:function(){}},{BBUK_AFFILIATE_ID:1274193,BBUK_SITE_NAME:"bbs_uk"});c.ns("shared.models.ad",f)}(window);
//# sourceMappingURL=ad.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=a.Backbone,e=a._,f=b.localStorage,g=d.Model.extend({defaults:{storage:f},lookup:function(a){var b={taId:a,stmId:null,displayName:null,countryId:null};if(!a)return b;var c=this.getFromLocalStorage(a);if(c.success)b=c.locationData;else{var d=this.getFromLocs(a);this.setToLocalStorage(d),b=d}return b},getFromLocalStorage:function(a){var b=this.get("storage"),c={success:!1,locationData:null};if(!b.isSupported())return c;var d=b.get(g.LOCAL_STORAGE_PREFIX+a+"TA");if(e.isNull(d))return c;c.locationData=JSON.parse(d);var f=(new Date).getTime()-c.locationData.timestamp;return 864e5>f&&(c.success=!0),c},setToLocalStorage:function(a){var b=this.get("storage");if(!b.isSupported()||!a||!a.taId)return this;var c=a.taId+"TA",d=(new Date).getTime(),f=JSON.stringify(e.extend({timestamp:d},a));return b.set(g.LOCAL_STORAGE_PREFIX+c,f),this},getFromLocs:function(a){var b={taId:parseInt(a,10),stmId:null,displayName:null,countryId:null};return c.ajax({url:"/api/stm/location-data-store.html",async:!1,dataType:"json",data:{id:g.PREFIX_TA_GEO_ID+a}}).done(function(a){e.extend(b,a)}),b}},{LOCAL_STORAGE_PREFIX:".locationDataStoreV2.",PREFIX_TA_GEO_ID:"g"});b.ns("shared.models.locationDataStore",g)}(window);
//# sourceMappingURL=locationDataStore.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=a.Backbone,e=a._,f=b.localStorage,g=d.Model.extend({lookup:function(a){var b={crusieDestinationId:null,crusieDestinationName:null};if(!a)return b;var c=this.getFromLocalStorage(a);if(c.success)return c.locationData;var d=this.getFromDOM(a);if(d.success)return this.setToLocalStorage(d.locationData),d.locationData;var e=this.getFromLocs(a);return e.crusieDestinationName&&this.setToLocalStorage(e),e},getFromDOM:function(a){var b={success:!1,locationData:null},d=["cruise_destination_id","region","destination"];for(var e in d){var f=c("[name="+d[e]+"]").find("option[value="+a+"]").first().text();if(f)return b.success=!0,b.locationData={cruiseDestinationId:parseInt(a,10),crusieDestinationName:c.trim(f)},b}return b},getFromLocalStorage:function(a){var b={success:!1,locationData:null};if(!f.isSupported())return b;var c=f.get(g.LOCAL_STORAGE_PREFIX+a+"LC");if(e.isNull(c))return b;var d=c.split("|");if(d.length<2)return b;var h=d[1],i=(new Date).getTime()-h;return 864e5>i&&(b.success=!0,b.locationData={cruiseDestinationId:parseInt(a,10),crusieDestinationName:d[0]}),b},setToLocalStorage:function(a){if(!(f.isSupported()&&a&&a.cruiseDestinationId&&a.crusieDestinationName))return this;var b=a.cruiseDestinationId+"LC",c=(new Date).getTime(),d=a.crusieDestinationName+"|"+c;return f.set(g.LOCAL_STORAGE_PREFIX+b,d),this},getFromLocs:function(a){var b={cruiseDestinationId:parseInt(a,10),crusieDestinationName:null};return c.ajax({url:"/api/stm/location-data-store.html",async:!1,dataType:"json",data:{id:g.PREFIX_CRUISE_ID+a}}).done(function(a){c.isNullOrUndefined(a.crusieDestinationName)||(b.crusieDestinationName=a.crusieDestinationName)}),b}},{LOCAL_STORAGE_PREFIX:".cruiseDestinationDataStore.",PREFIX_CRUISE_ID:"c"});b.ns("shared.models.cruiseDestinationDataStore",g)}(window);
//# sourceMappingURL=cruiseDestinationDataStore.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=c.models.locationDataStore,g=e({initialize:function(){this.locationDataStore=new f},locationDataStore:null,translateCStoBBV2:function(a){var b={};if(!a)return b;var c,e,f,g,h,i={taId:null,stmId:null,displayName:null};return c=e=f=g=i,a.location1&&!d.isNull(a.location1)&&(c=this.locationDataStore.lookup(a.location1.aid),f=this.locationDataStore.lookup(a.location1.cid)),a.location2&&!d.isNull(a.location2)&&(e=this.locationDataStore.lookup(a.location2.aid),g=this.locationDataStore.lookup(a.location2.cid)),d.each(a,function(a,d){switch(d){case"bb":b.bb=a;break;case"cd":b.c3=a;break;case"class":b.sc=a;break;case"clen":b.clen=a;break;case"clin":b.clin=a;break;case"d3":b.d3=a;break;case"da":b.da=a;break;case"date1":h=1e3*parseInt(a,10),b.d1=h.toString();break;case"date2":h=1e3*parseInt(a,10),b.d2=h.toString();break;case"flx":b.flx=a;break;case"location1":b.l1={airport:{country:null,id:c.stmId,ta_id:c.taId,name:c.displayName},city:{country:null,id:f.stmId,ta_id:f.taId,name:f.displayName}};break;case"location2":b.l2={airport:{country:null,id:e.stmId,ta_id:e.taId,name:e.displayName},city:{country:null,id:g.stmId,ta_id:g.taId,name:g.displayName}};break;case"nchl":b.nchl=a;break;case"nonstop":b.ns=a;break;case"o55":b.o55=a;break;case"oneway":b.st=1===a?"oneway":"roundtrip";break;case"ppp":b.ppp=a;break;case"prv":b.prv=a;break;case"rooms":b.nrms=a;break;case"time1":b.t1=a;break;case"time2":b.t2=a;break;case"travelers":b.ntrv=a}}),{cs:b}},translateBBV2toCS:function(a){var b={};if(!a||!a.cs)return b;var c=null,e=null;return d.each(a.cs,function(a,f){if(!d.isFunction(a))switch(f){case"bb":b.bb=a;break;case"c3":b.cd=a;break;case"clen":b.clen=a;break;case"clin":b.clin=a;break;case"d1":c=parseInt(a,10)/1e3,b.date1=c.toString();break;case"d2":c=parseInt(a,10)/1e3,b.date2=c.toString();break;case"d3":b.d3=a;break;case"da":b.da=a;break;case"fd":case"flx":d.isUndefined(b.flx)&&(b.flx=a);break;case"l1":b.location1={id:null,type:null,aid:null,cid:null,sid:null,said:null},a.city&&(b.location1.type="geo",a.city.ta_id&&(e=parseInt(a.city.ta_id,10),b.location1.id=e,b.location1.cid=e),a.city.id&&(b.location1.sid=parseInt(a.city.id,10))),a.airport&&(a.airport.ta_id&&(e=parseInt(a.airport.ta_id,10),b.location1.type="airport",b.location1.id=e,b.location1.aid=e),a.airport.id&&(b.location1.said=parseInt(a.airport.id,10)));break;case"l2":b.location2={id:null,type:null,aid:null,cid:null,sid:null,said:null},a.city&&(b.location2.type="geo",a.city.ta_id&&(e=parseInt(a.city.ta_id,10),b.location2.id=e,b.location2.cid=e),a.city.id&&(b.location2.sid=parseInt(a.city.id,10))),a.airport&&(a.airport.ta_id&&(e=parseInt(a.airport.ta_id,10),b.location2.type="airport",b.location2.id=e,b.location2.aid=e),a.airport.id&&(b.location2.said=parseInt(a.airport.id,10)));break;case"nchl":b.nchl=a;break;case"nrms":b.rooms=a;break;case"ns":b.nonstop=a;break;case"ntrv":b.travelers=a;break;case"o55":b.o55=a;break;case"ppp":b.ppp=a;break;case"sc":b["class"]=a;break;case"st":b.oneway="roundtrip"==a?0:1;break;case"t1":b.time1=a;break;case"t2":b.time2=a;break;case"prevl1":case"prevl2":}}),b}});b.ns("usdCookieTranslator",new g)}(window);
//# sourceMappingURL=usdCookieTranslator.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a.Backbone,f=a._,g=b.cookies,h=b.dates,i=b.strings,j=c.models.locationDataStore,k=c.models.cruiseDestinationDataStore,l={deprecatedQueryString:["ad","am","arrival_day","arrival_month","dd","departure_day","departure_month","dm","dod","dom","dropoff_day","dropoff_month","pd","pickup_day","pickup_month","pm","rd","return_day","return_month","rm"],queryStringAliases:{arrival_city:["ac"],arrival_date:[],board_basis:["bb"],"class":["sc","service_class"],cruise_destination_id:[],cruise_length:["cl"],cruise_line:[],date1:[],date2:[],departure_city:["dc"],departure_date:[],destination:["dest"],driver_age:["da"],dropoff_date:[],flex_days:["fd"],location1:[],location2:[],nonstop:["non_stop","ns"],num_children:["nc"],oneway:["search_type","st"],over_55:["o55"],pickup_city:["pc"],pickup_date:[],price_per_person:["ppp"],provider:["p"],return_date:[],rooms:["nb","nr","num_bedrooms","num_rooms"],slocation1:[],slocation2:[],time1:["departure_time","dt","pickup_time","put"],time2:["dot","dropoff_time","return_time","rt"],travel_month:["tm"],travelers:["nt","num_travelers"]},queryStringToAttribute:{ac:"location2",arrival_city:"location2",arrival_date:{hotel:"date1",vacation_rental:"date1"},bb:"bb",board_basis:"bb",cl:"clen","class":"class",cruise_destination_id:"cd",cruise_length:"clen",cruise_line:"clin",da:"da",date1:"date1",date2:"date2",dc:"location1",departure_city:"location1",departure_date:{air:"date1",airflex:"date1",holiday:"date1",hotel:"date2",vacation:"date1",vacation_rental:"date2"},departure_time:"time1",dest:"cd",destination:"cd",dot:"time2",driver_age:"da",dropoff_date:{car:"date2"},dropoff_time:{car:"time2"},dt:"time1",fd:"flx",flex_days:"flx",location1:"location1",location2:"location2",nb:"rooms",nc:"nchl",non_stop:"nonstop",nonstop:"nonstop",nr:"rooms",ns:"nonstop",nt:"travelers",num_bedrooms:"rooms",num_children:"nchl",num_rooms:"rooms",num_travelers:"travelers",o55:"o55",oneway:"oneway",over_55:"o55",p:"prv",pc:"location2",pickup_city:{car:"location2"},pickup_date:{car:"date1"},pickup_time:{car:"time1"},ppp:"ppp",price_per_person:"ppp",provider:"prv",put:"time1",return_date:{air:"date2",vacation:"date2",holiday:"date2",airflex:"date2"},return_time:"time2",rooms:"rooms",rt:"time2",sc:"class",search_type:"oneway",service_class:"class",slocation1:"location1",slocation2:"location2",st:"oneway",time1:"time1",time2:"time2",tm:"d3",travel_month:"d3",travelers:"travelers"},searchModes:{air:"air",airflex:"airflex",car:"car",cruise:"cruise",holiday:"holiday",hotel:"hotel",vacationPackage:"vacation",vacationRental:"vacation_rental"},searchTypes:{oneWay:"oneway",roundTrip:"roundtrip"}},m=e.Model.extend({initialize:function(){this.locationDataStore=new j,this.cruiseDestinationDataStore=new k,this.attach().updateFromCookie()},cookieName:"cs",mode:null,locationDataStore:null,cruiseDestinationDataStore:null,getBoardBasis:function(){return this.get("bb")},setBoardBasis:function(a,b){return this.set("bb",a,b)},getCruiseLocation:function(){return this.getCruiseDestinationName()},getCruiseDestination:function(){var a=this.get("cd");if(!a)return null;if(a.name&&!f.isEmpty(a.name))return a;var b=this.cruiseDestinationDataStore.lookup(a.id).crusieDestinationName;return a={id:a.id,name:b}},setCruiseDestination:function(a,b){return a&&a.id?(this.isIdenticalCruiseDestinations(a,this.get("cd"))||this.set("cd",a,b),this):this},getCruiseDestinationName:function(){var a=this.getCruiseDestination();return a?a.name:""},getCruiseDestinationId:function(){var a=this.get("cd");return a&&a.id?a.id:null},getServiceClass:function(){return this.get("class")},setServiceClass:function(a,b){return this.set("class",a,b)},getCruiseLength:function(){return this.get("clen")},setCruiseLength:function(a,b){return this.set("clen",a,b)},getCruiseLine:function(){return this.get("clin")},setCruiseLine:function(a,b){return this.set("clin",a,b)},getCruiseDeparture:function(){return this.get("d3")},setCruiseDeparture:function(a,b){return this.set("d3",a,b)},getDriverAge:function(){return this.get("da")},setDriverAge:function(a,b){return this.set("da",a,b)},getDate1:function(){return this.get("date1")},setDate1:function(a,b){var c=this.getDate2();return this.set("date1",a,b),a&&c&&a>c&&(c=new Date(a.getTime()),c.setDate(a.getDate()+1),this.setDate2(c)),this},getDate2:function(){return this.get("date2")},setDate2:function(a,b){return this.set("date2",a,b)},getFlexDays:function(){return this.get("flx")},setFlexDays:function(a,b){return this.set("flx",a,b)},getLocation1:function(){var a=this.get("location1");if(a){var b=this.locationDataStore.lookup(a.id);a.name=b.displayName}return a},getLocation1AsAirport:function(){var a=this.getLocation1();if(!a)return null;var b=this.locationDataStore.lookup(a.aid);return a.said=b.stmId,a.name=b.displayName,f.isNumber(a.said)||"airport"!==a.type||(a.said=a.sid),a},getLocation1AsGeo:function(){var a=this.getLocation1();if(!a)return null;var b="airport"===a.type?a.cid:a.id,c=this.locationDataStore.lookup(b);return a.sid=c.stmId,a.name=c.displayName,a},setLocation1:function(a,b){var c=this.normalizeLocationObject(a),d=this.getLocation1();return this.isIdenticalLocation(c,d)?this:this.set("location1",c,b)},getLocation2:function(){var a=this.get("location2");if(a){var b=this.locationDataStore.lookup(a.id);a.name=b.displayName}return a},getLocation2AsAirport:function(){var a=this.getLocation2();if(!a)return null;var b=this.locationDataStore.lookup(a.aid);return a.said=b.stmId,a.name=b.displayName,a},getLocation2AsGeo:function(){var a=f.clone(this.getLocation2());if(!a)return null;var b="airport"===a.type?a.cid:a.id,c=this.locationDataStore.lookup(b);return a.sid=c.stmId,a.name=c.displayName,a},setLocation2:function(a,b){var c=this.normalizeLocationObject(a);this.getLocation2();return this.set("location2",c,b)},getNumChildren:function(){return this.get("nchl")},setNumChildren:function(a,b){return this.set("nchl",a,b)},isNonstop:function(){return this.get("nonstop")},setNonstop:function(a,b){return this.set("nonstop",a,b)},isOver55:function(){return this.get("o55")},setOver55:function(a,b){return this.set("o55",a,b)},isOneway:function(){return this.get("oneway")},setOneway:function(a,b){return this.set("oneway",a===l.searchTypes.oneWay||1==a||a===!0,b)},isRoundTrip:function(){return!this.isOneway()},setRoundTrip:function(a,b){return this.setOneway(!a,b)},getPricePerPerson:function(){return this.get("ppp")},setPricePerPerson:function(a,b){return this.set("ppp",a,b)},getProvider:function(){return this.get("prv")},setProvider:function(a,b){return this.set("prv",a,b)},getRooms:function(){return this.get("rooms")},setRooms:function(a,b){return this.set("rooms",a,b)},getTime1:function(){return this.get("time1")},setTime1:function(a,b){return this.set("time1",a,b)},getTime2:function(){return this.get("time2")},setTime2:function(a,b){return this.set("time2",a,b)},getTravelers:function(){return this.get("travelers")},setTravelers:function(a,b){return this.set("travelers",a,b)},getLocation1Airport:function(){return this.getLocation1ByType("airport")},getLocation1City:function(){return this.getLocation1ByType("city")},getLocation1AirportOrCity:function(){var a=this.getLocation1Airport(),b=this.getLocation1City();return a?a:b?b:null},getLocation1ByType:function(a){switch(a){case"airport":var b=this.getLocation1AsAirport();if(b)return{name:b.name,id:b.said};break;case"city":var b=this.getLocation1AsGeo();if(b)return{name:b.name,id:b.sid}}return null},getLocation1ByTypes:function(a){for(var b=null,c=a.length,d="",e=0;c>e&&(d=a[e],b=this.getLocation1ByType(d),null===b||null===b.name||null===b.id);e++);return b},getLocation2Airport:function(){return this.getLocation2ByType("airport")},getLocation2City:function(){return this.getLocation2ByType("city")},getLocation2AirportOrCity:function(){var a=this.getLocation2Airport(),b=this.getLocation2City();return a?a:b?b:null},getLocation2ByType:function(a){switch(a){case"airport":var b=this.getLocation2AsAirport();if(b)return{name:b.name,id:b.said};break;case"city":var b=this.getLocation2AsGeo();if(b)return{name:b.name,id:b.sid}}return null},getLocation2ByTypes:function(a){for(var b=null,c=a.length,d="",e=0;c>e&&(d=a[e],b=this.getLocation2ByType(d),null===b||null===b.name||null===b.id);e++);return b},getCruiseDate:function(){return h.formatDate("yy-mm-01",this.getCruiseDeparture())},setCruiseDate:function(a){return this.setCruiseDeparture(h.parseDate("yy-mm-dd",a))},isOneWay:function(){return this.isOneway()},getSearchType:function(){return this.isOneway()?l.searchTypes.oneWay:l.searchTypes.roundTrip},setSearchType:function(a){return this.setOneway(a)},getLocation1Id:function(){return this.getLocationId(this.getLocation1())},getLocation1AirportId:function(){return this.getLocationAirportId(this.getLocation1())},getLocation1CityId:function(){return this.getLocationCityId(this.getLocation1())},getLocation1SId:function(){return this.getLocationSId(this.getLocation1())},getLocation1SAId:function(){return this.getLocationSAId(this.getLocation1())},getLocation1Code:function(){return this.getLocationCode(this.getLocation1())},getLocation1FullName:function(){return this.getLocationFullName(this.getLocation1())},getLocation1ShortName:function(){return this.getLocationShortName(this.getLocation1())},getLocation2Id:function(){return this.getLocationId(this.getLocation2())},getLocation2AirportId:function(){return this.getLocationAirportId(this.getLocation2())},getLocation2CityId:function(){return this.getLocationCityId(this.getLocation2())},getLocation2SId:function(){return this.getLocationSId(this.getLocation2())},getLocation2SAId:function(){return this.getLocationSAId(this.getLocation2())},getLocation2Code:function(){return this.getLocationCode(this.getLocation2())},getLocation2FullName:function(){return this.getLocationFullName(this.getLocation2())},getLocation2ShortName:function(){return this.getLocationShortName(this.getLocation2())},isSameLocation:function(a){var b=a.location1,c=a.location2;switch(d("<img />").prop({src:"/t.gif?t="+Date.now()+"&m="+encodeURIComponent("CORE-29046 SearchDataModel.isSameLocation called."),width:0,height:0}).appendTo("body"),this.mode){case m.SEARCH_MODE_AIR:case m.SEARCH_MODE_AIRFLEX:case m.SEARCH_MODE_VACATION_PACKAGES:return b&&c&&b.id===c.id;default:return!1}},isIdenticalLocation:function(a,b){return f.isObject(a)&&f.isObject(b)?a.id&&b.id&&a.id===b.id?!0:a.sid&&b.sid&&a.sid===b.sid?!0:!1:!1},isIdenticalCruiseDestinations:function(a,b){return f.isObject(a)&&f.isObject(b)&&a.id&&b.id&&a.id===b.id?!0:!1},isValidDate:function(a){var b,d;return null===a?!1:(b=c.getTodayDate(),d=c.getDateFromToday(330),d>a&&a>b)},updateFromCookie:function(){var a=g.getJSONDecoded(this.cookieName);if(f.isArray(a)||!f.isObject(a))return this;f.each(m.LOCATION_ATTRIBUTES.concat(m.OTHER_ATTRIBUTES),function(b){var c=a[b];f.isUndefined(c)||(this.attributes[b]=c)},this),f.each(m.BOOLEAN_ATTRIBUTES,function(b){var c=a[b];f.isUndefined(c)||(this.attributes[b]=1==c)},this);var b=c.getTodayDate();return f.each(m.DATE_ATTRIBUTES,function(c){var d=a[c];if(!f.isUndefined(d))if("d3"===c)try{this.attributes[c]=h.parseDate("yy-mm-dd",d)}catch(e){this.attributes[c]=null}else if(f.isString(d)&&d.match(/\d{2}\/\d{2}\/\d{4}/))try{this.attributes[c]=new Date(d)}catch(e){this.attributes[c]=null}else try{var g=h.parseDate("u",1e3*d);g>=b&&(this.attributes[c]=g)}catch(e){this.attributes[c]=null}},this),f.each(m.CRUISE_LOCATION_ATTRIBUTES,function(b){var c=a[b];f.isUndefined(c)||(this.attributes[b]={id:c})},this),this.trigger(m.ON_FULL_UPDATE,this),this},validateByMode:function(a){var b,c=this.mode;return a&&(this.mode=a),b=this.validateModel(this.attributes),a&&(this.mode=c),b},validateModel:function(a){var c,d,e=[];switch(this.mode){case m.SEARCH_MODE_AIR:case m.SEARCH_MODE_AIRFLEX:case m.SEARCH_MODE_VACATION_PACKAGES:(!f.isObject(a.location1)||f.isEmpty(a.location1))&&e.push("Please enter a departure airport in the 'from' field to continue."),(!f.isObject(a.location2)||f.isEmpty(a.location2))&&e.push("Please enter an arrival airport in the 'to' field to continue."),this.isIdenticalLocation(a.location1,a.location2)&&e.push("Please enter different 'from' and 'to' locations to continue.");break;case m.SEARCH_MODE_CAR:(!f.isObject(a.location2)||f.isEmpty(a.location2))&&e.push("'Pick-up City' is a required field.");break;case m.SEARCH_MODE_HOLIDAY:!f.isObject(a.location1)||f.isEmpty(a.location1)?e.push("Please select an airport from the 'From' field to continue."):f.contains(b.pageData.holidayDepartureAirports,a.location1.id)&&e.push("Please select an airport from the 'From' field to continue."),(!f.isObject(a.location2)||f.isEmpty(a.location2))&&e.push("Please select a destination from the 'To' field to continue.");break;case m.SEARCH_MODE_HOTEL:(!f.isObject(a.location2)||f.isEmpty(a.location2))&&e.push("'City' is a required field.");break;case m.SEARCH_MODE_VACATION_RENTALS:(!f.isObject(a.location2)||f.isEmpty(a.location2))&&e.push("'City, State, or Region' is a required field.")}switch(c=this.isValidDate(a.date1),d=this.isValidDate(a.date2),this.mode){case m.SEARCH_MODE_AIR:case m.SEARCH_MODE_AIRFLEX:a.date1||e.push("Departure date is required."),a.oneway||(a.date2||e.push("Return date is required."),a.date1>a.date2&&e.push("Departure date must precede return date.")),a.oneway&&!c?e.push("Flights are only available up to 330 days in advance."):a.oneway||c||d||e.push("Flights are only available up to 330 days in advance.");break;case m.SEARCH_MODE_CAR:a.date1||e.push("Pickup date is required."),a.date2||e.push("Dropoff date is required."),a.date1>a.date2&&e.push("Pickup date must precede dropoff date."),c||d||e.push("Car rentals are only available up to 330 days in advance.");break;case m.SEARCH_MODE_HOLIDAY:case m.SEARCH_MODE_VACATION_RENTALS:a.date1||e.push("Please enter a valid 'check-in'."),a.date2||e.push("Please enter a valid 'check-out'."),a.date1>a.date2&&e.push("'check-in' date must precede 'check-out' date.");break;case m.SEARCH_MODE_HOTEL:a.date1||e.push("Checkin date is required."),a.date2||e.push("Checkout date is required."),a.date1>a.date2&&e.push("Checkin date must precede checkout date."),c||d||e.push("Hotel rooms are only available up to 330 days in advance.");break;case m.SEARCH_MODE_VACATION_PACKAGES:a.date1||e.push("Departure date is required."),a.date2||e.push("Return date is required."),a.date1>a.date2&&e.push("Departure date must precede return date."),c||d||e.push("Vacation packages are only available up to 330 days in advance.")}return e.length>0?e:null},writeToCookie:function(){var a={};return f.each(m.LOCATION_ATTRIBUTES.concat(m.OTHER_ATTRIBUTES),function(b){f.isNull(this.attributes[b])||(a[b]=this.attributes[b])},this),f.each(m.BOOLEAN_ATTRIBUTES,function(b){f.isNull(this.attributes[b])||(a[b]=this.attributes[b]?1:0)},this),f.each(m.DATE_ATTRIBUTES,function(b){f.isNull(this.attributes[b])||(a[b]="d3"===b?h.formatDate("yy-mm-dd",this.attributes[b]):h.formatDate("u",this.attributes[b])/1e3)},this),f.each(m.CRUISE_LOCATION_ATTRIBUTES,function(b){f.isNull(this.attributes[b])||(a[b]=this.attributes[b].id)},this),g.setJSONEncoded(this.cookieName,a),this},getQueryStringFromData:function(){var a="";for(var b in this.attributes)null!==this.attributes[b]&&("location1"===b||"location2"===b?"geo"===this.attributes[b].type&&(a+="&"+b+"="+this.attributes[b].id,a+="&s"+b+"="+this.attributes[b].sid):a+="date1"===b||"date2"===b||"d3"===b?"&"+b+"="+this.getFormattedDateFromMilliseconds(Date.parse(this.attributes[b])):"cd"===b?"&cruise_destination_id="+this.attributes[b].id:"&"+b+"="+this.attributes[b]);return a.replace("&","")},onChangeOneWay:function(a,b,c){!b&&a.getDate2()<=a.getDate1()&&this.setDate2(h.getDateFromOffset(a.getDate1(),1))},attach:function(){return this.on("change:oneway",this.onChangeOneWay),this},defaults:function(){var a=c.getTodayDate();a.setDate(1);var b=c.getDateFromToday(21);b.isDefault=!0;var d=c.getDateFromToday(28);return d.isDefault=!0,{bb:"All",cd:{id:100000003,name:null},"class":m.SERVICE_CLASS_ECONOMY_NAME,clen:"Any Length",clin:"Any Cruise Line",d3:a,da:30,date1:b,date2:d,flx:3,location1:null,location2:null,nchl:0,nonstop:!1,o55:!1,oneway:!1,ppp:"Show Me All",prv:null,rooms:1,time1:"anytime",time2:"anytime",travelers:2}},getLocationId:function(a){return a&&a.id?a.id:null},getLocationAirportId:function(a){return a&&a.aid?a.aid:null},getLocationCityId:function(a){return a&&a.cid?a.cid:null},getLocationSId:function(a){return a&&a.sid?a.sid:null},getLocationSAId:function(a){return a&&a.said?a.said:null},getLocationCode:function(a){var b;if(a&&a.aid){var c=this.locationDataStore.lookup(a.aid);if(b=c.displayName.match(/.+ \((\w{3})\)$/),b&&b[1])return b[1]}return null},getLocationFullName:function(a){if(a&&a.id){var b=this.locationDataStore.lookup(a.id);return b.displayName}return null},getLocationShortName:function(a){var b;if(a&&a.id){var c=this.locationDataStore.lookup(a.id);return b=c.displayName.match(/(.+) \(\w{3}\)$/),b&&b[1]?b[1]:c.displayName}return null},normalizeLocationObject:function(a){var b={},c=["id","aid","cid","sid","said"];if(f.isObject(a))if(a.airport&&m.SEARCH_MODE_HOTEL!==this.mode)b.id=a.airport.ta_id,b.aid=a.airport.ta_id,b.sid=a.airport.id,b.said=a.airport.id,b.type="airport",a.city&&(b.cid=a.city.ta_id);else if(a.city&&m.SEARCH_MODE_AIR!==this.mode&&m.SEARCH_MODE_AIRFLEX!==this.mode&&m.SEARCH_MODE_CAR!==this.mode)b.id=a.city.ta_id,b.cid=a.city.ta_id,b.sid=a.city.id,b.type="city",a.airport&&(b.aid=a.airport.ta_id,b.said=a.airport.id);else{if(m.SEARCH_MODE_CAR===this.mode&&!a.airport)return b;a.id&&(b.id=a.id),a.ta_id&&(b.id=a.ta_id),a.type&&(b.type=a.type),a.aid&&(b.aid=a.aid),a.cid&&(b.cid=a.cid),a.sid&&(b.sid=a.sid),a.said&&(b.said=a.said),a.airport?b.type="airport":a.city&&(b.type="city")}else b=null;for(var e in b)-1!==d.inArray(e,c)&&(b[e]=parseInt(b[e],10));return b},sync:function(a){switch(a){case"create":case"update":this.writeToCookie();break;case"read":this.updateFromCookie()}},getFormattedDateFromMilliseconds:function(a){var b=new Date(a);return b.getFullYear()+"-"+(b.getMonth()+1)+"-"+b.getDate()}},{SEARCH_MODE_AIR:l.searchModes.air,SEARCH_MODE_AIRFLEX:l.searchModes.airflex,SEARCH_MODE_CAR:l.searchModes.car,SEARCH_MODE_CRUISE:l.searchModes.cruise,SEARCH_MODE_HOLIDAY:l.searchModes.holiday,SEARCH_MODE_HOTEL:l.searchModes.hotel,SEARCH_MODE_VACATION_PACKAGES:l.searchModes.vacationPackage,SEARCH_MODE_VACATION_RENTALS:l.searchModes.vacationRental,SERVICE_CLASS_BUSINESS:0,SERVICE_CLASS_BUSINESS_NAME:"business",SERVICE_CLASS_ECONOMY:1,SERVICE_CLASS_ECONOMY_NAME:"economy_coach",SERVICE_CLASS_FIRST:2,SERVICE_CLASS_FIRST_NAME:"first_class",SEARCH_TYPE_ONE_WAY:l.searchTypes.oneWay,SEARCH_TYPE_ROUND_TRIP:l.searchTypes.roundTrip,BOOLEAN_ATTRIBUTES:["nonstop","o55","oneway"],DATE_ATTRIBUTES:["d3","date1","date2"],LOCATION_ATTRIBUTES:["location1","location2"],CRUISE_LOCATION_ATTRIBUTES:["cd"],OTHER_ATTRIBUTES:["bb","class","clen","clin","da","flx","nchl","ppp","prv","rooms","time1","time2","travelers"],ALIASES_TO_QUERY_STRING_MAPPING:function(){var a={};return f.each(l.queryStringAliases,function(b,c){a[c]=c,f.each(b,function(b){a[b]=c})}),a}(),ATTRIBUTE_TO_QUERY_STRING_MAPPING:function(){var a={};return a[l.searchModes.air]={},a[l.searchModes.airflex]={},a[l.searchModes.car]={},a[l.searchModes.cruise]={},a[l.searchModes.holiday]={},a[l.searchModes.hotel]={},a[l.searchModes.vacationPackage]={},a[l.searchModes.vacationRental]={},f.each(l.queryStringToAttribute,function(b,c){f.isString(b)?f.each(a,function(a){a[b]||(a[b]=[]),a[b].push(c)}):f.each(b,function(b,d){a[d][b]||(a[d][b]=[]),a[d][b].push(c)})}),a}(),DEPRECATED_QUERY_STRING:l.deprecatedQueryString,QUERY_STRING_TO_ATTRIBUTE_MAPPING:function(){var a={};return a[l.searchModes.air]={},a[l.searchModes.airflex]={},a[l.searchModes.car]={},a[l.searchModes.cruise]={},a[l.searchModes.holiday]={},a[l.searchModes.hotel]={},a[l.searchModes.vacationPackage]={},a[l.searchModes.vacationRental]={},f.each(l.queryStringToAttribute,function(b,c){f.isString(b)?f.each(a,function(a){a[c]=b}):f.each(b,function(b,d){a[d][c]=b})}),a}(),SUPPORTED_QUERY_STRINGS:f.keys(l.queryStringToAttribute),ON_FULL_UPDATE:i.uniqueId(),getAttributeNameForQueryString:function(a,b){var c=null;return m.QUERY_STRING_TO_ATTRIBUTE_MAPPING[a]&&m.QUERY_STRING_TO_ATTRIBUTE_MAPPING[a][b]&&(c=m.QUERY_STRING_TO_ATTRIBUTE_MAPPING[a][b]),c},getQueryStringFromAlias:function(a){var b=a;return m.ALIASES_TO_QUERY_STRING_MAPPING[a]&&(b=m.ALIASES_TO_QUERY_STRING_MAPPING[a]),b},getQueryStringForAttribute:function(a,b){var c=[];return m.ATTRIBUTE_TO_QUERY_STRING_MAPPING[a]&&m.ATTRIBUTE_TO_QUERY_STRING_MAPPING[a][b]&&(c=m.ATTRIBUTE_TO_QUERY_STRING_MAPPING[a][b]),c=f.map(c,function(a){return m.getQueryStringFromAlias(a)}),f.uniq(c)},isValidMode:function(a){return f.contains(l.searchModes,a)},createGlobal:function(){return b.searchData||(b.searchData=new m,b.searchData.fetch()),b.searchData}});b.ns("shared.models.searchData",m)}(window);
//# sourceMappingURL=searchData.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a.Backbone,f=a._,g=b.cookies,h=b.dates,i=b.strings,j=c.models.cruiseDestinationDataStore,k={deprecatedQueryString:["ad","am","arrival_day","arrival_month","dd","departure_day","departure_month","dm","dod","dom","dropoff_day","dropoff_month","pd","pickup_day","pickup_month","pm","rd","return_day","return_month","rm"],queryStringAliases:{arrival_city:["ac"],arrival_date:[],board_basis:["bb"],"class":["sc","service_class"],cruise_destination_id:[],cruise_length:["cl"],cruise_line:[],date1:[],date2:[],departure_city:["dc"],departure_date:[],destination:["dest"],driver_age:["da"],dropoff_date:[],flex_days:["fd"],location1:[],location2:[],nonstop:["non_stop","ns"],num_children:["nc"],oneway:["search_type","st"],over_55:["o55"],pickup_city:["pc"],pickup_date:[],price_per_person:["ppp"],provider:["p"],return_date:[],rooms:["nb","nr","num_bedrooms","num_rooms"],slocation1:[],slocation2:[],time1:["departure_time","dt","pickup_time","put"],time2:["dot","dropoff_time","return_time","rt"],travel_month:["tm"],travelers:["nt","num_travelers"]},queryStringToAttribute:{ac:"location2",arrival_city:"location2",arrival_date:{hotel:"date1",vacation_rental:"date1"},bb:"bb",board_basis:"bb",cl:"clen","class":"class",cruise_destination_id:"cd",cruise_length:"clen",cruise_line:"clin",da:"da",date1:"date1",date2:"date2",dc:"location1",departure_city:"location1",departure_date:{air:"date1",airflex:"date1",holiday:"date1",hotel:"date2",vacation:"date1",vacation_rental:"date2"},departure_time:"time1",dest:"c3",destination:"c3",dot:"time2",driver_age:"da",dropoff_date:{car:"date2"},dropoff_time:{car:"time2"},dt:"time1",fd:"flx",flex_days:"flx",location1:"location1",location2:"location2",nb:"rooms",nc:"nchl",non_stop:"nonstop",nonstop:"nonstop",nr:"rooms",ns:"nonstop",nt:"travelers",num_bedrooms:"rooms",num_children:"nchl",num_rooms:"rooms",num_travelers:"travelers",o55:"o55",oneway:"oneway",over_55:"o55",p:"prv",pc:"location2",pickup_city:{car:"location2"},pickup_date:{car:"date1"},pickup_time:{car:"time1"},ppp:"ppp",price_per_person:"ppp",provider:"prv",put:"time1",return_date:{air:"date2",vacation:"date2",holiday:"date2",airflex:"date2"},return_time:"time2",rooms:"rooms",rt:"time2",sc:"class",search_type:"oneway",service_class:"class",slocation1:"location1",slocation2:"location2",st:"oneway",time1:"time1",time2:"time2",tm:"d3",travel_month:"d3",travelers:"travelers"},searchModes:{air:"air",airflex:"airflex",car:"car",cruise:"cruise",holiday:"holiday",hotel:"hotel",vacationPackage:"vacation",vacationRental:"vacation_rental"}},l=e.Model.extend({initialize:function(){this.updateFromCookie(),this.cruiseDestinationDataStore=new j,d("<img />").prop({src:"/t.gif?t="+Date.now()+"&m="+encodeURIComponent("CORE-29046 TASearchDataModel.initialize called."),width:0,height:0}).appendTo("body")},cookieName:"cs",mode:null,cruiseDestinationDataStore:null,getBoardBasis:function(){return this.get("bb")},setBoardBasis:function(a,b){return this.set("bb",a,b)},getCruiseLocation:function(){return this.getCruiseDestinationName()},getCruiseDestination:function(){var a=this.get("cd");if(!a)return{};if(a.name)return a;var b=this.cruiseDestinationDataStore.lookup(a.id).crusieDestinationName;return a={id:cruiseDestId,name:b},this.set("cd",a),a},setCruiseDestination:function(a,b){return a&&a.id?(this.isIdenticalCruiseDestinations(a,this.getCruiseDestination)||this.set("cd",a,b),this):this},getCruiseDestinationName:function(){var a=this.getCruiseDestination();return a?a.name:""},getCruiseDestinationId:function(){var a=this.getCruiseDestination();return a?a.id:""},getServiceClass:function(){return this.get("class")},setServiceClass:function(a,b){return this.set("class",a,b)},getCruiseLength:function(){return this.get("clen")},setCruiseLength:function(a,b){return this.set("clen",a,b)},getCruiseLine:function(){return this.get("clin")},setCruiseLine:function(a,b){return this.set("clin",a,b)},getCruiseDeparture:function(){return this.get("d3")},setCruiseDeparture:function(a,b){return this.set("d3",a,b)},getDriverAge:function(){return this.get("da")},setDriverAge:function(a,b){return this.set("da",a,b)},getDate1:function(){return this.get("date1")},setDate1:function(a,b){var c=this.getDate2();return this.set("date1",a,b),a&&c&&a>c&&(c=new Date(a.getTime()),c.setDate(a.getDate()+1),this.setDate2(c)),this},getDate2:function(){return this.get("date2")},setDate2:function(a,b){return this.set("date2",a,b)},getFlexDays:function(){return this.get("flx")},setFlexDays:function(a,b){return this.set("flx",a,b)},getLocation1:function(){return this.get("location1")},setLocation1:function(a,b){var c=this.normalizeLocationObject(a),d=this.getLocation1(),e=c&&d&&(c.sid==d.sid||c.id==d.id);return e?this:this.set("location1",c,b)},getLocation2:function(){return this.get("location2")},setLocation2:function(a,b){var c=this.normalizeLocationObject(a),d=this.getLocation2(),e=c&&d&&(c.sid==d.sid||c.id==d.id);return e?this:this.set("location2",c,b)},getNumChildren:function(){return this.get("nchl")},setNumChildren:function(a,b){return this.set("nchl",a,b)},isNonstop:function(){return this.get("nonstop")},setNonstop:function(a,b){return this.set("nonstop",a,b)},isOver55:function(){return this.get("o55")},setOver55:function(a,b){return this.set("o55",a,b)},isOneway:function(){return this.get("oneway")},setOneway:function(a,b){return this.set("oneway","oneway"===a||1==a||a===!0,b)},isRoundTrip:function(){return!this.isOneway()},setRoundTrip:function(a,b){return this.setOneway(!a,b)},getPricePerPerson:function(){return this.get("ppp")},setPricePerPerson:function(a,b){return this.set("ppp",a,b)},getProvider:function(){return this.get("prv")},setProvider:function(a,b){return this.set("prv",a,b)},getRooms:function(){return this.get("rooms")},setRooms:function(a,b){return this.set("rooms",a,b)},getTime1:function(){return this.get("time1")},setTime1:function(a,b){return this.set("time1",a,b)},getTime2:function(){return this.get("time2")},setTime2:function(a,b){return this.set("time2",a,b)},getTravelers:function(){return this.get("travelers")},setTravelers:function(a,b){return this.set("travelers",a,b)},getCruiseDate:function(){return h.formatDate("yy-mm-01",this.getCruiseDeparture())},setCruiseDate:function(a){return this.setCruiseDeparture(h.parseDate("yy-mm-dd",a))},getSearchType:function(){return this.isOneway()?"oneway":"roundtrip"},setSearchType:function(a){return this.setOneway(a)},getLocation1ByType:function(){return this.getLocation1()},getLocation1ByTypes:function(){return this.getLocation1()},getLocation2ByType:function(){return this.getLocation2()},getLocation2ByTypes:function(){return this.getLocation2()},getLocation1AirportId:function(){return this.getLocationAirportId(this.getLocation1())},getLocation1CityId:function(){return this.getLocationCityId(this.getLocation1())},getLocation1Code:function(){return this.getLocationCode(this.getLocation1())},getLocation1Id:function(){return this.getLocationId(this.getLocation1())},getLocation1FullName:function(){return this.getLocationFullName(this.getLocation1())},getLocation1ShortName:function(){return this.getLocationShortName(this.getLocation1())},getLocation2AirportId:function(){return this.getLocationAirportId(this.getLocation2())},getLocation2CityId:function(){return this.getLocationCityId(this.getLocation2())},getLocation2Code:function(){return this.getLocationCode(this.getLocation2())},getLocation2Id:function(){return this.getLocationId(this.getLocation2())},getLocation2FullName:function(){return this.getLocationFullName(this.getLocation2())},getLocation2ShortName:function(){return this.getLocationShortName(this.getLocation2())},isSameLocation:function(a){var b=a.location1,c=a.location2;switch(d("<img />").prop({src:"http://i.slimg.com/transparent.gif?t="+Date.now()+"&m="+encodeURIComponent("CORE-29046 TASearchDataModel.isSameLocation called."),width:0,height:0}).appendTo("body"),this.mode){case l.SEARCH_MODE_AIR:case l.SEARCH_MODE_AIRFLEX:case l.SEARCH_MODE_VACATION_PACKAGES:return b&&c&&b.id===c.id&&b.name===c.name;default:return!1}},isValidDate:function(a){var b,d;return null===a?!1:(b=c.getTodayDate(),d=c.getDateFromToday(330),d>a&&a>b)},updateFromCookie:function(){var a=g.getJSONDecoded(this.cookieName);return f.isArray(a)||!f.isObject(a)?this:(f.each(l.LOCATION_ATTRIBUTES.concat(l.OTHER_ATTRIBUTES),function(b){var c=a[b];if(!f.isUndefined(c))if("class"===b)switch(parseInt(c,10)){case l.SERVICE_CLASS_BUSINESS:this.attributes[b]=l.SERVICE_CLASS_BUSINESS_NAME;break;case l.SERVICE_CLASS_ECONOMY:this.attributes[b]=l.SERVICE_CLASS_ECONOMY_NAME;break;case l.SERVICE_CLASS_FIRST:this.attributes[b]=l.SERVICE_CLASS_FIRST_NAME}else this.attributes[b]=c},this),f.each(l.BOOLEAN_ATTRIBUTES,function(b){var c=a[b];f.isUndefined(c)||(this.attributes[b]=1==c)},this),f.each(l.DATE_ATTRIBUTES,function(b){var c=a[b];if(!f.isUndefined(c))if("d3"===b)try{this.attributes[b]=h.parseDate("yy-mm-dd",c)}catch(d){this.attributes[b]=null}else if(f.isString(c)&&c.match(/\d{2}\/\d{2}\/\d{4}/))try{this.attributes[b]=new Date(c)}catch(d){this.attributes[b]=null}else try{this.attributes[b]=h.parseDate("u",1e3*c)}catch(d){this.attributes[b]=null}},this),f.each(l.CRUISE_LOCATION_ATTRIBUTES,function(b){var c=a[b];f.isUndefined(c)||(this.attributes[b]={id:c})},this),this.trigger(l.ON_FULL_UPDATE,this),this)},validateByMode:function(a){var b,c=this.mode;return a&&(this.mode=a),b=this.validateModel(this.attributes),a&&(this.mode=c),b},validateModel:function(a){var c,d,e=[];switch(this.mode){case l.SEARCH_MODE_AIR:case l.SEARCH_MODE_AIRFLEX:case l.SEARCH_MODE_VACATION_PACKAGES:a.location1||e.push("Please enter a departure airport in the 'from' field to continue."),a.location2||e.push("Please enter an arrival airport in the 'to' field to continue."),this.isSameLocation(a)&&e.push("Please enter different 'from' and 'to' locations to continue.");break;case l.SEARCH_MODE_CAR:a.location2||e.push("'Pick-up City' is a required field.");break;case l.SEARCH_MODE_HOLIDAY:a.location1?f.contains(b.pageData.holidayDepartureAirports,a.location1.id)&&e.push("Please select an airport from the 'From' field to continue."):e.push("Please select an airport from the 'From' field to continue."),a.location2||e.push("Please select a destination from the 'To' field to continue.");break;case l.SEARCH_MODE_HOTEL:a.location2||e.push("'City' is a required field.");break;case l.SEARCH_MODE_VACATION_RENTALS:a.location2||e.push("'City, State, or Region' is a required field.")}switch(c=this.isValidDate(a.date1),d=this.isValidDate(a.date2),this.mode){case l.SEARCH_MODE_AIR:case l.SEARCH_MODE_AIRFLEX:a.date1||e.push("Departure date is required."),a.oneway||(a.date2||e.push("Return date is required."),a.date1>a.date2&&e.push("Departure date must precede return date.")),a.oneway&&!c?e.push("Flights are only available up to 330 days in advance."):a.oneway||c||d||e.push("Flights are only available up to 330 days in advance.");break;case l.SEARCH_MODE_CAR:a.date1||e.push("Pickup date is required."),a.date2||e.push("Dropoff date is required."),a.date1>a.date2&&e.push("Pickup date must precede dropoff date."),c||d||e.push("Car rentals are only available up to 330 days in advance.");break;case l.SEARCH_MODE_HOLIDAY:case l.SEARCH_MODE_VACATION_RENTALS:a.date1||e.push("Please enter a valid 'check-in'."),a.date2||e.push("Please enter a valid 'check-out'."),a.date1>a.date2&&e.push("'check-in' date must precede 'check-out' date.");break;case l.SEARCH_MODE_HOTEL:a.date1||e.push("Checkin date is required."),a.date2||e.push("Checkout date is required."),a.date1>a.date2&&e.push("Checkin date must precede checkout date."),c||d||e.push("Hotel rooms are only available up to 330 days in advance.");break;case l.SEARCH_MODE_VACATION_PACKAGES:a.date1||e.push("Departure date is required."),a.date2||e.push("Return date is required."),a.date1>a.date2&&e.push("Departure date must precede return date."),c||d||e.push("Vacation packages are only available up to 330 days in advance.")}return e.length>0?e:null},writeToCookie:function(){var a={};return f.each(l.LOCATION_ATTRIBUTES.concat(l.OTHER_ATTRIBUTES),function(b){f.isNull(this.attributes[b])||(a[b]=this.attributes[b])},this),f.each(l.BOOLEAN_ATTRIBUTES,function(b){f.isNull(this.attributes[b])||(a[b]=this.attributes[b]?1:0)},this),f.each(l.DATE_ATTRIBUTES,function(b){f.isNull(this.attributes[b])||(a[b]="d3"===b?h.formatDate("yy-mm-dd",this.attributes[b]):h.formatDate("u",this.attributes[b])/1e3)},this),f.each(l.CRUISE_LOCATION_ATTRIBUTES,function(b){f.isNull(this.attributes[b])||(a[b]=this.attributes[b].id)},this),g.setJSONEncoded(this.cookieName,a),this},defaults:function(){var a=c.getTodayDate();return a.setDate(1),{bb:"All",cd:100000003,"class":l.SERVICE_CLASS_ECONOMY_NAME,clen:"Any Length",clin:"Any Cruise Line",d3:a,da:30,date1:null,date2:null,flx:3,location1:null,location2:null,nchl:0,nonstop:!1,o55:!1,oneway:!1,ppp:"Show Me All",prv:null,rooms:1,time1:"anytime",time2:"anytime",travelers:2}},getLocationAirportId:function(a){return a&&a.aid?a.aid:null},getLocationCityId:function(a){return a&&a.cid?a.cid:null},getLocationCode:function(a){var b;return a&&a.name&&(b=a.name.match(/.+ \((\w{3})\)$/),b&&b[1])?b[1]:null},getLocationId:function(a){return a&&a.id?a.id:null},getLocationFullName:function(a){return a&&a.name?a.name:null},getLocationShortName:function(a){var b;return a&&a.name?(b=a.name.match(/(.+) \(\w{3}\)$/),b&&b[1]?b[1]:a.name):null},normalizeLocationObject:function(a){var b={};return f.isObject(a)?a.airport?(b.id=a.airport.ta_id,b.aid=a.airport.ta_id,b.sid=a.airport.id,b.name=a.airport.name,b.type="airport",a.city&&(b.cid=a.city.ta_id)):a.city?(b.id=a.city.ta_id,b.cid=a.city.ta_id,b.sid=a.city.id,b.name=a.city.name,b.type="city",a.airport&&(b.aid=a.airport.ta_id)):(a.id&&(b.id=a.id),a.ta_id&&(b.id=a.ta_id),a.sid&&(b.sid=a.sid),a.name&&(b.name=a.name),a.type&&(b.type=a.type)):b=null,b},sync:function(a){switch(a){case"create":case"update":this.writeToCookie();break;case"read":this.updateFromCookie()}}},{SEARCH_MODE_AIR:k.searchModes.air,SEARCH_MODE_AIRFLEX:k.searchModes.airflex,SEARCH_MODE_CAR:k.searchModes.car,SEARCH_MODE_CRUISE:k.searchModes.cruise,SEARCH_MODE_HOLIDAY:k.searchModes.holiday,SEARCH_MODE_HOTEL:k.searchModes.hotel,SEARCH_MODE_VACATION_PACKAGES:k.searchModes.vacationPackage,SEARCH_MODE_VACATION_RENTALS:k.searchModes.vacationRental,SERVICE_CLASS_BUSINESS:0,SERVICE_CLASS_BUSINESS_NAME:"business",SERVICE_CLASS_ECONOMY:1,SERVICE_CLASS_ECONOMY_NAME:"economy_coach",SERVICE_CLASS_FIRST:2,SERVICE_CLASS_FIRST_NAME:"first_class",BOOLEAN_ATTRIBUTES:["nonstop","o55","oneway"],DATE_ATTRIBUTES:["d3","date1","date2"],LOCATION_ATTRIBUTES:["location1","location2"],CRUISE_LOCATION_ATTRIBUTES:["cd"],OTHER_ATTRIBUTES:["bb","class","clen","clin","da","flx","nchl","ppp","prv","rooms","time1","time2","travelers"],ALIASES_TO_QUERY_STRING_MAPPING:function(){var a={};return f.each(k.queryStringAliases,function(b,c){a[c]=c,f.each(b,function(b){a[b]=c})}),a}(),ATTRIBUTE_TO_QUERY_STRING_MAPPING:function(){var a={};return a[k.searchModes.air]={},a[k.searchModes.airflex]={},a[k.searchModes.car]={},a[k.searchModes.cruise]={},a[k.searchModes.holiday]={},a[k.searchModes.hotel]={},a[k.searchModes.vacationPackage]={},a[k.searchModes.vacationRental]={},f.each(k.queryStringToAttribute,function(b,c){f.isString(b)?f.each(a,function(a){a[b]||(a[b]=[]),a[b].push(c)}):f.each(b,function(b,d){a[d][b]||(a[d][b]=[]),a[d][b].push(c)})}),a}(),DEPRECATED_QUERY_STRING:k.deprecatedQueryString,QUERY_STRING_TO_ATTRIBUTE_MAPPING:function(){var a={};return a[k.searchModes.air]={},a[k.searchModes.airflex]={},a[k.searchModes.car]={},a[k.searchModes.cruise]={},a[k.searchModes.holiday]={},a[k.searchModes.hotel]={},a[k.searchModes.vacationPackage]={},a[k.searchModes.vacationRental]={},f.each(k.queryStringToAttribute,function(b,c){f.isString(b)?f.each(a,function(a){a[c]=b}):f.each(b,function(b,d){a[d][c]=b})}),a}(),SUPPORTED_QUERY_STRINGS:f.keys(k.queryStringToAttribute),ON_FULL_UPDATE:i.uniqueId(),getAttributeNameForQueryString:function(a,b){var c=null;return l.QUERY_STRING_TO_ATTRIBUTE_MAPPING[a]&&l.QUERY_STRING_TO_ATTRIBUTE_MAPPING[a][b]&&(c=l.QUERY_STRING_TO_ATTRIBUTE_MAPPING[a][b]),c},getQueryStringFromAlias:function(a){var b=a;return l.ALIASES_TO_QUERY_STRING_MAPPING[a]&&(b=l.ALIASES_TO_QUERY_STRING_MAPPING[a]),b},getQueryStringForAttribute:function(a,b){var c=[];return l.ATTRIBUTE_TO_QUERY_STRING_MAPPING[a]&&l.ATTRIBUTE_TO_QUERY_STRING_MAPPING[a][b]&&(c=l.ATTRIBUTE_TO_QUERY_STRING_MAPPING[a][b]),c=f.map(c,function(a){return l.getQueryStringFromAlias(a)}),f.uniq(c)},isValidMode:function(a){return f.contains(k.searchModes,a)}});c.ns("models.taSearchData",l)}(window);
//# sourceMappingURL=taSearchData.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=a.Backbone,e=a.jQuery,f=a._,g=c.shared.models.ad;e(function(){b=a.BBAd});var h=d.Collection.extend({model:g,initialize:function(){this.on("change:_tab_focused",this.focusAd,this)},focusAd:function(a){if(a.isTabFocused()){var b=f.without(this.models,a);f.each(b,function(a){a.setTabFocused(!1)})}},reset:function(a){f.each(a,function(a){b.singleton(a.id).setMetaDataMulti(a)}),d.Collection.prototype.reset.apply(this,[a])},getBBAdSingletons:function(){var a={},c=null;return f.each(this.models,function(d){c=d.get("id"),a[c]=b.singleton(c)}),a},getTabAds:function(){return this.filter(function(a){return!a.isDropdownAd()})},getTabAdIds:function(){return this.getTabAds().map(function(a){return a.get("id")})},getDropdownAds:function(){return this.filter(function(a){return a.isDropdownAd()})},getDropdownAdIds:function(){return this.getDropdownAds().map(function(a){return a.get("id")})}});c.ns("shared.collections.ad",h)}(window);
//# sourceMappingURL=ad.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=c.View.extend({model:null,options:{renderOnChange:!0,renderOnInit:!0},events:{change:"changeHandler"},initialize:function(){void 0!==this.el&&(this.options.renderOnChange&&this.model.on("change",this.render,this),this.options.renderOnInit&&this.render())},render:function(){return this},changeHandler:function(){return this}});b.ns("shared.views.searchInput",d)}(window);
//# sourceMappingURL=searchInput.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({events:{"change [data-stm-role=location1Input]":"changeHandler"},changeHandler:function(){var a=this.location1Input.find(":selected").data("locationData");return this.model.setLocation1(a),this.model.save(),this},initialize:function(){this.location1Input=this.$('[data-stm-role="location1Input"]'),this.location1Id=this.$('[data-stm-role="location1Id"]'),c.prototype.initialize.apply(this)},render:function(){var a=this.model.getLocation1ByType("airport"),b="";a&&(b=a.sid?a.sid:a.id);var c=this.location1Input.find('[data-location-id="'+b+'"]');return c.length>=1?(c.prop("selected",!0),this.location1Id.val(b)):(this.location1Input.val(""),this.location1Id.val("")),this}});b.ns("shared.views.searchInput.holidayLocation1",d)}(window);
//# sourceMappingURL=holidayLocation1.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=a.jQuery,e=c.shared.views.searchInput;d(function(){b=a.LocationSuggest});var f=e.extend({events:{"LocationSuggest:valid [data-stm-role=location1Input]":"changeHandler","LocationSuggest:invalid [data-stm-role=location1Input]":"changeHandler"},changeHandler:function(){return this.model.setLocation1(this.location1Input.data("locationData")),this.model.save(),this},initialize:function(){this.location1Input=this.$("[data-stm-role=location1Input]"),this.location1Id=this.$("[data-stm-role=location1Id]"),this.ls1=new b(this.location1Input,this.getLSType(),null,{},this.location1Id),e.prototype.initialize.apply(this)},getLSType:function(){var a=null;switch(this.options.mode){case"air":case"vacation":a=["airport"];break;case"hotel":a=["city"];break;case"car":a=["airport","city"];break;case"vacation_rental":a=["city","state","region"];break;default:a=["airport"]}return a},render:function(){var a=this.model.getLocation1ByTypes(this.getLSType()),b="",c="";return a&&(b=a.name,c=a.id),this.location1Input.val(b),this.location1Id.val(c),this}});c.ns("shared.views.searchInput.location1",f)}(window);
//# sourceMappingURL=location1.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=a.jQuery,e=c.shared.views.searchInput;d(function(){b=a.LocationSuggest});var f=e.extend({events:{"LocationSuggest:valid [data-stm-role=location2Input]":"changeHandler","LocationSuggest:invalid [data-stm-role=location2Input]":"changeHandler"},changeHandler:function(){return this.model.setLocation2(this.location2Input.data("locationData")),this.model.save(),this},initialize:function(){this.location2Input=this.$("[data-stm-role=location2Input]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.ls2=new b(this.location2Input,this.getLSType(),null,{},this.location2Id),e.prototype.initialize.apply(this)},getLSType:function(){var a=null;switch(this.options.mode){case"air":case"vacation":a=["airport"];break;case"hotel":a=["city"];break;case"car":a=["airport","city"];break;case"holiday":a=["city","state","country"];break;case"vacation_rental":a=["city","state","region"];break;default:a=["airport"]}return a},render:function(){var a=this.model.getLocation2ByTypes(this.getLSType()),b="",c="";return a&&(b=a.name,c=a.id),this.location2Input.val(b),this.location2Id.val(c),this}});c.ns("shared.views.searchInput.location2",f)}(window);
//# sourceMappingURL=location2.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({initialize:function(){this.location1Input=this.$("[data-stm-role=location1Input]"),this.location1Id=this.$("[data-stm-role=location1Id]"),c.prototype.initialize.apply(this)},getLSType:function(){var a=null;switch(this.options.mode){case"air":case"vacation":a=["airport"];break;case"hotel":a=["city"];break;case"car":a=["airport","city"];break;case"vacation_rental":a=["city","state","region"];break;default:a=["airport"]}return a},render:function(){var a=this.model.getLocation1ByTypes(this.getLSType()),b="",c="";return a&&(b=a.name,c=a.id),this.location1Input.val(b),this.location1Id.val(c),this}});b.ns("shared.views.searchInput.location1Hidden",d)}(window);
//# sourceMappingURL=location1Hidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({initialize:function(){this.location2Input=this.$("[data-stm-role=location2Input]"),this.location2Id=this.$("[data-stm-role=location2Id]"),c.prototype.initialize.apply(this)},getLSType:function(){var a=null;switch(this.options.mode){case"air":case"vacation":a=["airport"];break;case"hotel":a=["city"];break;case"car":a=["airport","city"];break;case"vacation_rental":a=["city","state","region"];break;default:a=["airport"]}return a},render:function(){var a=this.model.getLocation2ByTypes(this.getLSType()),b="",c="";return a&&(b=a.name,c=a.id),this.location2Input.val(b),this.location2Id.val(c),this}});b.ns("shared.views.searchInput.location2Hidden",d)}(window);
//# sourceMappingURL=location2Hidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=b.browser,e=c.extend({events:{change:"changeHandler"},changeHandler:function(){return this.model.setDate1(this.$el.datepicker("getDate")),this.model.save(),this},initialize:function(){var a=this;this.$el.datepicker({beforeShow:function(b,c){return{highlightDateRange:a.options.tripHighlight,range1:a.model.getDate1(),range2:a.model.getDate2()}}}),this.$el.datepicker("option","dateFormat",this.options.dateFormat),c.prototype.initialize.apply(this)},setTripHighlight:function(a){this.options.tripHighlight=a},render:function(){var a=this.model.getDate1();return a&&(this.$el.datepicker("hide"),this.$el.datepicker("setDate",a)),d.Platform.isTablet&&this.$el.attr("readonly",!0),this}});b.ns("shared.views.searchInput.date1",e)}(window);
//# sourceMappingURL=date1.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=b.browser,e=c.extend({changeHandler:function(){return this.model.setDate2(this.$el.datepicker("getDate")),this.model.save(),this},updateMinDate:function(){var a=this.model.getDate1();a&&this.$el.datepicker("option","minDate",a)},initialize:function(){var a=this;this.$el.datepicker({beforeShow:function(b,c){return{highlightDateRange:a.options.tripHighlight,range1:a.model.getDate1(),range2:a.model.getDate2()}}}),this.$el.datepicker("option","dateFormat",this.options.dateFormat),this.model.on("change:date1",this.updateMinDate,this),c.prototype.initialize.apply(this)},render:function(){this.updateMinDate();var a=this.model.getDate2();return a&&(this.$el.datepicker("hide"),this.$el.datepicker("setDate",a)),d.Platform.isTablet&&this.$el.attr("readonly",!0),this}});b.ns("shared.views.searchInput.date2",e)}(window);
//# sourceMappingURL=date2.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.dates,d=b.shared.views.searchInput,e=d.extend({render:function(){var a=this.model.getDate1();return a&&this.$el.val(c.formatDate("mm/dd/yy",a)),this}});b.ns("shared.views.searchInput.date1Hidden",e)}(window);
//# sourceMappingURL=date1Hidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.dates,d=b.shared.views.searchInput,e=d.extend({render:function(){var a=this.model.getDate2();return a&&this.$el.val(c.formatDate("mm/dd/yy",a)),this}});b.ns("shared.views.searchInput.date2Hidden",e)}(window);
//# sourceMappingURL=date2Hidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=b.shared.views.searchInput,e=d.extend({changeHandler:function(){return this.model.setDriverAge(this.$el.val()),this.model.save(),this},render:function(){return this.$el.val(this.model.getDriverAge()),this}});c.ns("views.searchInput.driverAge",e)}(window);
//# sourceMappingURL=driverAge.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({changeHandler:function(){this.model.setFlexDays(this.$el.val()),this.model.save()},render:function(){var a=this.model.getFlexDays();return a&&this.$el.val(a),this}});b.ns("shared.views.searchInput.flexDays",d)}(window);
//# sourceMappingURL=flexDays.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({changeHandler:function(){return this.model.setTime1(this.$el.val()),this.model.save(),this},render:function(){return this.$el.val(this.model.getTime1()),this}});b.ns("shared.views.searchInput.time1",d)}(window);
//# sourceMappingURL=time1.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({changeHandler:function(){return this.model.setTime2(this.$el.val()),this.model.save(),this},render:function(){return this.$el.val(this.model.getTime2()),this}});b.ns("shared.views.searchInput.time2",d)}(window);
//# sourceMappingURL=time2.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({render:function(){return this.$el.val(this.model.getTime1()),this}});b.ns("shared.views.searchInput.time1Hidden",d)}(window);
//# sourceMappingURL=time1Hidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({render:function(){return this.$el.val(this.model.getTime2()),this}});b.ns("shared.views.searchInput.time2Hidden",d)}(window);
//# sourceMappingURL=time2Hidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({changeHandler:function(){return this.model.setServiceClass(this.$el.val()),this.model.save(),this},render:function(){return this.$el.val(this.model.getServiceClass()),this}});b.ns("shared.views.searchInput.serviceClass",d)}(window);
//# sourceMappingURL=serviceClass.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({render:function(){return this.$el.val(this.model.getServiceClass()),this}});b.ns("shared.views.searchInput.serviceClassHidden",d)}(window);
//# sourceMappingURL=serviceClassHidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=b.shared.views.searchInput,e=d.extend({changeHandler:function(){return this.model.setSearchType(this.$el.filter(":checked").val()),this.model.save(),this},render:function(){var a=this.model.getSearchType();return this.$el.each(function(){var b=c(this);b.prop("checked",b.val()===a)}),this}});b.ns("shared.views.searchInput.searchType",e)}(window);
//# sourceMappingURL=searchType.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({render:function(){return this.$el.val(this.model.getSearchType()),this}});b.ns("shared.views.searchInput.searchTypeHidden",d)}(window);
//# sourceMappingURL=searchTypeHidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({changeHandler:function(){return this.model.setTravelers(this.$el.val()),this.model.save(),this},render:function(){return this.$el.val(this.model.getTravelers()),this}});b.ns("shared.views.searchInput.travelers",d)}(window);
//# sourceMappingURL=travelers.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({render:function(){return this.$el.val(this.model.getTravelers()),this}});b.ns("shared.views.searchInput.travelersHidden",d)}(window);
//# sourceMappingURL=travelersHidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({changeHandler:function(){return this.model.setNonstop(this.$el.is(":checked")),this.model.save(),this},render:function(){return this.$el.attr("checked",this.model.isNonstop()),this}});b.ns("shared.views.searchInput.nonStop",d)}(window);
//# sourceMappingURL=nonStop.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({render:function(){return this.$el.val(this.model.isNonstop()?"1":"0"),this}});b.ns("shared.views.searchInput.nonStopHidden",d)}(window);
//# sourceMappingURL=nonStopHidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({changeHandler:function(){return this.model.setProvider(this.$el.val()),this.model.save(),this},render:function(){return this.$el.val(this.model.getProvider()),this}});b.ns("shared.views.searchInput.provider",d)}(window);
//# sourceMappingURL=provider.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({render:function(){return this.$el.val(this.model.getProvider()),this}});b.ns("shared.views.searchInput.providerHidden",d)}(window);
//# sourceMappingURL=providerHidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({changeHandler:function(){return this.model.setRooms(this.$el.val()),this.model.save(),this},render:function(){return this.$el.val(this.model.getRooms()),this}});b.ns("shared.views.searchInput.rooms",d)}(window);
//# sourceMappingURL=rooms.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({render:function(){return this.$el.val(this.model.getRooms()),this}});b.ns("shared.views.searchInput.roomsHidden",d)}(window);
//# sourceMappingURL=roomsHidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({changeHandler:function(){return this.model.setCruiseDestination({id:this.$el.val(),name:this.$el.find("option:selected").text()}),this.model.save(),this},render:function(){return this.$el.val(this.model.getCruiseDestinationId()),this}});b.ns("shared.views.searchInput.cruiseLocation",d)}(window);
//# sourceMappingURL=cruiseLocation.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({render:function(){return this.$el.val(this.model.getCruiseDestinationId()),this}});b.ns("shared.views.searchInput.cruiseLocationHidden",d)}(window);
//# sourceMappingURL=cruiseLocationHidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({changeHandler:function(){return this.model.setCruiseLine(this.$el.val()),this.model.save(),this},render:function(){return this.$el.val(this.model.getCruiseLine()),this}});b.ns("shared.views.searchInput.cruiseLine",d)}(window);
//# sourceMappingURL=cruiseLine.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({render:function(){return this.$el.val(this.model.getCruiseLine()),this}});b.ns("shared.views.searchInput.cruiseLineHidden",d)}(window);
//# sourceMappingURL=cruiseLineHidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({changeHandler:function(){return this.model.setCruiseDate(this.$el.val()),this.model.save(),this},render:function(){return this.model.getCruiseDate()&&this.$el.val(this.model.getCruiseDate()),this}});b.ns("shared.views.searchInput.cruiseDate",d)}(window);
//# sourceMappingURL=cruiseDate.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({render:function(){return this.model.getCruiseDate()&&this.$el.val(this.model.getCruiseDate()),this}});b.ns("shared.views.searchInput.cruiseDateHidden",d)}(window);
//# sourceMappingURL=cruiseDateHidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({changeHandler:function(){return this.model.setCruiseLength(this.$el.val()),this.model.save(),this},render:function(){return this.$el.val(this.model.getCruiseLength()),this}});b.ns("shared.views.searchInput.cruiseLength",d)}(window);
//# sourceMappingURL=cruiseLength.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({render:function(){return this.$el.val(this.model.getCruiseLength()),this}});b.ns("shared.views.searchInput.cruiseLengthHidden",d)}(window);
//# sourceMappingURL=cruiseLengthHidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({changeHandler:function(){return this.model.setOver55(this.$el.is(":checked")),this.model.save(),this},render:function(){return this.$el.attr("checked",this.model.isOver55()),this}});b.ns("shared.views.searchInput.over55",d)}(window);
//# sourceMappingURL=over55.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({render:function(){return this.$el.val(this.model.isOver55()?"1":"0"),this}});b.ns("shared.views.searchInput.over55Hidden",d)}(window);
//# sourceMappingURL=over55Hidden.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({changeHandler:function(){return this.model.setBoardBasis(this.$el.val()),this.model.save(),this},render:function(){var a=this.model.getBoardBasis();return a&&(a=a.replace("+"," ")),this.$el.val(a),this}});b.ns("shared.views.searchInput.boardBasis",d)}(window);
//# sourceMappingURL=boardBasis.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({changeHandler:function(){return this.model.setNumChildren(this.$el.val()),this.model.save(),this},render:function(){return this.$el.val(this.model.getNumChildren()),this}});b.ns("shared.views.searchInput.numChildren",d)}(window);
//# sourceMappingURL=numChildren.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared.views.searchInput,d=c.extend({changeHandler:function(){return this.model.setPricePerPerson(this.$el.val()),this.model.save(),this},render:function(){return this.$el.val(this.model.getPricePerPerson()),this}});b.ns("shared.views.searchInput.pricePerPerson",d)}(window);
//# sourceMappingURL=pricePerPerson.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=b.shared.views.searchInput.cruiseDate,e=b.shared.views.searchInput.cruiseLength,f=b.shared.views.searchInput.cruiseLine,g=b.shared.views.searchInput.cruiseLocation,h=b.shared.views.searchInput.date1,i=b.shared.views.searchInput.date2,j=b.shared.views.searchInput.holidayLocation1,k=b.shared.views.searchInput.location1,l=b.shared.views.searchInput.location2,m=b.shared.views.searchInput.nonStop,n=b.shared.views.searchInput.over55,o=b.shared.views.searchInput.provider,p=b.shared.views.searchInput.rooms,q=b.shared.views.searchInput.searchType,r=b.shared.views.searchInput.serviceClass,s=b.shared.views.searchInput.time1,t=b.shared.views.searchInput.time2,u=b.shared.views.searchInput.travelers,v=c.View.extend({model:null,options:{validate:!0,validateOnInitialize:!1,renderOnChange:!0,dateFormat:"mm/dd/yy"},events:{"click [data-stm-role=submit]":"submit"},initialize:function(){this.mode=this.$("[data-stm-role=mode]").val(),this.errorMessages=this.$("[data-stm-role=errors]"),this.firstRun=!0,this.initializeInputs(),this.initializeBaseInputs(),this.options.validate&&this.options.validateOnInitialize&&this.validate(),this.options.renderOnChange&&this.model.on("change",this.render,this)},initializeInputs:function(){return this},initializeBaseInputs:function(){return this.holidayLocation1||(this.holidayLocation1=new j({el:this.$("[data-stm-role=holidayLocation1]"),model:this.model})),this.location1||(this.location1=new k({el:this.$("[data-stm-role=location1]"),mode:this.mode,model:this.model})),this.location2||(this.location2=new l({el:this.$("[data-stm-role=location2]"),mode:this.mode,model:this.model})),this.date1||(this.date1=new h({el:this.$("[data-stm-role=date1]"),dateFormat:this.options.dateFormat,model:this.model,highlightTrip:!0})),this.date2||(this.date2=new i({el:this.$("[data-stm-role=date2]"),dateFormat:this.options.dateFormat,model:this.model,highlightTrip:!0})),this.time1||(this.time1=new s({el:this.$("[data-stm-role=time1]"),model:this.model})),this.time2||(this.time2=new t({el:this.$("[data-stm-role=time2]"),model:this.model})),this.serviceClass||(this.serviceClass=new r({el:this.$("[data-stm-role=serviceClass]"),model:this.model})),this.searchType||(this.searchType=new q({el:this.$("[data-stm-role=searchType]"),model:this.model})),this.travelers||(this.travelers=new u({el:this.$("[data-stm-role=travelers]"),model:this.model})),this.nonStop||(this.nonStop=new m({el:this.$("[data-stm-role=nonstop]"),model:this.model})),this.provider||(this.provider=new o({el:this.$("[data-stm-role=provider]"),model:this.model})),this.rooms||(this.rooms=new p({el:this.$("[data-stm-role=rooms]"),model:this.model})),this.cruiseLocation||(this.cruiseLocation=new g({el:this.$("[data-stm-role=cruiseLocation]"),model:this.model})),this.cruiseLine||(this.cruiseLine=new f({el:this.$("[data-stm-role=cruiseLine]"),model:this.model})),this.cruiseDate||(this.cruiseDate=new d({el:this.$("[data-stm-role=cruiseDate]"),model:this.model})),this.cruiseLength||(this.cruiseLength=new e({el:this.$("[data-stm-role=cruiseLength]"),model:this.model})),this.over55||(this.over55=new n({el:this.$("[data-stm-role=over55]"),model:this.model})),this},submit:function(){this.validate()&&this.$el.submit()},render:function(){return this.firstRun?this.firstRun=!1:this.validate(),this},validate:function(){if(this.resetError(),!this.options.validate)return!0;var a=this.model.validateByMode(this.mode);return a?(this.renderError(this.model,a),!1):!0},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)}});b.ns("shared.views.searchForm",v)}(window);
//# sourceMappingURL=searchForm.nano.js.map

// ===========================================
// DART Ads
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=b.functional,f=b.shared.logger,g=d.View.extend({initialize:function(){this.iframeContainerEl=this.$(this.options.iframeContainerSelector),this.metaDataEl=this.$(this.options.metaDataSelector),this.bindMethods().loadFromMetaData()},options:function(){return{endpoint:"",height:250,iframeContainerSelector:".ad_frame",iframeSelector:"iframe",metaDataSelector:".meta_data",requestUrl:"",width:300}},render:function(){var a=$j("<iframe />").attr({frameborder:0,height:this.options.height,scrolling:"no",width:this.options.width}),b=this.options.endpoint;return""===b?this.handleAdState(!1):(-1===b.indexOf("?")&&(b+="?"),b+=$j.param({height:this.options.height,request:this.options.request,width:this.options.width,keywords:this.options.keywords,ad_unit_path:this.options.ad_unit_path}),a.on("load",this.onIFrameLoad).attr("src",b).appendTo(this.iframeContainerEl),this)},onIFrameLoad:function(a){var b=$j(a.target);g.showAdIfValid(b,this.handleAdState)},bindMethods:function(){return e.bindMethods(this,["handleAdState","onIFrameLoad"]),this},handleAdState:function(a){var b=!!this.$el.data("isDebug");return a||b?(this.$el.show(),b&&f.logMessage("DART is in debugging mode.")):this.$el.hide(),this},loadFromMetaData:function(){var a=b.parseJSON(this.metaDataEl.html());return _.extend(this.options,a),this.metaDataEl.hide(),this}},{showAdIfValid:function(a){var b=arguments.length<2?function(){}:arguments[1],c=!(!a[0]||!a[0].innerHTML&&!a[0].contentDocument),d=c?a.contents():null;return f.startLoggingGroup("DART Debugging"),c&&d.find(".hide_this_ad").length>0?(f.logMessage("Found hide_this_ad element"),f.endLoggingGroup(),void b(!1)):c&&d.find("img[src$='817-grey.gif']").length>0?(f.logMessage("Found grey image"),f.endLoggingGroup(),void b(!1)):(f.logMessage("Showing ad"),f.endLoggingGroup(),a.show(),void b(!0))}});c.ns("views.dartAd",g)}(window);
//# sourceMappingURL=dartAd.nano.js.map

// ===========================================
// Exit DHTML Ads
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=b.shared.models.ad,e=d.prototype,f=d.extend({initialize:function(a,b){e.initialize.call(this,a,b)},defaults:function(){var a=e.defaults.call(this);return a.autoDisable=!1,a.delayOpening=!1,a.enabled=!0,a.restrictRightBoundary=!1,a},shouldAutoDisable:function(){return this.get("autoDisable")},setAutoDisable:function(a,b){return this.set("autoDisable",a,b)},shouldDelayOpening:function(){return this.get("delayOpening")},setDelayOpening:function(a,b){return this.set("delayOpening",a,b)},isEnabled:function(){return this.get("enabled")},setEnabled:function(a,b){return this.set("enabled",a,b)},shouldRestrictRightBoundary:function(){return this.get("restrictRightBoundary")},setRestrictRightBoundary:function(a,b){return this.set("restrictRightBoundary",a,b)}},{EXIT_DHTML_URL:"/getExitDHTML.html"});c.ns("models.exitDHTML",f)}(window);
//# sourceMappingURL=exitDHTML.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=b.shared,e=b.shared.logger,f=b.strings,g=function(a){b.pageData.queryString&&b.pageData.queryString.enableExitDhtmlConsoleLogging&&e.logMessage("Exit DHTML: "+a)},h=c.View.extend({initialize:function(a){this.eventNamespace="."+f.uniqueId(),this.template=d.getTemplate(this.model.get("template")||this.options.template),this.render()},className:"c-exit-dhtml",options:function(){return{adSelector:"> .ad",closeIconSelector:"> .close-icon",template:"exit-dhtml"}},eventNamespace:null,template:null,hide:function(){return this.$el.hide(),this},render:function(){return this.$el.appendTo("body").html(this.template({imageUrl:this.model.getUniversalLogo()})).hide(),this.attach(),g("Rendered"),this},show:function(){return this.$el.show().css("margin-left",-1*(this.$el.width()/2)),this.trigger(h.ON_AD_SHOWN,this),g("Shown"),this},onAdClick:function(a){this.trigger(h.ON_AD_CLICK,this)},onCloseIconClick:function(a){this.trigger(h.ON_CLOSE_ICON_CLICK,this)},attach:function(){return this.detach(),this.$el.on("click"+this.eventNamespace,this.options.adSelector,this.onAdClick.bind(this)),this.$el.on("click"+this.eventNamespace,this.options.closeIconSelector,this.onCloseIconClick.bind(this)),this},detach:function(){return this.$el.off(this.eventNamespace),this}},{ON_AD_CLICK:f.uniqueId(),ON_AD_SHOWN:f.uniqueId(),ON_CLOSE_ICON_CLICK:f.uniqueId()});d.ns("views.exitDHTML",h)}(window);
//# sourceMappingURL=exitDHTML.nano.js.map
!function(a){"use strict";var b=a.stm,c=a._,d=b.define,e=b.shared,f=b.dependenciesInjection,g=b.shared.models.exitDHTML,h=b.shared.views.exitDHTML,i=b.functional,j=b.shared.linkUtils,k=b.shared.logger,l=b.shared.orderedHash,m=b.shared.views.pageMask,n=b.popup,o=b.strings,p=function(){return b.pageData.exitDHTML},q=function(){return b.tracking.omniture},r=function(a){b.pageData.queryString&&b.pageData.queryString.enableExitDhtmlConsoleLogging&&k.logMessage("Exit DHTML: "+a)},s=d(null,e.getBackboneEvents(),{initialize:function(a){r("Initialized"),this.delayedIds=c.result(this,"delayedIds"),this.eventNamespace="."+o.uniqueId(),this.options=c.extend({},c.result(this,"options"),a),f.injectDependencies(this),i.bindAllMethods(this),this.attach()},delayedIds:function(){return{autoDisable:null,delayOpening:null,show:null,restrictRightBoundary:null}},eventNamespace:null,lastMousePositionX:null,lastMousePositionY:null,model:null,options:function(){return{pageMaskOptions:{}}},pageMaskView:null,shown:!1,view:null,onAdClick:function(a){var b=new n(this.buildAdUrl());b.useOptimalDimensions().tryPop(),q().trackFeaturedSearchClick(this.model.getId()),this.disable(),r("Ad clicked")},onAdShown:function(a){this.pageMaskView.$el.css("z-index",this.view.$el.css("z-index")-1).show(),q().trackExitDHTMLAdImpression(this.model.getId())},onCloseIconClick:function(a){this.disable()},onMouseMove:function(b){a.clearTimeout(this.delayedIds.show),this.lastMousePositionX=b.pageX,this.lastMousePositionY=b.pageY},onMouseOut:function(b){var c=this.lastMousePositionY-e.getWindow().scrollTop(),d=!0,f=c<s.MAX_Y_OFFSET;if(this.model.shouldRestrictRightBoundary()){var g=this.lastMousePositionX,h=e.getWindow().innerWidth();d=g<=h-s.X_BOUNDARY_OFFSET}f&&d&&(b.toElement||b.relatedTarget||(this.delayedIds.show=a.setTimeout(this.show,s.DELAY_FOR_SHOWING)))},onPageMaskHide:function(a){this.disable()},attach:function(){return this.shown?this:(this.detach(),this.model.isEnabled()?(this.model.shouldAutoDisable()&&(this.delayedIds.autoDisable=a.setTimeout(this.disable,s.DELAY_FOR_AUTO_DISABLING)),this.model.shouldDelayOpening()?this.delayedIds.delayOpening=a.setTimeout(this.attachMouseMovements,s.DELAY_FOR_DELAYED_OPENING):this.attachMouseMovements(),this.listenTo(this.pageMaskView,m.EVENT_HIDE,this.onPageMaskHide),this.listenTo(this.view,h.ON_AD_CLICK,this.onAdClick),this.listenTo(this.view,h.ON_AD_SHOWN,this.onAdShown),this.listenTo(this.view,h.ON_CLOSE_ICON_CLICK,this.onCloseIconClick),this):this)},attachMouseMovements:function(){var a=e.getDocument();return a.on("mousemove"+this.eventNamespace,this.onMouseMove),a.on("mouseout"+this.eventNamespace,this.onMouseOut),r("Attaching mouse movements tracking"),this},buildAdUrl:function(){var a=j.getFinalizedUrl(this.model.getUrl(),{trackingHash:this.model.getTrackingHash()});return a},disable:function(){return this.detach(),this.model.setEnabled(!1),this.pageMaskView.hide(),this.view.hide(),this.shown=!0,c.each(this.delayedIds,function(b){a.clearTimeout(b)}),r("Disabled"),this},detach:function(){return this.stopListening(),this.detachMouseMovements(),this},detachMouseMovements:function(){return e.getDocument().off(this.eventNamespace),this},getDependencies:function(){var a=new l;return a.append("model",function(){return new g(p()||{enabled:!1})}),a.append("pageMaskView",function(){return new m(this.options.pageMaskOptions)}),a.append("view",function(){return new h({model:this.model})}),a},show:function(b){return a.clearTimeout(this.delayedIds.show),this.model.isEnabled()?(this.view.show(),this.detachMouseMovements(),this.shown=!0,b||a.focus(),this):this},reloadAd:function(a){a.exitDHTML&&!this.shown&&(r("Setting ad info: "+a.exitDHTML.enabled),this.model.set(a.exitDHTML),this.model.loadOldBBAd(),this.view.render(),this.attach())},STATIC:{DELAY_FOR_AUTO_DISABLING:6e5,DELAY_FOR_DELAYED_OPENING:5e3,DELAY_FOR_SHOWING:300,X_BOUNDARY_OFFSET:15,MAX_Y_OFFSET:50}});e.ns("controllers.exitDHTML",s)}(window);
//# sourceMappingURL=exitDHTML.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=b.define,e=b.shared.controllers.exitDHTML,f=e.prototype,g=b.shared.linkUtils,h=d(e,{initialize:function(a,b){this.propertyId=a,f.initialize.call(this,b)},propertyId:0,buildAdUrl:function(){var a={trackingHash:this.model.getTrackingHash()};return this.propertyId>0&&(a.metaPropertyId="p"+this.propertyId),g.getFinalizedUrl(this.model.getUrl(),a)},STATIC:{}});c.ns("controllers.exitDHTML.meta",h)}(window);
//# sourceMappingURL=meta.nano.js.map

// ===========================================
// Meta Vendors
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=d.Model.extend({initialize:function(){},defaults:function(){return{id:"",currency:"$",dataState:e.STATE_UNKNOWN,displayName:"",featured:!1,logoUrl:"",pricePerNight:0,taAuthor:"",taxFeesPerNight:0,totalPrice:0,url:"",homePageUrl:"",fauxTabs:"",order:0,visibility:!0,lowestPrice:!1}},getId:function(){return this.get("id")},getBucketId:function(){var a=(this.getId()||"").match(/^b(\d+)/);return a?a[1]:void 0},setId:function(a,b){return this.set("id",a,b)},getCurrency:function(){return this.get("currency")},setCurrency:function(a,b){return this.set("currency",a,b)},getDataState:function(){return this.get("dataState")},setDataState:function(a,b){return this.set("dataState",a,b)},getDisplayName:function(){return this.get("displayName")},setDisplayName:function(a,b){return this.set("displayName",a,b)},isFeatured:function(){return this.get("featured")},setFeatured:function(a,b){return this.set("featured",a,b)},getLogoUrl:function(){return this.get("logoUrl")},setLogoUrl:function(a,b){return this.set("logoUrl",a,b)},getPricePerNight:function(){return this.get("pricePerNight")},setPricePerNight:function(a,b){return this.set("pricePerNight",a,b)},getTAAuthor:function(){return this.get("taAuthor")},setTAAuthor:function(a,b){return this.set("taAuthor",a,b)},getTaxFeesPerNight:function(){return this.get("taxFeesPerNight")},setTaxFeesPerNight:function(a,b){return this.set("taxFeesPerNight",a,b)},getTotalPrice:function(){return this.get("totalPrice")},setTotalPrice:function(a,b){return this.set("totalPrice",a,b)},getUrl:function(){return this.get("url")},setUrl:function(a,b){return this.set("url",a,b)},getHomePageUrl:function(){return this.get("homePageUrl")},setHomePageUrl:function(a,b){return this.set("homePageUrl",a,b)},getFauxTabs:function(){return this.get("fauxTabs")},setFauxTabs:function(a,b){return this.set("fauxTabs",a,b)},getOrder:function(){return this.get("order")},setOrder:function(a,b){return this.set("order",a,b)},getVisibility:function(){return this.get("visibility")},setVisibility:function(a,b){return this.set("visibility",a,b)},isLowestPrice:function(){return this.get("lowestPrice")},setLowestPrice:function(a,b){return this.set("lowestPrice",a,b)},mapToTabBrowsingAdModelAttributes:function(){return{id:this.getId(),name:this.getDisplayName(),currency:this.getCurrency(),price:this.getPricePerNight(),url:this.getUrl(),logo:this.getLogoUrl(),homePageUrl:this.getHomePageUrl(),fauxTabs:this.getFauxTabs(),position:this.getOrder(),selected:!1}}},{STATE_AVAILABLE:"available",STATE_PENDING:"pending",STATE_UNAVAILABLE:"unavailable",STATE_UNKNOWN:"unknown"});c.ns("models.metaVendor",e)}(window);
//# sourceMappingURL=metaVendor.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a._,f=c.models.metaVendor,g=d.Collection.extend({initialize:function(){this.attach()},comparator:"order",model:f,onOrderChange:function(a,b){var c=this.where({order:b}),d=1;e.each(c,function(c){c.getId()!==a.getId()&&c.setOrder(b+d++)})},attach:function(){return this.listenTo(this,"change:order",this.onOrderChange),this}},{});c.ns("collections.metaVendors",g)}(window);
//# sourceMappingURL=metaVendors.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=c.collections.metaVendors,f=d.Model.extend({initialize:function(){this.vendors=new this.vendorsCollectionClass},defaults:function(){return{id:0,availability:!1,dataLoaded:!1}},vendors:null,vendorsCollectionClass:e,getId:function(){return this.get("id")},setId:function(a,b){return this.set("id",a,b)},hasAvailability:function(){return this.get("availability")},setAvailability:function(a,b){return this.set("availability",a,b)},isDataLoaded:function(){return this.get("dataLoaded")},setDataLoaded:function(a,b){return this.set("dataLoaded",a,b)},getVendorsWithPrice:function(){return this.vendors.filter(function(a){return!!a.getPricePerNight()})},hasVendorsWithPrice:function(){return!!this.getVendorsWithPrice().length},getVendorCount:function(){return this.vendors.length}},{});c.ns("models.metaHotel",f)}(window);
//# sourceMappingURL=metaHotel.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=c.models.metaHotel,f=d.Collection.extend({model:e},{});c.ns("collections.metaHotels",f)}(window);
//# sourceMappingURL=metaHotels.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=c.collections.metaHotels,f=d.Model.extend({initialize:function(){this.hotels=new this.hotelsCollectionClass},defaults:function(){return{id:0}},hotels:null,hotelsCollectionClass:e,getId:function(){return this.get("id")},setId:function(a,b){return this.set("id",a,b)}},{});c.ns("models.metaCity",f)}(window);
//# sourceMappingURL=metaCity.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a._,f=b.define,g=b.mixins.observable,h=c.collections.metaHotels,i=c.models.metaVendor,j=c.soleChain,k=function(){return b.pageData.queryString?b.pageData.queryString.icak:null},l=function(){return b.pageData.queryString?b.pageData.queryString.icup:null},m=f(null,g,{constructor:function(a,b){this.mcid=a,this.options=e.extend({},e.result(this,"options"),b),this.fetchChain=new j,this.url=this.options.url,this.options.city?(this.city=this.options.city,this.hotels=this.city.hotels):this.hotels=this.options.hotels,delete this.options.city,delete this.options.hotels,delete this.options.url},adults:null,checkinDate:null,checkoutDate:null,city:null,extraQueryData:{},fetchChain:null,hotels:null,mcid:null,options:function(){return{maxRetries:6,requestDelay:1e3,city:null,hotels:new h,url:"/metapartnerlist"}},queryKey:null,requestCounter:null,searchType:null,url:null,getExtraQueryData:function(){return this.extraQueryData},setExtraQueryData:function(a){return this.extraQueryData=a,this},addExtraQueryData:function(a,b){return this.extraQueryData[a]=b,this},cleanupRequest:function(a){return this.hotels.each(function(a){var b=!1;a.vendors.each(function(a){switch(a.getDataState()){case i.STATE_AVAILABLE:b=!0;break;case i.STATE_PENDING:a.setDataState(i.STATE_UNKNOWN);case i.STATE_UNKNOWN:b=!0}}),a.setDataLoaded(!0),a.setAvailability(b),a.vendors.sort()}),this.publish(m.EVENT_LOADED,this),a.runNext(),this},fetch:function(){return this.fetchChain.restart(),this.fetchChain.chain.append("prepare-for-request",e.bind(this.prepareForRequest,this,this.fetchChain.chain)),this.fetchChain.chain.append("make-request",e.bind(this.makeRequest,this,this.fetchChain.chain)),this.fetchChain.chain.append("cleanup-request",e.bind(this.cleanupRequest,this,this.fetchChain.chain)),this.fetchChain.chain.run(),this},fetchUsingCity:function(){return this.searchType=m.SEARCH_TYPE_CITY,this.fetch()},fetchUsingHotels:function(){return this.searchType=m.SEARCH_TYPE_HOTELS,this.fetch()},handleServerResponse:function(a,b){var c=this,d=!0;return b=this.preprocessResponse(b),b&&!b.errorCode&&b.hotels?(b.queryKey&&(this.queryKey=b.queryKey),e.each(b.hotels,function(a,f){var g;c.hotels.add({id:f}),g=c.hotels.get(f),g.set({availability:a.availability,dataLoaded:a.dataLoaded}),e.each(a.vendors,function(a){a.currency=b.currencySymbol}),g.vendors.set(a.vendors,{add:!0,merge:!0,remove:!0}),d=d&&a.dataLoaded}),("mm/dd/yy"===this.checkinDate||"mm/dd/yy"===this.checkoutDate)&&(d=!0),d?(a.runNext(),c):(c.publish(m.EVENT_DATA_RETRIEVED,c,b),e.delay(c.makeRequest.bind(c,a),c.options.requestDelay),c)):(this.publish(m.EVENT_ERROR,c,b),c)},makeRequest:function(a){var b,c,f,g=[];return++this.requestCounter>this.options.maxRetries?(a.runNext(),this):(this.queryKey?b={qkey:this.queryKey,mcid:this.mcid}:(b=e.extend({},this.extraQueryData,{date1:this.checkinDate,date2:this.checkoutDate,mcid:this.mcid,travelers:this.adults}),this.searchType===m.SEARCH_TYPE_CITY?b.tid=this.city.getId():(g=this.hotels.filter(function(a){return!a.isDataLoaded()}),b.hotels=e.map(g,function(a){return a.getId()}).join(","))),f=l(),c=k(),f&&(b.icup=f),c&&(b.icak=c),d.ajax({url:this.url,data:b}).always(e.bind(this.handleServerResponse,this,a)),this)},prepareForRequest:function(a){return this.queryKey=null,this.requestCounter=0,this.publish(m.EVENT_READY,this),a.runNext(),this},preprocessResponse:function(a){return a},STATIC:{DEFAULT_MAX_RETRIES:6,DEFAULT_REQUEST_DELAY:1e3,EVENT_DATA_RETRIEVED:"stm-shared-metaClient:dataRetrieved",EVENT_ERROR:"stm-shared-metaClient:error",EVENT_LOADED:"stm-shared-metaClient:loaded",EVENT_READY:"stm-shared-metaClient:ready",SEARCH_TYPE_CITY:"city",SEARCH_TYPE_HOTELS:"hotels"}});c.ns("metaClient",m)}(window);
//# sourceMappingURL=metaClient.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=a._,e=b.shared,f=b.browser,g=b.Popup,h=function(){return b.pageData.metaTabBrowsingDisabled},i=function(){return b.pageData.metaTabBrowsingDomain},j=function(){return b.pageData.metaTabBrowsingExtraArgs},k={metaVendorSpecificWindowDimensions:{"Booking.com":{left:50,top:50,height:700,width:950}},openTabBrowsingWindow:function(a,b,c,d,e,f){var h,i;return h=this.tabBrowsingUrl(a,b,c,d,e,f),i=new g(h,{name:"stmMetaTabBrowsing",otherFeatures:{location:1,toolbar:1}}),i.useOptimalDimensions().tryPop(),i.popupWindow&&i.popupWindow.focus(),k},tabBrowsingUrl:function(a,b,e,f,g,h){var k,l;return k={hotelId:a,date1:b,date2:e,travelers:f},g&&(k.selectedVendorId=g),h&&(k.mcid=h),j()&&d.extend(k,j()),l=i()?i():"",l+"/tab-browsing/check-rates.html?"+c.param(k)},openVendorInNewWindow:function(a,e,f){var h,i,j=d.extend({},e,{name:"STMMetaVendor"+a.getId(),otherFeatures:{resizable:1,scrollbars:1}});return(b.Browser.ie||b.Browser.firefox)&&(j.otherFeatures.location=1,j.otherFeatures.toolbar=1,j.otherFeatures.menubar=1),d.isUndefined(j.additionalUrlParams)||(i=a.getUrl()+"&"+c.param(j.additionalUrlParams),delete j.additionalUrlParams),h=new g(i,j),f||h.useOptimalDimensions(),h.tryPop(),k},isTabBrowsingSupported:function(a){var b=f.name.toLowerCase();if(h())return!1;if("safari"===b)return!1;if(a&&a.length>0){if("always"===a)return!1;if("ie"===b&&a.indexOf("ie")>-1)return!1}return!0},isMobileMetaTabsRedirectSupported:function(){return f.isIPhone||f.isAndroidPhone},isCookieDropperRequired:function(){return this.isCookieDropperExcludedDomain(a.location.host)?!1:f.ie},isCookieDropperExcludedDomain:function(a){var b=["onetime.com"];if(!a||a.length<5)return!1;for(var c=a.toLowerCase(),d=0;d<b.length;d++)if(c.indexOf(b[d])>0)return!0;return!1},getMetaVendorWindowDimensions:function(a){return this.metaVendorSpecificWindowDimensions[a]||null}};e.ns("metaUtils",k)}(this);
//# sourceMappingURL=metaUtils.nano.js.map

// ===========================================
// Meta Popunder
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a._,f=b.define,g=b.cookies,h=b.dates,i=b.functional,j=b.dependenciesInjection,k=b.Popup,l=f({initialize:function(a,b){this.element=a,this.options=e.extend({},e.result(this,"options"),b),g.get(this.options.cookieName)||(j.injectDependencies(this),this.bindMethods().attach())},options:function(){return{cookieName:"stmMetaPopunderShown",cookieOptions:{offset:24,type:"hours"},ignoredElementSelector:"",url:"/tabsearches.php?"}},popunder:null,onClick:function(a){var b=d(a.target),c=b.is(this.options.ignoredElementsSelector),e=b.parents(this.options.ignoredElementsSelector);c||e.length||this.showPopunder()},onDatepickerClose:function(a,b){b&&this.showPopunder()},attach:function(){return this.element.on("click."+l.EVENT_NAMESPACE,this.onClick),d.subscribe("datepicker:beforeClose",this.onDatepickerClose),this},bindMethods:function(){return i.bindMethods(this,["onClick","onDatepickerClose"]),this},getDependencies:function(){return{popunder:function(){var a=new k(null,{allowRepeat:!0,name:"stmMetaPopunderSearchWindow",popunder:!0});return a.useOptimalDimensions(),a}}},getUrl:function(){var a,c,e=this.options.url,f=b.searchData.getTravelers(),g=b.searchData.getRooms(),i=b.searchData.getDate1(),j=b.searchData.getDate2(),k=b.searchData.getLocation2City();return k?(a={search_mode:"hotel",arrival_city:k.name,num_travelers:f,num_rooms:g,ctm:"A2"},i&&j||(c=b.searchData.defaults(),i=c.date1,j=c.date2),a.arrival_date=h.formatDate(d.datepicker._defaults.dateFormat,i),a.departure_date=h.formatDate(d.datepicker._defaults.dateFormat,j),e+d.param(a)):null},showPopunder:function(){var a=this.popunder.url;return this.popunder.popupWindow&&this.popunder.popupWindow.closed?this:(this.popunder.url=this.getUrl(),a===this.popunder.url?this:(this.popunder.popupWindow?this.popunder.popupWindow.location=this.popunder.url:this.popunder.tryPop(),this.popunder.hasPopped&&g.set(this.options.cookieName,1,this.options.cookieOptions),this))},STATIC:{EVENT_NAMESPACE:"stm-shared-controllers-metaPopunder"}});c.ns("controllers.metaPopunder",l)}(window);
//# sourceMappingURL=metaPopunder.nano.js.map

// ===========================================
// Meta Widgets
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a.jQuery,f=a._,g=b.domState,h=c.models.metaVendor,i=d.View.extend({initialize:function(){var a=this.$(this.options.templateSelector);this.template=a.length?f.template(a.html()):function(){}},options:function(){return{templateSelector:"[data-template-name='metawidget-basic-vendor']"}},template:null,render:function(a,b){var c=this;return c.$el.html(""),a?(f.each(a,function(a){var d,f=e("<div />");f.append(c.template(a.attributes)),d=f.children(),b?g.add(d,b):a.getDataState()===h.STATE_AVAILABLE?g.add(d,i.STATE_AVAILABLE):a.getDataState()===h.STATE_PENDING?g.add(d,i.STATE_PENDING):a.getDataState()===h.STATE_UNAVAILABLE?g.add(d,i.STATE_UNAVAILABLE):g.add(d,i.STATE_UNKNOWN),d.data("metaVendor",a),c.$el.append(d)}),this):c}},{STATE_AVAILABLE:"hasPrice",STATE_PENDING:"searching",STATE_UNAVAILABLE:"noAvailability",STATE_UNKNOWN:"hasAvailability"});c.ns("views.metaWidget.basicVendors",i)}(window);
//# sourceMappingURL=basicVendors.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a.jQuery,f=a._,g=b.domState,h=d.View.extend({initialize:function(){var a=this.$(this.options.templateSelector);this.template=a&&a.length?f.template(a.html()):function(){}},options:function(){return{templateSelector:"[data-template-name='metawidget-chevron-vendor']"}},template:null,render:function(a){var b=this;return b.$el.html(""),a?(f.each(a,function(a){var c,d=e("<div />");d.append(b.template(a.attributes)),c=d.children(),a.getLogoUrl()&&g.add(c,h.STATE_HAS_LOGO),a.isFeatured()&&g.add(c,h.STATE_IS_FEATURED),a.isLowestPrice()&&g.add(c,h.STATE_IS_LOWEST),c.data("metaVendor",a),b.$el.append(c)}),this):b}},{STATE_HAS_LOGO:"hasLogo",STATE_IS_FEATURED:"isFeatured",STATE_IS_LOWEST:"lowestPrice"});c.ns("views.metaWidget.chevronVendors",h)}(window);
//# sourceMappingURL=chevronVendors.nano.js.map
!function(a){"use strict";var b,c,d=a.stm,e=a.jQuery,f=a._,g=d.define,h=d.shared,i=d.dependenciesInjection,j=d.functional,k=d.shared.controllers.metaPopunder,l=d.Popup;e(function(){b=d.shared.views.metaWidget.container,c=d.shared.controllers.leaveBehindPopunder});var m=g({initialize:function(a,b){this.element=a,this.options=f.extend({},f.result(this,"options"),b),this.enabled=!0,i.injectDependencies(this),this.bindMethods().attach()},options:function(){return{placeholderUrl:"/c/popunder/prepop.html",cookieUrlDisplayDurationInSeconds:5}},cookieDropperPopunder:null,enabled:null,isVendorClick:!1,hasLeaveBehindPopped:!1,hasFirstClickHappened:!1,hasCookieDropperPopped:!1,onClick:function(){return this.isVendorClick?void(this.isVendorClick=!1):(this.openCookieDropperPopunder(),void(this.hasFirstClickHappened=!0))},onVendorClicked:function(a,b){this.isVendorClick=!0,this.hasCookieDropperPopunderPopped()&&this.loadCookieDropperUrl(b.getHomePageUrl())},onDatepickerClose:function(a,b){b&&(d.searchData.getDate1()&&d.searchData.getDate2()&&!this.hasFirstClickHappened&&(this.hasFirstClickHappened=!0),this.hasFirstClickHappened&&!this.hasCookieDropperPopped&&(this.openCookieDropperPopunder(),this.hasCookieDropperPopped=!0))},onLeaveBehindPopped:function(a){this.hasLeaveBehindPopped=!0},attach:function(){var d=this;return d.element.on("click."+k.EVENT_NAMESPACE,this.onClick),e.subscribe(b.EVENT_VENDOR_CLICKED,this.onVendorClicked),e.subscribe(c.EVENT_LEAVE_BEHIND_POPPED,this.onLeaveBehindPopped),e.subscribe("datepicker:beforeClose",this.onDatepickerClose),e(a).on("unload",function(){d.hasCookieDropperPopunderPopped()&&d.cookieDropperPopunder.popupWindow.close()}),this},bindMethods:function(){return j.bindMethods(this,["onClick","onVendorClicked","onDatepickerClose","onLeaveBehindPopped","hasCookieDropperPopunderPopped","isPopupAllowed","openCookieDropperPopunder"]),this},isPopupAllowed:function(){return this.enabled&&this.hasFirstClickHappened&&this.hasLeaveBehindPopped&&!this.hasCookieDropperPopunderPopped()},getDependencies:function(){return{cookieDropperPopunder:function(){var a=new l(this.options.placeholderUrl,{name:"stmMetaCookieDropperPopunder",allowRepeat:!0,popunder:!0});return a}}},hasCookieDropperPopunderPopped:function(){return this.cookieDropperPopunder.hasPopped&&this.cookieDropperPopunder.popupWindow&&!this.cookieDropperPopunder.popupWindow.closed&&this.cookieDropperPopunder.popupWindow.location},openCookieDropperPopunder:function(){return this.isPopupAllowed()&&(this.cookieDropperPopunder.tryPop(),this.cookieDropperPopunder.hasPopped&&e.publish(m.EVENT_COOKIE_DROPPER_POPPED,[this.cookieDropperPopunder])),this},loadCookieDropperUrl:function(b){var c=this;return c.hasCookieDropperPopunderPopped()&&null!==b&&b.length>9?(c.cookieDropperPopunder.popupWindow.location=b,c.options.placeholderUrl!==b&&a.setTimeout(function(){c.loadCookieDropperUrl(c.options.placeholderUrl)},1e3*c.options.cookieUrlDisplayDurationInSeconds),!0):!1},STATIC:{EVENT_COOKIE_DROPPER_POPPED:"stm-shared-controllers-metaCookieDropper:cookieDropperPopped"}});h.ns("controllers.metaCookieDropper",m)}(this);
//# sourceMappingURL=metaCookieDropper.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a.jQuery,f=a._,g=b.domState,h=b.functional,i=b.dependenciesInjection,j=c.metaUtils,k=c.views.metaWidget.basicVendors,l=c.views.metaWidget.chevronVendors,m=c.views.searchInput.date1,n=c.views.searchInput.date2,o=c.views.searchInput.travelers,p=function(){return b.shared.controllers.metaCookieDropper},q=c.models.metaVendor,r=b.dates,s=d.View.extend({constructor:function(a,b){b=f.extend({},b,{model:a}),d.View.call(this,b)},initialize:function(){i.injectDependencies(this),this.bindMethods().attach(),this.finePrintContainer=this.$(this.options.finePrintSelector),this.ctaNoAvailabilityTemplate=c.getTemplate(this.options.ctaNoAvailabilityTemplateName),this.ctaAvailabilityTemplate=c.getTemplate(this.options.ctaAvailabilityTemplateName)},model:null,options:function(){return{adultsSelector:"[name=adults]",checkinDateSelector:"[name=inDate]",checkoutDateSelector:"[name=outDate]",basicVendorsSelector:".basicVendors",chevronVendorsSelector:".chevronVendors",chevronVendorsToShowForLarge:1,chevronVendorsToShowForRegular:1,individualVendorSelector:".basicVendorContainer, .chevronVendorContainer",finePrintSelector:".fineprint",showDatepickerOnNoDates:!1,basicVendorsToShowForLarge:100,basicVendorsToShowForRegular:100,ctaNoAvailabilityTemplateName:"metawidget-ctaInstructions-noAvailability",ctaAvailabilityTemplateName:"metawidget-ctaInstructions-availability"}},adultsView:null,basicVendorsView:null,checkinDateView:null,checkoutDateView:null,chevronVendorsView:null,finePrintContainer:null,hasCookieDropperPopped:!1,ctaNoAvailabilityTemplate:null,ctaAvailabilityTemplate:null,onCheckinDatepickerClose:function(){b.searchData.setDate2(null),this.checkoutDateView.$el.datepicker("show"),this.checkinDateView.$el.off(".containerView"),this.checkoutDateView.$el.off(".containerView")},onCheckoutDatepickerClose:function(){!b.searchData.getDate1()&&b.searchData.getDate2()&&this.checkinDateView.$el.datepicker("show"),this.checkinDateView.$el.off(".containerView"),this.checkoutDateView.$el.off(".containerView")},onDateChange:function(a){this.checkinDateView.$el.off(".containerView"),this.checkoutDateView.$el.off(".containerView"),this.checkinDateView.$el.on("datepicker:afterClose.containerView",this.onCheckinDatepickerClose),this.checkoutDateView.$el.on("datepicker:afterClose.containerView",this.onCheckoutDatepickerClose)},onVendorClick:function(a){var c=e(a.currentTarget),d=c.data("metaVendor");return b.searchData.getDate1()?b.searchData.getDate2()?void this.doVendorClick(d):void this.checkoutDateView.$el.datepicker("show"):void this.checkinDateView.$el.datepicker("show")},onMouseEnter:function(){var a=this.finePrintContainer.data("finePrint");a&&this.finePrintContainer.html(a)},onMouseLeave:function(){this.finePrintContainer.html(" ")},onCookieDropperPopped:function(){this.hasCookieDropperPopped=!0},attach:function(){return this.$el.on("click",this.options.individualVendorSelector,this.onVendorClick),this.$el.on("mouseenter",this.onMouseEnter),this.$el.on("mouseleave",this.onMouseLeave),this.checkinDateView.$el.on("change",this.onDateChange),this.checkoutDateView.$el.on("change",this.onDateChange),e.subscribe(p().EVENT_COOKIE_DROPPER_POPPED,this.onCookieDropperPopped),this},bindMethods:function(){return h.bindMethods(this,["onCheckinDatepickerClose","onCheckoutDatepickerClose","onDateChange","onVendorClick","onMouseEnter","onMouseLeave","onCookieDropperPopped","doVendorClick"]),this},getDependencies:function(){return{adultsView:function(){return new o({model:b.searchData,el:this.$el.find(this.options.adultsSelector)})},checkinDateView:function(){return new m({model:b.searchData,el:this.$el.find(this.options.checkinDateSelector)})},checkoutDateView:function(){return new n({model:b.searchData,el:this.$el.find(this.options.checkoutDateSelector)})},basicVendorsView:function(){return new k({el:this.$el.find(this.options.basicVendorsSelector)})},chevronVendorsView:function(){return new l({el:this.$el.find(this.options.chevronVendorsSelector)})}}},render:function(a){var c=this,d=c.model.vendors&&c.model.vendors.length,h=c.options.showDatepickerOnNoDates,i="[data-hotel-id="+c.model.id+"]>.instructions";return g.clear(c.$el),a===s.STATE_INITIAL?(g.add(c.$el,s.STATE_INITIAL),this):b.searchData.getDate1()&&b.searchData.getDate2()?d&&c.model.hasAvailability()?c.renderVendors():(g.add(c.$el,k.STATE_UNAVAILABLE),this.chevronVendorsView.render(),this.basicVendorsView.render(),e(i).html(c.ctaNoAvailabilityTemplate()),c):(g.add(c.$el,s.STATE_NEED_DATES),h&&c.$el.is(":visible")&&f.delay(function(){e(".s-needDates:eq(0)  .hasDatepicker:eq(0)").focus()},500),c.renderVendors(!0,k.STATE_UNKNOWN))},renderVendors:function(a,b){var c,d=this,f=[],g=[],h=d.$el.hasClass("large")?d.options.chevronVendorsToShowForLarge:d.options.chevronVendorsToShowForRegular,i=d.$el.hasClass("large")?d.options.basicVendorsToShowForLarge:d.options.basicVendorsToShowForRegular,j=0,k="[data-hotel-id="+d.model.id+"]>.instructions",l=!1,m=null;return d.model.vendors.length?(d.model.vendors.each(function(b){var c,d=!!b.getPricePerNight(),e=g.length<h,k=f.length<i;!a&&d&&e?g.push(b):k?f.push(b):b.setVisibility(!1),d&&(c=b.getPricePerNight()<j,(c||!j)&&(j=b.getPricePerNight(),m=b))}),c=g.indexOf(m)>-1,m&&c&&m.setLowestPrice(!0),this.chevronVendorsView.render(g),this.basicVendorsView.render(f,b),g.forEach(function(a){a.isFeatured()===!0&&a.getDataState()===q.STATE_AVAILABLE&&(l=!0)}),l===!0?e(k).html(d.ctaAvailabilityTemplate()):e(k).html(d.ctaNoAvailabilityTemplate()),this):(e(k).html(d.ctaNoAvailabilityTemplate()),this)},doVendorClick:function(a){this.showVendor(a),this.trigger(s.EVENT_VENDOR_CLICKED,this,a),e.publish(s.EVENT_VENDOR_CLICKED,[this,a])},showVendor:function(a){var c,d=a.getDisplayName();if(j.isTabBrowsingSupported(a.getFauxTabs()))this.openMetaTabBrowsingWindow(a);else{var e=j.getMetaVendorWindowDimensions(d),g={additionalUrlParams:[{name:"originatingPage",value:b.tracking.omniture.getPageName()}]};c=f.extend({},e,g),j.openVendorInNewWindow(a,c,!!e)}return this},openMetaTabBrowsingWindow:function(a){return j.openTabBrowsingWindow(this.model.getId(),r.formatDate("yy-mm-dd",b.searchData.getDate1()),r.formatDate("yy-mm-dd",b.searchData.getDate2()),this.adultsView.$el.val(),a.getId(),b.pageData.metaMCID),this}},{EVENT_VENDOR_CLICKED:"stm-shared-views-metaWidget-container:vendorClicked",STATE_NEED_DATES:"needDates",STATE_INITIAL:"initial"});c.ns("views.metaWidget.container",s)}(window);
//# sourceMappingURL=container.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a._,f=b.define,g=b.shared.views.metaWidget.container,h=b.dates,i=b.dependenciesInjection,j=b.functional,k=b.shared.metaClient,l=b.shared.controllers.metaCookieDropper,m=b.shared.metricsUtils,n=b.mixins.observable,o=b.shared.soleChain,p=b.strings,q=b.tracking.omniture,r=f(null,n,{initialize:function(a,c){this.element=a,this.options=e.extend({},e.result(this,"options"),c),i.injectDependencies(this),this.bindMethods().attach(),(this.options.trackMetrics&&!b.searchData.getDate1()||!b.searchData.getDate2())&&this.metricsUtils.startTiming(r.METRIC_INITIAL_META_REQUEST),this.options.updateOnConstruction&&this.update()},client:null,element:null,hasCookieDropperPopped:!1,metricsUtils:null,widgetsReady:!1,widgetsReadyTimer:null,options:function(){return{createContainer:function(a,b){return new g(b,{el:a,showDatepickerOnNoDates:!!a.data("showDatepickerOnNoDates")})},metaWidgetSelector:".mvcView.metaWidget",updateOnConstruction:!0,trackMetrics:!1}},updateRunner:null,update:function(){return this.options.trackMetrics&&b.searchData.getDate1()&&b.searchData.getDate2()&&this.metricsUtils.startTiming(r.METRIC_FIRST_HOTEL_LOADED),this.updateRunner.restart(),this.updateRunner.chain.append("prepare for search",e.partial(this.prepareForSearchChainItem,this.updateRunner.chain)),this.updateRunner.chain.append("fetch vendors",e.partial(this.fetchVendorsChainItem,this.updateRunner.chain)),this.updateRunner.chain.append("track meta search",e.partial(this.trackMetaSearchChainItem,this.updateRunner.chain)),this.updateRunner.chain.append("wrapup",e.bind(this.wrapupChainItem,this,this.updateRunner.chain)),this.updateRunner.run(),this},onAdultsChange:function(){b.searchData.getDate1()&&b.searchData.getDate2()&&this.update()},onDatepickerClose:function(){b.searchData.getDate1()&&b.searchData.getDate2()&&(d.publish("datesChanged"),this.update())},onCookieDropperPopped:function(){this.hasCookieDropperPopped=!0},attach:function(){return d.subscribe("datepicker:afterClose",e.debounce(this.onDatepickerClose,500)),b.searchData.on("change:travelers",this.onAdultsChange),d.subscribe(l.EVENT_COOKIE_DROPPER_POPPED,this.onCookieDropperPopped),this},bindMethods:function(){return j.bindMethods(this,["onAdultsChange","onDatepickerClose","onCookieDropperPopped","fetchVendorsChainItem","prepareForSearchChainItem","trackMetaSearchChainItem"]),this},getDependencies:function(){return{client:function(){var a={requestDelay:b.pageData.metaRequestInterval};return new k(b.pageData.metaMCID,a)},updateRunner:function(){return new o},metricsUtils:function(){return new m}}},fetchVendorsChainItem:function(a){var c,f,g,i=this,j=i.element.find(i.options.metaWidgetSelector),l=b.searchData.getDate1(),m=b.searchData.getDate2();return c=function(){return i.widgetsReady?(i.options.trackMetrics&&i.metricsUtils.stopTiming(r.METRIC_INITIAL_META_REQUEST),void j.each(function(a){var c=d(this),e=c.data(r.DATA_KEY_CONTAINER_VIEW);e&&(e.render(),i.options.trackMetrics&&0===a&&b.searchData.getDate1()&&b.searchData.getDate2()&&(i.metricsUtils.stopTiming(r.METRIC_FIRST_HOTEL_LOADED),i.metricsUtils.startTiming(r.METRIC_LAST_HOTEL_LOADED)))})):(null!==i.widgetsReadyTimer&&clearTimeout(i.widgetsReadyTimer),void(i.widgetsReadyTimer=e.delay(c,100)))},f=function(){c(),i.options.trackMetrics&&i.metricsUtils.stopTiming(r.METRIC_LAST_HOTEL_LOADED),a.runNext()},g=function(){i.options.trackMetrics&&i.metricsUtils.clearTiming(r.METRIC_FIRST_HOTEL_LOADED),j.each(function(){var a=d(this),b=a.data(r.DATA_KEY_CONTAINER_VIEW);b&&(b.model.vendors.reset(),b.render())})},i.client.unsubscribe(k.EVENT_DATA_RETRIEVED),i.client.unsubscribe(k.EVENT_ERROR),i.client.unsubscribe(k.EVENT_LOADED),null!==i.widgetsReadyTimer&&clearTimeout(i.widgetsReadyTimer),i.client.subscribe(k.EVENT_DATA_RETRIEVED,c),i.client.subscribe(k.EVENT_ERROR,g),i.client.subscribe(k.EVENT_LOADED,f),i.client.checkinDate=l?h.formatDate("mm/dd/yy",l):"mm/dd/yy",i.client.checkoutDate=m?h.formatDate("mm/dd/yy",m):"mm/dd/yy",i.client.adults=b.searchData.getTravelers(),i.client.fetchUsingHotels(),i.initializeMetaWidgetViews(),i},initializeMetaWidgetViews:function(){var a=this,b=a.element.find(a.options.metaWidgetSelector);return b.length?(b.each(function(){var b,c=d(this),e=c.data(r.DATA_KEY_HOTEL_ID);return c.data(r.DATA_KEY_CONTAINER_VIEW)?!0:(b=a.options.createContainer.call(this,c,a.client.hotels.get(e)),b.hasCookieDropperPopped=a.hasCookieDropperPopped,c.data(r.DATA_KEY_CONTAINER_VIEW,b),b.render(g.STATE_INITIAL),!0)}),this.widgetsReady=!0,this):this},prepareForSearchChainItem:function(a){var b=this,c=b.element.find(b.options.metaWidgetSelector);return c.length?(c.each(function(){var a=d(this),c=a.data(r.DATA_KEY_HOTEL_ID);b.client.hotels.add({id:c}),b.client.hotels.get(c).setDataLoaded(!1)}),a.runNext(),this):this},trackMetaSearchChainItem:function(a){var c=b.searchData.getDate1(),d=b.searchData.getDate2();return e.isDate(c)&&e.isDate(d)&&q.trackTAMetaSearchVisit(),a.runNext(),this},wrapupChainItem:function(a){return this.publish(this.constructor.ON_UPDATE_COMPLETE,this),d.publish("metaWidget:updateCompleted"),a.runNext(),this},STATIC:{DATA_KEY_CONTAINER_VIEW:"stm-shared-controllers-metaWidget:data-key-container-view",DATA_KEY_HOTEL_ID:"hotelId",METRIC_FIRST_HOTEL_LOADED:"meta.firstHotelLoadedAfterDates",METRIC_INITIAL_META_REQUEST:"meta.pageLoadToInitialMetaRequestComplete",METRIC_LAST_HOTEL_LOADED:"meta.lastHotelLoadedAfterDates",ON_UPDATE_COMPLETE:p.uniqueId()}});c.ns("controllers.metaWidget",r)}(window);
//# sourceMappingURL=metaWidget.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a._,f=b.define,g=b.functional,h=c.controllers.metaWidget,i=c.views.pageMask,j=f(h,{initialize:function(a,b){h.prototype.initialize.call(this,a,b),this.moveLayers()},options:function(){var a=h.prototype.options.call(this);return e.extend(a,{updateOnConstruction:!1})},pageMaskView:null,onOldWorldMetaPop:function(a){this.update();var b,e=d().add(a.currentTarget),f=c.getBody().find(this.options.metaWidgetSelector),g=f.filter("[data-hotel-id='"+e.data("taHotelId")+"']"),h=g.data(j.DATA_KEY_CONTAINER_VIEW);this.pageMaskView.show(),h.$el.show(),b=c.getCenterPositionOnDocumentForItem(h.$el.height(),h.$el.width()),h.$el.css({position:"fixed",top:b.top,left:b.left,zIndex:20})},onOldWorldMetaLayersAdded:function(){this.moveLayers()},onPageMaskHide:function(){c.getBody().find(this.options.metaWidgetSelector).hide()},attach:function(){return h.prototype.attach.call(this),d.subscribe("fromOldWorld:metaLayerPop",this.onOldWorldMetaPop),d.subscribe("fromOldWorld:metaLayersAdded",this.onOldWorldMetaLayersAdded),this.pageMaskView.on(i.EVENT_HIDE,this.onPageMaskHide),this},bindMethods:function(){return h.prototype.bindMethods.call(this),g.bindMethods(this,["onOldWorldMetaPop","onOldWorldMetaLayersAdded","onPageMaskHide"]),this},getDependencies:function(){var a=h.prototype.getDependencies.call(this);return e.extend(a,{pageMaskView:function(){return new i}})},moveLayers:function(){return this.element.find(this.options.metaWidgetSelector).filter(function(){return d(this).parent("body").length?!1:!0}).appendTo("body").hide(),this},STATIC:{}});c.ns("controllers.layerMetaWidget",j)}(window);
//# sourceMappingURL=layerMetaWidget.nano.js.map

// ===========================================
// Meta Bubble
// ===========================================
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=c.Model.extend({initialize:function(a,b){},defaults:function(){var a={};return a[d.ATTR_ACTIVE]=!1,a[d.ATTR_HIDE_WAIT_TIME]=1e4,a[d.ATTR_SELECTOR_ALL_VENDORS]=".chevronVendors .chevronVendorContainer, .basicVendors .basicVendorContainer",a[d.ATTR_SELECTOR_CHEVRON_VENDORS]=".chevronVendors .chevronVendorContainer",a[d.ATTR_SELECTOR_META_WIDGET]=".mvcView.metaWidget",a[d.ATTR_SHOW_WAIT_TIME]=2e3,a[d.ATTR_SHOWING_FOR]=null,a},isActive:function(){return this.get(d.ATTR_ACTIVE)},setActive:function(a,b){return this.set(d.ATTR_ACTIVE,a,b)},getHideWaitTime:function(){return this.get(d.ATTR_HIDE_WAIT_TIME)},setHideWaitTime:function(a,b){return this.set(d.ATTR_HIDE_WAIT_TIME,a,b)},getSelectorAllVendors:function(){return this.get(d.ATTR_SELECTOR_ALL_VENDORS)},setSelectorAllVendors:function(a,b){return this.set(d.ATTR_SELECTOR_ALL_VENDORS,a,b)},getSelectorChevronVendors:function(){return this.get(d.ATTR_SELECTOR_CHEVRON_VENDORS)},setSelectorChevronVendors:function(a,b){return this.set(d.ATTR_SELECTOR_CHEVRON_VENDORS,a,b)},getSelectorMetaWidget:function(){return this.get(d.ATTR_SELECTOR_META_WIDGET)},setSelectorMetaWidget:function(a,b){return this.set(d.ATTR_SELECTOR_META_WIDGET,a,b)},getShowWaitTime:function(){return this.get(d.ATTR_SHOW_WAIT_TIME)},setShowWaitTime:function(a,b){return this.set(d.ATTR_SHOW_WAIT_TIME,startWaitTime,b)},getShowingFor:function(){return this.get(d.ATTR_SHOWING_FOR)},setShowingFor:function(a,b){return this.set(d.ATTR_SHOWING_FOR,a,b)}},{ATTR_ACTIVE:"active",ATTR_HIDE_WAIT_TIME:"hideWaitTime",ATTR_SELECTOR_ALL_VENDORS:"allVendorsCssSelector",ATTR_SELECTOR_CHEVRON_VENDORS:"chevronVendorCssSelectors",ATTR_SELECTOR_ATTR_SELECTOR_META_WIDGET:"metaWidgetCssSelector",ATTR_SHOW_WAIT_TIME:"showWaitTime",ATTR_SHOWING_FOR:"showingFor"});b.ns("modules.metaBubble.models.config",d)}(this);
//# sourceMappingURL=config.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=(b.modules.metaBubble.models.config,b.shared),e=c.View.extend({initialize:function(a){this.template=d.getTemplate(this.options.templateName)},className:"c-meta-bubble",model:null,template:null,options:function(){return{templateName:"metaBubble-bubble"}},attach:function(){var a=this.model.constructor;return this.listenTo(this.model,"change:"+a.ATTR_SHOWING_FOR,this.onShowForChange),this},detach:function(){return this.stopListening(this.model),this},hide:function(){return this.$el.fadeOut(),this},render:function(){var a=this.model.getShowingFor(),b=a.find(this.model.getSelectorChevronVendors()).first(),c=b.offset();return this.$el.html(this.template({numOfSites:a.find(this.model.getSelectorAllVendors()).length})),this.$el.appendTo("body"),this.$el.css({left:c.left,top:c.top-this.$el.height()}).hide().fadeIn(),this},onShowForChange:function(a,b,c){b?this.render():this.hide()}},{});b.ns("modules.metaBubble.views.bubble",e)}(this);
//# sourceMappingURL=bubble.nano.js.map
!function(a){"use strict";var b=a.stm,c=a._,d=b.define,e=b.functional,f=b.shared.logger,g=b.shared,h=(b.modules.metaBubble.views.bubble,b.modules.metaBubble.models.config,b.shared.controllers.metaWidget,d(null,g.getBackboneEvents(),{initialize:function(a,b,c){this.model=a,this.bubbleView=b,this.metaWidgetController=c,e.bindMethods(this,["onMetaWidgetUpdateComplete","onVendorClick","show","stop"])},bubbleView:null,metaWidgetController:null,model:null,start:function(){return this.model.isActive()&&(this.attach(),this.logMessage("Script activated.")),this},stop:function(){return this.detach(),this.model.setActive(!1),this.bubbleView.hide(),this.logMessage("Script deactivated.")},onMetaWidgetUpdateComplete:function(a){this.startTimerForShowing()},onVendorClick:function(a){this.stop()},attach:function(){return this.detach(),this.bubbleView.attach(),this.metaWidgetController.subscribe(this.metaWidgetController.constructor.ON_UPDATE_COMPLETE,this.onMetaWidgetUpdateComplete),this.metaWidgetController.element.on("click",this.model.getSelectorAllVendors(),this.onVendorClick),this},detach:function(){return this.bubbleView.detach(),this.metaWidgetController.unsubscribe(this.metaWidgetController.constructor.ON_UPDATE_COMPLETE,this.onMetaWidgetUpdateComplete),this.metaWidgetController.element.off("click",this.model.getSelectorAllVendors(),this.onVendorClick),this},findWidgetToShowFor:function(){var a=this.metaWidgetController.element.find(this.model.getSelectorChevronVendors()).filter(":visible"),b=a.first().parents(this.model.getSelectorMetaWidget());return b},logMessage:function(b){return-1!==c.indexOf(a.location.search,"metaBubbleLogging=enabled")&&f.logMessage("stm.modules.metaBubble.controllers.main: "+b),this},show:function(){if(this.logMessage("Trying to show."),this.model.isActive()){var a=this.findWidgetToShowFor();a.length&&(this.model.setShowingFor(a),this.startTimerForHiding(),this.model.setActive(!1),this.logMessage("Showing."))}return this},startTimerForHiding:function(){return c.delay(this.stop,this.model.getHideWaitTime()),this},startTimerForShowing:function(){return c.delay(this.show,this.model.getShowWaitTime()),this},STATIC:{}}));b.ns("modules.metaBubble.controllers.main",h)}(this);
//# sourceMappingURL=main.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.modules.metaBubble.models.config,d=b.modules.metaBubble.views.bubble,e=b.modules.metaBubble.controllers.main,f={Controller:{Main:e},Model:{Config:c},View:{Bubble:d}};b.ns("modules.metaBubble.exports",f)}(this);
//# sourceMappingURL=exports.nano.js.map
!function(a){"use strict";var b=a.stm,c=(a._,b.modules.metaBubble.exports),d=(b.shared.controllers.metaWidget,b.shared),e=(b.strings,{createMainController:function(a){var b=e.createConfigModel(),d=new c.View.Bubble({model:b,metaWidgetContainerEl:a.element});return new c.Controller.Main(b,d,a)},createConfigModel:function(){var a={};return a[c.Model.Config.ATTR_ACTIVE]=b.pageData&&b.pageData.metaBubbleActive,new c.Model.Config(a)}});d.ns("factories.metaBubble",e)}(this);
//# sourceMappingURL=metaBubble.nano.js.map

// ===========================================
// Pages With Meta Widgets
// ===========================================
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=a._,e=b.define,f=b.shared,g=b.shared.views.metaWidget.container,h=b.dependenciesInjection,i=b.functional,j=b.shared.controllers.metaCookieDropper,k=b.shared.controllers.metaPopunder,l=b.shared.metaUtils,m=b.shared.controllers.metaWidget,n=b.shared.models.searchData,o=b.storage.session,p=b.strings,q="metaOpener",r="single",s=e({initialize:function(a,c){this.element=a,this.options=d.extend({},d.result(this,"options"),c),b.pageData.noPrepops=!0,n.createGlobal(),d.each(["date1","date2"],function(a){b.searchData.has(a)&&b.searchData.get(a).isDefault&&b.searchData.set(a,null)}),h.injectDependencies(this),l.isCookieDropperRequired()&&(this.metaCookieDropper=new j(a,{})),this.bindMethods().attach().setMetaOpenerSetting()},element:null,metaCookieDropper:null,metaPopunderController:null,metaWidgetController:null,options:function(){return{}},sessionStorage:null,onVendorClick:function(a,b){if(this.metaPopunderController.popunder)try{this.metaPopunderController.popunder.popupWindow.focus(),this.metaPopunderController.popunder.popupWindow.close(),this.metaPopunderController.popunder.popupWindow.closed=!0}catch(c){}},attach:function(){return c.subscribe(g.EVENT_VENDOR_CLICKED,this.onVendorClick),this},bindMethods:function(){return i.bindMethods(this,["onVendorClick"]),this},getDependencies:function(){return{metaPopunderController:function(){return new k(this.element)},metaWidgetController:function(){return new m(this.element)},sessionStorage:function(){return o.getInstance()}}},setMetaOpenerSetting:function(){var c=p.parseQueryString(a.location.search),d=this.sessionStorage.get(q)===r;return c[q]&&(this.sessionStorage.set(q,c[q]),d=c[q]===r),b.pageData.metaTabBrowsingDisabled=d,this.metaCookieDropper&&(this.metaCookieDropper.enabled=!d),this}});f.ns("controllers.pagesWithMetaWidgets",s)}(this);
//# sourceMappingURL=pagesWithMetaWidgets.nano.js.map

// ===========================================
// BlueKai
// ===========================================
!function(a){"use strict";var b=a.jQuery,c=a.stm,d=c.shared,e=c.define,f=c.functional,g=c.strings,h={hasTriedLoading:!1,isReady:!1,getApi:function(){return a.BKTAG=a.BKTAG||{},a.BKTAG}},i=e(null,d.getBackboneEvents(),{initialize:function(){this.bindMethods()},isApiReady:function(){return h.isReady},addPageContext:function(a,b){var c;return this.isApiReady()?(c=h.getApi(),c.addPageCtx(a,b),this):(this.trigger(i.ON_ERROR,{trigger:this,message:"API not ready."}),this)},executeTag:function(a,b){var c;return this.isApiReady()?(a.site_id>0?(c=h.getApi(),c.doTag(a,b)):this.trigger(i.ON_ERROR,{trigger:this,message:"'"+a.site_id+"' is not a valid BlueKai site ID."}),this):(this.trigger(i.ON_ERROR,{trigger:this,message:"API not ready."}),this)},load:function(){return h.hasTriedLoading?h.isReady&&this.onBlueKaiApiLoaded():(h.hasTriedLoading=!0,b.getScript(i.API_URL,this.onBlueKaiApiLoaded)),this},onBlueKaiApiLoaded:function(){h.isReady=!0,this.trigger(i.ON_API_LOADED,{trigger:this})},bindMethods:function(){return f.bindMethods(this,["onBlueKaiApiLoaded"]),this},STATIC:{API_URL:"//tags.bkrtx.com/js/bk-coretag.js",ON_API_LOADED:g.uniqueId(),ON_ERROR:g.uniqueId()}});c.ns("modules.blueKai.utils.library",i)}(window);
//# sourceMappingURL=library.nano.js.map
!function(a){"use strict";var b=a._,c=a.jQuery,d=a.stm,e=d.shared,f=d.modules.blueKai.utils.library,g=d.dates,h=d.define,i=d.functional,j=d.shared.logger,k=d.shared.models.searchData,l=d.strings,m=h(null,e.getBackboneEvents(),{initialize:function(a,c,d,e,f,g,h){this.element=a,this.model=c,this.library=d,this.searchMode=e,this.options=b.extend({},b.result(this,"options"),g),this.tagOptions=b.extend({site_id:f},b.result(this,"tagOptions"),h),this.logObjects([[this.options,"Controller Options"],[this.tagOptions,"Tag Options"]],"Initialized")},library:null,tagOptions:function(){return{allow_multiple_calls:!0,is_debug:!1,pixel_limit:m.TRACKING_LIMIT_DEFAULT}},element:null,model:null,options:function(){return{dateFormat:"yy-mm-dd",debug:!1,requireValidSearch:!1}},searchData:null,searchMode:null,getLibrary:function(){return this.library},getModel:function(){return this.model},getSearchData:function(){return this.searchData},start:function(){var a=this;return this.logInfo("Beginning execution."),this.attach().bindMethods().prepareSearchData(),m.permissionGranted?this.getLibrary().load():c.subscribe("/blueKai/permissionGranted",function(){a.getLibrary().load()}),this},stop:function(){return this.logInfo("Stopping execution."),this.detach().reset(),this},onBlueKaiApiLoaded:function(){var a;this.logInfo("API Loaded."),this.options.requireValidSearch?(a=this.validate(),a===!0?this.track():(this.logWarning("The following fields are invalid. The tag has not been fired."),this.logObjects([[a]],"Invalid Fields"))):this.track()},onBlueKaiTagFired:function(){this.logInfo("Tag fired successfully."),this.trigger(m.ON_BLUEKAI_TAG_FIRED,{trigger:this})},onLibraryError:function(a){this.logError(a.message)},attach:function(){return this.listenTo(this.library,f.ON_API_LOADED,this.onBlueKaiApiLoaded),this.listenTo(this.library,f.ON_ERROR,this.onLibraryError),this},bindMethods:function(){return i.bindMethods(this,["onBlueKaiApiLoaded","onBlueKaiTagFired","onLibraryError"]),this},detach:function(){return this.stopListening(this.library),this},getLocationInfo:function(a){var d,e,f,g=this.getModel(),h=g.getLocationShortName(a),i=g.getLocationCode(a);return b.contains(h,",")?(f=h.split(","),d=c.trim(f[0]),e=c.trim(f[1])):h?(d=null,e=h):(d=null,e=null),{code:i,city:d,parent:e}},logDebug:function(a){return this.options.debug&&j.logMessage("BlueKai Tag :: "+a),this},logError:function(a){return this.logWarning("Exception thrown: "+a),j.logException({message:a},"stm.modules.blueKai.controllers.main"),this},logInfo:function(a){return this.options.debug&&j.logInfo("BlueKai Tag :: "+a),this},logObjects:function(a,c){return this.options.debug&&b.isArray(a)&&(j.startLoggingGroup("BlueKai Tag :: "+c),b.each(a,function(a,c,d){if(b.isArray(a)&&!b.isEmpty(a)){var e=a[0],f=a[1];b.isString(f)&&j.logMessage(f),b.isEmpty(e)?j.logMessage("<Empty Object>"):j.logObjectHierarchy(e)}}),j.endLoggingGroup()),this},logWarning:function(a){return this.options.debug&&j.logWarning("BlueKai Tag :: "+a),this},prepareSearchData:function(){var a,c=this.getModel(),d=this.getLocationInfo(c.getLocation1()),e=this.getLocationInfo(c.getLocation2()),f=g.formatDate(this.options.dateFormat,c.getDate1()),h=g.formatDate(this.options.dateFormat,c.getDate2());switch(this.searchMode){case k.SEARCH_MODE_AIR:a={l1a:d.code,l1c:d.city,l1p:d.parent,l2a:e.code,l2c:e.city,l2p:e.parent,d1:f,d2:null,t1:c.getTime1(),t2:null,ntrv:c.getTravelers(),st:c.getSearchType(),sc:c.getServiceClass(),ns:c.isNonstop()},c.isOneway()||(a.d2=h,a.t2=c.getTime2());break;case k.SEARCH_MODE_CAR:a={l2a:e.code,l2c:e.city,l2p:e.parent,d1:f,d2:h,t1:c.getTime1(),t2:c.getTime2()};break;case k.SEARCH_MODE_CRUISE:a={c3:c.getCruiseDestinationName(),d3:g.formatDate(this.options.dateFormat,c.getCruiseDeparture()),clin:c.getCruiseLine(),clen:c.getCruiseLength(),o55:c.isOver55()};break;case k.SEARCH_MODE_HOLIDAY:a={l1a:d.code,l1c:d.city,l1p:d.parent,l2a:e.code,l2c:e.city,l2p:e.parent,d1:f,d2:h,flx:c.getFlexDays(),ppp:c.getPricePerPerson(),bb:c.getBoardBasis(),ntrv:c.getTravelers(),nchl:c.getNumChildren()};break;case k.SEARCH_MODE_HOTEL:a={l2a:e.code,l2c:e.city,l2p:e.parent,d1:f,d2:h,prv:c.getProvider(),ntrv:c.getTravelers(),nrms:c.getRooms()};break;case k.SEARCH_MODE_VACATION_PACKAGES:a={l1a:d.code,l1c:d.city,l1p:d.parent,l2a:e.code,l2c:e.city,l2p:e.parent,d1:f,d2:h,ntrv:c.getTravelers()};break;case k.SEARCH_MODE_VACATION_RENTALS:a={l2a:e.code,l2c:e.city,l2p:e.parent,d1:f,d2:h,nrms:c.getRooms()};break;default:a={},this.logWarning("Unsupported search mode: "+this.searchMode)}return b.isObject(a)&&!b.isEmpty(a)&&(a.mode=this.searchMode),this.searchData=a,this.logObjects([[this.searchData]],"Search Data"),this},reset:function(){return this.searchData=null,this},track:function(){var a,c=this.getLibrary(),d=this.getSearchData();if(b.isObject(d)){for(var e in d)a=d[e],(b.isBoolean(a)||b.isNumber(a)||b.isString(a)&&a.length>0)&&c.addPageContext(e,a);c.executeTag(this.tagOptions,this.onBlueKaiTagFired)}return this},validate:function(){var a,c,d,e=this.getModel(),f={},g=this.getSearchData();switch(g.mode){case k.SEARCH_MODE_AIR:a=["l1a","l2a","d1","t1"],e.isOneway()||(a.push("d2"),a.push("t2"));break;case k.SEARCH_MODE_CAR:a=["l2c","d1","d2","t1","t2"];break;case k.SEARCH_MODE_CRUISE:a=["c3","d3"];break;case k.SEARCH_MODE_HOLIDAY:a=["l1a","l2c","d1","d2","ntrv"];break;case k.SEARCH_MODE_VACATION_PACKAGES:a=["l1a","l2a","d1","d2","ntrv"];break;case k.SEARCH_MODE_HOTEL:a=["l2c","d1","d2","ntrv","nrms"];break;case k.SEARCH_MODE_VACATION_RENTALS:a=["l2c","d1","d2","nrms"];break;default:a=[]}a.push("mode");for(var h=0;h<a.length;h++)c=a[h],d=g[c],b.isBoolean(d)||b.isNumber(d)||b.isString(d)&&!(d.length<1)||(f[c]="The field '"+c+"' is required.");return b.isEmpty(f)?!0:f},STATIC:{permissionGranted:!1,grantPermission:function(){this.permissionGranted=!0,c.publish("/blueKai/permissionGranted")},TRACKING_LIMIT_DEFAULT:7,ON_BLUEKAI_TAG_FIRED:l.uniqueId()}});d.ns("modules.blueKai.controllers.main",m)}(window);
//# sourceMappingURL=main.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.modules.blueKai.utils.library,d=b.modules.blueKai.controllers.main,e={Controller:{Main:d},Utils:{Library:c}};b.ns("modules.blueKai.exports",e)}(window);
//# sourceMappingURL=exports.nano.js.map
!function(a){"use strict";var b=a._,c=a.stm,d=c.shared,e=c.modules.blueKai.exports,f=c.shared.models.searchData,g={deriveSearchMode:function(){var a,d=c.pageData;return a=b.isObject(d)&&!b.isEmpty(d.mode)?d.mode:null}},h={createMainController:function(a,c,d,f,h){var i=this.createBlueKaiLibrary(),j=g.deriveSearchMode();return b.isObject(h)||(h=this.createSearchDataModel()),this.updateSearchDataModel(j,h),new e.Controller.Main(a,h,i,j,c,d,f)},createBlueKaiLibrary:function(){return new e.Utils.Library},createSearchDataModel:function(){return f.createGlobal()},updateSearchDataModel:function(a,d){var e,g=c.pageData;switch(a){case f.SEARCH_MODE_HOTEL:b.isObject(g.taMeta)&&b.isObject(g.taMeta.hotel)&&(!b.isObject(d.getLocation2())&&b.isNumber(g.taMeta.hotel.parent)&&(e={id:g.taMeta.hotel.parent},d.setLocation2(e)),b.isEmpty(g.taMeta.hotel.name)||d.setProvider(g.taMeta.hotel.name))}return this}};d.ns("factories.blueKai",h)}(window);
//# sourceMappingURL=blueKai.nano.js.map
!function(a){"use strict";var b=a._,c=a.stm,d=c.shared,e=c.modules.blueKai.exports,f=c.shared.factories.blueKai,g=c.cookies,h=c.define,i=c.strings,j=h(null,d.getBackboneEvents(),{initialize:function(a,c,d){this.element=a,this.model=c,this.options=b.extend({},b.result(this,"options"),d)},mainController:null,model:null,options:function(){return{attributeAutoInitialize:"bluekai-auto-initialize",attributeSiteId:"bluekai-site-id",attributeControllerOptions:"bluekai-controller-options",attributeTagOptions:"bluekai-tag-options"}},shouldAutoInitialize:function(){return this.element.data(this.options.attributeAutoInitialize)===!0},start:function(){return this.shouldRun()&&(this.mainController||(this.mainController=this.createController()),this.attach(),this.mainController.start()),this},stop:function(){return this.mainController.stop(),this.detach()},onBlueKaiTagFired:function(){this.trigger(j.ON_BLUEKAI_TAG_FIRED,{trigger:this})},attach:function(){return this.listenTo(this.mainController,e.Controller.Main.ON_BLUEKAI_TAG_FIRED,this.onBlueKaiTagFired),this},createController:function(){var a=parseInt(this.element.data(this.options.attributeSiteId),10),b=this.element.data(this.options.attributeControllerOptions)||{},c=this.element.data(this.options.attributeTagOptions)||{};return f.createMainController(this.element,a,b,c,this.model)},detach:function(){return this.stopListening(this.mainController),this},shouldRun:function(){var a=null!==g.get(j.COOKIE_NAME_WATIR_TEST);return!a},STATIC:{COOKIE_NAME_WATIR_TEST:"bb_watir_test",ON_BLUEKAI_TAG_FIRED:i.uniqueId()}});d.ns("controllers.blueKai",j)}(window);
//# sourceMappingURL=blueKai.nano.js.map

// ===========================================
// Meta Tab Browsing
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=b.shared.featuredSearchUtils,f=b.shared.recommendationsClient,g=d.Model.extend({getInterstitialUrl:function(){return this.getUrl()+"&"+e.QUERY_KEY_SHOW_INTERSTITIAL+"=1"},isPhoneAd:function(){return this.has("phone")},setVisited:function(a){return this.set("visited",a),this},isVisited:function(){return this.get("visited")},getRank:function(){return this.get("rank")},getId:function(){return this.get("id")},setId:function(a,b){return this.set("id",a,b),this},getCurrency:function(){return this.get("currency")},setCurrency:function(a,b){return this.set("currency",a,b),this},getName:function(){return this.get("name")},setName:function(a,b){return this.set("name",a,b),this},getPrice:function(){return this.get("price")},setPrice:function(a,b){return this.set("price",a,b),this},getUrl:function(){var a=this.get("url");return a+"&recommended_hotels="+f.getHotelIDs().join(",")},setUrl:function(a,b){return this.set("url",a,b),this},getHomePageUrl:function(){return this.get("homePageUrl")},setHomePageUrl:function(a,b){return this.set("homePageUrl",a,b)},getFauxTabs:function(){return this.get("fauxTabs")},setFauxTabs:function(a,b){return this.set("fauxTabs",a,b)},getLogo:function(){return this.get("logo")},setLogo:function(a,b){return this.set("logo",a,b),this},getPosition:function(){return this.get("position")},setPosition:function(a,b){return this.set("position",a,b),this},getUniversalLogo:function(){return this.get("universal_logo")},setUniversalLogo:function(a,b){return this.set("universal_logo",a,b),this},isSelected:function(){return this.get("selected")},setSelected:function(a,b){return this.set("selected",a,b),a&&this.setVisited(!0),this},getTrackingInfo:function(){return this.get("tracking_info")},setTrackingInfo:function(a,b){return this.set("tracking_info",a,b),this},defaults:function(){return{id:0,currency:"$",name:"",price:0,url:"",homePageUrl:"",fauxTabs:"",logo:"",universal_logo:"",tracking_info:{},position:0,selected:!1,visited:!1}}},{});c.ns("models.tabBrowsingAd",g)}(window);
//# sourceMappingURL=tabBrowsingAd.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a._,f=c.models.tabBrowsingAd,g=d.Collection.extend({constructor:function(a,b){d.Collection.call(this,a,b),this.ensureOnlyOneSelectedAd(b).attach()},comparator:"position",model:f,activeAd:null,getActiveAd:function(){return this.activeAd},setActiveAd:function(a,b){var c=b&&(b.silent||b.silentSetActiveAd),d=this.activeAd;return this.activeAd===a?this:(this.activeAd=a,d&&d.setSelected(!1,b),this.activeAd&&this.activeAd.setSelected(!0,b),c||this.trigger(g.EVENT_CHANGED_ACTIVE_AD,a,b),this)},onAdAddition:function(a,b,c){a.isSelected()&&this.setActiveAd(a,c)},onAdRemoval:function(a,b,c){var d=this.getActiveAd();d&&d.getId()===a.getId()&&d.setSelected(!1,c)},onAdPositionChange:function(a,b,c){var d=this.where({position:b}),f=1;e.each(d,function(d){d.getId()!==a.getId()&&d.setPosition(b+f++,c)}),this.sort()},onAdSelectedChange:function(a,b,c){var d=this.getActiveAd();b===!0?d&&d.getId()===a.getId()||this.setActiveAd(a,c):d&&d.getId()===a.getId()&&this.setActiveAd(null,c)},onCollectionReset:function(a,b){this.ensureOnlyOneSelectedAd(b)},attach:function(){return this.listenTo(this,"add",this.onAdAddition),this.listenTo(this,"remove",this.onAdRemoval),this.listenTo(this,"reset",this.onCollectionReset),this.listenTo(this,"change:position",this.onAdPositionChange),this.listenTo(this,"change:selected",this.onAdSelectedChange),this},ensureOnlyOneSelectedAd:function(a){var b=this.where({selected:!0});return this.setActiveAd(b.shift(),a),b.forEach(function(b){b.setSelected(!1,a)}),this}},{EVENT_CHANGED_ACTIVE_AD:"stm-shared-collections-tabBrowsingAds:changed-active-ad"});c.ns("collections.tabBrowsingAds",g)}(window);
//# sourceMappingURL=tabBrowsingAds.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=b.TAHotelImages,f=a._,g=b.strings,h=b.dates,i=b.dependenciesInjection,j=b.functional,k=b.shared.views.searchInput.date1,l=b.shared.views.searchInput.date2,m=d.View.extend({initialize:function(){b.searchData&&(this.currentDate1=h.formatDate("mm/dd/yy",b.searchData.getDate1()),this.currentDate2=h.formatDate("mm/dd/yy",b.searchData.getDate2())),i.injectDependencies(this),this.bindMethods().attach()},date1View:null,date2View:null,currentDate1:"",currentDate2:"",options:function(){return{hotelContentBlockSelector:".hotelContentBlock",photoContainerSelector:".hotelPhotoContainer",photoTemplate:f.template('<div class="hotelPhoto" data-photo-exist=<%= photoUrl.length > 0 ? 1: 0 %> style="background-image: url(<%- photoUrl %>)"></div>'),date1Selector:"[data-stm-role=date1]",date2Selector:"[data-stm-role=date2]",submitSelector:".submit",individualTabSelector:".individual-tab"}},render:function(){return this.date1View&&this.date1View.render(),this.date2View&&this.date2View.render(),this.renderHotelPhoto(),this.fillVendorCount(),this},renderHotelPhoto:function(){var a=this.options.photoTemplate,b=this.$el.find(this.options.hotelContentBlockSelector).data("hotel-id"),c=this.$el.find(this.options.photoContainerSelector);return c.find(".hotelPhoto").data("photo-exist")&&0!==c.find(".hotelPhoto").data("photo-exist")||e.getMultipleImagesByHotelId(b,function(b){b&&b.length>0&&c.html(a({photoUrl:b[0]}))}),this},fillVendorCount:function(){return this.$el.find(".vendorCount").html(this.collection.length+"&nbsp;"),this},onSubmitClick:function(){this.isSearchDatesChanged()?this.trigger(m.ON_SUCCESSFUL_UPDATE,{trigger:this}):this.trigger(m.ON_SUBMIT_CLICK_WITHOUT_DATE_CHANGED,{trigger:this})},attach:function(){return this.$el.on("click",this.options.submitSelector,this.onSubmitClick),this},bindMethods:function(){return j.bindMethods(this,["onSubmitClick"]),this},getDependencies:function(){return{date1View:function(){var a=this.$(this.options.date1Selector);return a.length?new k({el:a,dateFormat:a.attr("placeholder").replace("yyyy","yy"),model:this.model}):null},date2View:function(){var a=this.$(this.options.date2Selector);return a.length?new l({el:a,dateFormat:a.attr("placeholder").replace("yyyy","yy"),model:this.model}):null}}},isSearchDatesChanged:function(){var a="",c="",d=!1;return b.searchData&&(a=h.formatDate("mm/dd/yy",b.searchData.getDate1()),c=h.formatDate("mm/dd/yy",b.searchData.getDate2())),(a!==this.currentDate1||c!==this.currentDate2)&&(d=!0),d}},{ON_SUCCESSFUL_UPDATE:g.uniqueId(),ON_SUBMIT_CLICK_WITHOUT_DATE_CHANGED:g.uniqueId()});c.ns("pages.metaTabBrowsing.views.metaInstruction",m)}(window);
//# sourceMappingURL=metaInstruction.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a.jQuery,f=a._,g=b.dependenciesInjection,h=b.functional,i=b.shared.pages.metaTabBrowsing.views.metaInstruction,j=b.shared.collections.tabBrowsingAds,k=b.strings,l=b.Popup,m=c.metaUtils,n=d.View.extend({constructor:function(a,b){var c,e;b=f.extend({},b,{collection:a}),d.View.call(this,b),c=this.$el.parents("html"),e=c.find(this.options.templateSelector),this.iframeTemplate=e.length?f.template(e.html()):function(){},e=c.find(this.options.popupHTMLTemplateSelector),this.popupHTMLTemplate=e.length?f.template(e.html()):function(){},this.defaultContentEl=this.$(this.options.defaultContentSelector),this.loadingMsgContainerEl=this.$(this.options.loadingMsgContainerSelector),g.injectDependencies(this),this.bindMethods().attach()},collection:null,options:function(){return{defaultContentSelector:".default-content-section",loadingMsgContainerSelector:"[data-loader-name='loadingMsgContainer']",iframeContainerSelector:".iframe-container",templateSelector:"[data-template-name='tab-browsing-iframe']",popupHTMLTemplateSelector:"[data-template-name='tab-browsing-leave-behind']"}},iframeTemplate:null,defaultContentEl:null,loadingMsgContainerEL:null,hasFirstDelayedLoadCompeleted:!1,isMetaInstructionUpdated:!1,metaInstructionView:null,popupHTMLTemplate:null,poppedWindows:[],onChangedActiveAd:function(a,b){this.render()},onMetaInstructionUpdated:function(){this.holdingWindow=a.open("about:blank","_blank","left=9999,top=9999,width=1,height=1"),this.trigger(n.ON_METAINSTRUCTION_UPDATED,{trigger:this}),this.isMetaInstructionUpdated=!0},onMetaInstructionSubmitClickedWithoutDateChange:function(){if(this.collection.length>0){var a=this.collection.at(0);this.collection.setActiveAd(a,{}),this.showActiveAd()}},attach:function(){return this.listenTo(this.collection,j.EVENT_CHANGED_ACTIVE_AD,this.onChangedActiveAd),this.listenTo(this.metaInstructionView,i.ON_SUCCESSFUL_UPDATE,this.onMetaInstructionUpdated),this.listenTo(this.metaInstructionView,i.ON_SUBMIT_CLICK_WITHOUT_DATE_CHANGED,this.onMetaInstructionSubmitClickedWithoutDateChange),this},bindMethods:function(){return h.bindMethods(this,["onMetaInstructionUpdated","onMetaInstructionSubmitClickedWithoutDateChange"]),this},getDependencies:function(){return{metaInstructionView:function(){return new i({el:this.$(this.options.defaultContentSelector),model:this.model,collection:this.collection})}}},render:function(){var a=this.collection.getActiveAd();return a?this.showActiveAd():this.showDefaultScreen()},showActiveAd:function(){var c=this.collection.getActiveAd(),d=k.replaceText("[data-ad-id='#{id}']",c.attributes),f=this.$(d),g=this;return g.defaultContentEl.hide(),g.$(this.options.iframeContainerSelector).hide(),f.length?f.show():(g.loadingMsgContainerEl.find(".vendorName").html(c.getName()),g.loadingMsgContainerEl.show(),a.setTimeout(function(){g.loadingMsgContainerEl.hide()},7e3),g.renderAd(c)),"undefined"==typeof b.pageData.queryString.disableAutoPop&&(b.pageData.queryString.disableAutoPop="false"),c||"true"===b.pageData.queryString.disableAutoPop||g.defaultContentEl.data("stm-shared-views-tabBrowsing-instruction-shown")&&g.defaultContentEl.data("stm-shared-views-tabBrowsing-instruction-dismissed")||(g.fillVendorCount(),g.defaultContentEl.show(),g.defaultContentEl.data("stm-shared-views-tabBrowsing-instruction-shown",1),e("body").on("click",function(){g.firstDelayedLoadCompelete=!0,g.defaultContentEl.hide(),g.defaultContentEl.data("stm-shared-views-tabBrowsing-instruction-dismissed",1)})),g},renderAd:function(a){var b=a.getHomePageUrl();a.getName();return m.isTabBrowsingSupported(a.getFauxTabs())?m.isCookieDropperRequired()&&b&&b.length>9?this.showCookieDropper(a):(this.closeHoldingWindow(),this.loadAdIFrame(a)):this.openAdInNewWindow(a)},showCookieDropper:function(c){var d=c.getHomePageUrl(),e=null,f=this;return(f.hasFirstDelayedLoadCompeleted||b.pageData.queryString.selectedVendorId!=c.getId())&&(e=new l(d,{name:"CookieWindow"+c.getId(),allowRepeat:!0,popunder:!0}),e.tryPop()),a.setTimeout(function(){f.loadAdIFrame(c),e&&e.popupWindow&&(e.popupWindow.close(),e=null)},5e3),this},loadAdIFrame:function(b){var c=this,d=k.replaceText("[data-ad-id='#{id}']",b.attributes),e=this.$(d);return e.length?e.show():c.$el.append(c.iframeTemplate(b.attributes)),e=c.$el.find("#AF"+b.getId()),e.length>0&&(e.on("load",function(){c.adIFrameLoaded.call(c,e)}),c.hasFirstDelayedLoadCompeleted||a.setTimeout(function(){c.hasFirstDelayedLoadCompeleted=!0,c.adIFrameLoaded.call(c,e)},5e3)),c},closeHoldingWindow:function(){this.holdingWindow&&(this.holdingWindow.closed||this.holdingWindow.close(),this.holdingWindow=null)},showDefaultScreen:function(){return this.$(this.options.iframeContainerSelector).hide(),this.loadingMsgContainerEl.hide(),this.defaultContentEl.show(),this.fillVendorCount(),0===this.collection.length&&(this.closeHoldingWindow(),this.fillTitle()),this.metaInstructionView.render(),this},fillVendorCount:function(){return this.defaultContentEl.find(".vendorCount").html(this.collection.length+"&nbsp;"),this},adIFrameLoaded:function(a){var b=a.data("stm-shared-views-tabBrowsing-adVendorLoaded");return b?this.hasFirstDelayedLoadCompeleted&&(this.loadingMsgContainerEl.hide(),this.defaultContentEl.hide()):a.data("stm-shared-views-tabBrowsing-adVendorLoaded",1),this},openAdInNewWindow:function(a){var b=a.getId(),c=this,d=null;if(c.$el.append(c.popupHTMLTemplate(a.attributes)),c.$el.find('[data-tab-leave-behind-ad-id="'+b+'"]').on("click",function(){c.openAdInNewWindow(a)}),!c.poppedWindows[b]||c.poppedWindows[b].closed||!c.poppedWindows[b].location)if(this.holdingWindow&&!this.holdingWindow.closed){var e=this.getAdWindowSettings(a);this.holdingWindow.moveTo(e.left,e.top),this.holdingWindow.resizeTo(e.width,e.height),this.holdingWindow.location=a.getUrl(),this.holdingWindow.focus(),c.poppedWindows[b]=this.holdingWindow,this.holdingWindow=null}else d=new l(a.getUrl(),c.getAdWindowSettings(a)),d.tryPop(),d.popupWindow&&(c.poppedWindows[b]=d.popupWindow);return c.poppedWindows[b]&&!c.poppedWindows[b].closed&&c.poppedWindows[b].focus(),c.loadingMsgContainerEl.hide(),c},getAdWindowSettings:function(c){var d,g="undefined"!=typeof a.screenY?a.screenY:a.screenTop,h="undefined"!=typeof a.screenX?a.screenX:a.screenLeft,i=0,j=0,k=e(document).height(),l=e(".header-section").height()+7,n=e(".ad-display-section").height(),o={},p=c.getId(),q=c.getName();if(b.Browser.ie){var r=parseInt(b.Browser.version,10);switch(r){case 7:case 8:j=100;break;case 11:j=58,i=a.outerHeight-a.innerHeight;break;default:j=80,i=a.outerHeight-k-5}}else b.Browser.firefox?(j=58,i=a.outerHeight-k):(j=58,i=a.outerHeight-k-5);d=b.Browser.safari?k-l:b.Browser.firefox?k-l-j:n-j,o={name:"STMMetaTabWindow"+p,popunder:!1,height:d,width:e(a).width()+2,top:g+i+l,left:h,otherFeatures:{resizable:1,scrollbars:1}};var s=m.getMetaVendorWindowDimensions(q);return s&&f.extend(o,s),b.Browser.chrome&&(o.otherFeatures.scrollbars=0),b.Browser.ie&&b.Browser.version>=9&&(o.otherFeatures.resizable=0),(b.Browser.ie||b.Browser.firefox)&&(o.otherFeatures.location=1,o.otherFeatures.toolbar=1),o},getIsMetaInstructionUpdated:function(){return this.isMetaInstructionUpdated},resetIsMetaInstructionUpdated:function(){return this.isMetaInstructionUpdated=!1,this},fillTitle:function(){var a=this.model.getProvider();return this.defaultContentEl.find(".title").html("We found no availability at the "+a+" for your dates"),this.defaultContentEl.find(".subtitle").html("Change your travel dates and search again"),this}},{ON_METAINSTRUCTION_UPDATED:"on-meta-instruction-updated",ON_METAINSTRUCTION_SUBMIT_CLICKED_WITHOUT_DATE_CHANGE:"on-meta-instruction-clicked-without-date-change"});c.ns("views.tabBrowsing.adDisplay",n)}(window);
//# sourceMappingURL=adDisplay.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a.jQuery,f=a._,g=b.Chain,h=c.collections.tabBrowsingAds,i=b.strings,j=d.View.extend({constructor:function(a,b){var c,e;b=f.extend({},b,{collection:a}),d.View.call(this,b),c=this.$el.parents("html"),e=c.find(this.options.individualTabTemplateSelector),this.leftArrowEl=this.$(this.options.leftArrowSelector),this.rightArrowEl=this.$(this.options.rightArrowSelector),this.tabsContainerEl=this.$(this.options.tabsContainerSelector),this.individualTabTemplate=e.length?f.template(e.html()):function(){},this.attach()},collection:null,events:function(){var a={};return a["click "+this.options.individualTabSelector]="onIndividualTabClick",a["click "+this.options.leftArrowSelector]="onLeftArrowClick",a["click "+this.options.rightArrowSelector]="onRightArrowClick",a},options:function(){return{hasPriceClassname:"has-price",individualTabSelector:".individual-tab",individualTabTemplateSelector:"[data-template-name='tab-browsing-individual-tab']",leftArrowSelector:".left-arrow",missingPriceClassname:"missing-price",rightArrowSelector:".right-arrow",selectedClassname:"selected",visitedClassname:"visited",tabsContainerSelector:".tabs"}},individualTabTemplate:null,leftArrowEl:null,rightArrowEl:null,tabsContainerEl:null,tabsContainerPositions:null,onChangedActiveAd:function(){this.render(),this.trigger(j.ON_CHANGE_SELECTED_AD,{trigger:this})},onIndividualTabClick:function(a){var b=e(a.currentTarget),c=e(b).data("adId"),d=this.collection.get(c);a.preventDefault(),d.setSelected(!0)},onLeftArrowClick:function(a){a.preventDefault(),this.getSlideRightChain().run()},onRightArrowClick:function(a){a.preventDefault(),this.getSlideLeftChain().run()},onWindowResize:f.debounce(function(){var a=this,b=a.$(a.options.individualTabSelector),c=new g;c.append("update-container-positions",function(){a.calculateTabsContainerPositions(),c.runNext()}),b.each(function(){var b=e(this);c.append("update-tab-visibility-"+b.data("adId"),f.partial(function(b){var d=b.offset(),e=d.left+b.outerWidth(!0);e>=a.tabsContainerPositions.right?(b.css("visibility","hidden"),c.runNext()):d.left>=0&&"hidden"===b.css("visibility")&&b.css("visibility","visible"),c.runNext()},b))}),c.append("optimize-view",function(){a.ensureOptimalDisplay(),c.runNext()}),c.run()},500),attach:function(){return this.listenTo(this.collection,h.EVENT_CHANGED_ACTIVE_AD,this.onChangedActiveAd),this},calculateTabsContainerPositions:function(){var a,b,c,d=this.tabsContainerEl.css("margin-left"),e=this.rightArrowEl.css("margin-right");return this.tabsContainerEl.css("margin-left",0),this.rightArrowEl.css("margin-right",0),a=this.tabsContainerEl.offset(),b=this.tabsContainerEl.outerHeight(!0),c=this.tabsContainerEl.outerWidth(!0),this.tabsContainerEl.css("margin-left",d),this.rightArrowEl.css("margin-right",e),this.tabsContainerPositions={bottom:a.top+b,left:a.left,right:a.left+c,top:a.top},this},ensureOptimalDisplay:function(){var a,b,c,d=this,f=d.$(d.options.individualTabSelector);f.each(function(){var b=e(this),d="hidden"!==b.css("visibility");d?a=b:c=!0}),b=a?a.offset().left+a.outerWidth(!0):d.tabsContainerPositions.right,d.rightArrowEl.css("margin-right",d.tabsContainerPositions.right-b),c?(d.leftArrowEl.css("visibility","visible").show().fadeIn(),d.rightArrowEl.css("visibility","visible").show().fadeIn()):(d.leftArrowEl.fadeOut(300,function(){d.leftArrowEl.css("visibility","hidden").show()}),this.rightArrowEl.fadeOut(300,function(){d.leftArrowEl.css("visibility","hidden").show()}))},getHideThenFadeInTabsChain:function(){var a=this,b=a.$(a.options.individualTabSelector),c=new g;return c.append("hide-tabs",function(){a.calculateTabsContainerPositions(),b.css("visibility","hidden"),c.runNext()}),b.each(function(){var b=e(this);c.append("fade-in-tab-"+b.data("adId"),f.partial(function(b){var d=b.offset().left+b.outerWidth(!0);d<=a.tabsContainerPositions.right?b.css("visibility","visible").hide().fadeIn(300,function(){c.runNext()}):c.runNext()},b))}),c.append("optimize-view",function(){a.ensureOptimalDisplay(),c.runNext()}),c},getSlideLeftChain:function(){var a=this,b=a.$(a.options.individualTabSelector),c=b.last(),d=new g;return d.append("should-slide",function(){"hidden"===c.css("visibility")&&d.run()}),d.append("slide-left",function(){var c,f=parseInt(a.tabsContainerEl.css("margin-left"),10);f||(f=0),b.each(function(){var a=e(this),b="visible"===a.css("visibility");if(b&&!c)c=a;else if(!b&&c)return a.hide().css("visibility","visible").fadeIn(),!1;return!0}),a.tabsContainerEl.animate({marginLeft:f-c.outerWidth(!0)},{done:function(){b.filter(function(){return"visible"===e(this).css("visibility")}).first().css("visibility","hidden"),d.run()}})}),d},getSlideRightChain:function(){var a=this,b=a.$(a.options.individualTabSelector),c=b.first(),d=new g;return d.append("should-slide",function(){"hidden"===c.css("visibility")&&d.run()}),d.append("slide-right",function(){var c,f=parseInt(a.tabsContainerEl.css("margin-left"),10);f||(f=0),b.each(function(){var a=e(this),b="visible"===a.css("visibility");return b&&c?(c.hide().css("visibility","visible").fadeIn(),!1):(b||(c=a),!0)}),a.tabsContainerEl.animate({marginLeft:f+c.outerWidth(!0)},{done:function(){b.filter(function(){return"visible"===e(this).css("visibility")}).last().css("visibility","hidden"),d.run()}})}),d},hideThenFadeInTabs:function(){var b=this,c=b.getHideThenFadeInTabsChain();return c.append("set-resize-event",function(){e(a).on("resize",b.onWindowResize.bind(b)),c.runNext()}),c.run(),this},render:function(a){return a&&this.tabsContainerEl.html(""),this.collection.each(function(a,b){var c=a.toJSON(),d=i.replaceText("[data-ad-id='#{id}']",a.attributes),f=this.$(d);f.length||(c.hasPrice=c.price?"has-price":"missing-price",this.tabsContainerEl.append(e.trim(this.individualTabTemplate(c)))),f=this.$(d),a.isSelected()?f.addClass(this.options.selectedClassname):f.removeClass(this.options.selectedClassname),a.isVisited()?(f.addClass(this.options.visitedClassname),f.find(".individual-tab-completion-icon").text("")):f.find(".individual-tab-completion-icon").text(b+1)},this),this}},{ON_CHANGE_SELECTED_AD:i.uniqueId()});c.ns("views.tabBrowsing.tabsListing",j)}(window);
//# sourceMappingURL=tabsListing.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.Chain,g=b.dates,h=b.domState,i=b.functional,j=b.dependenciesInjection,k=b.shared.collections.tabBrowsingAds,l=b.shared.metaClient,m=b.shared.models.metaVendor,n=b.shared.metricsUtils,o=b.shared.orderedHash,p=b.shared.models.searchData,q=b.shared.views.tabBrowsing.adDisplay,r=b.shared.views.tabBrowsing.tabsListing,s=(b.browser,b.shared.metaUtils),t=b.shared.linkUtils,u=e(null,c.getBackboneEvents(),{initialize:function(a,c){this.element=a,this.options=d.extend({},d.result(this,"options"),c),this.ads=new k([]),this.headerSectionEl=this.element.find(this.options.headerSectionSelector),this.loadingIndicatorSectionEl=this.element.find(this.options.loadingIndicatorSectionSelector),b.searchData||(b.searchData=new p,b.searchData.fetch()),j.injectDependencies(this),this.bindMethods().attach().dispatch()},adDisplayView:null,ads:null,chain:null,client:null,element:null,headerSectionEl:null,loadingIndicatorSectionEl:null,metrics:null,options:function(){return{adDisplaySectionSelector:".ad-display-section",headerSectionSelector:".header-section",loadingIndicatorSectionSelector:".loading-indicator-section",tabsListingSectionSelector:".tabs-listing-section"}},tabsListingView:null,onMetaInstructionUpdated:function(){this.dispatch()},onWindowResize:function(){this.adjustAdDisplayAreaHeight()},onBeforeAdsFetch:function(){this.metrics.startTiming(u.METRICS_KEY_ADS_FETCHING)},adjustAdDisplayAreaHeight:function(){var a=c.getWindow(),b=a.height();return this.adDisplayView.$el.css("height",b-this.headerSectionEl.height()-2),this},attach:function(){return this.listenTo(this.adDisplayView,q.ON_METAINSTRUCTION_UPDATED,this.onMetaInstructionUpdated),this},bindMethods:function(){return i.bindMethods(this,["displayPageChainItem","fetchAdsChainItem","onMetaInstructionUpdated","onWindowResize","prepareForFetchChainItem","redirectChainItem"]),this},dispatch:function(){var a=new f;return a.append("prepare for fetch",d.partial(this.prepareForFetchChainItem,a)),a.append("fetch ads",d.partial(this.fetchAdsChainItem,a)),a.append("conditionally redirect to ad",d.partial(this.redirectChainItem,a)),a.append("display page",d.partial(this.displayPageChainItem,a)),a.run(),this},displayPageChainItem:function(a){var b=this;if(c.getWindow().on("resize",b.onWindowResize),b.loadingIndicatorSectionEl.fadeOut(500,function(){h.add(b.element,u.STATE_DATA_LOADED),b.adDisplayView.render(),b.tabsListingView.render(!0),b.element.show(),b.tabsListingView.hideThenFadeInTabs(),b.adjustAdDisplayAreaHeight(),b.element.css("cursor","default"),a.runNext()}),this.adDisplayView.getIsMetaInstructionUpdated()){var d=this.tabsListingView.collection.at(0);this.tabsListingView.collection.setActiveAd(d,{}),this.adDisplayView.resetIsMetaInstructionUpdated()}return b},getDependencies:function(){var a=this.element.parents("html"),c=new o;return c.append("adDisplayView",function(){return new q(this.ads,{el:a.find(this.options.adDisplaySectionSelector),model:b.searchData})}),c.append("client",function(){return new l(b.pageData.metaMCID,{requestDelay:b.pageData.metaRequestInterval})}),c.append("metrics",function(){return new n}),c.append("tabsListingView",function(){return new r(this.ads,{el:a.find(this.options.tabsListingSectionSelector)})}),c},fetchAdsChainItem:function(a){var c,d=this,e=b.pageData.queryString.hotelId/1,f=b.pageData.queryString.selectedVendorId,h=s.isTabBrowsingSupported(),i=s.isMobileMetaTabsRedirectSupported();h||i||(b.pageData.queryString.disableAutoPop="true"),d.client.hotels.add({id:e}),d.client.checkinDate=g.formatDate("mm/dd/yy",b.searchData.getDate1()),d.client.checkoutDate=g.formatDate("mm/dd/yy",b.searchData.getDate2()),d.client.adults=b.searchData.getTravelers();var j=d.extractSaRefReqId();return j&&d.client.addExtraQueryData("saRefReqId",j),d.client.subscribe(l.EVENT_READY,function(){d.onBeforeAdsFetch()}),d.client.subscribe(l.EVENT_LOADED,function(){var g=d.client.hotels.get(e),h="true"===b.pageData.queryString.disableAutoPop;if(d.metrics.stopTiming(u.METRICS_KEY_ADS_FETCHING),g.vendors.length){if(g.vendors.each(function(a){var b,c=!!f&&(a.getId()==f||a.getBucketId()==f),e=a.getDataState()===m.STATE_UNAVAILABLE;(c||!e)&&(h&&(c=!1),b=a.mapToTabBrowsingAdModelAttributes(),b.selected=c,d.ads.add(b,{silentSetActiveAd:!0}))}),h&&f){var i=f.match(/(\d+)/);i&&i.length>1&&(c=d.ads.get(i[1]))}else c=d.ads.getActiveAd();c&&c.setPosition(0)}a.runNext()}),d.client.fetchUsingHotels(),this},prepareForFetchChainItem:function(a){var b=this;return this.client.hotels.map(function(a){return a.setDataLoaded(!1)}),this.client.unsubscribe(l.EVENT_LOADED),this.tabsListingView.collection.reset(),b.element.css("cursor","pointer"),d.delay(function(){b.element.hasClass("s-dataLoaded")||b.loadingIndicatorSectionEl.fadeIn()},500),a.runNext(),this},redirectChainItem:function(a){var b=this.ads.getActiveAd();return b&&b.getUrl()&&(s.isMobileMetaTabsRedirectSupported()||!s.isTabBrowsingSupported(b.getFauxTabs()))?void(document.location=b.getUrl()):void a.runNext()},extractSaRefReqId:function(){var a=t.parseUrlIntoParts(document.URL);return a.queryString.hasOwnProperty("sa_ref_req_id")?a.queryString.sa_ref_req_id:null},STATIC:{METRICS_KEY_ADS_FETCHING:"ads-fetching",STATE_DATA_LOADED:"dataLoaded"}});c.ns("controllers.metaTabBrowsing",u)}(window);
//# sourceMappingURL=metaTabBrowsing.nano.js.map

// ===========================================
// Alert On Close
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=d.Model.extend({getDisplayText:function(){return this.get("displayText")},setDisplayText:function(a,b){return this.set("displayText",a,b)},isEnabled:function(){return this.get("enabled")},setEnabled:function(a,b){return this.set("enabled",a,b)},isPersistent:function(){return this.get("persistent")},setPersistent:function(a,b){return this.set("persistent",a,b)},isShown:function(){return this.get("shown")},setShown:function(a,b){return this.set("shown",a,b)},isShownOnElementNavigation:function(){return this.get("shownOnElementNavigation")},setShownOnElementNavigation:function(a,b){return this.set("shownOnElementNavigation",a,b)},defaults:function(){return{displayText:e.DEFAULT_DISPLAY_TEXT,enabled:!1,persistent:!1,shown:!1,shownOnElementNavigation:!1}}},{DEFAULT_DISPLAY_TEXT:'Wait! Find this low fare now. Enter your trip details and click "find flights" below.'});c.ns("models.alertOnClose",e)}(window);
//# sourceMappingURL=alertOnClose.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=a.jQuery,g=(b.cookies,b.shared.linkUtils),h=e(null,c.getBackboneEvents(),{initialize:function(a,b,c,e,f){this.model=a,this.alertOnCloseModel=b,this.element=c,this.options=d.extend({},d.result(this,"options"),e),this.attach().parseQueryString(),f&&(this.messages=f,this.data={air:d.template(f.data.air),car:d.template(f.data.car),carUK:d.template(f.data.carUK),cruise:d.template(f.data.cruise),holiday:d.template(f.data.holiday),hotel:d.template(f.data.hotel),vacation:d.template(f.data.vacation),vacation_rental:d.template(f.data.vacationRental)})},model:null,alertOnCloseModel:null,messages:null,searchCount:0,element:null,options:function(){return{searchesToDisable:1}},data:null,onBeforeUnload:function(){return this.shouldShow()?(this.alertOnCloseModel.setShown(!0),this.messages?this.getMessage():this.alertOnCloseModel.getDisplayText()):void 0},getMessage:function(){var a=this.getTemplate();return a({geo:this.model.getLocationsFullText()})},getTemplate:function(){var a=this.model.getSearchMode(),b=this.model.getAffiliateName();return"car"===a&&"bb_affiliate_bookingbuddy_co_uk"===b&&(a+="UK"),this.data[a]},onElementClick:function(){a.last_clicked=(new Date).getTime()},onAdSelectedChange:function(a,b){b&&this.searchCount++},attach:function(){return f(this.element).on("click",this.onElementClick),this},shouldShow:function(){return!this.alertOnCloseModel.isShownOnElementNavigation()&&a.last_clicked&&(new Date).getTime()-a.last_clicked<100?!1:this.alertOnCloseModel.isEnabled()&&(!this.alertOnCloseModel.isShown()||this.alertOnCloseModel.isPersistent())},parseQueryString:function(){var a=g.parseUrlIntoParts(document.URL).queryString;return a.alert&&this.alertOnCloseModel.setEnabled("1"===a.alert?!0:"0"===a.alert?!1:this.alertOnCloseModel.isEnabled()),this}});c.ns("controllers.alertOnClose",h)}(window);
//# sourceMappingURL=alertOnClose.nano.js.map

// ===========================================
// DB5 Tab Browsing
// ===========================================

!function(a){"use strict";var b=a.stm,c=b.shared,d=b.shared.models.tabBrowsingAd,e=d.prototype,f=d.extend({initialize:function(a,b){e.initialize.call(this,a,b)},getDisplayName:function(){return this.get("display_name")},setDisplayName:function(a,b){return this.set("display_name",a,b)},getFauxTabs:function(){return this.get("faux_tabs")},setFauxTabs:function(a,b){return this.set("faux_tabs",a,b)},getHiResUniversalLogo:function(){return this.get("hi_res_universal_logo")},setHiResUniversalLogo:function(a,b){return this.set("hi_res_universal_logo",a,b)},getLegacyLogo:function(){return this.get("logo")},setLegacyLogo:function(a,b){return this.set("logo",a,b)},getSearchAdapterUrl:function(){return this.get("search_adapter_url")},setSearchAdapterUrl:function(a,b){return this.set("search_adapter_url",a,b)},getDeprecatedLogo:function(){return this.get("tab_logo")},setDeprecatedLogo:function(a,b){return this.set("tab_logo",a,b)},getTrackingHash:function(){return this.get("tracking_hash")},setTrackingHash:function(a,b){return this.set("tracking_hash",a,b)},getUniversalLogo:function(){return this.get("universal_logo")},setUniversalLogo:function(a,b){return this.set("universal_logo",a,b)},getSearchMode:function(){return this.get("search_mode")},setSearchMode:function(a,b){return this.set("search_mode",a,b)},getDisplayPlacement:function(){return this.get("display_placement")},setDisplayPlacement:function(a,b){return this.set("display_placement",a,b)},defaults:function(){return{id:0,display_name:null,faux_tabs:null,hi_res_universal_logo:null,logo:null,search_adapter_url:null,tab_logo:null,tracking_hash:null,universal_logo:null,url:null,position:0,selected:!1,visited:!1}}},{});c.ns("models.tabBrowsingAd.db5",f)}(window);
//# sourceMappingURL=db5.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=b.shared.collections.tabBrowsingAds,e=b.shared.models.tabBrowsingAd.db5,f=d.extend({constructor:function(a,b){d.call(this,a,b)},model:e},{});c.ns("collections.tabBrowsingAds.db5",f)}(window);
//# sourceMappingURL=db5.nano.js.map

!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=d.Model.extend({initialize:function(){},getLogoUrl:function(){return this.get("logo_url")},setLogoUrl:function(a,b){return this.set("logo_url",a,b)},getDisplayText:function(){return this.get("display_text")},setDisplayText:function(a,b){return this.set("display_text",a,b)},isSelected:function(){return this.get("selected")},setSelected:function(a,b){return this.set("selected",a,b)},defaults:function(){return{logo_url:e.DEFAULT_LOGO_URL,display_text:e.DEFAULT_DISPLAY_TEXT,selected:!0}}},{DEFAULT_DISPLAY_TEXT:"Click Now",DEFAULT_LOGO_URL:"http://i.slimg.com/core-sites/bbus/MVCView/Page/TabBrowsing/DB5/start-tab-click-now.png"});c.ns("models.startTab",e)}(window);
//# sourceMappingURL=startTab.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a._,f=b.dates,g=b.dependenciesInjection,h=b.functional,i=b.strings,j=b.shared.collections.tabBrowsingAds.db5,k=b.shared.models.searchData,l=d.Model.extend({initialize:function(a,b){this.containerEl=a.el,g.injectDependenciesWith(this,this.getDependencies(),b?b.dependencies:null),this.bindMethods().attach()},containerEl:null,dropdownAds:null,omnitureData:null,searchData:null,tabAds:null,getOtherDataQS:function(){return this.get("otherDataQS")},setOtherDataQS:function(a,b){return this.set("otherDataQS",a,b)},getSearchDataQS:function(){return this.get("searchDataQS")},setSearchDataQS:function(a,b){return this.set("searchDataQS",a,b)},getUnknownDataQS:function(){return this.get("unknownDataQS")},setUnknownDataQS:function(a,b){return this.set("unknownDataQS",a,b)},getDatesText:function(){var a,b,c="",d=!1;switch(this.getSearchMode()){case k.SEARCH_MODE_AIR:d=!0;case k.SEARCH_MODE_AIRFLEX:case k.SEARCH_MODE_CAR:case k.SEARCH_MODE_HOLIDAY:case k.SEARCH_MODE_HOTEL:case k.SEARCH_MODE_VACATION_PACKAGES:case k.SEARCH_MODE_VACATION_RENTALS:a=this.searchData.getDate1(),b=this.searchData.getDate2(),d&&this.searchData.isOneway()&&a?c=f.formatDate("D M d",a):a&&b&&(c=f.formatDate("D M d",a)+" - "+f.formatDate("D M d",b));break;case k.SEARCH_MODE_CRUISE:c=f.formatDate("M yy",this.searchData.getCruiseDeparture())}return c},getHeadline:function(){return this.getOtherDataQS().headline},getLocationsFullText:function(){var a,b,c="";switch(this.getSearchMode()){case k.SEARCH_MODE_AIR:case k.SEARCH_MODE_AIRFLEX:case k.SEARCH_MODE_HOLIDAY:case k.SEARCH_MODE_VACATION_PACKAGES:a=this.searchData.getLocation1FullName(),b=this.searchData.getLocation2FullName(),a&&b&&(c=a+" to "+b);break;case k.SEARCH_MODE_CAR:case k.SEARCH_MODE_HOTEL:case k.SEARCH_MODE_VACATION_RENTALS:c=this.searchData.getLocation2FullName();break;case k.SEARCH_MODE_CRUISE:c=this.searchData.getCruiseLocation()}return c},getLocationsShortText:function(){var a,b,c="";switch(this.getSearchMode()){case k.SEARCH_MODE_AIR:case k.SEARCH_MODE_AIRFLEX:case k.SEARCH_MODE_HOLIDAY:case k.SEARCH_MODE_VACATION_PACKAGES:a=this.searchData.getLocation1ShortName(),b=this.searchData.getLocation2ShortName(),a&&b&&(c=a+" to "+b);break;case k.SEARCH_MODE_CAR:case k.SEARCH_MODE_HOTEL:case k.SEARCH_MODE_VACATION_RENTALS:c=this.searchData.getLocation2ShortName();break;case k.SEARCH_MODE_CRUISE:c=this.searchData.getCruiseLocation()}return c},getDestinationShortText:function(){return this.getSearchMode()===k.SEARCH_MODE_CRUISE?this.searchData.getCruiseLocation():this.searchData.getLocation2ShortName()},getDestinationCityName:function(){return(this.getDestinationShortText()||"").replace(/, [A-Z]{2}$/,"")},getQueryString:function(){var a=e.extend({},this.getUnknownDataQS(),this.getOtherDataQS(),this.getSearchDataQS()),c={};return e.each(a,function(a,b){e.isNull(a)||(c[b]=a)}),delete c.search_mode,delete c.sm,b.pageData.queryString=c,c},isOneWay:function(){return!!this.getSearchDataQS().oneway},loadPageDataFromQueryString:function(){var b,c=a.location.search,d=a.location.hash,f=this.getSearchMode();return k.isValidMode(f)?(this.trigger(l.ON_PAGE_DATA_INIT,{trigger:this}),this.attributes=this.defaults(),"#"===d[0]&&(d=d.substr(1)),b=e.extend(i.parseQueryString(c),i.parseQueryString(d)),e.each(b,function(a,b){e.has(this.attributes.searchDataQS,b)?this.attributes.searchDataQS[b]=a:e.has(this.attributes.otherDataQS,b)?this.attributes.otherDataQS[b]=a:this.attributes.unknownDataQS[b]=a},this),this.attributes.searchDataQS.mode=f,delete this.attributes.unknownDataQS.search_mode,delete this.attributes.unknownDataQS.sm,this.searchData.mode=f,this.trigger(l.ON_PAGE_DATA_LOADED,{trigger:this}),this):(this.trigger(l.INVALID_SEARCH_MODE,{trigger:this}),this)},onSearchDataChange:function(){this.updateQueryStringWithSearchData()},onWindowResize:function(){this.trigger(l.ON_WINDOW_RESIZE,{trigger:this})},bindMethods:function(){return h.bindMethods(this,["onSearchDataChange","onWindowResize"]),this},defaults:function(){var a={};return e.each(k.SUPPORTED_QUERY_STRINGS,function(b){a[b]=null}),e.each(k.DEPRECATED_QUERY_STRING,function(b){a[b]=null}),a.mode=null,{containerEl:c.getBody(),otherDataQS:{adIds:null,af:null,alert:null,allow_framed:null,bb_affiliate:null,ctm:null,e1:null,fare_id:null,maxWindow:null,nl_cs:null,nltv:null,noInstr:null,oppLanderId:null,pt:null,r:null,selectedAdId:null,showStep2AsPopunder:null,source:null,suppress_dart_ads:null,suppress_exit_dhtml:null,take_action:null,u:null,dtrk:null,dpop:null,headline:null},searchDataQS:a,unknownDataQS:{}}},getDependencies:function(){return{dropdownAds:function(){return new j([],{comparator:function(a){return a.get("rank")}})},searchData:function(){return new k},tabAds:function(){return new j([])}}},updateOmnitureAdImpressions:function(){var a=this;return a.omnitureData.adImpressionIds=[],a.tabAds.each(function(b){a.omnitureData.adImpressionIds.push(b.getId())}),this},updateQueryStringWithSearchData:function(){var a=this.getSearchDataQS(),b=this.getSearchMode();return e.each(a,function(c,d){var g,h,i;"mode"!==d&&(g=k.getAttributeNameForQueryString(b,d),a[d]=null,g&&(h=k.getQueryStringFromAlias(d),i=this.searchData.get(g),a[h]=null,e.isNull(i)||e.isUndefined(i)||(e.contains(k.OTHER_ATTRIBUTES,g)?a[h]=i:e.contains(k.BOOLEAN_ATTRIBUTES,g)?a[h]=i?1:0:e.contains(k.DATE_ATTRIBUTES,g)?"d3"===g?a[h]=f.formatDate("yy-mm-01",i):a[g]=i.getTime()/1e3:e.contains(k.LOCATION_ATTRIBUTES,g)?(i.id&&(a[g]=i.id),e.contains(["slocation1","slocation2"],h)&&i.sid?a[h]=i.sid:h!==g&&i.name&&(a[h]=i.name)):e.contains(k.CRUISE_LOCATION_ATTRIBUTES,g)&&("cruise_destination_id"==h?a[h]=i.id:i.name&&(a[h]=i.name)))))},this),this.getQueryString(),this}},{ON_ADS_FOUND:i.uniqueId(),ON_ADS_NOT_FOUND:i.uniqueId(),ON_ADS_FETCHING:i.uniqueId(),ON_OTHER_DATA_FETCHING:i.uniqueId(),ON_OTHER_DATA_LOADED:i.uniqueId(),ON_OMNITURE_DATA_LOADED:i.uniqueId(),ON_INVALID_SEARCH_MODE:i.uniqueId(),ON_PAGE_DATA_INIT:i.uniqueId(),ON_PAGE_DATA_LOADED:i.uniqueId(),ON_WINDOW_RESIZE:i.uniqueId()});c.ns("models.pages.tabBrowsing",l)}(window);
//# sourceMappingURL=tabBrowsing.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a._,f=b.Browser,g=b.functional,h=b.strings,i=b.shared.models.pages.tabBrowsing,j=b.shared.models.searchData,k=b.shared.recommendationsClient,l=i.extend({initialize:function(a,b){i.prototype.initialize.apply(this,arguments)},isMobileSafari:!(!f.safari||!f.Platform.ios),isFauxTabAd:!1,fetchAds:function(){return d.ajax({url:"/tab-browsing/db5/getMain.html",data:this.getQueryString(),beforeSend:this.onBeforeAdsFetch,success:this.onAdsRetrieval,async:!this.isMobileSafari}),this},fetchOtherData:function(){return this.trigger(l.ON_OTHER_DATA_FETCHING,{trigger:this}),d.ajax({url:"/tab-browsing/db5/getOthers.html",data:this.getQueryString(),success:this.onOtherDataRetrieval}),this},fetchFauxTabDartAd:function(a){var b=this;return d.ajax({url:"/tab-browsing/db5/getFauxTabDartAd.html",data:this.getQueryString(),success:function(c){b.onFauxTabDartAdRetrieval(a,c)}}),this},getAffiliateName:function(){return b.pageData.db5TabBrowsing.af},getSearchMode:function(){return b.pageData.mode},removeAdIdsFromModel:function(){var a=this.getOtherDataQS();return a&&a.adIds&&(a.adIds=null),this},onAdsRetrieval:function(a){this.trigger(l.ON_AFTER_AD_FETCH_AJAX_REQUEST,{trigger:this});var b={trigger:this,response:a};this.searchData.updateFromCookie(),k.fetchForLocation(this.getDestinationShortText()),a.tabs&&a.tabs.length?(this.tabAds.reset(a.tabs),this.dropdownAds.reset(a.dropdowns),this.trigger(l.ON_ADS_FOUND,b)):this.trigger(l.ON_ADS_NOT_FOUND,b)},onBeforeAdsFetch:function(a,b){this.trigger(l.ON_ADS_FETCHING,{trigger:this}),this.trigger(l.ON_BEFORE_AD_FETCH_AJAX_REQUEST,{trigger:this})},onOtherDataRetrieval:function(a){a.omniture&&(this.omnitureData=a.omniture,this.updateOmnitureAdImpressions(),this.trigger(l.ON_OMNITURE_DATA_LOADED,{trigger:this})),this.trigger(l.ON_OTHER_DATA_LOADED,{trigger:this,response:a})},onFauxTabDartAdRetrieval:function(a,b){this.trigger(l.ON_FAUX_TAB_DART_AD_DATA_LOADED,{trigger:this,response:b,adId:a})},attach:function(){return this.listenTo(this.searchData,"change",this.onSearchDataChange),this.listenTo(this.searchData,j.ON_FULL_UPDATE,this.onSearchDataChange),c.getWindow().on("resize",e.debounce(this.onWindowResize,200)),this},bindMethods:function(){return g.bindMethods(this,["onAdsRetrieval","onBeforeAdsFetch","onSearchDataChange","onWindowResize","onOtherDataRetrieval","onFauxTabDartAdRetrieval"]),this}},{METRICS_KEY_ADS_FETCHING:"ads-fetching",START_TAB_AD_ID:0,ON_FAUX_TAB_DART_AD_DATA_LOADED:h.uniqueId(),ON_BEFORE_AD_FETCH_AJAX_REQUEST:h.uniqueId(),ON_AFTER_AD_FETCH_AJAX_REQUEST:h.uniqueId()});c.ns("models.pages.tabBrowsing.db5",l)}(window);
//# sourceMappingURL=db5.nano.js.map

!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=b.domState,f=b.functional,g=b.strings,h=d.View.extend({initialize:function(){this.template=c.getTemplate(this.options.templateName),this.bindMethods().attach()},model:null,options:function(){return{shortSyntaxCutoff:480,templateName:"edit-details"}},template:null,ensureOptimalDisplay:function(){var a,b=c.getWindow().width();return e.clear(this.$el),a=c.getWidth(this.$el,"margin"),b-a<this.options.shortSyntaxCutoff&&e.add(this.$el,"shortLocations"),this},render:function(){var a=""===this.$el.html(),b=this.model.getDatesText(),c=this.model.getLocationsFullText(),d=this.model.getLocationsShortText();return this.$el.html(this.template({dates:b,longLocations:c,shortLocations:d})),this.ensureOptimalDisplay(),a&&this.$el.hide().fadeIn(),this},onClick:function(a){this.trigger(h.ON_CLICK,{trigger:this,event:a})},attach:function(){return this.$el.on("click",this.onClick),this},bindMethods:function(){return f.bindMethods(this,["onClick"]),this}},{ON_CLICK:g.uniqueId()});c.ns("views.tabBrowsing.db5.editDetails",h)}(window);
//# sourceMappingURL=editDetails.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.dependenciesInjection,g=b.shared.views.tabBrowsing.db5.editDetails,h=b.shared.models.pages.tabBrowsing.db5,i=b.strings,j=e(null,c.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=d.extend({},d.result(this,"options"),b),f.injectDependencies(this),this.attach()},model:null,options:function(){return{containerSelector:".c-edit-details"}},view:null,onAdsFound:function(){this.view.render()},onAdsNotFound:function(){this.view.render()},onClick:function(){this.trigger(j.ON_CLICK,{trigger:this})},onWindowResize:function(){this.view.ensureOptimalDisplay()},attach:function(){return this.listenTo(this.model,h.ON_ADS_NOT_FOUND,this.onAdsNotFound),this.listenTo(this.model,h.ON_ADS_FOUND,this.onAdsFound),this.listenTo(this.model,h.ON_WINDOW_RESIZE,this.onWindowResize),this.listenTo(this.view,g.ON_CLICK,this.onClick),this},getDependencies:function(){return{view:function(){return new g({el:this.model.containerEl.find(this.options.containerSelector),model:this.model})}}},STATIC:{ON_CLICK:i.uniqueId()}});c.ns("controllers.tabBrowsing.db5.editDetails",j)}(window);
//# sourceMappingURL=editDetails.nano.js.map

!function(a){"use strict";var b=a.stm,c=b.shared,d=b.shared.models.exitDHTML,e=d.prototype,f=d.extend({initialize:function(a,b){e.initialize.call(this,a,b)},defaults:function(){var a=e.defaults.call(this);return a.disableAfterTabClick=!1,a},shouldDisableAfterTabClick:function(){return this.get("disableAfterTabClick")},setDisableAfterTabClick:function(a,b){return this.set("disableAfterTabClick",a,b)}});c.ns("models.tabBrowsing.db5.exitDHTML",f)}(window);
//# sourceMappingURL=exitDHTML.nano.js.map
!function(a){"use strict";var b=a.stm,c=a._,d=b.define,e=b.shared,f=b.dependenciesInjection,g=b.shared.models.tabBrowsing.db5.exitDHTML,h=b.shared.controllers.exitDHTML,i=b.shared.logger,j=b.shared.models.pages.tabBrowsing.db5,k=b.shared.featuredSearchUtils,l=function(a){b.pageData.queryString&&b.pageData.queryString.enableExitDhtmlConsoleLogging&&i.logMessage("Exit DHTML: "+a)},m=d(null,e.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=c.extend({},c.result(this,"options"),b),f.injectDependencies(this),this.attach()},model:null,options:function(){return{}},exitDHTMLController:null,loaded:!1,onAdSelectedChange:function(a,b,d){return this.loaded?void this.exitDHTMLController.model.setEnabled(!this.shouldDisableExitDHTMLAfterTabClick(a,this.exitDHTMLController.model)):void c.delay(this.onAdSelectedChange.bind(this,a,b,d),500)},onOtherDataLoaded:function(a){a.response&&a.response.exitDHTML&&!this.exitDHTMLController.shown&&(l("Setting ad info: "+a.response.exitDHTML.enabled),this.exitDHTMLController.model.set(a.response.exitDHTML),this.exitDHTMLController.model.loadOldBBAd(),this.exitDHTMLController.view.render(),this.exitDHTMLController.attach()),this.loaded=!0},attach:function(){return this.listenTo(this.model,j.ON_OTHER_DATA_LOADED,this.onOtherDataLoaded),this.listenTo(this.model.tabAds,"change:selected",this.onAdSelectedChange),this},getDependencies:function(){return{exitDHTMLController:function(){return new h({dependencies:{model:function(){return new g({enabled:!1})}}})}}},shouldDisableExitDHTMLAfterTabClick:function(a,b){if(!a||!b)return!0;var c=k.shouldUseFauxTab(a.getFauxTabs()),d=a.getSearchMode();return c&&d&&"air"==d?!1:b.shouldDisableAfterTabClick()},STATIC:{}});e.ns("controllers.tabBrowsing.db5.exitDHTML",m)}(window);
//# sourceMappingURL=exitDHTML.nano.js.map

!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a._,f=b.shared.views.searchInput.boardBasis,g=b.shared.views.searchInput.cruiseDate,h=b.shared.views.searchInput.cruiseLength,i=b.shared.views.searchInput.cruiseLine,j=b.shared.views.searchInput.cruiseLocation,k=b.shared.views.searchInput.date1,l=b.shared.views.searchInput.date2,m=b.dependenciesInjection,n=b.shared.views.searchInput.flexDays,o=b.functional,p=b.shared.views.searchInput.holidayLocation1,q=b.shared.views.searchInput.location1,r=b.shared.views.searchInput.location2,s=b.shared.views.searchInput.nonStop,t=b.shared.views.searchInput.numChildren,u=(b.shared.views.searchInput.over55,b.shared.views.searchInput.pricePerPerson),v=b.shared.views.searchInput.provider,w=b.shared.views.searchInput.rooms,x=b.shared.views.searchInput.searchType,y=b.shared.views.searchInput.serviceClass,z=b.strings,A=b.shared.models.searchData,B=b.shared.views.searchInput.time1,C=b.shared.views.searchInput.time2,D=b.shared.views.searchInput.travelers,E=d.View.extend({initialize:function(){this.date2ContainerEl=this.$(this.options.date2ContainerSelector),this.errorMessagesEl=this.$(this.options.errorMessagesSelector),m.injectDependencies(this),this.bindMethods().attach()},boardBasisView:null,cruiseDepartureView:null,cruiseLengthView:null,cruiseLineView:null,cruiseLocationView:null,date1View:null,date2ContainerEl:null,date2View:null,driverAgeView:null,errorMessagesEl:null,flexDaysView:null,holidayLocation1View:null,location1View:null,location2View:null,model:null,nonstopView:null,numChildrenView:null,onewayView:null,options:function(){return{boardBasisSelector:"[data-stm-role=boardBasis]",cruiseLengthSelector:"[data-stm-role=cruiseLength]",cruiseLineSelector:"[data-stm-role=cruiseLine]",cruiseLocationSelector:"[data-stm-role=cruiseLocation]",date1Selector:"[data-stm-role=date1]",date2Selector:"[data-stm-role=date2]",driverAgeSelector:"[data-stm-role=driver_age]",flexDaysSelector:"[data-stm-role=flexDays]",holidayLocation1Selector:"[data-stm-role=holidayLocation1]",location1Selector:"[data-stm-role=location1]",location2Selector:"[data-stm-role=location2]",nonstopSelector:"[data-stm-role=nonstop]",numChildrenSelector:"[data-stm-role=numChildren]",onewaySelector:"[data-stm-role=flightType]",over55Selector:"[data-stm-role=over_55]",pricePerPersonSelector:"[data-stm-role=pricePerPerson]",providerSelector:"[data-stm-role=provider]",roomsSelector:"[data-stm-role=rooms]",serviceClassSelector:"[data-stm-role=class]",time1Selector:"[data-stm-role=time1]",time2Selector:"[data-stm-role=time2]",travelersSelector:"[data-stm-role=travelers]",travelMonthSelector:"[data-stm-role=travelMonth]",closeIconSelector:".close-icon",date2ContainerSelector:"[data-stm-role=date2Block]",errorMessagesSelector:".errors",submitSelector:".submit"}},over55View:null,pricerPerPersonView:null,providerView:null,roomsView:null,serviceClassView:null,time1View:null,time2View:null,travelersView:null,haveErrors:function(){var a=this.model.validateByMode();return a&&a.length?(this.errorMessagesEl.html("").hide(),e.each(a,function(a){this.errorMessagesEl.append("<div>&raquo; "+a+"</div>")},this),this.errorMessagesEl.fadeIn(),!0):!1},hide:function(){return this.$el.fadeOut(),this},render:function(){return this.boardBasisView&&this.boardBasisView.render(),this.cruiseDepartureView&&this.cruiseDepartureView.render(),this.cruiseLengthView&&this.cruiseLengthView.render(),this.cruiseLineView&&this.cruiseLineView.render(),this.cruiseLocationView&&this.cruiseLocationView.render(),this.date1View&&this.date1View.render(),this.date2View&&this.date2View.render(),this.driverAgeView&&this.driverAgeView.render(),this.flexDaysView&&this.flexDaysView.render(),this.holidayLocation1View&&this.holidayLocation1View.render(),this.location1View&&this.location1View.render(),this.location2View&&this.location2View.render(),this.nonstopView&&this.nonstopView.render(),this.numChildrenView&&this.numChildrenView.render(),this.onewayView&&this.onewayView.render(),this.over55View&&this.over55View.render(),this.pricerPerPersonView&&this.pricerPerPersonView.render(),this.providerView&&this.providerView.render(),this.roomsView&&this.roomsView.render(),this.serviceClassView&&this.serviceClassView.render(),this.time1View&&this.time1View.render(),this.time2View&&this.time2View.render(),this.travelersView&&this.travelersView.render(),this.errorMessagesEl.hide(),this.updateDate2Container(),this},show:function(){return this.$el.fadeIn(),this},onCloseIconClick:function(){this.hide()},onOnewayChange:function(a,b,c){this.updateDate2Container()},onSubmitClick:function(){this.cruiseDepartureView&&this.cruiseDepartureView.changeHandler(),this.cruiseLengthView&&this.cruiseLengthView.changeHandler(),this.cruiseLineView&&this.cruiseLineView.changeHandler(),this.cruiseLocationView&&this.cruiseLocationView.changeHandler(),this.roomsView&&this.roomsView.changeHandler(),this.travelersView&&this.travelersView.changeHandler(),this.ServiceClassView&&this.ServiceClassView.changeHandler(),this.haveErrors()||(this.trigger(E.ON_SUCCESSFUL_UPDATE,{trigger:this}),this.hide())},attach:function(){return this.model.on("change:oneway",this.onOnewayChange),this.$el.on("click",this.options.closeIconSelector,this.onCloseIconClick),this.$el.on("click",this.options.submitSelector,this.onSubmitClick),this},bindMethods:function(){return o.bindMethods(this,["onCloseIconClick","onOnewayChange","onSubmitClick"]),this},getDependencies:function(){return{boardBasisView:function(){var a=this.$(this.options.boardBasisSelector);return a.length?new f({el:a,model:this.model}):null},cruiseDepartureView:function(){var a=this.$(this.options.travelMonthSelector);return a.length?new g({el:a,model:this.model}):null},cruiseLineView:function(){var a=this.$(this.options.cruiseLineSelector);return a.length?new i({el:a,model:this.model}):null},cruiseLengthView:function(){var a=this.$(this.options.cruiseLengthSelector);return a.length?new h({el:a,model:this.model}):null},cruiseLocationView:function(){var a=this.$(this.options.cruiseLocationSelector);return a.length?new j({el:a,model:this.model}):null},date1View:function(){var a=this.$(this.options.date1Selector);return a.length?new k({el:a,dateFormat:a.attr("placeholder").replace("yyyy","yy"),model:this.model}):null},date2View:function(){var a=this.$(this.options.date2Selector);return a.length?new l({el:a,dateFormat:a.attr("placeholder").replace("yyyy","yy"),model:this.model}):null},flexDaysView:function(){var a=this.$(this.options.flexDaysSelector);return a.length?new n({el:a,model:this.model}):null},holidayLocation1View:function(){var a=this.$(this.options.holidayLocation1Selector);return a.length?new p({el:a,model:this.model}):null},location1View:function(){var a=this.$(this.options.location1Selector);return a.length?new q({el:a,mode:this.model.mode,model:this.model}):null},location2View:function(){var a=this.$(this.options.location2Selector);return a.length?new r({el:a,mode:this.model.mode,model:this.model}):null},nonstopView:function(){var a=this.$(this.options.nonstopSelector);return a.length?new s({el:a,model:this.model}):null},numChildrenView:function(){var a=this.$(this.options.numChildrenSelector);return a.length?new t({el:a,model:this.model}):null},onewayView:function(){var a=this.$(this.options.onewaySelector);return a.length?new x({el:a,model:this.model}):null},pricePerPersonView:function(){var a=this.$(this.options.pricePerPersonSelector);return a.length?new u({el:a,model:this.model}):null},providerView:function(){var a=this.$(this.options.providerSelector);return a.length?new v({el:a,model:this.model}):null},roomsView:function(){var a=this.$(this.options.roomsSelector);return a.length?new w({el:a,model:this.model}):null},serviceClassView:function(){var a=this.$(this.options.serviceClassSelector);return a.length?new y({el:a,model:this.model}):null},time1View:function(){var a=this.$(this.options.time1Selector);return a.length?new B({el:a,model:this.model}):null},time2View:function(){var a=this.$(this.options.time2Selector);return a.length?new C({el:a,model:this.model}):null},travelersView:function(){var a=this.$(this.options.travelersSelector);return a.length?new D({el:a,model:this.model}):null}}},updateDate2Container:function(){return this.model.mode===A.SEARCH_MODE_AIR&&this.date2ContainerEl.toggle(this.model.isRoundTrip()),this}},{ON_SUCCESSFUL_UPDATE:z.uniqueId()});c.ns("views.tabBrowsing.db5.searchWidget",E)}(window);
//# sourceMappingURL=searchWidget.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.dependenciesInjection,g=b.shared.models.pages.tabBrowsing.db5,h=b.shared.views.tabBrowsing.db5.searchWidget,i=b.strings,j=e(null,c.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=d.extend({},d.result(this,"options"),b),f.injectDependencies(this),this.attach()},model:null,options:function(){return{containerSelector:".c-search-widget"}},view:null,hide:function(){return this.view.hide(),this},show:function(){return this.view.render().show(),this},onAdsNotFound:function(){this.model.getNewPlatformRedirectUrl()||(this.show(),this.view.haveErrors())},onSuccessfulUpdate:function(){this.trigger(j.ON_SUCCESSFUL_UPDATE,{trigger:this})},attach:function(){return this.listenTo(this.model,g.ON_ADS_NOT_FOUND,this.onAdsNotFound),this.listenTo(this.view,h.ON_SUCCESSFUL_UPDATE,this.onSuccessfulUpdate),this},getDependencies:function(){return{view:function(){return new h({el:this.model.containerEl.find(this.options.containerSelector),model:this.model.searchData})}}},STATIC:{ON_SUCCESSFUL_UPDATE:i.uniqueId()}});c.ns("controllers.tabBrowsing.db5.searchWidget",j)}(window);
//# sourceMappingURL=searchWidget.nano.js.map

!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=b.functional,f=b.strings,g=d.View.extend({initialize:function(){this.bindMethods().attach()},model:null,options:function(){return{logoSelector:"> .logo > img"}},render:function(){return this},onLogoClick:function(a){this.trigger(g.ON_LOGO_CLICK,{trigger:this,event:a})},attach:function(){return this.$el.on("click",this.options.logoSelector,this.onLogoClick),this},bindMethods:function(){return e.bindMethods(this,["onLogoClick"]),this}},{ON_LOGO_CLICK:f.uniqueId()});c.ns("views.tabBrowsing.db5.header",g)}(window);
//# sourceMappingURL=header.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.dependenciesInjection,g=b.shared.views.tabBrowsing.db5.header,h=b.strings,i=e(null,c.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=d.extend({},d.result(this,"options"),b),f.injectDependencies(this),this.attach()},model:null,options:function(){return{containerSelector:".c-header"}},view:null,onLogoClick:function(){this.trigger(i.ON_LOGO_CLICK,{trigger:this})},attach:function(){return this.listenTo(this.view,g.ON_LOGO_CLICK,this.onLogoClick),this},getDependencies:function(){return{view:function(){return new g({el:this.model.containerEl.find(this.options.containerSelector),model:this.model})}}},STATIC:{ON_LOGO_CLICK:h.uniqueId()}});c.ns("controllers.tabBrowsing.db5.header",i)}(window);
//# sourceMappingURL=header.nano.js.map

!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a._,f=b.domState,g=b.strings,h=d.View.extend({initialize:function(a){this.options=e.extend({},this.options,a),this.template=c.getTemplate(this.options.templateName),this.attach()},model:null,options:function(){return{logoSelector:"> .logo > img",templateName:"default-content"}},template:null,hide:function(){return this.$el.hide(),this},render:function(){var a=this.template({sitesFound:this.model.tabAds.length,locations:this.model.getLocationsFullText(),dates:this.model.getDatesText(),destination:this.model.getDestinationShortText()});return f.clear(this.$el),this.$el.html(a),this},show:function(){return this.$el.is(":not(:visible)")&&this.$el.fadeIn(),this},showInProgressState:function(){return f.add(this.$el,"inProgress"),this},onLogoClick:function(a){this.trigger(h.ON_LOGO_CLICK,{trigger:this,event:a})},attach:function(){return this.$el.on("click",this.options.logoSelector,this.onLogoClick.bind(this)),this}},{ON_LOGO_CLICK:g.uniqueId()});c.ns("views.tabBrowsing.db5.defaultContent",h)}(window);
//# sourceMappingURL=defaultContent.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.shared.views.tabBrowsing.db5.defaultContent,g=b.dependenciesInjection,h=b.shared.models.pages.tabBrowsing.db5,i=b.strings,j=e(null,c.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=d.extend({},d.result(this,"options"),b),g.injectDependencies(this),this.attach()},model:null,options:function(){return{containerSelector:".c-default-content"}},view:null,show:function(){return this.view.render().show(),this},showInProgressState:function(){return this.view.render().showInProgressState().show(),this},onAdRemoval:function(a,b){var c=b.getActiveAd();c||this.show()},onAdSelectedChange:function(){this.model.tabAds.findWhere({selected:!0})?this.view.hide():this.view.show()},onAdsFetching:function(){this.showInProgressState()},onAdsFound:function(){this.show()},onLogoClick:function(){this.trigger(j.ON_LOGO_CLICK,{trigger:this})},attach:function(){return this.listenTo(this.model,h.ON_ADS_FETCHING,this.onAdsFetching),this.listenTo(this.model,h.ON_ADS_FOUND,this.onAdsFound),this.listenTo(this.model.tabAds,"change:selected",this.onAdSelectedChange),this.listenTo(this.model.tabAds,"remove",this.onAdRemoval),this.listenTo(this.view,f.ON_LOGO_CLICK,this.onLogoClick),this},getDependencies:function(){return{view:function(){return new f({el:this.model.containerEl.find(this.options.containerSelector),model:this.model})}}},STATIC:{ON_LOGO_CLICK:i.uniqueId()}});c.ns("controllers.tabBrowsing.db5.defaultContent",j)}(window);
//# sourceMappingURL=defaultContent.nano.js.map

!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=b.domState,f=b.shared.views.dartAd,g=b.Browser,h=b.shared.models.pages.tabBrowsing.db5,i=d.View.extend({initialize:function(){},model:null,options:function(){return{}},addDartAd:function(a,b){var c,d=i.DART_AD_PREFIX+b;return this.$el.append("<div class='"+d+"'>"+a+"</div>"),c=new f({el:this.$("."+d+"> .mvcView.bBDartAd")}),c.render(),this.render()},checkDartAdExists:function(a){return 0!==this.$el.has("."+i.DART_AD_PREFIX+a).length},hide:function(){return this.$el.hide(),this},render:function(){return e.clear(this.$el),this.model.isFauxTabAd?(e.add(this.$el,"onCenterBottom"),g.Platform.ios||g.Platform.android?e.add(this.$el,"tablet"):e.add(this.$el,"desktop")):c.getWindow().width()>i.MIN_WIDTH_TO_SHOW_ON_RIGHT&&e.add(this.$el,"onRight"),this},show:function(){return this.$el.show(),this},showDartAd:function(a){return this.model.isFauxTabAd=a!==h.START_TAB_AD_ID,this.$el.find("."+i.DART_AD_PREFIX+a).show(),this.$el.find("."+i.DART_AD_PREFIX+a).siblings().hide(),this.render()}},{MIN_WIDTH_TO_SHOW_ON_RIGHT:1130,DART_AD_PREFIX:"dart-"});c.ns("views.tabBrowsing.db5.googleFP",i)}(window);
//# sourceMappingURL=googleFP.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.browser,g=b.dependenciesInjection,h=b.shared.featuredSearchUtils,i=b.shared.views.tabBrowsing.db5.googleFP,j=b.shared.models.pages.tabBrowsing.db5,k=b.shared.models.searchData,l=e(null,c.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=d.extend({},d.result(this,"options"),b),g.injectDependencies(this),this.attach()},model:null,options:function(){return{containerSelector:".c-google-fp"}},view:null,show:function(){this.view.render().show()},onAdSelectedChange:function(a,c){if(!b.pageData.db5TabBrowsing.hideDisplayAd){if(!c)return this.show(),void this.view.showDartAd(j.START_TAB_AD_ID);if(!this.shouldShowAdSpecificDART(a))return void this.view.hide();var d=a.getId();this.view.checkDartAdExists(d)?this.view.showDartAd(d):this.model.fetchFauxTabDartAd(d),this.show()}},onAdsFetching:function(){this.show()},onOtherDataLoaded:function(a){var c;b.pageData.db5TabBrowsing.hideDisplayAd||(c=this.view.checkDartAdExists(j.START_TAB_AD_ID),!c&&a.response&&a.response.dart&&(this.view.addDartAd(a.response.dart,j.START_TAB_AD_ID),this.view.showDartAd(j.START_TAB_AD_ID)))},onFauxTabDartAdLoaded:function(a){a.response&&(this.view.addDartAd(a.response,a.adId),this.view.showDartAd(a.adId))},onWindowResize:function(){this.view.render()},attach:function(){return this.listenTo(this.model,j.ON_ADS_FETCHING,this.onAdsFetching),this.listenTo(this.model,j.ON_OTHER_DATA_LOADED,this.onOtherDataLoaded),this.listenTo(this.model,j.ON_WINDOW_RESIZE,this.onWindowResize),this.listenTo(this.model,j.ON_FAUX_TAB_DART_AD_DATA_LOADED,this.onFauxTabDartAdLoaded),this.listenTo(this.model.tabAds,"change:selected",this.onAdSelectedChange),this},getDependencies:function(){return{view:function(){return new i({el:this.model.containerEl.find(this.options.containerSelector),model:this.model})}}},shouldShowAdSpecificDART:function(a){var b=h.shouldUseFauxTab(a.get("faux_tabs")),c=a.getSearchMode()?a.getSearchMode():"",d=f.safari&&f.Platform.ios;return b&&(d||c===k.SEARCH_MODE_AIR)?!0:!1},STATIC:{}});c.ns("controllers.tabBrowsing.db5.googleFP",l)}(window);
//# sourceMappingURL=googleFP.nano.js.map

!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a._,f=b.Browser,g=b.domState,h=b.functional,i=b.strings,j=d.View.extend({initialize:function(){this.template=c.getTemplate(this.options.templateName),this.bindMethods().attach()},className:"c-individual-ad",model:null,options:function(){return{advertiserSelector:"> .instructions .advertiser",instructionsSelector:"> .instructions",interstitialSelector:"> .interstitial",templateName:"individual-ad"}},hasRendered:!1,hasShownInterstitial:!1,template:null,ensureOptimalDisplay:function(){return g.clear(this.$el),this.model.isSelected()||g.add(this.$el,"isNotSelected"),this},render:function(){return this.hasRendered||(this.$el.html(this.template({browser:f,displayName:this.model.get("display_name"),tip:this.getTip(),universalLogo:this.model.getUniversalLogo(),searchMode:this.model.getSearchMode()})),f.safari&&f.Platform.ios&&this.$el.addClass("ios"),a.scrollTo(0,0),this.hasRendered=!0),this.ensureOptimalDisplay()},onAdvertiserClick:function(){this.trigger(j.ON_ADVERTISER_CLICK,{trigger:this})},onInstructionsClick:function(){this.trigger(j.ON_INSTRUCTIONS_CLICK,{trigger:this})},attach:function(){return this.$el.on("click",this.options.advertiserSelector,this.onAdvertiserClick),this.$el.on("click",this.options.instructionsSelector,this.onInstructionsClick),this},bindMethods:function(){return h.bindMethods(this,["onAdvertiserClick","onInstructionsClick"]),this},getTip:function(){var a=["Travel Tip #1: Compare! Most travelers check more than one site and save.","Travel Tip #2: Be flexible! Prices can vary from one day to the next.","Travel Tip #3: Pack light! Skip checked-baggage fees with a carry-on.","Travel Tip #4: Do the math! Airlines charge different fees for different items.","Travel Tip #5: Explore all options! Not all prices and perks are created equal."];return a[e.random(a.length-1)]},showInstructions:function(){return this.$(this.options.instructionsSelector).show(),this},showInterstitial:function(){var a=this.$("iframe"),b=this.$(this.options.interstitialSelector),c=0,d=function(){b.fadeOut()},g=function(){if(c++)d();else if(!f.ie)try{a.contents().find("#usdDebug").length&&d()}catch(b){}};return this.hasShownInterstitial||(b.show(),a.on("load",g),e.delay(d,1e4),this.hasShownInterstitial=!0),this}},{ON_ADVERTISER_CLICK:i.uniqueId(),ON_INSTRUCTIONS_CLICK:i.uniqueId()});c.ns("views.tabBrowsing.db5.individualAd",j)}(window);
//# sourceMappingURL=individualAd.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=b.browser,f=d.View.extend({initialize:function(){},model:null,options:function(){return{}},append:function(a){return this.$el.append(a.$el),this},render:function(){var a,b;return e.safari&&e.Platform.ios||(a=c.getWindow().height(),b=parseInt(this.$el.css("margin-top"),10),this.$el.css("height",a-b-4+"px")),this}},{});c.ns("views.tabBrowsing.db5.adDisplay",f)}(window);
//# sourceMappingURL=adDisplay.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a._,f=b.define,g=b.Browser,h=b.shared.views.tabBrowsing.db5.adDisplay,i=b.dependenciesInjection,j=b.shared.featuredSearchUtils,k=b.shared.views.tabBrowsing.db5.individualAd,l=b.shared.orderedHash,m=b.shared.models.pages.tabBrowsing.db5,n=b.Popup,o=f(null,c.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=e.extend({},e.result(this,"options"),b),this.itemViews=new l,this.popups={},i.injectDependencies(this),this.attach()},containerView:null,itemViews:null,model:null,options:function(){return{containerSelector:".c-ad-display",itemClass:k}},popups:null,ensureOptimalDisplay:function(){this.containerView.render()},showAd:function(a){var b=j.shouldUseFauxTab(a.model.get("faux_tabs"));return a.render(),b?this.popFauxTab(a):this.useIFrame(a),this},onAdSelectedChange:function(a,b){var c=this.itemViews.get(a.getId());b?this.showAd(c):c.ensureOptimalDisplay()},onAdsFetching:function(){this.reset()},onAdsFound:function(){this.reset(),this.model.tabAds.each(this.createItemView,this),this.model.dropdownAds.each(this.createItemView,this),this.ensureOptimalDisplay()},onAdvertiserClick:function(a){this.showAd(a.trigger)},onInstructionsClick:function(a){this.popFauxTab(a.trigger)},onWindowResize:function(){this.ensureOptimalDisplay()},attach:function(){return this.listenTo(this.model,m.ON_ADS_FETCHING,this.onAdsFetching),this.listenTo(this.model,m.ON_ADS_FOUND,this.onAdsFound),this.listenTo(this.model,m.ON_WINDOW_RESIZE,this.onWindowResize),this.listenTo(this.model.tabAds,"change:selected",this.onAdSelectedChange),this},createItemView:function(a){var b=new this.options.itemClass({model:a});return b.ensureOptimalDisplay(),this.containerView.append(b),this.itemViews.append(a.getId(),b),this.listenTo(b,k.ON_ADVERTISER_CLICK,this.onAdvertiserClick),this.listenTo(b,k.ON_INSTRUCTIONS_CLICK,this.onInstructionsClick),this},getDependencies:function(){return{containerView:function(){return new h({el:this.model.containerEl.find(this.options.containerSelector),model:this.model})}}},getPopupFor:function(a){var b=this.popups[a];return(!b||b.popupWindow&&b.popupWindow.closed)&&(b=new n(null,{name:a,otherFeatures:{toolbar:"yes",location:"yes"}})),this.popups[a]=b,b},popFauxTab:function(a){var b="advertiser"+a.model.getId(),c=this.getPopupFor(b);if(!c.popupWindow||c.popupWindow.closed){var d=this.getFauxLocationAndDimensions();c.options.height=d.height,c.options.width=d.width,c.options.left=d.left,c.options.top=d.top,c.url=a.model.getInterstitialUrl(),g.Platform.ios&&g.safari&&(c.options.popunder=!0),c.tryPop()}else c.popupWindow.focus();return a.showInstructions(),this},getFauxLocationAndDimensions:function(){var b=this.containerView.$el,d=b.offset().top,f=b.height(),h=e.chain([a.screenX,a.screenLeft]).without(void 0).first().value(),i=e.chain([a.screenY,a.screenTop]).without(void 0).first().value(),j=c.getWindow().height(),k=c.getWindow().width(),l=e.chain([a.outerHeight,document.body.offsetHeight]).without(void 0).first().value(),m=l-j,n=0,p=0,q=0,r=0;g.ie?(n=o.FAUX_TAB_OFFSET_ADDITIONAL_LEFT_IE,p=o.FAUX_TAB_OFFSET_ADDITIONAL_TOP_IE,q=o.FAUX_TAB_WIDTH_ADJUSTMENT_IE,r=o.FAUX_TAB_HEIGHT_ADJUSTMENT_IE):g.firefox?(n=o.FAUX_TAB_OFFSET_ADDITIONAL_LEFT_FF,p=o.FAUX_TAB_OFFSET_ADDITIONAL_TOP_FF,q=o.FAUX_TAB_WIDTH_ADJUSTMENT_FF,r=o.FAUX_TAB_HEIGHT_ADJUSTMENT_FF):g.chrome&&(n=o.FAUX_TAB_OFFSET_ADDITIONAL_LEFT_CHROME,p=o.FAUX_TAB_OFFSET_ADDITIONAL_TOP_CHROME,q=o.FAUX_TAB_WIDTH_ADJUSTMENT_CHROME,r=o.FAUX_TAB_HEIGHT_ADJUSTMENT_CHROME);var s={height:f-m+r,width:k+q,left:h+n,top:i+m+d+p};return s},reset:function(){return this.itemViews.invoke("remove").invoke("off").reset(),this.popups={},this},useIFrame:function(a){var b=a.$("iframe");return b.length?b.attr("src")||b.attr("src",this.getLandingUrl(a.model)):(b=d("<iframe />").attr("src",this.getLandingUrl(a.model)),a.$el.prepend(b)),a.showInterstitial(),this},getLandingUrl:function(a){return a.getUrl()},STATIC:{FAUX_TAB_OFFSET_ADDITIONAL_LEFT_CHROME:5,FAUX_TAB_OFFSET_ADDITIONAL_LEFT_FF:10,FAUX_TAB_OFFSET_ADDITIONAL_LEFT_IE:10,FAUX_TAB_OFFSET_ADDITIONAL_TOP_CHROME:-5,FAUX_TAB_OFFSET_ADDITIONAL_TOP_FF:-10,FAUX_TAB_OFFSET_ADDITIONAL_TOP_IE:-10,FAUX_TAB_WIDTH_ADJUSTMENT_CHROME:-15,FAUX_TAB_WIDTH_ADJUSTMENT_FF:-15,FAUX_TAB_WIDTH_ADJUSTMENT_IE:-20,FAUX_TAB_HEIGHT_ADJUSTMENT_CHROME:20,FAUX_TAB_HEIGHT_ADJUSTMENT_FF:0,FAUX_TAB_HEIGHT_ADJUSTMENT_IE:-15}});c.ns("controllers.tabBrowsing.db5.adDisplay",o)}(window);
//# sourceMappingURL=adDisplay.nano.js.map

!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a.jQuery,f=b.domState,g=b.functional,h=d.View.extend({initialize:function(a){this.options=_.extend(this.options,a),this.template=c.getTemplate(this.options.templateName),this.bindMethods().attach()},className:"c-individual-tab",model:null,options:function(){return{logoSelector:"> .logo",templateName:"individual-tab"}},template:null,fadeIn:function(a){return this.$el.fadeIn({done:a}),this},hide:function(){return this.$el.hide(),this},render:function(){var a,b=this.template({name:this.model.get("display_name"),index:this.options.index}),c=e("<img />");return this.$el.html(b),a=this.$(this.options.logoSelector),f.clear(this.$el),this.model.getUniversalLogo()?(c.attr("src",this.model.getUniversalLogo()).appendTo(a),f.add(this.$el,"universalLogoType")):this.model.getDeprecatedLogo()?(c.attr("src",this.model.getDeprecatedLogo()).appendTo(a),f.add(this.$el,"deprecatedLogoType")):this.model.getLegacyLogo()?(c.attr("src",this.model.getLegacyLogo()).appendTo(a),f.add(this.$el,"legacyLogoType")):f.add(this.$el,"noLogoType"),this.model.isSelected()&&f.add(this.$el,"active"),this.model.isVisited()&&f.add(this.$el,"visited"),this},show:function(){return this.$el.show(),this},onClick:function(a){this.model.setSelected(!0,{silent:!0}),this.model.setVisited(!0),this.model.trigger("change:selected",this.model,!0)},onSelectedChange:function(){this.render()},attach:function(){return this.listenTo(this.model,"change:selected",this.onSelectedChange),this.$el.on("click",this.onClick),this},bindMethods:function(){return g.bindMethods(this,["onClick","onSelectedChange"]),this}},{});c.ns("views.tabBrowsing.db5.individualTab",h)}(window);
//# sourceMappingURL=individualTab.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=b.domState,f=b.functional,g=b.shared.views.tabBrowsing.db5.individualTab,h=b.strings,i=g.extend({initialize:function(){this.template=c.getTemplate(this.options.templateName),this.bindMethods().attach()},className:"c-individual-tab c-start-tab",model:null,options:function(){return{logoSelector:"> .logo",templateName:"individual-tab"}},render:function(){var a,b=this.template({name:this.model.getDisplayText(),index:0}),c=d("<img />");return this.$el.html(b),a=this.$(this.options.logoSelector),e.clear(this.$el),e.add(this.$el,"universalLogoType"),c.attr("src",this.model.getLogoUrl()).appendTo(a),this.model.isSelected()&&e.add(this.$el,"active"),this},reset:function(){return this.model.setSelected(!0),this},onClick:function(){this.trigger(i.ON_START_TAB_CLICK,{trigger:this})},onSelectedChange:function(){this.render()},attach:function(){return this.listenTo(this.model,"change:selected",this.onSelectedChange),this.$el.on("click",this.onClick),this},bindMethods:function(){return f.bindMethods(this,["onClick","onSelectedChange"]),this}},{ON_START_TAB_CLICK:h.uniqueId()});c.ns("views.tabBrowsing.db5.individualTab.startTab",i)}(window);
//# sourceMappingURL=startTab.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=b.domState,f=b.functional,g=b.strings,h=d.View.extend({initialize:function(){this.inProgressTemplate=c.getTemplate(this.options.inProgressTemplateName),this.leftArrowEl=this.$(this.options.leftArrowSelector),this.rightArrowEl=this.$(this.options.rightArrowSelector),this.upArrowEl=this.$(this.options.upArrowSelector),this.downArrowEl=this.$(this.options.downArrowSelector),this.wrapperEl=this.$(this.options.wrapperSelector),this.reset().bindMethods().attach()},inProgressTemplate:null,leftArrowEl:null,model:null,options:function(){return{inProgressTemplateName:"tabs-in-progress",leftArrowSelector:"> .left-arrow > .arrow",rightArrowSelector:"> .right-arrow > .arrow",upArrowSelector:"> .up-arrow",downArrowSelector:"> .down-arrow",startTabSelector:"> .c-start-tab",wrapperSelector:"> .tabs > .wrapper"}},rightArrowEl:null,startTabEl:null,wrapperEl:null,append:function(a){return this.wrapperEl.append(a.$el),this},showInProgressState:function(){return this.reset(),this.wrapperEl.html(this.inProgressTemplate()),e.add(this.$el,"inProgress"),this},onLeftArrowClick:function(){this.trigger(h.ON_LEFT_ARROW_CLICK,{trigger:this})},onRightArrowClick:function(){this.trigger(h.ON_RIGHT_ARROW_CLICK,{trigger:this})},onUpArrowClick:function(){this.trigger(h.ON_UP_ARROW_CLICK,{trigger:this})},onDownArrowClick:function(a){this.trigger(h.ON_DOWN_ARROW_CLICK,{trigger:this})},attach:function(){return this.$el.on("click",this.options.leftArrowSelector,this.onLeftArrowClick),this.$el.on("click",this.options.rightArrowSelector,this.onRightArrowClick),this.$el.on("click",this.options.downArrowSelector,this.onDownArrowClick),this.$el.on("click",this.options.upArrowSelector,this.onUpArrowClick),this},bindMethods:function(){return f.bindMethods(this,["onLeftArrowClick","onRightArrowClick","onUpArrowClick","onDownArrowClick"]),this},reset:function(){return c.fadeIn(this.leftArrowEl),c.fadeIn(this.rightArrowEl),this.wrapperEl.html("").css("margin-left",0),e.clear(this.$el),this}},{ON_LEFT_ARROW_CLICK:g.uniqueId(),ON_RIGHT_ARROW_CLICK:g.uniqueId(),ON_UP_ARROW_CLICK:g.uniqueId(),ON_DOWN_ARROW_CLICK:g.uniqueId()});c.ns("views.tabBrowsing.db5.tabsListing",h)}(window);
//# sourceMappingURL=tabsListing.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.shared.views.tabBrowsing.db5.tabsListing,g=b.dependenciesInjection,h=b.shared.views.tabBrowsing.db5.individualTab,i=b.shared.orderedHash,j=b.shared.models.pages.tabBrowsing.db5,k=b.shared.soleChain,l=b.shared.models.startTab,m=b.shared.views.tabBrowsing.db5.individualTab.startTab,n=b.strings,o=(b.shared.models.tabBrowsingAd.db5,e(null,c.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=d.extend({},d.result(this,"options"),b),this.effectsChain=new k,this.itemViews=new i,g.injectDependencies(this),this.attach()},containerView:null,effectsChain:null,isEffectInProgress:!1,itemViews:null,model:null,options:function(){return{containerSelector:".c-tabs-listing",itemClass:h,startTabClass:m}},startTabModel:null,startTabView:null,executeInitialEffect:function(){var a=this.getVisibilitySeparatedViews(),b=this.model.tabAds.findWhere({selected:!0}),c=b?this.itemViews.get(b.getId()):this.itemViews.getFirst();return d.contains(a.postVisible,c)?this.slideTabIntoVisibility(c):this.fadeInTabs(),this},showInProgressState:function(){return this.containerView.showInProgressState(),this},onAdAddition:function(a,b,c){a.setSelected(!0),this.createItemView(a,b.indexOf(a)),this.slideTabIntoVisibility(this.itemViews.getLast())},onAdRemoval:function(a){var b=this.itemViews.get(a.getId()),c=this.model.tabAds.getActiveAd();b.remove(),c||this.startTabModel.setSelected(!0),this.itemViews.remove(a.getId()),this.ensureOptimalDisplay()},onAdSelectedChange:function(a,b){b&&(this.slideTabIntoVisibility(this.itemViews.get(a.getId())),this.startTabView&&this.startTabView.model.setSelected(!1))},onAdsFetching:function(){this.showInProgressState()},onAdsFound:function(){this.reset(),this.createStartTabView(),this.model.tabAds.each(this.createItemView,this),this.executeInitialEffect()},onLeftArrowClick:function(){this.slideTabsRight()},onRightArrowClick:function(){this.slideTabsLeft()},onStartTabClick:function(){var a,b=this.startTabView.model.isSelected();b?(this.model.tabAds.at(0).setSelected(!0),this.startTabView.model.setSelected(!1)):(a=this.model.tabAds.getActiveAd(),a&&(a.setSelected(!1),this.startTabView.model.setSelected(!0)))},attach:function(){return this.listenTo(this.model,j.ON_ADS_FETCHING,this.onAdsFetching),this.listenTo(this.model,j.ON_ADS_FOUND,this.onAdsFound),this.listenTo(this.model.tabAds,"add",this.onAdAddition),this.listenTo(this.model.tabAds,"change:selected",this.onAdSelectedChange),this.listenTo(this.model.tabAds,"remove",this.onAdRemoval),this.listenTo(this.containerView,f.ON_LEFT_ARROW_CLICK,this.onLeftArrowClick),this.listenTo(this.containerView,f.ON_RIGHT_ARROW_CLICK,this.onRightArrowClick),this},createItemView:function(a,b){var c=new this.options.itemClass({model:a,index:b+1});return c.render(),this.containerView.append(c),this.itemViews.append(a.getId(),c),this},createStartTabView:function(){var a=this.model.tabAds.getActiveAd();return this.startTabModel.setSelected(d.isNull(a)||d.isUndefined(a)),this.startTabView=new this.options.startTabClass({model:this.startTabModel}),this.listenTo(this.startTabView,m.ON_START_TAB_CLICK,this.onStartTabClick),this.renderStartTabView()},ensureOptimalDisplay:function(){var a=this.getVisibilitySeparatedViews();return a.preVisible.length>0?c.fadeIn(this.containerView.leftArrowEl):c.fadeOut(this.containerView.leftArrowEl),a.postVisible.length>0?c.fadeIn(this.containerView.rightArrowEl):c.fadeOut(this.containerView.rightArrowEl),this},fadeInTabs:function(){var a,b;return this.isEffectInProgress?this:(this.effectsChain.restart(),b=this.effectsChain.chain,this.containerView.wrapperEl.css("margin-left",0),a=this.getVisibilitySeparatedViews(),b.append(n.uniqueId(),function(){this.isEffectInProgress=!0,this.itemViews.invoke("hide"),b.runNext()}.bind(this)),d.each(a.visible,function(a){b.append(n.uniqueId(),function(){a.$el.fadeIn({done:b.runNext})})},this),d.each(a.postVisible,function(a){b.append(n.uniqueId(),function(){a.show(),b.runNext()})},this),b.append(n.uniqueId(),function(){this.isEffectInProgress=!1,this.ensureOptimalDisplay()}.bind(this)),b.run(),this)},getDependencies:function(){return{containerView:function(){return new f({el:this.model.containerEl.find(this.options.containerSelector),model:this.model})},startTabModel:function(){return new l}}},getVisibilitySeparatedViews:function(){var a={preVisible:[],visible:[],postVisible:[]},b=this.containerView.wrapperEl.position().left,d=c.getWidth(this.containerView.wrapperEl,"margin"),e=b+d;return this.itemViews.each(function(d){var f=d.$el.offset().left,g=c.getWidth(d.$el,"margin"),h=f+g,i=f>=b&&e>=h;i?a.visible.push(d):a.visible.length?a.postVisible.push(d):a.preVisible.push(d)}.bind(this)),a},renderStartTabView:function(){return this.startTabView.render(),this.containerView.append(this.startTabView),this.itemViews.prepend("start",this.startTabView),this},reset:function(){return this.containerView.reset(),this.itemViews.invoke("remove").reset(),this},slideTabIntoVisibility:function(a){var b,e,f,g;return this.isEffectInProgress?this:(b=this.getVisibilitySeparatedViews(),d.contains(b.visible,a)?this:(f=b.preVisible.indexOf(a),g=b.postVisible.indexOf(a),-1===f&&-1===g?this:(this.effectsChain.restart(),e=this.effectsChain.chain,e.append(n.uniqueId(),function(){var a=parseInt(this.containerView.wrapperEl.css("margin-left"),10);f>=0?(d.each(b.preVisible.slice(f),function(b){a+=c.getWidth(b.$el,"margin")}),a>0&&(a=0)):d.each(b.postVisible.slice(0,g+1),function(b){a-=c.getWidth(b.$el,"margin")}),this.isEffectInProgress=!0,this.containerView.wrapperEl.animate({marginLeft:a},{done:e.runNext})}.bind(this)),e.append(n.uniqueId(),function(){this.isEffectInProgress=!1,this.ensureOptimalDisplay()}.bind(this)),e.run(),this)))},slideTabsLeft:function(){var a=this.getVisibilitySeparatedViews();return a.postVisible.length&&this.slideTabIntoVisibility(d.first(a.postVisible)),this},slideTabsRight:function(){var a=this.getVisibilitySeparatedViews();return a.preVisible.length&&this.slideTabIntoVisibility(d.last(a.preVisible)),this},STATIC:{}}));c.ns("controllers.tabBrowsing.db5.tabsListing",o)}(window);
//# sourceMappingURL=tabsListing.nano.js.map

!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a.jQuery,f=b.domState,g=b.functional,h=d.View.extend({initialize:function(){this.template=c.getTemplate(this.options.templateName),this.bindMethods().attach()},className:"logo-option",model:null,options:function(){return{logoElementSelector:".logo",templateName:"dropdown-logo-option"}},template:null,render:function(){var a=this.template({name:this.model.get("display_name")});return this.$el.html(a),this.setLogoImage(),this},remove:function(){this.$el.off("click",this.onClick),this.$el.remove()},setLogoImage:function(){var a=e("<img />"),b=this.$(this.options.logoElementSelector);return f.clear(this.$el),this.model.getUniversalLogo()?(a.attr("src",this.model.getUniversalLogo()).appendTo(b),f.add(this.$el,"universalLogoType")):this.model.getDeprecatedLogo()?(a.attr("src",this.model.getDeprecatedLogo()).appendTo(b),f.add(this.$el,"deprecatedLogoType")):f.add(this.$el,"noLogoType"),this},onClick:function(){this.model.setSelected(!0)},attach:function(){return this.$el.on("click",this.onClick),this},bindMethods:function(){return g.bindMethods(this,["onClick"]),this}},{});c.ns("views.tabBrowsing.db5.logoOption",h)}(window);
//# sourceMappingURL=logoOption.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=(a.jQuery,b.functional),f=d.View.extend({initialize:function(){this.template=c.getTemplate(this.options.templateName),this.bindMethods().attach()},className:"text-option",model:null,options:function(){return{templateName:"dropdown-text-option"}},template:null,render:function(){var a=this.template({name:this.model.get("display_name")});return this.$el.html(a),this},remove:function(){this.$el.off("click",this.onClick),this.$el.remove()},onClick:function(a){this.model.setSelected(!0)},attach:function(){return this.$el.on("click",this.onClick),this},bindMethods:function(){return e.bindMethods(this,["onClick"]),this}},{});c.ns("views.tabBrowsing.db5.textOption",f)}(window);
//# sourceMappingURL=textOption.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=b.functional,f=c.views.tabBrowsing.db5.logoOption,g=c.views.tabBrowsing.db5.textOption,h=d.View.extend({initialize:function(){this.bindMethods().attach()},optionsContainerElement:null,model:null,options:function(){return{optionsContainerTemplateHTML:'<div class="c-options" />',separatorTemplateHTML:'<hr class="separator" />'}},views:[],render:function(){var a=[],b=[],c=this;return c.model.dropdownAds.length<1?this:(c.optionsContainerElement=$j(c.options.optionsContainerTemplateHTML),c.model.dropdownAds.each(function(c){c.get("tab_logo")||c.get("logo")?a.push(c):b.push(c)}),_.each(a,function(a){var b=new f({model:a});c.optionsContainerElement.append(b.render().el),c.views.push(b)}),a.length>0&&c.optionsContainerElement.append(c.options.separatorTemplateHTML),_.each(b,function(a){var b=new g({model:a});c.optionsContainerElement.append(b.render().el),c.views.push(b)}),c.$el.append(c.optionsContainerElement),c.$el.addClass("c-dropdown-active"),this)},removeOptionsList:function(){return this.optionsContainerElement&&(_.each(this.views,function(a){a.remove()}),this.views=[],this.optionsContainerElement.remove(),this.optionsContainerElement=null),this.$el.removeClass("c-dropdown-active"),this},toggleOptionsList:function(){return this.optionsContainerElement?this.removeOptionsList():this.render(),this},onDisplayInputClick:function(a){var b=$j(a.target);b.get(0)===this.$el.get(0)||this.$el.find(b).length>0?this.toggleOptionsList():this.removeOptionsList()},attach:function(){return $j(document).on("click",this.onDisplayInputClick),this},bindMethods:function(){return e.bindMethods(this,["onDisplayInputClick"]),this}},{});c.ns("views.tabBrowsing.db5.dropDown",h)}(window);
//# sourceMappingURL=dropDown.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.dependenciesInjection,g=b.shared.views.tabBrowsing.db5.dropDown,h=e(null,c.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=d.extend({},d.result(this,"options"),b),f.injectDependencies(this),this.attach()},model:null,options:function(){return{containerSelector:".c-dropdown"}},view:null,onAdAddition:function(){this.containerView.render()},onTabAdRemoval:function(a){this.model.dropdownAds.add(a)},onDropDownAdsReset:function(){this.containerView.render()},onDropDownAdSelectedChange:function(a){a.isSelected()&&!this.model.tabAds.contains(a)&&(this.model.dropdownAds.remove(a),this.model.tabAds.add(a))},attach:function(){return this.listenTo(this.model.tabAds,"remove",this.onTabAdRemoval),this.listenTo(this.model.dropdownAds,"change:selected",this.onDropDownAdSelectedChange),this},getDependencies:function(){return{view:function(){return new g({el:this.model.containerEl.find(this.options.containerSelector),model:this.model})}}},STATIC:{}});c.ns("controllers.tabBrowsing.db5.dropDown",h)}(window);
//# sourceMappingURL=dropDown.nano.js.map

!function(a){"use strict";var b=a.stm,c=a.Backbone,d=b.shared,e=b.strings,f=(b.Popup,c.View.extend({el:"body",events:{click:"onPageClick"},initialize:function(a){this.eventNamespace="."+e.uniqueId()},eventNamespace:null,render:function(){return this},onPageClick:function(a){this.trigger(f.ON_PAGE_CLICK,a)}},{ON_PAGE_CLICK:e.uniqueId()}));d.ns("views.tabPopunder",f)}(window);
//# sourceMappingURL=tabPopunder.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=b.dependenciesInjection,e=b.shared.featuredSearchUtils,f=b.define,g=(b.functional,b.shared.orderedHash),h=(a.Backbone,a.jQuery),i=b.Browser,j=b.Popup,k=(b.shared.models.pages.tabBrowsing.db5,b.shared.collections.tabBrowsingAds.db5),l=b.shared.models.searchData,m=b.shared.views.tabPopunder,n=f(null,c.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=_.extend({},_.result(this,"options"),b),d.injectDependencies(this);var c=this.model.getQueryString(),e="1"===c.showStep2AsPopunder,f="1"===c.showMetaAsPopunder,g=this.model.getSearchMode()===l.SEARCH_MODE_CRUISE;if(e||f&&g){if(this.isBrowserSupported()){this.enabled=!0,this.targetUrl=n.URL_PATH_STEP_2;var h=this.getWindow();this.windowHeight=h.height(),this.windowWidth=h.width()}}else f&&this.isBrowserSupported()&&(this.enabled=!0,this.targetUrl=n.URL_PATH_META,this.windowHeight=n.WINDOW_HEIGHT_META,this.windowWidth=n.WINDOW_WIDTH_META);this.enabled?(this.view.render(),this.attach()):this.disable()},model:null,view:null,enabled:!1,targetUrl:null,windowWidth:null,windowHeight:null,onPageClick:function(a){this.enabled&&this.pop().disable()},onTabClick:function(a){this.enabled&&(a&&e.shouldUseFauxTab(a.get("faux_tabs"))||this.pop().disable())},isBrowserSupported:function(){return i.ie&&i.version>7||i.firefox},disable:function(){return this.enabled=!1,this.view.undelegateEvents(),this.stopListening(this.model.tabAds),this},pop:function(){var b=h.extend({},this.model.getQueryString());b.ctm&&delete b.ctm;var c=this.targetUrl+"?"+h.toQueryString(b),d=a.screenX,e=a.screenY;return i.ie8&&(this.windowHeight+=60,d=a.screenLeft-6,e=a.screenTop-120),new j(c,{popunder:!0,name:"tab_popunder",height:this.windowHeight,width:this.windowWidth,left:d,top:e}).tryPop(),this},getWindow:function(){return h(a)},attach:function(){return this.listenTo(this.view,m.ON_PAGE_CLICK,this.onPageClick),this.listenTo(this.model.tabAds,k.EVENT_CHANGED_ACTIVE_AD,this.onTabClick),this},getDependencies:function(){var a=new g;return a.append("view",function(){return new m}),a},STATIC:{URL_PATH_STEP_2:"/step2.php",URL_PATH_META:"/popunder/ecommercemetaleavebehind",WINDOW_WIDTH_META:918,WINDOW_HEIGHT_META:563}});c.ns("controllers.tabPopunder",n)}(window);
//# sourceMappingURL=tabPopunder.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=b.dependenciesInjection,f=b.functional,g=b.shared.views.pageMask,h=b.shared.models.searchData,i=b.strings,j=b.shared.controllers.windowAutoExpander,k=d.View.extend({initialize:function(a){this.templateA=c.getTemplate(this.options.templateAName,!0),this.templateB=c.getTemplate(this.options.templateBName,!0),this.templateC=c.getTemplate(this.options.templateCName,!0),e.injectDependencies(this),this.bindMethods().attach()},model:null,options:function(){return{templateAName:"traq-layer-a",templateBName:"traq-layer-b",templateCName:"traq-layer-c"}},subscriptionFieldEl:null,pageMaskView:null,scrollingId:null,templateA:null,templateB:null,templateC:null,windowAutoExpanderController:null,hide:function(){return this.$el.fadeOut(),this.scrollingId=null,this.windowAutoExpanderController.maximizeWindow(),this.trigger(k.ON_HIDE,{trigger:this}),this},render:function(){var a,b,c={},d=$j("<div />").addClass("layer-a"),e=$j("<div />").addClass("layer-b"),f=$j("<div />").addClass("layer-C");return c.dates=this.model.getDatesText(),c.locations=this.model.getLocationsShortText(),c.mode=this.getSearchModeText(this.model.getSearchMode()),c.tip1=this.getTip1(),c.tip2=this.getTip2(),c.tip3=this.getTip3(),c.tip4=this.getTip4(),c.tip5=this.getTip5(),this.$el.html(""),this.templateA&&d.html(this.templateA(c)).appendTo(this.$el),this.templateB&&e.html(this.templateB()).appendTo(this.$el),this.templateC&&f.html(this.templateC(c)),a=f.children().html(),b=f.children().data("scrolling"),a&&this.changePageTitle(a,b),this.pageMaskView.$el.css("z-index",this.$el.children().css("z-index")-1),this},show:function(){return this.pageMaskView.show(),this.$el.show(),this},onClick:function(a){this.pageMaskView.hide()},onPageMaskHide:function(a){this.hide()},attach:function(){return this.pageMaskView.on(g.EVENT_HIDE,this.onPageMaskHide),this.$el.on("click",this.onClick),this},bindMethods:function(){return f.bindMethods(this,["onClick","onPageMaskHide"]),this},changePageTitle:function(b,c){var d=function(b,c,e){return null===this.scrollingId?void(a.document.title=b):void(this.scrollingId===e&&(a.document.title=c,_.delay(_.bind(d,this,b,c.substr(1)+c.substr(0,1),e),150)))};return a.document.title=b,c?(this.scrollingId=i.uniqueId(),d.call(this,b,b+"___ ",this.scrollingId)):this.scrollingId=null,this},getDependencies:function(){return{pageMaskView:function(){return new g},windowAutoExpanderController:function(){return new j}}},getSearchModeText:function(a){switch(a){case h.SEARCH_MODE_AIR:case h.SEARCH_MODE_AIRFLEX:return"flight";case h.SEARCH_MODE_VACATION:return"vacation";default:return a}},getTip1:function(){var a=this.getSearchModeText(this.model.getSearchMode()),c="Different sites have different",d="prices &mdash; for the same "+a.replace("_"," ");if(b.pageData.db5TabBrowsing.isTraqExitWindow)switch(this.model.getSearchMode()){case h.SEARCH_MODE_HOTEL:c="Save on Your Trip:",d="Search "+this.model.searchData.getLocation2ShortName()+" Hotel Deals";break;case h.SEARCH_MODE_VACATION:c="Save 30% With a "+this.model.searchData.getLocation2ShortName(),d="Flight & Hotel Package!"}return'<span class="line1">'+c+'</span><span class="line2">'+d+"</span>"},getTip2:function(){var a,c;return b.pageData.db5TabBrowsing.isTraqExitWindow?(a="Different Sites Have Different Prices:",c="Compare More to Save More!"):(a="Compare multiple sites",c="all at once and save big!"),'<span class="line1">'+a+'</span><span class="line2">'+c+"</span>"},getTip3:function(){var a,b=this.model.searchData.getLocation2()?" to "+this.model.searchData.getLocation2ShortName():"";switch(this.model.getSearchMode()){case h.SEARCH_MODE_AIR:case h.SEARCH_MODE_AIRFLEX:case h.SEARCH_MODE_VACATION:a="We've found more low fares for your trip";break;default:a="We've found more low rates for your trip"}return a+'<span class="location">'+b+"</span>."},getTip4:function(){var a,b;switch(this.model.getSearchMode()){case h.SEARCH_MODE_AIR:case h.SEARCH_MODE_AIRFLEX:a=this.model.getLocationsShortText(),b='Not all sites have the same prices on <span class="locations">'+a+"</span> flights.";break;default:a=this.model.searchData.getLocation2ShortName(),b="Traveling"+(a?" to ":"")+'<span class="location">'+a+"</span>?"}return b},getTip5:function(){var a;switch(this.model.getSearchMode()){case h.SEARCH_MODE_AIR:case h.SEARCH_MODE_AIRFLEX:a='Compare multiple sites to grab a great deal on <span class="dates">'+this.model.getDatesText()+"</span> fares!";break;default:a="Compare "+this.getSearchModeText(this.model.getSearchMode())+" prices for the best deal!"}return a}},{ON_HIDE:i.uniqueId()});c.ns("views.tabBrowsing.db5.traqLayer",k)}(window);
//# sourceMappingURL=traqLayer.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.dependenciesInjection,g=b.shared.models.pages.tabBrowsing.db5,h=b.shared.views.tabBrowsing.db5.traqLayer,i=b.strings,j=e(null,c.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=d.extend({},d.result(this,"options"),b),f.injectDependencies(this),this.attach()},model:null,options:function(){return{containerSelector:".c-traq-layer",traqLayerAName:"traq-layer-a"}},view:null,show:function(){return this.hasTraqComponents()&&(this.view.render().show(),this.trigger(j.ON_SHOW,{trigger:this})),this},hasTraqComponents:function(){return b.pageData.db5TabBrowsing.traqLayer&&(b.pageData.db5TabBrowsing.traqLayer.A||b.pageData.db5TabBrowsing.traqLayer.B||b.pageData.db5TabBrowsing.traqLayer.C)},onOtherDataLoaded:function(a){this.attachTraqLayerViewEvents(),this.show()},onViewHiding:function(){this.trigger(j.ON_HIDE,{trigger:this}),this.stopListening(this.model,g.ON_ADS_FOUND)},attachTraqLayerViewEvents:function(){return this.listenTo(this.view,h.ON_HIDE,this.onViewHiding),this},attach:function(){return this.listenTo(this.model,g.ON_OTHER_DATA_LOADED,this.onOtherDataLoaded),this},getDependencies:function(){return{view:function(){return new h({el:this.model.containerEl.find(this.options.containerSelector),subscriptionModel:this.subscriptionModel,model:this.model,traqLayerAName:this.options.traqLayerAName})}}},STATIC:{ON_HIDE:i.uniqueId(),ON_SHOW:i.uniqueId()}});c.ns("controllers.tabBrowsing.db5.traqLayer",j)}(window);
//# sourceMappingURL=traqLayer.nano.js.map

!function(a){"use strict";var b=a.stm,c=b.shared,d=(a._,b.define),e=b.cookies,f=(b.strings,b.shared.controllers.alertOnClose),g={data:{air:"Wait! Lower prices may be available for your <%= geo %> flight. Click the tabs above to show flight prices for your trip.",car:"Wait! Lower prices may be available for your <%= geo %> car rental. Click the tabs above to show car rental prices for your trip.",carUK:"Wait! Lower prices may be available for your <%= geo %> car hire. Click the tabs above to show car hire prices for your trip.",cruise:"Wait! Lower prices may be available for your <%= geo %> cruise. Click the tabs above to show cruise prices for your trip.",holiday:"Wait! Lower prices may be available for your <%= geo %> holiday package. Click the tabs above to show holiday package prices for your trip.",hotel:"Wait! Lower prices may be available for your <%= geo %> hotel. Click the tabs above to show hotel prices for your trip.",vacation:"Wait! Lower prices may be available for your <%= geo %> vacation package. Click the tabs above to show vacation package prices for your trip.",vacationRental:"Wait! Lower prices may be available for your <%= geo %> vacation rental. Click the tabs above to show vacation rental prices for your trip."}},h=d(f,{initialize:function(a,c){f.prototype.initialize.call(this,a,new b.shared.models.alertOnClose,null,null,g)},attach:function(){return this.listenTo(this.model.tabAds,"change:selected",this.onAdSelectedChange),this.listenTo(this.model.dropdownAds,"change:selected",this.onAdSelectedChange),this},shouldShow:function(){var a="true"===e.get("alertonclose"),c=1==this.model.getOtherDataQS().alert;return(a||c||b.pageData.db5TabBrowsing.alertOnClose)&&!this.shown&&this.searchCount<this.options.searchesToDisable&&this.getTemplate()}});c.ns("controllers.tabBrowsing.db5.alertOnClose",h)}(window);
//# sourceMappingURL=alertOnClose.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.dependenciesInjection,g=b.shared.models.pages.tabBrowsing.db5,h=b.shared.controllers.windowAutoExpander,i=b.shared.featuredSearchUtils,j=b.shared.controllers.tabPopunder,k=e(null,c.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=d.extend({},d.result(this,"options"),b),f.injectDependencies(this),this.attach()},model:null,options:function(){return{}},windowAutoExpanderController:null,tabPopunderController:null,showAffiliateHomepage:function(){var c;return c=b.pageData.db5TabBrowsing.homepageUrl?b.pageData.db5TabBrowsing.homepageUrl:b.pageData.db5TabBrowsing.rd+"?r=tabbed_"+b.pageData.db5TabBrowsing.af.replace("bb_affiliate_",""),a.location.href=c,this},onAdsFound:function(){var a,b,c=this.model.getOtherDataQS();c.selectedAdId?(a=parseInt(c.selectedAdId,10),b=this.model.tabAds.get(a)):1==c.noInstr&&(b=this.getFirstNonFauxTabAd()),b&&b.setSelected(!0)},onPageDataLoaded:function(){this.checkAllowFramed().checkDartFlags().loadPopunder(),d.delay(this.checkMaximizeWindow.bind(this),1e3)},attach:function(){return this.listenTo(this.model,g.ON_ADS_FOUND,this.onAdsFound),this.listenTo(this.model,g.ON_PAGE_DATA_LOADED,this.onPageDataLoaded),this},checkAllowFramed:function(){var c=this.model.getOtherDataQS();return d.isString(c.allow_framed)&&"true"===c.allow_framed||b.pageData.db5TabBrowsing.allowFramed||a.top!==a.self&&a.top.location.replace(a.self.location.href),this},checkDartFlags:function(){return this},checkMaximizeWindow:function(){this.windowAutoExpanderController||(this.windowAutoExpanderController=new h)},getDependencies:function(){return{}},getFirstNonFauxTabAd:function(){var a=null;return this.model.tabAds&&(a=this.model.tabAds.find(function(a){return!i.shouldUseFauxTab(a.get("faux_tabs"))})),a},loadPopunder:function(){return null===this.tabPopunderController&&(this.tabPopunderController=new j(this.model)),this},STATIC:{}});c.ns("controllers.tabBrowsing.db5.minorFunctionalities",k)}(window);
//# sourceMappingURL=minorFunctionalities.nano.js.map
!function(a){"use strict";var b,c,d=a.stm,e=d.shared,f=a.jQuery,g=a._,h=d.define,i=d.shared.models.pages.tabBrowsing.db5;f(function(){b=a.BBAd,c=d.tracking.omniture});var j=h(null,e.getBackboneEvents(),{initialize:function(a){this.model=a,this.attach()},clickTrackedAds:{},loaded:!1,model:null,trackSubClick:function(a){c.sendEvents(a,j.TRACKING_SUBSCRIPTION_DESC)},trackAdClick:function(a){if(!this.loaded)return g.delay(this.trackAdClick.bind(this,a),500),this;var d=a.getId(),e=b.singleton(d);return e.setMetaDataMulti(a.attributes),c.trackFeaturedSearchClick(d),this.clickTrackedAds[d]=!0,this},trackPageLoad:function(){return this.loaded?(this.model.omnitureData&&(this.model.updateOmnitureAdImpressions(),c.triggerConfigChanged(this.model.omnitureData)),this):(g.delay(this.trackPageLoad.bind(this),500),this)},onAdSelectedChange:function(a){a.isSelected()&&!this.clickTrackedAds[a.getId()]&&this.trackAdClick(a)},onConfigDataLoaded:function(){c.triggerConfigChanged(this.model.omnitureData),this.loaded=!0},attach:function(){return this.listenTo(this.model,i.ON_OMNITURE_DATA_LOADED,this.onConfigDataLoaded),this.listenTo(this.model.tabAds,"change:selected",this.onAdSelectedChange),this.listenTo(this.model.dropdownAds,"change:selected",this.onAdSelectedChange),this},STATIC:{TRACKING_SUBSCRIPTION_DESC:"A user has been subscribed to a newsletter"}});e.ns("controllers.tabBrowsing.db5.omniture",j)}(window);
//# sourceMappingURL=omniture.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=(a._,b.shared.views.tabBrowsing.db5.tabsListing),e=b.shared.controllers.tabBrowsing.db5.tabsListing,f=71,g=b.define(e,{onDownArrowClick:function(){this.containerView.$(".tabs");this.scrollTabs("+="+f)},onUpArrowClick:function(){this.containerView.$(".tabs");this.scrollTabs("-="+f)},slideTabIntoVisibility:function(a){if(a){var b=a.$el.position().top+a.$el.height()+16-a.$el.parents(".tabs").height();b>0&&this.scrollTabs("+="+b)}},scrollTabs:function(a){var b=this,c=this.containerView.$(".tabs");c.animate({scrollTop:a},400,"swing",function(){b.ensureOptimalDisplay()})},ensureOptimalDisplay:function(){var a=this.containerView.$(".tabs"),b=this.containerView.$(".wrapper"),c=b.height()-(a.scrollTop()+a.height());return a.scrollTop()<=0?this.containerView.upArrowEl.fadeOut():this.containerView.upArrowEl.fadeIn(),0>=c?this.containerView.downArrowEl.fadeOut():this.containerView.downArrowEl.fadeIn(),this},executeInitialEffect:function(){var a=this,b=400,d=15,e=0,f=this.containerView.$(".c-individual-tab").not(".c-start-tab"),g=this.model.tabAds.findWhere({selected:!0});if(g){var h=this.itemViews.get(g.getId());this.slideTabIntoVisibility(h)}return f.each(function(a,f){var g=c(f),h=function(){g.addClass("s-universalLogoType"),g.removeClass("s-noLogoType")};g.css("margin-left",-300),g.delay(e).animate({"margin-left":d},b),g.hasClass("s-universalLogoType")&&(g.removeClass("s-universalLogoType"),g.addClass("s-noLogoType"),g.find("img").load(h),setTimeout(h,3e3)),e+=b}),setTimeout(function(){a.ensureOptimalDisplay()},Math.min(7*b,b*f.length)),this},attach:function(){var b=this;return e.prototype.attach.call(this),this.listenTo(this.containerView,d.ON_DOWN_ARROW_CLICK,this.onDownArrowClick),this.listenTo(this.containerView,d.ON_UP_ARROW_CLICK,this.onUpArrowClick),c(a).resize(function(){b.ensureOptimalDisplay()}),this}});b.shared.ns("controllers.tabBrowsing.db5.verticalTabsListing",g)}(window);
//# sourceMappingURL=verticalTabsListing.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.define,d=b.shared.controllers.tabBrowsing.db5.adDisplay,e=c(d,{getFauxLocationAndDimensions:function(){var a=(this.containerView.$el,d.prototype.getFauxLocationAndDimensions.call(this));return a.height+=20,a.width-=300,a.left+=290,a}});b.shared.ns("controllers.tabBrowsing.db5.verticalAdDisplay",e)}(window);
//# sourceMappingURL=verticalAdDisplay.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a._,f=b.define,g=(b.shared.controllers.tabBrowsing.db5.adDisplay,b.shared.controllers.tabBrowsing.db5.alertOnClose),h=b.shared.controllers.tabBrowsing.db5.defaultContent,i=b.dependenciesInjection,j=b.shared.controllers.tabBrowsing.db5.dropDown,k=b.shared.controllers.tabBrowsing.db5.editDetails,l=b.shared.controllers.tabBrowsing.db5.googleFP,m=b.shared.controllers.tabBrowsing.db5.header,n=b.shared.linkUtils,o=b.shared.featuredSearchUtils,p=b.shared.metricsUtils,q=b.shared.controllers.tabBrowsing.db5.minorFunctionalities,r=b.shared.controllers.tabBrowsing.db5.omniture,s=b.shared.orderedHash,t=b.shared.models.pages.tabBrowsing.db5,u=b.shared.controllers.tabBrowsing.db5.searchWidget,v=b.cookies,w=b.strings,x=(b.shared.controllers.tabBrowsing.db5.tabsListing,b.shared.controllers.tabBrowsing.db5.traqLayer),y=b.shared.controllers.tabBrowsing.db5.exitDHTML,z=b.shared.controllers.tabBrowsing.db5.verticalAdDisplay,A=b.shared.controllers.tabBrowsing.db5.verticalTabsListing,B=f(null,c.getBackboneEvents(),{initialize:function(a,b){this.element=a,this.options=e.extend({},e.result(this,"options"),b),i.injectDependenciesWith(this,this.getDependenciesPre(),this.options.dependencies.pre),this.model.loadPageDataFromQueryString(),this.isOneClickOneWindowSupported&&o.shouldOpenOneClickOneWindow(this.model.searchData.mode)?this.redirectToOneClickOneWindow():(this.attachPre(),this.model.fetchAds(),d(function(){i.injectDependenciesWith(this,this.getDependenciesPost(),this.options.dependencies.post),this.attachPost()}.bind(this)))},adDisplayController:null,alertOnCloseController:null,defaultContentController:null,dropDownController:null,editDetailsController:null,element:null,googleFPController:null,headerController:null,isOneClickOneWindowSupported:!1,metrics:null,minorFunctionalitiesController:null,model:null,omnitureController:null,options:function(){return{blueKaiSelector:"[data-bluekai]",tabSelector:".c-individual-tab",dependencies:{controllers:{},models:{}}}},searchWidgetController:null,tabsListingController:null,traqLayerController:null,isSem:!1,onAlertMessageShown:function(a){var b=this.exitDHTMLController.exitDHTMLController.shown,c=(this.exitDHTMLController.exitDHTMLController.model.isEnabled(),a.shown);if(this.isSem){if(b||c)return void(a.getMessage=function(){});if(this.isAlertOnCloseEnabled())return;this.exitDHTMLController.exitDHTMLController.model.setEnabled(!0),this.exitDHTMLController.exitDHTMLController.pageMaskView.$el.css({opacity:1}),this.exitDHTMLController.exitDHTMLController.show(),a.getMessage=function(){return"Stay now for an amazing offer!"}}},isAlertOnCloseEnabled:function(){return("true"===v.get("alertonclose")||1==this.model.getOtherDataQS().alert)&&this.alertOnCloseController.searchCount<this.alertOnCloseController.options.searchesToDisable},onAlertCloseValidation:function(a){a&&a.response&&a.response.isSem&&(this.isSem=a.response.isSem,this.isSem&&!this.alertOnCloseController.shouldShow()&&(this.alertOnCloseController.shouldShow=function(){return!0}))},onEditDetailsClick:function(){this.searchWidgetController.show()},onInvalidSearchMode:function(){a.location="/tablander.php"},onLogoClick:function(){this.minorFunctionalitiesController.showAffiliateHomepage()},onAdsDataLoaded:function(a){this.model.fetchOtherData()},onBeforeAdsFetchAjaxRequest:function(a){this.metrics.startTiming(t.METRICS_KEY_ADS_FETCHING)},onAfterAdsFetchAjaxRequest:function(a){this.metrics.stopTiming(t.METRICS_KEY_ADS_FETCHING)},onHashChange:function(){this.model.loadPageDataFromQueryString(),this.model.fetchAds()},onTabClick:function(){c.getWindow().off(B.EVENT_NAMESPACE),this.element.off(B.EVENT_NAMESPACE),this.isSem&&(this.alertOnCloseController.shouldShow=function(){return!0})},onTraqHiding:function(){this.tabsListingController.isEffectInProgress=!1,this.model.tabAds.length&&this.tabsListingController.executeInitialEffect()},onTraqShowing:function(){this.tabsListingController.isEffectInProgress=!0},onWidgetUpdate:function(){this.model.removeAdIdsFromModel(),this.model.fetchAds()},attachPost:function(){return c.getWindow().on("hashchange"+B.EVENT_NAMESPACE,this.onHashChange.bind(this)),this.element.on("mousedown"+B.EVENT_NAMESPACE,this.options.tabSelector,this.onTabClick.bind(this)),this.listenTo(this.defaultContentController,h.ON_LOGO_CLICK,this.onLogoClick),this.listenTo(this.editDetailsController,k.ON_CLICK,this.onEditDetailsClick),this.listenTo(this.headerController,m.ON_LOGO_CLICK,this.onLogoClick),this.listenTo(this.searchWidgetController,u.ON_SUCCESSFUL_UPDATE,this.onWidgetUpdate),this.listenTo(this.model,t.ON_OTHER_DATA_LOADED,this.onAlertCloseValidation),this.listenTo(this.alertOnCloseController,g.ON_SHOW,this.onAlertMessageShown),this},attachPre:function(){return this.listenTo(this.model,t.ON_ADS_FOUND,this.onAdsDataLoaded),this.listenTo(this.model,t.ON_ADS_NOT_FOUND,this.onAdsDataLoaded),this.listenTo(this.model,t.ON_INVALID_SEARCH_MODE,this.onInvalidSearchMode),this.listenTo(this.traqLayerController,x.ON_HIDE,this.onTraqHiding),this.listenTo(this.traqLayerController,x.ON_SHOW,this.onTraqShowing),this.listenTo(this.model,t.ON_BEFORE_AD_FETCH_AJAX_REQUEST,this.onBeforeAdsFetchAjaxRequest),this.listenTo(this.model,t.ON_AFTER_AD_FETCH_AJAX_REQUEST,this.onAfterAdsFetchAjaxRequest),this},getDependenciesPre:function(){return new s([["model",function(){return new t({el:this.element})}],["adDisplayController",function(){return new z(this.model)}],["defaultContentController",function(){return new h(this.model)}],["metrics",function(){return new p}],["minorFunctionalitiesController",function(){return new q(this.model)}],["tabsListingController",function(){return new A(this.model)}],["traqLayerController",function(){return new x(this.model)}]])},getDependenciesPost:function(){return new s([["alertOnCloseController",function(){return o.shouldOpenOneClickOneWindow(this.model.searchData.mode)?null:new g(this.model)}],["dropDownController",function(){return new j(this.model)}],["editDetailsController",function(){return new k(this.model)}],["googleFPController",function(){return new l(this.model)}],["headerController",function(){return new m(this.model)}],["searchWidgetController",function(){return new u(this.model)}],["omnitureController",function(){return new r(this.model)}],["exitDHTMLController",function(){return new y(this.model)}]])},redirectToOneClickOneWindow:function(){var b=this.model.getQueryString();return a.location=n.getFancyLanderOneClickOneWindowUrl(b),this},STATIC:{EVENT_NAMESPACE:"."+w.uniqueId()}});c.ns("pages.tabBrowsing.controllers.db5",B)}(window);
//# sourceMappingURL=db5.nano.js.map

// ===========================================
// Tabbed Entry
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a._,f=b.Browser,g=b.dates,h=b.functional,i=b.strings,j=b.shared.models.pages.tabBrowsing,k=b.shared.models.searchData,l=j.extend({initialize:function(a,b){j.prototype.initialize.call(this,a,b),this.searchData&&(this.searchData.mode=this.getSearchMode()),this.landerStyle=this.getLanderStyle()},isMobileSafari:!(!f.safari||!f.Platform.ios),landerStyle:null,metricsSent:!1,shouldGetExitOffer:!1,preSelectFirstAd:!1,ABCore29334Recipe:"",ABCore29989Recipe:"",ABCore30693Recipe:"",fetchAds:function(){var a=this.getQueryString();return a.landerStyle=this.getLanderStyle(),this.trigger(l.ON_ADS_FETCHING,{trigger:this}),this.trigger(l.ON_BEFORE_AD_FETCH_AJAX_REQUEST,{trigger:this}),d.ajax({url:"/lander/getMain.html",data:a,success:this.onAdsRetrieval,async:!this.isMobileSafari}),this},fetchExitDHTMLData:function(){if(this.shouldGetExitOffer){var a=e.defaults(this.getQueryString(),{is_fancy_lander:1,site_page:"fancy_1c1w_lander"});d.ajax({url:"/getExitDHTML.html",data:a,success:this.onExitDHTMLDataRetrieval})}return this},getAffiliateName:function(){return b.pageData.tabbedEntry.af},getDatesText:function(){var a,b,c="",d=!1;switch(this.getSearchMode()){case k.SEARCH_MODE_AIR:d=!0;case k.SEARCH_MODE_CAR:case k.SEARCH_MODE_HOLIDAY:case k.SEARCH_MODE_HOTEL:case k.SEARCH_MODE_VACATION_PACKAGES:case k.SEARCH_MODE_VACATION_RENTALS:a=this.searchData.getDate1(),b=this.searchData.getDate2(),d&&this.searchData.isOneway()&&a?c=g.formatDate("M d",a):a&&b&&(c=g.formatDate("M d",a)+" - "+g.formatDate("M d",b));break;case k.SEARCH_MODE_CRUISE:c=g.formatDate("M yy",this.searchData.getCruiseDeparture())}return c},getDatesTextForTabletFooter:function(){var a,b,c="",d=!1;switch(this.getSearchMode()){case k.SEARCH_MODE_AIR:d=!0;case k.SEARCH_MODE_CAR:case k.SEARCH_MODE_HOLIDAY:case k.SEARCH_MODE_HOTEL:case k.SEARCH_MODE_VACATION_PACKAGES:case k.SEARCH_MODE_VACATION_RENTALS:a=this.searchData.getDate1(),b=this.searchData.getDate2(),d&&this.searchData.isOneway()&&a?c=g.formatDate("M d",a):a&&b&&(c=g.formatDate("M d",a)+" _ "+g.formatDate("M d",b));break;case k.SEARCH_MODE_CRUISE:c=g.formatDate("M yy",this.searchData.getCruiseDeparture())}return c},getLocationsFullText:function(){var a,b,c="";switch(this.getSearchMode()){case k.SEARCH_MODE_AIR:case k.SEARCH_MODE_AIRFLEX:case k.SEARCH_MODE_HOLIDAY:case k.SEARCH_MODE_VACATION_PACKAGES:a=this.searchData.getLocation1ShortName(),b=this.searchData.getLocation2ShortName(),a&&b&&(c=a+" to "+b);break;case k.SEARCH_MODE_CAR:case k.SEARCH_MODE_HOTEL:case k.SEARCH_MODE_VACATION_RENTALS:c=this.searchData.getLocation2ShortName();break;case k.SEARCH_MODE_CRUISE:c=this.searchData.getCruiseLocation()}return c},getLocationsCode:function(){return"air"!=this.getSearchMode()?this.searchData.getLocation2Code():this.searchData.getLocation1Code()&&this.searchData.getLocation2Code()?this.searchData.getLocation1Code()+" - "+this.searchData.getLocation2Code():" - "},getSearchMode:function(){return b.pageData.tabbedEntry.mode},getLanderStyle:function(){return b.pageData.tabbedEntry.landerStyle},isTriFoldEligible:function(){var b=this.getLanderStyle(),c=i.parseQueryString(a.location.search).mode;return"Fancy"===b||"LowestFare"===b&&"air"===c},getABCore29334Recipe:function(){return this.ABCore29334Recipe},getABCore29989Recipe:function(){return this.ABCore29989Recipe},getABCore30693Recipe:function(){return this.ABCore30693Recipe},onAdsRetrieval:function(a){if(this.trigger(l.ON_AFTER_AD_FETCH_AJAX_REQUEST,{trigger:this}),this.searchData.updateFromCookie(),"B"===a.core_28765&&e.isObject(this.searchData.getLocation2())&&this.searchData.getLocation2Id()>0&&(this.shouldGetExitOffer=!0),a.tabs&&a.tabs.length){if(this.tabAds.reset(a.tabs),this.preSelectFirstAd===!0&&this.tabAds.at(0).setSelected(!0,{silent:!0}),this.getOtherDataQS().selectedAdId){var b=this.tabAds.get(this.getOtherDataQS().selectedAdId);b&&b.setSelected(!0,{silent:!0})}this.trigger(l.ON_ADS_FOUND,{trigger:this})}else this.trigger(l.ON_ADS_NOT_FOUND,{trigger:this});a.omniture&&(this.omnitureData=a.omniture,this.updateOmnitureAdImpressions(),this.trigger(l.ON_OMNITURE_DATA_LOADED,{trigger:this})),a.awdFauxAd&&(this.awdFauxAd=new this.tabAds.model(a.awdFauxAd),this.awdFauxAd.fauxHack=!0),a.overlayedAd&&(this.overlayedAd=new this.tabAds.model(a.overlayedAd),this.trigger(l.ON_OVERLAYED_AD_LOADED,{trigger:this}))},onExitDHTMLDataRetrieval:function(a){this.trigger(l.ON_EXIT_DHTML_DATA_LOADED,{trigger:this,response:a})},attach:function(){return this.listenTo(this.searchData,"change",this.onSearchDataChange),this.listenTo(this.searchData,k.ON_FULL_UPDATE,this.onSearchDataChange),c.getWindow().on("resize",e.debounce(this.onWindowResize,200)),this},bindMethods:function(){return h.bindMethods(this,["onAdsRetrieval","onSearchDataChange","onWindowResize","onExitDHTMLDataRetrieval"]),this},triggerPageDataInitEvent:function(){return this.trigger(l.ON_PAGE_DATA_INIT,{trigger:this}),this.triggerPageDataInitEvent=function(){return this},this},triggerPageDataLoadedEvent:function(){return this.trigger(l.ON_PAGE_DATA_LOADED,{trigger:this}),this.triggerPageDataLoadedEvent=function(){return this},this}},{METRICS_KEY_ADS_FETCHING:"ads-fetching",ON_EXIT_DHTML_DATA_LOADED:i.uniqueId(),ON_BEFORE_AD_FETCH_AJAX_REQUEST:i.uniqueId(),ON_AFTER_AD_FETCH_AJAX_REQUEST:i.uniqueId(),ON_OVERLAYED_AD_LOADED:"on_overlayed_ad_loaded"});c.ns("models.pages.tabbedEntry",l)}(window);
//# sourceMappingURL=tabbedEntry.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=b.shared.collections.tabBrowsingAds,f=b.shared.models.tabBrowsingAd.db5,g=e.extend({constructor:function(a,b){d.Collection.call(this,a,b),this.attach()},model:f,setActiveAd:function(a,b){var c=b&&b.silent;return this.activeAd===a?this:(this.activeAd=a,this.activeAd&&this.activeAd.setSelected(!0,b),c||this.trigger(g.EVENT_CHANGED_ACTIVE_AD,a,b),this)},getSelectedAds:function(){return this.where({selected:!0})}},{});c.ns("collections.tabBrowsingAds.tabbedEntry",g)}(window);
//# sourceMappingURL=tabbedEntry.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.shared.collections.tabBrowsingAds.tabbedEntry,f=b.shared.models.pages.tabbedEntry,g=f.extend({onAdsRetrieval:function(a){("B"===a.core_29334||"C"===a.core_29334)&&(this.shouldGetExitOffer=!0,this.ABCore29334Recipe=a.core_29334),("B"===a.core_30693||"C"===a.core_30693)&&(this.ABCore30693Recipe=a.core_30693),"B"===a.core_29989&&(this.ABCore29989Recipe=a.core_29989),f.prototype.onAdsRetrieval.call(this,a)},getDependencies:function(){var a=f.prototype.getDependencies.call(this);return d.extend({},a,{tabAds:function(){return new e([])}})}},{});c.ns("models.pages.tabbedEntry.multiSelect",g)}(window);
//# sourceMappingURL=multiSelect.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a.jQuery,f=d.View.extend({initialize:function(a){this.template=c.getTemplate(this.options.templateName),this.checkForInitalError(),this.attach()},model:null,options:function(){return{templateName:"trip-details-tabbed-entry",pencilButtonSelector:" > .tablet-footer > img",searchWidgetSelector:".c-search-widget-fancy"}},template:null,pencilButton:null,searchWidget:null,render:function(){var a=this.template;"B"==this.model.getABCore29989Recipe()&&(a=c.getTemplate("trip-details-tabbed-entry-tablet"));var b=""===this.$el.html(),d=this.model.getDatesText(),f=this.model.getLocationsFullText(),g=this.model.getLocationsShortText(),h=this.model.getLocationsCode(),i=this.model.searchData.getSearchType(),j=this.model.searchData.getTravelers(),k=this.model.getSearchMode(),l=this.model.getHeadline(),m="",n="returning",o="traveler(s)",p=this.model.getDatesTextForTabletFooter();return"air"!=k?i=k:("roundtrip"!=i&&(n=null),m=h),"cruise"==k&&(j=this.model.searchData.getCruiseLength(),o="",n="",m=g),"hotel"==k&&(o="guest(s)",m=g),"car"==k&&(o="",j="--",m=g),"vacation"==k&&(m=h),l?this.$el.html(e("<p>").text(l)):this.$el.html(a({dates:d,longLocations:f,shortLocations:g,locationCodes:h,tripType:i,travelers:j,datesSubText:n,datesForTabletFooter:p,travelerSubText:o,locationCodeForTablet:m,destinationCity:this.model.getDestinationCityName(),mode:k})),b&&this.$el.hide().fadeIn(),this.pencilButton=this.$(this.options.pencilButtonSelector),this.searchWidget=e(this.options.searchWidgetSelector),this},onPencilButtonClick:function(a){var b=this.searchWidget;this.searchWidget.addClass("slideUp").on("animationend webkitAnimationEnd",function(){b.toggleClass("slideUp",!0)})},attach:function(){return this.$el.on("click",this.options.pencilButtonSelector,this.onPencilButtonClick.bind(this)),this},checkForInitalError:function(){if(null==this.model.getLocationsCode()||"-"==this.model.getLocationsCode().trim()){var a=e(this.options.searchWidgetSelector);a.addClass("slideUp").on("animationend webkitAnimationEnd",function(){a.toggleClass("slideUp",!0)})}}},{});c.ns("views.tabbedEntry.tripDetails",f)}(window);
//# sourceMappingURL=tripDetails.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.dependenciesInjection,g=b.shared.views.tabbedEntry.tripDetails,h=b.shared.models.pages.tabbedEntry,i=e(null,c.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=d.extend({},d.result(this,"options"),b),f.injectDependencies(this),this.attach()},model:null,options:function(){return{containerSelector:".c-trip-details"}},view:null,onAdsFound:function(){this.view.render()},onAdsNotFound:function(){this.view.render()},attach:function(){return this.listenTo(this.model,h.ON_ADS_NOT_FOUND,this.onAdsNotFound),this.listenTo(this.model,h.ON_ADS_FOUND,this.onAdsFound),this},getDependencies:function(){return{view:function(){return new g({el:this.model.containerEl.find(this.options.containerSelector),model:this.model})}}},STATIC:{}});c.ns("controllers.tabbedEntry.tripDetails",i)}(window);
//# sourceMappingURL=tripDetails.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a.jQuery,f=b.domState,g=b.functional,h=d.View.extend({initialize:function(a,b){this.template=c.getTemplate(this.options.templateName),b&&(this.index=b),this.bindMethods().attach()},className:"c-individual-ad",index:0,model:null,options:function(){return{adSize:"small",checkboxSelector:":checkbox",logoSelector:".vendorLogo > .logo",tagLine:"",templateName:"individual-ad-tabbed-entry"}},template:null,fadeIn:function(a){return this.$el.css("visibility","visible"),this.$el.hide().fadeIn({done:a}),this},hide:function(){return this.$el.css("visibility","hidden"),this},render:function(){var a,b=this.template({name:this.model.get("display_name"),adSize:this.options.adSize,tagline:this.options.tagline,selected:this.model.isSelected(),index:this.index});return f.clear(this.$el),this.$el.html(b),a=this.$(this.options.logoSelector),this.model.getUniversalLogo()?(e("<img />").prop("src",this.model.getUniversalLogo()).prop("alt",this.model.getName()).appendTo(a),f.add(this.$el,"universalLogoType")):this.model.getLogo()?(e("<img />").prop("src",this.model.getLogo()).prop("alt",this.model.getName()).appendTo(a),f.add(this.$el,"legacyLogoType")):f.add(this.$el,"noLogoType"),this.model.isSelected()&&f.add(this.$el,"active"),this},show:function(){return this.$el.show(),this},onClick:function(a){this.model.setSelected(!this.model.isSelected()),this.model.isSelected()&&this.$el.find(".tip").addClass("selected",!0)},onSelectedChange:function(a,b,c){this.render()},attach:function(){return this.listenTo(this.model,"change:selected",this.onSelectedChange),this.$el.on("click",this.onClick),this},bindMethods:function(){return g.bindMethods(this,["onClick","onSelectedChange"]),this}},{});c.ns("views.tabbedEntry.individualAd",h)}(window);
//# sourceMappingURL=individualAd.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=a.Backbone,f=b.domState,g=b.functional,h=b.strings,i=e.View.extend({initialize:function(a){this.calloutEl=this.$(this.options.calloutSelector),this.inProgressTemplate=c.getTemplate(this.options.inProgressTemplateName),this.wrapperEl=this.$(this.options.wrapperSelector),this.errorMessagesEl=this.$(this.options.errorMessagesSelector),this.searchButtonEl=this.$(this.options.searchButtonSelector),this.compareErrorEl=this.$(this.options.compareErrorSelector),this.reset().bindMethods().attach()},calloutEl:null,inProgressTemplate:null,errorMessagesEl:null,model:null,options:function(){return{compareErrorSelector:".c-compare > .error-tip",inProgressTemplateName:"ads-in-progress-tabbed-entry",wrapperSelector:"> .partners",calloutSelector:"> .callout",searchButtonSelector:"> .searchButton",errorMessagesSelector:".errors"}},searchButtonEl:null,wrapperEl:null,append:function(a){return this.wrapperEl.append(a.$el),this},fadeInCallout:function(a){return this.model.isTriFoldEligible()?(a.done(),this):(this.calloutEl.length?this.calloutEl.fadeIn(a):d.isFunction(a.done)&&a.done(),this)},hideCallout:function(){return this.calloutEl.hide(),this},hideCompareError:function(a){return d.isNumber(a)||(a=i.DEFAULT_COMPARE_ERROR_FADE_MS),this.compareErrorEl&&this.compareErrorEl.fadeOut(a),this},showCompareError:function(a){return this.model.isTriFoldEligible()?this:(d.isNumber(a)||(a=i.DEFAULT_COMPARE_ERROR_FADE_MS),this.compareErrorEl&&this.compareErrorEl.fadeIn(a),this)},showInProgressState:function(){return this.reset(),this.wrapperEl.html(this.inProgressTemplate()),f.add(this.$el,"inProgress"),this},hasErrors:function(){var a=this.model.searchData.validateByMode();return a&&a.length>0},renderErrors:function(){return jQuery(".c-trip-details").addClass("hasError"),jQuery(".c-partner-listing-fancy").addClass("hasError"),jQuery(".c-compare").hide(),this.errorMessagesEl.fadeIn(),this.calloutEl.hide(),this.wrapperEl.hide(),this},onSearchButtonClick:function(a){this.trigger(i.ON_SEARCH_BUTTON_CLICK,{trigger:this})},attach:function(){return this.searchButtonEl.on("click",this.onSearchButtonClick),this},bindMethods:function(){return g.bindMethods(this,["onSearchButtonClick"]),this},reset:function(){return jQuery(".c-trip-details").removeClass("hasError"),jQuery(".c-partner-listing-fancy").removeClass("hasError"),this.model.isTriFoldEligible()||(jQuery(".c-compare").show(),this.calloutEl.show()),this.errorMessagesEl.hide(),this.searchButtonEl.hide(),this.wrapperEl.empty().show(),f.clear(this.$el),this}},{DEFAULT_COMPARE_ERROR_FADE_MS:350,STATE_HAS_ADS:"hasAds",STATE_NO_ADS:"noAds",ON_SEARCH_BUTTON_CLICK:h.uniqueId()});c.ns("views.tabbedEntry.adsListing",i)}(window);
//# sourceMappingURL=adsListing.nano.js.map
!function(a){"use strict";var b=a.stm,c=Backbone.View.extend({className:"select-all",events:{"click input":"onClick"},initialize:function(){this.render()},render:function(){this.$el.html(this.template()),this.$("input").prop("checked",this.clicked)},template:_.template('<label><input name="select-all" type="checkbox"> Select All</label>'),onClick:function(){this.clicked=!0,this.model.invoke("setSelected",!0),this.render(),this.$("label").addClass("s-checked")},fadeIn:function(a){this.$el.css("visibility","visible"),this.$el.hide().fadeIn({done:a})},hide:function(){this.$el.css("visibility","hidden")}});b.shared.ns("views.tabbedEntry.selectAll",c)}(window);
//# sourceMappingURL=selectAll.nano.js.map
!function(a){"use strict";var b=stm.shared.models.pages.tabbedEntry,c=Backbone.View.extend({className:"fancy-overlay-frame-ad",initialize:function(){this.listenTo(this.model,b.ON_OVERLAYED_AD_LOADED,this.render.bind(this))},render:function(){this.$el.html(this.template({url:this.model.overlayedAd.getUrl()}))},template:_.template('<iframe src="<%- url %>"></iframe><div class="shade"></div>'),hideShade:function(){this.$(".shade").hide()}});stm.shared.ns("views.tabbedEntry.iframeAdView",c)}(window);
//# sourceMappingURL=iframeAdView.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=c.views.tabbedEntry.adsListing,g=b.dependenciesInjection,h=b.domState,i=c.orderedHash,j=c.models.pages.tabbedEntry,k=c.soleChain,l=b.strings,m=c.views.tabbedEntry.selectAll,n=b.browser,o=e(null,c.getBackboneEvents(),{ABSTRACT:!0,"abstract fadeInAds":null,"abstract createItemView":null,initialize:function(a,b){this.model=a,this.options=d.extend({},d.result(this,"options"),b),this.effectsChain=new k,this.itemViews=new i,g.injectDependencies(this),this.attach()},displayedAds:0,effectsChain:null,isEffectInProgress:!1,itemViews:null,model:null,view:null,selectAllView:null,showInProgressState:function(){return this.view.showInProgressState(),this},onAdsFetching:function(){this.showInProgressState()},onAdsFound:function(){this.reset(),this.displayedAds=0,h.add(this.view.$el,f.STATE_HAS_ADS),this.model.tabAds.each(function(a){this.createItemView(a)},this),this.isSelectAllCapable()&&(this.selectAllView=new m({model:this.model.tabAds}),this.view.append(this.selectAllView)),this.fadeInAds()},onAdsNotFound:function(){this.reset(),h.add(this.view.$el,f.STATE_NO_ADS),this.view.hasErrors()?this.view.renderErrors():this.view.searchButtonEl.fadeIn()},onAdSelectedChange:function(a,b){b&&this.trigger(o.ON_LOGO_CLICK,{trigger:this,model:a})},onSearchButtonClick:function(){this.trigger(o.ON_SEARCH_BUTTON_CLICK,{trigger:this})},attach:function(){return this.listenTo(this.model,j.ON_ADS_FETCHING,this.onAdsFetching),this.listenTo(this.model,j.ON_ADS_FOUND,this.onAdsFound),this.listenTo(this.model,j.ON_ADS_NOT_FOUND,this.onAdsNotFound),this.listenTo(this.model.tabAds,"change:selected",this.onAdSelectedChange),this.listenTo(this.view,f.ON_SEARCH_BUTTON_CLICK,this.onSearchButtonClick),this},getDependencies:function(){return{view:function(){return new f({el:this.model.containerEl.find(this.options.containerSelector),model:this.model})}}},reset:function(){return this.view.reset(),this.itemViews.invoke("remove").reset(),this},isSelectAllCapable:function(){return!n.chrome},STATIC:{ON_LOGO_CLICK:l.uniqueId(),ON_SEARCH_BUTTON_CLICK:l.uniqueId()}});c.ns("controllers.tabbedEntry.adsListing",o)}(window);
//# sourceMappingURL=adsListing.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=b.define,e=b.shared.views.tabbedEntry.individualAd,f=b.strings,g=b.shared.controllers.tabbedEntry.adsListing,h=g.prototype,i=b.shared.models.pages.tabbedEntry,j=d(g,{options:function(){return{containerSelector:".c-partner-listing-fancy",itemClass:e}},getNumOfSelectedAds:function(){var a=this.model.tabAds.getSelectedAds();return a.length},hideCompareError:function(){return this.view.hideCompareError(),this},fadeInAds:function(){var a;return this.isEffectInProgress?this:(this.effectsChain.restart(),a=this.effectsChain.chain,a.append(f.uniqueId(),function(){this.isEffectInProgress=!0,this.view.hideCallout(),this.itemViews.invoke("hide"),this.selectAllView&&this.selectAllView.hide(),a.runNext()}.bind(this)),this.model.isTriFoldEligible()||a.append(f.uniqueId(),function(){this.view.fadeInCallout({done:a.runNext})}.bind(this)),this.itemViews.each(function(b){a.append(f.uniqueId(),function(){b.fadeIn(a.runNext)})},this),this.selectAllView&&a.append(f.uniqueId(),_.bind(function(){this.selectAllView.fadeIn(a.runNext)},this)),a.append(f.uniqueId(),function(){this.isEffectInProgress=!1}.bind(this)),a.run(),this)},showCompareError:function(){return this.view.showCompareError(),this},onAdSelectedChange:function(a,b,c){this.view.hideCompareError(),h.onAdSelectedChange.call(this,a,b,c)},onAdsFetching:function(a){this.view.hideCompareError(0),h.onAdsFetching.call(this,a)},attach:function(){return this.listenTo(this.model.tabAds,"selected:change",this.onAdSelectedChange),this.listenTo(this.model,i.ON_ADS_FETCHING,this.onAdsFetching),h.attach.call(this),this},createItemView:function(a){var b=new this.options.itemClass({model:a},++this.displayedAds);return b.render(),this.view.append(b),this.itemViews.append(a.getId(),b),this}});c.ns("controllers.tabbedEntry.adsListing.fancy",j)}(window);
//# sourceMappingURL=fancy.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=b.shared,e=b.shared.views.searchInput.cruiseDate,f=b.shared.views.searchInput.cruiseLength,g=b.shared.views.searchInput.cruiseLine,h=b.shared.views.searchInput.cruiseLocation,i=b.shared.views.searchInput.date1,j=b.shared.views.searchInput.date2,k=b.dependenciesInjection,l=b.shared.views.searchInput.flexDays,m=b.functional,n=b.shared.views.searchInput.holidayLocation1,o=b.shared.views.searchInput.location1,p=b.shared.views.searchInput.location2,q=b.shared.views.searchInput.nonStop,r=b.shared.views.searchInput.numChildren,s=b.shared.views.searchInput.rooms,t=b.shared.views.searchInput.searchType,u=b.strings,v=b.shared.models.searchData,w=b.shared.views.searchInput.travelers,x=c.View.extend({initialize:function(a){this.date2ContainerEl=this.$(this.options.date2ContainerSelector),k.injectDependencies(this),this.bindMethods().attach()},cruiseDepartureView:null,cruiseLengthView:null,cruiseLineView:null,cruiseLocationView:null,date1View:null,date1TabletView:null,date2TabletView:null,date2ContainerEl:null,date2View:null,flexDaysView:null,holidayLocation1View:null,location1View:null,location2View:null,model:null,nonstopView:null,numChildrenView:null,onewayView:null,updateButton:null,searchWidget:null,backBtn:null,options:function(){return{cruiseLengthSelector:"[data-stm-role=cruiseLength]",cruiseLineSelector:"[data-stm-role=cruiseLine]",cruiseLocationSelector:"[data-stm-role=cruiseLocation]",date1Selector:"[data-stm-role=date1]",date2Selector:"[data-stm-role=date2]",date1TabletSelector:"[data-stm-role=date1ForTablet]",date2TabletSelector:"[data-stm-role=date2ForTablet]",flexDaysSelector:"[data-stm-role=flexDays]",holidayLocation1Selector:"[data-stm-role=holidayLocation1]",location1Selector:"[data-stm-role=location1]",location2Selector:"[data-stm-role=location2]",nonstopSelector:"[data-stm-role=nonstop]",numChildrenSelector:"[data-stm-role=numChildren]",onewaySelector:"[data-stm-role=flightType]",roomsSelector:"[data-stm-role=rooms]",travelersSelector:"[data-stm-role=travelers]",travelMonthSelector:"[data-stm-role=travelMonth]",updateButtonSelector:"[data-stm-role=updateBtn]",date2ContainerSelector:"[data-stm-role=date2Block]",searchWidgetSelector:".c-search-widget-fancy",backBtnSelector:".back-arrow",errorMessagesSelector:".errors"}},roomsView:null,travelersView:null,hide:function(){return this.$el.fadeOut(),this},render:function(){return this.cruiseDepartureView&&this.cruiseDepartureView.render(),this.cruiseLengthView&&this.cruiseLengthView.render(),this.cruiseLineView&&this.cruiseLineView.render(),this.cruiseLocationView&&this.cruiseLocationView.render(),this.date1View&&this.date1View.render(),this.date2View&&this.date2View.render(),this.date1TabletView&&this.date1TabletView.render(),this.date2TabletView&&this.date2TabletView.render(),this.flexDaysView&&this.flexDaysView.render(),this.holidayLocation1View&&this.holidayLocation1View.render(),this.location1View&&this.location1View.render(),this.location2View&&this.location2View.render(),this.nonstopView&&this.nonstopView.render(),this.numChildrenView&&this.numChildrenView.render(),this.onewayView&&this.onewayView.render(),this.roomsView&&this.roomsView.render(),this.travelersView&&this.travelersView.render(),this.updateButton=this.$(this.options.updateButtonSelector),this.searchWidget=$j(this.options.searchWidgetSelector),this.backBtn=$j(this.options.backBtnSelector),this.updateDate2Container(),this},onOnewayChange:function(){this.updateDate2Container()},onInputChange:function(){this.trigger(x.ON_SEARCH_DATA_CHANGE,{trigger:this})},onUpdateButtonClicked:function(a){var b=this.searchWidget;this.searchWidget.addClass("slideDown").on("animationend webkitAnimationEnd",function(){b.removeClass("slideUp"),b.removeClass("slideDown")})},onBackBtnClicked:function(a){var b=this.searchWidget;this.searchWidget.addClass("slideDown").on("animationend webkitAnimationEnd",function(){b.removeClass("slideUp"),b.removeClass("slideDown")})},attach:function(){return this.model.on("change:oneway",this.onOnewayChange),this.model.on("change",this.onInputChange),this.$el.on("click",this.options.updateButtonSelector,this.onUpdateButtonClicked.bind(this)),this.$el.on("click",this.options.backBtnSelector,this.onBackBtnClicked.bind(this)),this},bindMethods:function(){return m.bindMethods(this,["onOnewayChange","onInputChange","render"]),this},getDependencies:function(){return{cruiseDepartureView:function(){var a=this.$(this.options.travelMonthSelector);return a.length?new e({el:a,model:this.model}):null},cruiseLineView:function(){var a=this.$(this.options.cruiseLineSelector);return a.length?new g({el:a,model:this.model}):null},cruiseLengthView:function(){var a=this.$(this.options.cruiseLengthSelector);return a.length?new f({el:a,model:this.model}):null},cruiseLocationView:function(){var a=this.$(this.options.cruiseLocationSelector);return a.length?new h({el:a,model:this.model}):null},date1View:function(){var a=this.$(this.options.date1Selector);return a.length?new i({el:a,dateFormat:a.attr("value").replace("yyyy","yy"),model:this.model}):null},date2View:function(){var a=this.$(this.options.date2Selector);return a.length?new j({el:a,dateFormat:a.attr("value").replace("yyyy","yy"),model:this.model}):null},date1TabletView:function(){var a=this.$(this.options.date1TabletSelector);return a.length?new i({el:a,dateFormat:a.attr("value").replace("yyyy","yy"),model:this.model}):null},date2TabletView:function(){var a=this.$(this.options.date2TabletSelector);return a.length?new j({el:a,dateFormat:a.attr("value").replace("yyyy","yy"),model:this.model}):null},flexDaysView:function(){var a=this.$(this.options.flexDaysSelector);return a.length?new l({el:a,model:this.model}):null},holidayLocation1View:function(){var a=this.$(this.options.holidayLocation1Selector);return a.length?new n({el:a,model:this.model}):null},location1View:function(){var a=this.$(this.options.location1Selector);return a.length?new o({el:a,mode:this.model.mode,model:this.model}):null},location2View:function(){var a=this.$(this.options.location2Selector);return a.length?new p({el:a,mode:this.model.mode,model:this.model}):null},nonstopView:function(){var a=this.$(this.options.nonstopSelector);return a.length?new q({el:a,model:this.model}):null},numChildrenView:function(){var a=this.$(this.options.numChildrenSelector);return a.length?new r({el:a,model:this.model}):null},onewayView:function(){var a=this.$(this.options.onewaySelector);return a.length?new t({el:a,model:this.model}):null},roomsView:function(){var a=this.$(this.options.roomsSelector);return a.length?new s({el:a,model:this.model}):null},travelersView:function(){var a=this.$(this.options.travelersSelector);return a.length?new w({el:a,model:this.model}):null}}},updateDate2Container:function(){return this.model.mode===v.SEARCH_MODE_AIR&&this.date2ContainerEl.toggle(this.model.isRoundTrip()),this}},{ON_SEARCH_DATA_CHANGE:u.uniqueId()});d.ns("views.tabbedEntry.searchWidget",x)}(this);
//# sourceMappingURL=searchWidget.nano.js.map
!function(a){"use strict";var b=a.stm,c=a._,d=b.define,e=b.shared,f=b.dependenciesInjection,g=b.shared.views.tabbedEntry.searchWidget,h=b.strings,i=d(null,e.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=c.extend({},c.result(this,"options"),b),this.start()},model:null,options:function(){return{containerSelector:".c-search-widget"}},view:null,start:function(){return f.injectDependencies(this),this.attach()},stop:function(){return this.detach(),this.view=null,this},onSearchDataChange:function(a){this.trigger(i.ON_SEARCH_DATA_CHANGE,{trigger:this})},attach:function(){return this.listenTo(this.view,g.ON_SEARCH_DATA_CHANGE,this.onSearchDataChange),this},detach:function(){return this.stopListening(),this},getDependencies:function(){return{view:function(){return new g({el:this.model.containerEl.find(this.options.containerSelector),model:this.model.searchData})}}},STATIC:{ON_SEARCH_DATA_CHANGE:h.uniqueId()}});e.ns("controllers.tabbedEntry.searchWidget",i)}(this);
//# sourceMappingURL=searchWidget.nano.js.map
!function(a){"use strict";var b,c,d=a.stm,e=d.shared,f=a.jQuery,g=a._,h=d.define,i=d.shared.models.pages.tabbedEntry;f(function(){b=a.BBAd,c=d.tracking.omniture});var j=h(null,e.getBackboneEvents(),{initialize:function(a){this.model=a,this.attach()},clickTrackedAds:{},loaded:!1,model:null,trackAdClick:function(a){if(!this.loaded)return g.delay(this.trackAdClick.bind(this,a),500),this;var d,e=a.getId();return this.clickTrackedAds[e]||(d=b.singleton(e),d.setMetaDataMulti(a.attributes),c.trackFeaturedSearchClick(e),this.clickTrackedAds[e]=!0),this},trackPageLoad:function(){return this.loaded?(this.model.omnitureData&&(this.model.updateOmnitureAdImpressions(),c.triggerConfigChanged(this.model.omnitureData)),this):(g.delay(this.trackPageLoad.bind(this),500),this)},onConfigDataLoaded:function(){return c?(c.triggerConfigChanged(this.model.omnitureData),void(this.loaded=!0)):void g.delay(this.onConfigDataLoaded.bind(this),100)},attach:function(){return this.listenTo(this.model,i.ON_OMNITURE_DATA_LOADED,this.onConfigDataLoaded),this}});e.ns("controllers.tabbedEntry.omniture",j)}(window);
//# sourceMappingURL=omniture.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=a._,e=b.shared,f=(b.domState,b.strings),g=c.View.extend({initialize:function(a){this.attach()},options:function(){return{activeWidgetSelector:".c-search-widget-fancy",inactiveWidgetSelector:".other-search-widgets",searchModeSelector:".search-mode input",widgetSelector:".mvcView.searchWidget"}},render:function(){var a=this.getSelectedMode(),b=this.$(this.options.searchModeSelector),c=this.$(this.options.activeWidgetSelector),d=this.$(this.options.inactiveWidgetSelector);return b.prop("checked",!1),c.find(this.options.widgetSelector).appendTo(d),d.find(this.options.widgetSelector).filter("."+a).appendTo(c),b.filter("[value="+a+"]").prop("checked",!0),this},onSearchModeChange:function(a){this.trigger(g.ON_SEARCH_MODE_CHANGE,{trigger:this,mode:this.getSelectedMode()})},attach:function(){return this.$(this.options.searchModeSelector).on("change",d.bind(this.onSearchModeChange,this)),this},getSelectedMode:function(){var a=this.$(this.options.searchModeSelector).filter("[type=radio]"),b=a.filter(":checked");return b.length<1&&(b=a.first(),b.prop("checked",!0)),b.val()}},{ON_SEARCH_MODE_CHANGE:f.uniqueId()});e.ns("views.tabbedEntry.multiModeWidget",g)}(this);
//# sourceMappingURL=multiModeWidget.nano.js.map
!function(a){"use strict";var b=a.stm,c=a._,d=b.define,e=b.shared,f=b.dependenciesInjection,g=b.shared.views.tabbedEntry.multiModeWidget,h=b.strings,i=d(null,e.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=c.extend({},c.result(this,"options"),b),f.injectDependencies(this),this.attach()},model:null,options:function(){return{containerSelector:".c-multi-mode-widget"}},view:null,onSearchModeChange:function(a){this.view.render(a.mode),this.trigger(i.ON_SEARCH_MODE_CHANGE,{trigger:this,mode:a.mode})},attach:function(){return this.listenTo(this.view,g.ON_SEARCH_MODE_CHANGE,this.onSearchModeChange),this},getDependencies:function(){return{view:function(){return new g({el:this.model.containerEl.find(this.options.containerSelector),model:this.model})}}},STATIC:{ON_SEARCH_MODE_CHANGE:h.uniqueId()}});e.ns("controllers.tabbedEntry.multiModeWidget",i)}(this);
//# sourceMappingURL=multiModeWidget.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=b.functional,f=b.strings,g=d.View.extend({initialize:function(){this.compareButtonEl=this.$(this.options.buttonSelector),this.bindMethods().attach()},compareButtonEl:null,model:null,options:function(){return{buttonSelector:"> button"}},hide:function(){return this.$el.hide(),this},render:function(){return this.$el.hide().fadeIn(),this},onCompareButtonClick:function(a){this.trigger(g.ON_COMPARE_BUTTON_CLICK,{trigger:this})},attach:function(){return this.compareButtonEl.on("click",this.onCompareButtonClick),this},bindMethods:function(){return e.bindMethods(this,["onCompareButtonClick"]),this}},{ON_COMPARE_BUTTON_CLICK:f.uniqueId()});c.ns("views.tabbedEntry.compareButton",g)}(window);
//# sourceMappingURL=compareButton.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.dependenciesInjection,g=b.shared.views.tabbedEntry.compareButton,h=b.shared.models.pages.tabbedEntry,i=b.strings,j=e(null,c.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=d.extend({},d.result(this,"options"),b),f.injectDependencies(this),this.attach()},model:null,options:function(){return{containerSelector:".compareButton"}},view:null,onAdsFound:function(){this.view.render()},onAdsNotFound:function(){this.view.hide()},onCompareButtonClick:function(){this.trigger(j.ON_COMPARE_BUTTON_CLICK,{trigger:this})},onAdsFetching:function(){this.view.hide(),this.trigger(j.ON_SEARCH_DATA_CHANGE,{trigger:this})},onSearchButtonClick:function(){this.trigger(j.ON_SEARCH_BUTTON_CLICK,{trigger:this})},attach:function(){return this.listenTo(this.model,h.ON_ADS_NOT_FOUND,this.onAdsNotFound),this.listenTo(this.model,h.ON_ADS_FOUND,this.onAdsFound),this.listenTo(this.model,h.ON_ADS_FETCHING,this.onAdsFetching),this.listenTo(this.view,g.ON_COMPARE_BUTTON_CLICK,this.onCompareButtonClick),this},getDependencies:function(){return{view:function(){return new g({el:this.model.containerEl.find(this.options.containerSelector),model:this.model})}}},STATIC:{ON_SEARCH_DATA_CHANGE:i.uniqueId(),ON_SEARCH_BUTTON_CLICK:i.uniqueId()}});c.ns("controllers.tabbedEntry.compareButton",j)}(window);
//# sourceMappingURL=compareButton.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=(a._,b.define),e=(b.cookies,b.strings,b.shared.controllers.alertOnClose),f={data:{air:"Wait! Lower prices may be available for your <%= geo %> flight. Click the tabs to show flight prices for your trip.",car:"Wait! Lower prices may be available for your <%= geo %> car rental. Click the tabs to show car rental prices for your trip.",carUK:"Wait! Lower prices may be available for your <%= geo %> car hire. Click the tabs to show car hire prices for your trip.",cruise:"Wait! Lower prices may be available for your <%= geo %> cruise. Click the tabs to show cruise prices for your trip.",holiday:"Wait! Lower prices may be available for your <%= geo %> holiday package. Click the tabs to show holiday package prices for your trip.",hotel:"Wait! Lower prices may be available for your <%= geo %> hotel. Click the tabs to show hotel prices for your trip.",vacation:"Wait! Lower prices may be available for your <%= geo %> vacation package. Click the tabs to show vacation package prices for your trip.",vacationRental:"Wait! Lower prices may be available for your <%= geo %> vacation rental. Click the tabs to show vacation rental prices for your trip."}},g=d(e,{initialize:function(a,c){e.prototype.initialize.call(this,a,new b.shared.models.alertOnClose,null,null,f)},attach:function(){return this.listenTo(this.model.tabAds,"change:selected",this.onAdSelectedChange),this.listenTo(this.model.dropdownAds,"change:selected",this.onAdSelectedChange),this},shouldShow:function(){var a=1==this.model.getOtherDataQS().alert;return(a||b.pageData.tabbedEntry.alertOnClose)&&!this.shown&&this.searchCount<this.options.searchesToDisable&&this.getTemplate()}});c.ns("controllers.tabbedEntry.alertOnClose",g)}(window);
//# sourceMappingURL=alertOnClose.nano.js.map
// START: CORE-28765
!function(a){"use strict";var b=a.stm,c=a._,d=b.define,e=b.shared,f=b.dependenciesInjection,g=b.shared.models.exitDHTML,h=b.shared.controllers.exitDHTML,i=b.shared.logger,j=e.models.pages.tabbedEntry,k=function(a){b.pageData.queryString&&b.pageData.queryString.enableExitDhtmlConsoleLogging&&i.logMessage("Exit DHTML: "+a)},l=d(null,e.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=c.extend({},c.result(this,"options"),b),f.injectDependencies(this),this.attach()},model:null,options:function(){return{}},exitDHTMLController:null,loaded:!1,onExitDHTMLDataLoaded:function(a){a.response&&a.response.exitDHTML&&!this.exitDHTMLController.shown&&(k("Setting ad info: "+a.response.exitDHTML.enabled),this.exitDHTMLController.reloadAd(a.response)),this.loaded=!0},attach:function(){return this.listenTo(this.model,j.ON_EXIT_DHTML_DATA_LOADED,this.onExitDHTMLDataLoaded),this},setExitDHTMLEnabled:function(){this.exitDHTMLController.model.setEnabled(!0)},getDependencies:function(){return{exitDHTMLController:function(){return new h({dependencies:{model:function(){return new g({enabled:!1})}}})}}},STATIC:{}});e.ns("controllers.tabbedEntry.exitDHTML",l)}(window);
//# sourceMappingURL=exitDHTML.nano.js.map
// END: CORE-28765
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=["ATL","AUS","BNA","BOS","BWI","CDG","CLE","CLT","CUN","DAL","DCA","DEN","DFW","DTW","EWR","FLL","HNL","HOU","IAD","IAH","IND","JAX","JFK","LAS","LAX","LGA","LHR","LON","MCI","MDW","MCO","MIA","MNL","MSP","MSY","OGG","ORD","PBI","PDX","PHL","PHX","PIT","RDU","RSW","SAN","SAT","SEA","SIG","SFO","SJU","SLC","SMF","STL","TPA","YYZ"],f={34439:"MIA",34231:"RSW"},g="http://i.slimg.com/core-sites/bbus/MVCView/Page/TabbedEntry/CityImages/{code}.jpg",h=d.View.extend({initialize:function(a){a=_.extend({forceDefault:!1},a),this.defaultImageURL=a.defaultImageURL,this.forceDefault=a.forceDefault,this.listenTo(this.model,"all",this.render),this.render()},render:function(){var a=this.model.getLocation2Code(),b=this.model.getLocation2Id(),c=this.getImageURL(a,b);this.$el.css("background-image","url("+c+")")},getImageURL:function(a,b){var c;return this.forceDefault?c=null:_.contains(e,a)?c=a:f[b]&&(c=f[b]),c?g.replace("{code}",c):this.defaultImageURL}});c.ns("views.tabbedEntry.backgroundImage",h)}(window);
//# sourceMappingURL=backgroundImage.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=d.View.extend({model:null,hide:function(){return this.$el.hide(),this},show:function(){return this.$el.show(),this}});c.ns("views.tabbedEntry.comparePanel",e)}(window);
//# sourceMappingURL=comparePanel.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.dependenciesInjection,g=b.shared.views.tabbedEntry.comparePanel,h=b.shared.models.pages.tabbedEntry,i=e(null,c.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=d.extend({},d.result(this,"options"),b),f.injectDependencies(this),this.attach()},model:null,options:function(){return{containerSelector:".c-compare-box-fancy"}},view:null,onAdsFound:function(a){this.model.isTriFoldEligible()&&this.view.show()},onAdsNotFound:function(a){this.view.hide()},onSearchDataChange:function(a){var b=a.validateByMode()||[];b.length&&this.view.hide()},attach:function(){return this.listenTo(this.model,h.ON_ADS_NOT_FOUND,this.onAdsNotFound),this.listenTo(this.model,h.ON_ADS_FOUND,this.onAdsFound),this.listenTo(this.model.searchData,"change",this.onSearchDataChange),this},getDependencies:function(){return{view:function(){return new g({el:this.model.containerEl.find(this.options.containerSelector),model:this.model})}}},STATIC:{}});c.ns("controllers.tabbedEntry.comparePanel",i)}(window);
//# sourceMappingURL=comparePanel.nano.js.map

!function(a){function b(b){var g="_smarterpu_"+b,h=0;d.set(g,"",{offset:-7});var i=setInterval(function(){var b=c(g),e=b?b.url:void 0;return a.document.hasFocus()||h++>=f?void clearInterval(i):void(e&&(d.set(g,"",{offset:-7}),a.location.assign(e)))},e)}function c(a){var b=d.get(a);try{return b?JSON.parse(decodeURIComponent(b)):void 0}catch(c){return void 0}}var d=stm.cookies,e=1e3,f=1500;stm.shared.ns("smarterPopunderRedirect",b)}(window);
//# sourceMappingURL=smarterPopunderRedirect.nano.js.map

!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.shared.controllers.tabbedEntry.adsListing,g=b.dependenciesInjection,h=b.shared.featuredSearchUtils,i=b.shared.linkUtils,j=b.shared.metricsUtils,k=b.shared.orderedHash,l=b.shared.models.pages.tabbedEntry,m=b.shared.controllers.tabbedEntry.searchWidget,n=b.strings,o=b.shared.controllers.windowAutoExpander,p=b.shared.smarterPopunderRedirect,q=e(null,c.getBackboneEvents(),{ABSTRACT:!0,"abstract ensureOptimalDisplay":null,"abstract getDependencies":null,initialize:function(b,c){this.element=b,this.options=d.extend({},d.result(this,"options"),c),this.eventNamespace="."+n.uniqueId(),g.injectDependencies(this),this.model.loadPageDataFromQueryString(),this.attach().ensureOptimalDisplay(),this.model.fetchAds();var e=d.extend(n.parseQueryString(a.location.search),n.parseQueryString(a.location.hash)).sa_update_publisher;e&&p(e)},adsListingController:null,element:null,eventNamespace:null,metrics:null,model:null,omnitureController:null,options:function(){return{minimumWindowHeight:600,minimumWindowMargin:20}},searchWidgetController:null,tripDetailsController:null,windowAutoExpanderController:null,onAdClick:function(a){var b=0;a.model&&(b=a.model.getId()),this.openTabBrowsing(b),a.model.setSelected(0),c.getWindow().off(this.eventNamespace)},onAdsDataLoaded:function(){this.searchWidgetController.view.render()},onBeforeAdsFetchAjaxRequest:function(a){this.metrics.startTiming(l.METRICS_KEY_ADS_FETCHING)},onAfterAdsFetchAjaxRequest:function(a){this.metrics.stopTiming(l.METRICS_KEY_ADS_FETCHING)},onHashChange:function(){this.model.loadPageDataFromQueryString(),this.model.fetchAds()},onInvalidSearchMode:function(){a.location="tablander.php"},onPageDataLoaded:function(){d.delay(this.checkMaximizeWindow.bind(this),100)},onSearchButtonClick:function(){this.openTabBrowsing()},onWidgetUpdate:function(){this.adsListingController.view.hasErrors()?this.adsListingController.view.renderErrors():this.model.fetchAds()},onWindowResize:function(){this.ensureOptimalDisplay()},attach:function(){return c.getWindow().on("hashchange"+this.eventNamespace,this.onHashChange.bind(this)),this.listenTo(this.model,l.ON_PAGE_DATA_LOADED,this.onPageDataLoaded),this.listenTo(this.model,l.ON_ADS_FOUND,this.onAdsDataLoaded),this.listenTo(this.model,l.ON_ADS_NOT_FOUND,this.onAdsDataLoaded),this.listenTo(this.model,l.ON_INVALID_SEARCH_MODE,this.onInvalidSearchMode),this.listenTo(this.model,l.ON_WINDOW_RESIZE,this.onWindowResize),this.listenTo(this.adsListingController,f.ON_SEARCH_BUTTON_CLICK,this.onSearchButtonClick),this.listenTo(this.adsListingController,f.ON_LOGO_CLICK,this.onAdClick),this.listenTo(this.searchWidgetController,m.ON_SEARCH_DATA_CHANGE,this.onWidgetUpdate),this.listenTo(this.model,l.ON_BEFORE_AD_FETCH_AJAX_REQUEST,this.onBeforeAdsFetchAjaxRequest),this.listenTo(this.model,l.ON_AFTER_AD_FETCH_AJAX_REQUEST,this.onAfterAdsFetchAjaxRequest),this},checkMaximizeWindow:function(){return this.windowAutoExpanderController||(this.windowAutoExpanderController=new o),this},getDependencies:function(){var a=new k;return a.append("metrics",function(){return new j}),a},openTabBrowsing:function(a){var b=d.extend({},this.model.getSearchDataQS(),this.model.getOtherDataQS(),this.model.getUnknownDataQS(),this.model.tests,{selectedAdId:a}),c=i.getDB5TabBrowsingUrl(b);return h.openTabBrowsingWindow(c),this},STATIC:{}});c.ns("pages.tabbedEntry.controllers.lander",q)}(window);
//# sourceMappingURL=lander.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a._,f=b.shared.controllers.tabbedEntry.alertOnClose,g=(b.shared.models.alertOnClose,b.browser),h=c.controllers.tabbedEntry.compareButton,i=b.define,j=b.shared.controllers.tabbedEntry.adsListing.fancy,k=(b.shared.featuredSearchUtils,b.shared.controllers.tabbedEntry.multiModeWidget),l=b.shared.models.pages.tabbedEntry.multiSelect,m=b.shared.controllers.tabbedEntry.omniture,n=b.popup,o=c.controllers.tabbedEntry.searchWidget,p=c.pages.tabbedEntry.controllers.lander,q=p.prototype,r=c.controllers.tabbedEntry.tripDetails,s=b.shared.controllers.tabbedEntry.exitDHTML,t=b.shared.views.tabbedEntry.backgroundImage,u=(b.shared.linkUtils,b.shared.controllers.tabbedEntry.comparePanel),v=i(p,{browser:g,alertOnCloseController:null,compareButtonController:null,multiModeWidgetController:null,popups:[],holdingWindowUrl:function(){return!a.AWD&&g.chrome&&g.version>=41?"/c/popunder/prepop_animated.html":"/c/popunder/prepop.html"}(),holdingWindowPosition:{startX:a.screenX?a.screenX:a.screenLeft?a.screenLeft:100,startY:a.screenY?a.screenY:a.screenTop?a.screenTop:100,offsetX:25,offsetY:25},ensureOptimalDisplay:function(){return this},ensureWidgetsMatch:function(){var a=this.searchWidgetController.view,b=this.adsListingController.view,c=this.search_modes.view;a.$el.height("auto"),b.$el.height("auto"),c.$el.height("auto");var d=Math.max(a.$el.height(),b.$el.height());return a.$el.height(d),b.$el.height(d),c.$el.height(d),this},isMultiCompareEnabled:function(){var a=!0;return this.browser.ie&&this.browser.version<9?a=!1:this.browser.chrome&&this.browser.version<41&&(a=!1),a},isValidComparisonSearch:function(){var a=this.model.tabAds.getSelectedAds(),b=!1;return this.isMultiCompareEnabled()&&a.length>0&&(b=!0),b},shouldUseHoldingWindows:function(){var a=!1;return this.browser.chrome&&this.browser.version>=41?a=!0:this.browser.ie&&this.browser.version>=11&&!this.isActiveXEnabled()&&(a=!0),a},onCompareButtonClick:function(a){if(this.isMultiCompareEnabled()){if(!this.isValidComparisonSearch())return void this.adsListingController.showCompareError();this.adsListingController.hideCompareError()}this.isMultiCompareEnabled()&&this.shouldUseHoldingWindows()?this.handleMultiCompareWithHoldingWindows():this.handleMultiCompareNoHoldingWindows(),this.exitDHTMLController&&this.exitDHTMLController.exitDHTMLController&&"vacation"!==this.model.getSearchMode()&&("B"===this.model.getABCore29334Recipe()&&this.adsListingController.getNumOfSelectedAds()>=3||"C"===this.model.getABCore29334Recipe()&&this.adsListingController.getNumOfSelectedAds()>=0)&&this.exitDHTMLController.exitDHTMLController.show(!0),this.trigger(v.ON_AD_OPENED)},onAdClick:function(a){if(c.getWindow().off(this.eventNamespace),this.isChromeFullScreen()||!this.isMultiCompareEnabled())this.openVendorWindow(a.model),this.trigger(v.ON_AD_OPENED);else if(this.isMultiCompareEnabled()&&this.shouldUseHoldingWindows()){if(this.isPopOnCompare()&&1==this.getSelectedAds().length)return;if(this.isPopAndRedirect()&&this.getSelectedAds().length<=2)return;this.openHoldingWindow(a.model.getId(),this.holdingWindowUrl)}},onAdsDataLoaded:function(a){p.prototype.onAdsDataLoaded.call(this),this.model.fetchExitDHTMLData(),"B"==this.model.getABCore29989Recipe()&&d("body").addClass("tablet"),"B"==this.model.getABCore30693Recipe()&&d("body").addClass("core30693B"),"C"==this.model.getABCore30693Recipe()&&d("body").addClass("core30693C"),this.model.isTriFoldEligible()&&this.shouldShowCompareButton()?this.enableTriFoldLayout():this.disableTriFoldLayout(),this.ensureWidgetsMatch()},onSearchModeChange:function(a){var c=this.model.getSearchDataQS();c.mode=a.mode,b.pageData.mode=a.mode,b.pageData.tabbedEntry.mode=a.mode,this.model.searchData&&(this.model.searchData.mode=a.mode),this.searchWidgetController.stop().start(),this.model.fetchAds()},onWidgetUpdate:function(){this.isMultiCompareEnabled()&&this.adsListingController.hideCompareError(0);var a=this.model.searchData.validateByMode()||[];a.length&&(this.disableTriFoldLayout(),this.ensureWidgetsMatch()),p.prototype.onWidgetUpdate.call(this)},onAdsNotFound:function(a){this.disableTriFoldLayout(),this.ensureWidgetsMatch()},attach:function(){return p.prototype.attach.call(this),this.shouldShowCompareButton()&&(this.listenTo(this.compareButtonController,h.ON_COMPARE_BUTTON_CLICK,this.onCompareButtonClick),this.listenTo(this.triFoldCompareButtonController,h.ON_COMPARE_BUTTON_CLICK,this.onCompareButtonClick)),this.listenTo(this.multiModeWidgetController,k.ON_SEARCH_MODE_CHANGE,this.onSearchModeChange),d(a).on("unload",this.removeHoldingWindows.bind(this)),this.listenTo(this.model,l.ON_ADS_NOT_FOUND,this.onAdsNotFound.bind(this)),this.listenTo(this.searchWidgetController,o.ON_SEARCH_DATA_CHANGE,this.onWidgetUpdate),this},deriveHoldingWindowHeight:function(){var a=v.PREPOP_ANIMATED_HEIGHT;return this.browser.ie&&(a=v.PREPOP_LEGACY_HEIGHT),a},deriveHoldingWindowPositionLeft:function(a){var b;return b=this.browser.chrome?9999:this.holdingWindowPosition.startX+a*this.holdingWindowPosition.offsetX},deriveHoldingWindowPositionTop:function(a){var b;return b=this.browser.chrome?9999:this.holdingWindowPosition.startY+a*this.holdingWindowPosition.offsetY},deriveHoldingWindowWidth:function(){var a=v.PREPOP_ANIMATED_WIDTH;return this.browser.ie&&(a=v.PREPOP_LEGACY_WIDTH),a},getDependencies:function(){var a=q.getDependencies.call(this);return a.append("model",function(){return new l({el:this.element},{dependencies:{preSelectFirstAd:this.shouldPreSelectFirstAd()}})}),a.append("alertOnCloseController",function(){return new f(this.model)}),a.append("searchWidgetController",function(){return new o(this.model,{containerSelector:".c-search-widget-fancy"})}),a.append("multiModeWidgetController",function(){var a=new k(this.model);return a.view.render(),a}),a.append("search_modes",function(){return new k(this.model,{containerSelector:".search-modes"})}),a.append("omnitureController",function(){return new m(this.model)}),a.append("adsListingController",function(){return new j(this.model)}),a.append("tripDetailsController",function(){return new r(this.model)}),a.append("exitDHTMLController",function(){return new s(this.model)}),a.append("backgroundImageView",function(){return new t({model:this.model.searchData,el:this.element,forceDefault:!0,defaultImageURL:v.DEFAULT_BACKGROUND_IMAGE})}),this.shouldShowCompareButton()&&(a.append("compareButtonController",function(){return new h(this.model,{containerSelector:".c-partner-listing-fancy .compareButton"})}),a.append("triFoldComparePanelController",function(){return new u(this.model)}),a.append("triFoldCompareButtonController",function(){return new h(this.model,{containerSelector:".c-compare-box-fancy .compareButton"})})),a},getHoldingWindow:function(){if(this.popups.length<1)return null;var a=this.popups.shift();return a.popupWindow&&!a.popupWindow.closed?a:this.getHoldingWindow()},handleMultiCompareWithHoldingWindows:function(){var a=e.compact(e.filter(this.popups,function(a){return a.popupWindow.window})),b=this.getSelectedAds(),c=a.length+1;this.isPopAndRedirect()&&(c+=1);var d=b.slice(0,c).reverse();d[0].fauxHack&&(d=e.filter(b,function(a){return!a.fauxHack}).slice(0,c).reverse());for(var f=0;f<d.length;f++){var g=d[f];if(this.isPopAndRedirect()&&d.length>=c&&0==f)!function(a){setTimeout(function(){document.location.href=a.getInterstitialUrl()},1e3)}(g);else{var h=a.shift(),i=!0;h||(this.popups=[],this.openHoldingWindow(Math.random(),g.getInterstitialUrl()),i=!1,h=this.popups.shift()),h.focus(),i&&h.setLocation(g.getInterstitialUrl()),g.fauxHack?h.fauxExpand():h.expand(),this.omnitureController.trackAdClick(g)}}this.popups=[]},handleMultiCompareNoHoldingWindows:function(){var b,c=this.getSelectedAds(),d={left:0,top:0},e=100;this.isMultiCompareEnabled()&&a.outerHeight&&a.innerHeight&&(e=a.outerHeight-a.innerHeight);for(var f=c.length-1;f>=0;f--){c[f];b=this.openVendorWindow(c[f],d,b),d.left+=50,d.top+=e}return this},isActiveXEnabled:function(){var a;try{a=new ActiveXObject("htmlFile")}catch(b){}return"object"==typeof a},getSelectedAds:function(){var a=this.model.tabAds.getSelectedAds().slice();if(this.model.awdFauxAd&&!this.model.isOneWay()&&!g.Platform.isTablet){var b=e.indexOf(a,e.find(a,function(a){return/Airfarewatchdog/.test(a.getDisplayName())}));-1!=b&&a.splice(b,0,this.model.awdFauxAd)}return a},openHoldingWindow:function(a,b,c,d){if(this.popups.length>=this.model.tabAds.getSelectedAds().length)return this;var f="STFancyLanderWindow_"+a,g=c?c:this.popups.length,h=e.extend({},{name:f,popunder:!this.browser.chrome,width:this.deriveHoldingWindowWidth(),height:this.deriveHoldingWindowHeight(),top:this.deriveHoldingWindowPositionTop(g),left:this.deriveHoldingWindowPositionLeft(g),otherFeatures:{menubar:1,toolbar:1}},d),i=new n(b,h);return this.popups.push(i.tryPop()),this.browser.chrome&&i.pushToLowerRight(),this},openVendorWindow:function(b,c,d){var f,g={},h="STFancyLanderWindow_"+b.getId(),i=b.getInterstitialUrl();if(this.browser.chrome)g.name=h;else{var j=a.outerHeight>0?a.outerHeight:document.documentElement.clientHeight,k=a.outerWidth>0?a.outerWidth:document.documentElement.clientWidth;if(g.center=!1,g.width=parseInt(.8*k,10),g.height=parseInt(.8*j,10),g.name=h,this.browser.ie&&this.browser.version>=9)return g=e.extend({toolbar:1,location:1,scrollbars:1},g,c),b.fauxHack&&(g.left+=250,g.width-=300,g.height-=95,g.top+=35),this.openActiveXWindow(i,g.name,g,1)&&this.omnitureController.trackAdClick(b),this;g.otherFeatures={menubar:1,toolbar:1}}if(g=e.extend({},g,c),b.fauxHack&&d){var l=d.popupWindow;l&&(g=e.extend(g,this.fauxOf(l)))}return f=new n(i,g),f.tryPop(),f.hasPopped&&this.omnitureController.trackAdClick(b),f},fauxOf:function(a){var b=300,c=120,d={left:a.screenX+b,width:a.innerWidth-b,top:a.screenY+c,height:a.innerHeight-c};return g.safari&&(d.width=780,d.height=630,d.top-=42),g.firefox&&"windows"==g.platform&&(d.top+=5,d.height-=5),d},openActiveXWindow:function(a,b,c,e){var f,g,h,i,j=d.param(c).replace(/&/g,","),k=!1;g=document.createElement("iframe"),g.style.display="none",g.innerHTML="<html><body></body></html>",this.element.append(g),h=new g.contentWindow.ActiveXObject("htmlFile"),h.open(),h.close(),g.contentDocument.open();try{i=new h.parentWindow.ActiveXObject("htmlFile"),f=i.parentWindow.open(a,b,j),f.focus(),k=!0}catch(l){e>0&&(k=this.openActiveXWindow(a,b,j,--e))}finally{this.element.find(g).remove()}return k},removeHoldingWindows:function(){return this.popups.length<1?this:(e.each(this.popups,function(a){if(a.popupWindow)try{a.popupWindow.close()}catch(b){}}),this)},shouldShowCompareButton:function(){return this.isMultiCompareEnabled()?!0:this.browser.ie&&11===this.browser.version?!0:!1},shouldPreSelectFirstAd:function(){return this.shouldShowCompareButton()&&this.browser.ie&&this.browser.version>=11&&!this.isActiveXEnabled()},isChromeFullScreen:function(){var b=a.innerWidth===screen.width&&a.innerHeight===screen.height,c=this.browser.Platform.mac&&0===a.screenTop,d=g.Platform.ios||g.Platform.android;return this.browser.chrome&&(d||b||c)},isPopOnCompare:function(){return!!document.location.href.match(/chwt=pop_on_compare/)},isPopAndRedirect:function(){return!!document.location.href.match(/chwt=pop_and_redirect/)},enableTriFoldLayout:function(){return d(".c-page-content-fancy").addClass("tri-fold"),this.adsListingController.view.$el.find(".c-compare").hide(),this},disableTriFoldLayout:function(){return d(".c-page-content-fancy").removeClass("tri-fold"),this},STATIC:{PREPOP_ANIMATED_HEIGHT:305,PREPOP_ANIMATED_WIDTH:177,PREPOP_LEGACY_HEIGHT:600,PREPOP_LEGACY_WIDTH:800,DEFAULT_BACKGROUND_IMAGE:"http://i.slimg.com/core-sites/bbus/MVCView/Page/TabbedEntry/Fancy/tropical-pier.jpg?q=2014073001",ON_AD_OPENED:"ad_opened"}});c.ns("pages.tabbedEntry.controllers.fancy",v)}(window);
//# sourceMappingURL=fancy.nano.js.map

// ===========================================
// TabLander
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a._,f=b.define,g=b.autoInitialize,h=b.cookies,i=b.dependenciesInjection,j=b.shared.controllers.exitDHTML,k=b.shared.models.exitDHTML,l=b.functional,m=b.shared.orderedHash,n=b.shared.models.searchData,o={message:"Wait! You could be missing out on great prices for your trip. Perform a search below, then click tabs on the next screen to compare rates from our partner sites. "},p=f(null,c.getBackboneEvents(),{initialize:function(a,b){this.element=a,this.options=e.extend({},e.result(this,"options"),b),i.injectDependencies(this),this.attach().bindMethods().updateExitDHTMLStatus()},element:null,exitDHTMLController:null,options:function(){return{searchModeLabelSelector:".search_mode_label",searchModeOptionSelector:".search_mode_option"}},shown:!1,searchData:null,onBeforeUnload:function(){return this.shouldShow()?(this.shown=!0,this.getMessage()):void 0},onDateChange:function(){e.isDate(this.searchData.getDate1())&&e.isDate(this.searchData.getDate2())&&d.publish("datesChanged"),this.fetchExitDHTML()},onDatePickerClose:function(a,b){e.isDate(this.searchData.getDate1())&&e.isDate(this.searchData.getDate2())&&d.publish("datesChanged")},onLocationChange:function(){this.fetchExitDHTML()},onSearchModeOptionClick:function(a){d(this.options.searchModeOptionSelector).removeClass("active"),d(this.options.searchModeOptionSelector).addClass("inactive");var b=d(a.currentTarget);b.removeClass("inactive"),b.addClass("active")},onSearchModeLabelClick:function(a){d(this.options.searchModeLabelSelector).removeClass("active"),d(this.options.searchModeLabelSelector).addClass("inactive");var b=d(a.currentTarget);b.removeClass("inactive"),b.addClass("active")},attach:function(){return this.listenTo(this.searchData,"change:date1",e.debounce(this.onDateChange,500)),this.listenTo(this.searchData,"change:date2",e.debounce(this.onDateChange,500)),this.listenTo(this.searchData,"change:location1",e.debounce(this.onLocationChange,500)),this.listenTo(this.searchData,"change:location2",e.debounce(this.onLocationChange,500)),b.pageData&&b.pageData.core29124&&-1!==d.inArray(b.pageData.core29124.userPool,["B","C","D"])&&(d(this.options.searchModeLabelSelector).on("click",this.onSearchModeLabelClick.bind(this)),d(this.options.searchModeOptionSelector).on("click",this.onSearchModeOptionClick.bind(this))),this},bindMethods:function(){return l.bindMethods(this,["onDateChange","onDatePickerClose","onLocationChange","updateExitDHTML"]),this},getDependencies:function(){return new m([["exitDHTMLController",function(){return new j}],["searchData",function(){return n.createGlobal()}]])},getMessage:function(){var a=e.template(o.message);return a()},fetchExitDHTML:function(){return d.ajax({url:k.EXIT_DHTML_URL,data:{search_mode:n.SEARCH_MODE_HOTEL,site_page:"Tab Lander"},success:this.updateExitDHTML}),this},shouldShow:function(){var a="true"===h.get("alertonclose"),c=b.pageData&&b.pageData.ignoreAlertOnClose;return a&&!this.shown&&!c},updateExitDHTML:function(a){return this.exitDHTMLController.reloadAd(a),this.updateExitDHTMLStatus()},updateExitDHTMLStatus:function(){var a=e.isObject(this.searchData.getLocation1())&&e.isObject(this.searchData.getLocation2());return this.exitDHTMLController.model.setEnabled(a,this.exitDHTMLController.options),this},STATIC:{autoInitialize:function(a){g.loadClass(p,a?a:"tablander",!0)}}});p.autoInitialize(),c.ns("controllers.tabLander",p)}(window);
//# sourceMappingURL=tabLander.nano.js.map

// ===========================================
// Go Meta Go
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.Chain,g=b.functional,h=c.models.searchData,i=e({initialize:function(a,c){this.element=a,this.options=d.extend({},d.result(this,"options"),c),b.searchData||(b.searchData=new h,b.searchData.fetch()),this.bindMethods().dispatch()},ABSTRACT:!0,"abstract sendClickstreamChainItem":null,"abstract sendOmnitureChainItem":null,"abstract setupTrackingChainItem":null,element:null,omnitureCheckCounter:0,options:function(){return{maxOmnitureChecks:4,omnitureCheckDelay:500}},bindMethods:function(){return g.bindMethods(this,["checkOmnitureChainItem","handleStupidIOSChainItem","redirectUserChainItem","sendClickstreamChainItem","sendOmnitureChainItem","setupTrackingChainItem"]),this},checkOmnitureChainItem:function(b){var c=a.s.pageImages[a.s.pageImages.length-1],e=c&&c.complete,f=++this.omnitureCheckCounter<this.options.maxOmnitureChecks;return e||!f?(b.runNext(),this):(d.delay(this.checkOmnitureChainItem,this.options.omnitureCheckDelay,b),this)},dispatch:function(){var a=new f;return a.append("setup tracking",d.partial(this.setupTrackingChainItem,a)),a.append("handle stupid iOS",d.partial(this.handleStupidIOSChainItem,a)),a.append("send omniture",d.partial(this.sendOmnitureChainItem,a)),a.append("check omniture completeness",d.partial(this.checkOmnitureChainItem,a)),a.append("send clickstream",d.partial(this.sendClickstreamChainItem,a)),a.append("redirect user",d.partial(this.redirectUserChainItem,a)),a.run(),this},handleStupidIOSChainItem:function(a){var c,d=b.pageData.deviceInfo.browser&&"safari"===b.pageData.deviceInfo.browser.toLowerCase(),e=b.pageData.deviceInfo.os&&"ios"===b.pageData.deviceInfo.os.toLowerCase(),f=[6,1,3],g=null;if(d&&e&&(g=b.pageData.deviceInfo.version.split("."),g&&g.length))for(c=0;c<f.length&&c<g.length&&!(isNaN(g[c])||g[c]>f[c]);c++)if(g[c]<f[c]){this.omnitureCheckCounter=this.options.maxOmnitureChecks;break}return a.runNext(),this},redirectUserChainItem:function(c){return a.location=b.pageData.goMetaGo.destinationUrl,c.runNext(),this},STATIC:{}});c.ns("controllers.goMetaGo",i)}(window);
//# sourceMappingURL=goMetaGo.nano.js.map

// ===========================================
// META Leave Behind Popunder
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.shared.models.metaHotel,f=e.extend({defaults:function(){var a=e.prototype.defaults.call(this);return d.extend(a,{name:"",taRating:0,url:""})},getName:function(){return this.get("name")},setName:function(a,b){return this.set("name",a,b)},getTARating:function(){return this.get("taRating")},setTARating:function(a,b){return this.set("taRating",a,b)},getUrl:function(){return this.get("url")},setUrl:function(a,b){return this.set("url",a,b)},getVendorsCount:function(){return null!==this.vendors?this.vendors.length:0}});c.ns("models.metaHotel.leaveBehind",f)}(window);
//# sourceMappingURL=leaveBehind.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a._,f=b.domState,g=c.models.metaVendor,h=c.views.metaWidget.basicVendors,i=h.extend({options:function(){var a=h.prototype.options.call(this);return e.extend(a,{maximumVendorsToDisplay:4})},render:function(a,b){var c=this,i=0;return c.$el.html(""),a?(e.each(a,function(a){if(i===c.options.maximumVendorsToDisplay)return!1;var e,j=d("<div />");j.append(c.template(a.attributes)),e=j.children(),b?f.add(e,b):a.getDataState()===g.STATE_AVAILABLE?f.add(e,h.STATE_AVAILABLE):a.getDataState()===g.STATE_PENDING?f.add(e,h.STATE_PENDING):a.getDataState()===g.STATE_UNAVAILABLE?f.add(e,h.STATE_UNAVAILABLE):f.add(e,h.STATE_UNKNOWN),e.data("metaVendor",a),c.$el.append(e),++i}),this):c}},{});c.ns("views.metaWidget.basicVendors.leaveBehind",i)}(window);
//# sourceMappingURL=leaveBehind.nano.js.map
!function(a){"use strict";var b=a.stm,c=a._,d=a.jQuery,e=b.shared,f=e.views.metaWidget.chevronVendors,g=e.views.metaWidget.container,h=b.dates,i=e.views.metaWidget.basicVendors.leaveBehind,j=e.metaUtils,k=g.extend({constructor:function(a,b){b=c.extend({},b,{model:a}),g.prototype.constructor.call(this,a,b);var d=this.$(this.options.hotelInfoTemplateSelector);this.hotelInfoTemplate=d&&d.length?c.template(d.html()):function(){},d=this.$(this.options.seeAllTemplateSelector),this.seeAllTemplate=d&&d.length?c.template(d.html()):function(){}},options:function(){var a=g.prototype.options.call(this);return c.extend(a,{basicVendorsSelector:".leaveBehindBasicVendors",chevronVendorsSelector:".leaveBehindChevronVendors",hotelImageSelector:".hotelImage",hotelInfoContainerSelector:".hotel",hotelInfoTemplateSelector:"[data-template-name='mvcView_metaWidget_leaveBehindHotel']",seeAllContainerSelector:".seeAllVendors",seeAllTemplateSelector:"[data-template-name='mvcView_metaWidget_leaveBehindHotel_seeAll']"})},hotelInfoTemplate:null,seeAllTemplate:null,onVendorClick:function(a){var c=d(a.currentTarget),e=c.data("metaVendor"),f=b.searchData.getDate1(),h=b.searchData.getDate2();f||(f=new Date,f.setDate(f.getDate()+7)),h||(h=new Date,h.setDate(f.getDate()+7)),this.showVendor(e,f,h),this.trigger(g.EVENT_VENDOR_CLICKED,this,e),d.publish(g.EVENT_VENDOR_CLICKED,[this,e])},attach:function(){return this.$el.on("click",this.options.individualVendorSelector,this.onVendorClick),this},getDependencies:function(){return{basicVendorsView:function(){return new i({el:this.$el.find(this.options.basicVendorsSelector)})},chevronVendorsView:function(){return new f({el:this.$el.find(this.options.chevronVendorsSelector)})}}},render:function(c){if(!this.model)return this;var d=0,e=this.$el.find(this.options.seeAllContainerSelector),f=this.model.attributes;return f.windowTarget=a.location.href.indexOf("popunder")>0?"_blank":"_self",this.$el.data("leaveBehindContainerHotelInfo")||(this.$el.find(this.options.hotelInfoContainerSelector).html("").append(this.hotelInfoTemplate(f)),b.TAHotelImages.insertImages(this.$(this.options.hotelImageSelector)),this.$el.data("leaveBehindContainerHotelInfo",this)),this.model.vendors&&(d=this.model.vendors.length,f.vendorCount=d),1>d?e.hide():e.html("").append(this.seeAllTemplate(f)).show(),this.model.setAvailability(!0),g.prototype.render.call(this,c),this},showVendor:function(a,d,e){var f,g=a.getDisplayName();if(j.isTabBrowsingSupported(a.getFauxTabs()))j.openTabBrowsingWindow(this.model.getId(),h.formatDate("yy-mm-dd","undefined"!=typeof d?d:b.searchData.getDate1()),h.formatDate("yy-mm-dd","undefined"!=typeof e?e:b.searchData.getDate2()),b.searchData.getTravelers(),a.getId());else{var i=j.getMetaVendorWindowDimensions(g),k={additionalUrlParams:[{name:"originatingPage",value:b.tracking.omniture.getPageName()}]};f=c.extend({},i,k),j.openVendorInNewWindow(a,f,!!i)}return this}});e.ns("views.metaWidget.container.leaveBehind",k)}(this);
//# sourceMappingURL=leaveBehind.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.shared.models.searchData,g=c.controllers.metaWidget,h=c.views.metaWidget.container,i=c.models.metaHotel.leaveBehind,j=c.views.metaWidget.container.leaveBehind,k=e(g,{initialize:function(a,c){var e=this;e.options=d.extend({},d.result(e,"options"),c);var h=a.find(e.options.leaveBehindHotelWidgetSelector);!b.pageData.leaveBehindHotels||h.length<1||(b.searchData||(b.searchData=new f),b.pageData.queryString.date1&&b.searchData.setDate1(new Date(b.pageData.queryString.date1/1)),b.pageData.queryString.date2&&b.searchData.setDate2(new Date(b.pageData.queryString.date2/1)),g.prototype.initialize.call(e,a,c))},options:function(){var a=g.prototype.options.call(this),b=!0;return a.createContainer=function(a,b){return new j(b,{el:a,showDatepickerOnNoDates:!!a.data("showDatepickerOnNoDates")})},d.extend(a,{excludeHotelId:0,leaveBehindHotelWidgetSelector:".mvcView.metaWidget.leaveBehindHotel",numberOfLeaveBehindHotelsToDisplay:4,updateOnConstruction:b})},attach:function(){return this},prepareForSearchChainItem:function(a){for(var c=0,d=0;d<b.pageData.leaveBehindHotels.length;d++){var e=b.pageData.leaveBehindHotels[d],f=null,j=this.element.find('[data-hotel-id="'+e.id+'"]'),l=null,m=!1;j.hide(),e.id==this.options.excludeHotelId||c>=this.options.numberOfLeaveBehindHotelsToDisplay||(f=this.client.hotels.get(e.id),f||(f=new i({id:e.id,name:e.name,taRating:e.taRating,url:e.url}),this.client.hotels.add(f)),f.setDataLoaded(!1),m=j.data(k.DATA_KEY_LEAVE_BEHIND_VIEW_INIT),m?l=j.data(g.DATA_KEY_CONTAINER_VIEW):(l=this.options.createContainer.call(this,j,f),j.data(g.DATA_KEY_CONTAINER_VIEW,l),j.data(k.DATA_KEY_LEAVE_BEHIND_VIEW_INIT,!0)),j.show(),l.render(h.STATE_INITIAL),++c)}return a.runNext(),this},STATIC:{DATA_KEY_LEAVE_BEHIND_VIEW_INIT:"stm-bbus-shared-controllers-metaWidget-leaveBehind:data-key-leave-behind-view-init"}});c.ns("controllers.metaWidget.leaveBehind",k)}(window);
//# sourceMappingURL=leaveBehind.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a._,f=b.define,g=b.functional,h=b.dates,i=b.dependenciesInjection,j=b.Popup,k=c.controllers.metaPopunder,l=c.views.metaWidget.container,m=b.browser,n=f({initialize:function(a,c){this.isEnabled()&&(this.element=a,this.options=e.extend({},e.result(this,"options"),c),b.pageData.noDealsPopunder=!0,i.injectDependencies(this),this.bindMethods().attach())},options:function(){return{url:"/popunder/metaleavebehind?",holdingWindowUrl:"/prepop.php",windowWidth:918,windowHeight:563}},metaLeaveBehindPopunder:null,lastHotelId:0,isVendorClick:!1,onClick:function(a){if(this.isVendorClick)return void(this.isVendorClick=!1);if(a){var b=d(a.target);if(b.hasClass("noFirstClick")||b.parents(".noFirstClick").length)return}this.metaLeaveBehindPopunder.popupWindow&&this.metaLeaveBehindPopunder.popupWindow.location||this.showPopunder(this.lastHotelId),this.element.off("click."+k.EVENT_NAMESPACE,this.onClick),this.isVendorClick=!0},onDatepickerClose:function(a,c){if(c){var d=b.searchData.getDate1(),e=this.lastHotelId,f=this.element.find(".currentlyActiveDatepicker");a&&a.target&&f.length>0&&(e=this.getHotelId(f)),d&&this.showPopunder(e),f.removeClass("currentlyActiveDatepicker")}},onDatepickerShow:function(a){this.element.find(".currentlyActiveDatepicker").removeClass("currentlyActiveDatepicker"),d(a.target).addClass("currentlyActiveDatepicker")},onVendorClicked:function(a){this.isVendorClick=!0,this.metaLeaveBehindPopunder.popupWindow&&this.metaLeaveBehindPopunder.popupWindow.location&&this.showPopunder(a.model.getId())},attach:function(){return this.element.on("click."+k.EVENT_NAMESPACE,this.onClick),d.subscribe("datepicker:beforeClose",this.onDatepickerClose),d.subscribe("datepicker:afterShow",this.onDatepickerShow),d.subscribe(l.EVENT_VENDOR_CLICKED,this.onVendorClicked),this},bindMethods:function(){return g.bindMethods(this,["onClick","onDatepickerClose","onDatepickerShow","onVendorClicked","showPopunder","getUrl","getHotelId"]),this},getDependencies:function(){var a=this.options.windowHeight,c=this.options.windowWidth,d="";return b.pageData&&b.pageData.deviceInfo&&b.pageData.deviceInfo.browser&&(d=b.pageData.deviceInfo.browser.toLowerCase(),d.indexOf("safari")>-1?a=516:d.indexOf("firefox")>-1&&(a=565)),{metaLeaveBehindPopunder:function(){var b=new j(null,{name:"stmMetaLeaveBehindPopunder",allowRepeat:!0,popunder:!0,width:c,height:a,holdingWindowUrl:this.options.holdingWindowUrl});return b}}},getUrl:function(a){var c,e=this.options.url,f=b.searchData.getDate1(),g=b.searchData.getDate2();return c={mcid:b.pageData.metaMCID,location2:b.searchData.getLocation2Id(),arrival_date:f?h.formatDate(d.datepicker._defaults.dateFormat,f):null,departure_date:g?h.formatDate(d.datepicker._defaults.dateFormat,g):null,travelers:b.searchData.getTravelers()},!isNaN(a)&&a>0&&(c.talid=a),e+d.param(c)},getHotelId:function(a){if(a){var b=parseInt(a.data("hotel-id"),10);if(b&&!isNaN(b))return b;if(a.parent().length>0)return this.getHotelId(a.parent())}return null},showPopunder:function(a){var b=this.metaLeaveBehindPopunder.url;return this.metaLeaveBehindPopunder.url=this.getUrl(a),b===this.metaLeaveBehindPopunder.url?this:(this.metaLeaveBehindPopunder.popupWindow&&this.metaLeaveBehindPopunder.popupWindow.location?this.metaLeaveBehindPopunder.popupWindow.location=this.metaLeaveBehindPopunder.url:(this.metaLeaveBehindPopunder.tryPop(),this.metaLeaveBehindPopunder.hasPopped&&d.publish(n.EVENT_LEAVE_BEHIND_POPPED,[this.metaLeaveBehindPopunder])),this.lastHotelId=a,this)},isEnabled:function(){return m.safari&&"ios"==m.platform&&m.version>=8?!1:!0},STATIC:{EVENT_LEAVE_BEHIND_POPPED:"stm-shared-controllers-leaveBehindPopunder:leaveBehindPopped"}});c.ns("controllers.leaveBehindPopunder",n)}(window);
//# sourceMappingURL=leaveBehindPopunder.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=b.define,e=b.autoInitialize,f=c.controllers.pagesWithMetaWidgets,g=c.controllers.metaWidget.leaveBehind,h=c.controllers.closeWindow,i=d(f,{getDependencies:function(){var a=f.prototype.getDependencies.call(this);return a.metaWidgetController=function(){return new g(this.element.find('[data-metaleavebehind="true"]'))},a.closeWindowController=function(){return new h},a},STATIC:{autoInitialize:function(a){e.loadClass(i,a?a:"autoinit-shared-metaLeaveBehind-popunder",!0)}}});i.autoInitialize(),c.ns("pages.popunder.metaleavebehindpopunder.controllers.main",i)}(window);
//# sourceMappingURL=main.nano.js.map

// ===========================================
// Blender Popunder
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=(a.jQuery,a._),f=d.View.extend({initialize:function(){var a=this.$(this.options.templateSelector);this.template=a&&a.length?e.template(a.html()):function(){}},options:function(){return{templateSelector:"[data-template-name='relatedfares-fare']"}},template:null,render:function(a){var b=this;return e.each(a,function(a){var c=b.template(a);b.$el.append(c)}),b.$el.slideDown(),this}});c.ns("views.relatedFares",f)}(window);
//# sourceMappingURL=relatedFares.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=c.views.relatedFares,g=b.strings,h=e(null,c.getBackboneEvents(),{constructor:function(a,b,c,e,g){this.element=a,this.fareId=b,this.depAirportCode=c,this.arrAirportCode=e,this.options=d.extend({},d.result(this,"options"),g),this.relatedFaresView=new f({el:this.element.find(this.relatedFaresSelector)}),this.makeRequest()},element:null,fareId:0,depAirportCode:"",arrAirportCode:"",options:function(){return{fareCount:9}},url:"/relatedfares",relatedFaresView:null,relatedFaresSelector:".faresSidebar .relatedFares",makeRequest:function(){var a={orig_fare_id:this.fareId,dep:this.depAirportCode,arr:this.arrAirportCode,fare_count:this.options.fareCount};return $j.ajax({url:this.url,data:a}).always(d.bind(this.handleServerResponse,this)),this},handleServerResponse:function(a){return a.success?this.relatedFaresView.render(a.fares):this.trigger(h.ON_RELATED_FARES_RESPONSE_FAILURE,{trigger:this}),this},STATIC:{ON_RELATED_FARES_RESPONSE_FAILURE:g.uniqueId()}});c.ns("controllers.relatedFares",h)}(window);
//# sourceMappingURL=relatedFares.nano.js.map
!function(a){"use strict";var b=a.stm,c=a._,d=b.define,e=b.shared,f=b.dependenciesInjection,g=b.shared.views.tabbedEntry.searchWidget,h=b.strings,i=d(null,e.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=c.extend({},c.result(this,"options"),b),this.start()},model:null,options:function(){return{containerSelector:".c-search-widget"}},view:null,start:function(){return f.injectDependencies(this),this.attach()},stop:function(){return this.detach(),this.view=null,this},onSearchDataChange:function(a){this.trigger(i.ON_SEARCH_DATA_CHANGE,{trigger:this})},attach:function(){return this.listenTo(this.view,g.ON_SEARCH_DATA_CHANGE,this.onSearchDataChange),this},detach:function(){return this.stopListening(),this},getDependencies:function(){return{view:function(){return new g({el:this.model.containerEl.find(this.options.containerSelector),model:this.model.searchData})}}},STATIC:{ON_SEARCH_DATA_CHANGE:h.uniqueId()}});e.ns("controllers.tabbedEntry.searchWidget",i)}(this);
//# sourceMappingURL=searchWidget.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=b.functional,f=b.strings,g=d.View.extend({initialize:function(){this.searchButtonEl=this.$(this.options.searchButtonSelector),this.bindMethods().attach()},options:function(){return{searchButtonSelector:".button"}},searchButtonEl:null,onSearchButtonClick:function(){this.trigger(g.ON_SEARCH_BUTTON_CLICK,{trigger:this})},attach:function(){return this.searchButtonEl.on("click",this.onSearchButtonClick),this},bindMethods:function(){return e.bindMethods(this,["onSearchButtonClick"]),this}},{ON_SEARCH_BUTTON_CLICK:f.uniqueId()});c.ns("views.blenderPopunder",g)}(window);
//# sourceMappingURL=blenderPopunder.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=b.functional,e=b.shared.models.pages.tabBrowsing,f=b.shared.models.searchData,g=e.extend({getSearchMode:function(){return f.SEARCH_MODE_AIR},attach:function(){return this.listenTo(this.searchData,"change",this.onSearchDataChange),this.listenTo(this.searchData,f.ON_FULL_UPDATE,this.onSearchDataChange),this},bindMethods:function(){return d.bindMethods(this,["onSearchDataChange"]),this}},{});c.ns("models.pages.blenderPopunder",g)}(window);
//# sourceMappingURL=blenderPopunder.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.autoInitialize,g=c.views.blenderPopunder,h=b.dependenciesInjection,i=b.shared.featuredSearchUtils,j=c.linkUtils,k=b.dates,l=c.orderedHash,m=c.models.pages.blenderPopunder,n=c.controllers.relatedFares,o=c.controllers.tabbedEntry.searchWidget,p=function(){return b.tracking?b.tracking.omniture:null},q=function(){return b.pageData.omnitureConfigs},r=e(null,c.getBackboneEvents(),{initialize:function(a,c){var e=p(),f=q();if(b.pageData.core28348&&b.pageData.cityTAId&&(f.vars[b.pageData.core28348.evar]="AFWD Site Blend Pop Under - Recipe "+b.pageData.core28348.userPool),e&&f&&e.triggerConfigChanged(f),this.element=a,this.options=d.extend({},d.result(this,"options"),c),h.injectDependencies(this),this.attach(),this.model.loadPageDataFromQueryString(),b.pageData.core28348&&"B"===b.pageData.core28348.userPool){var g=this;setTimeout(function(){g.showHotels(b.pageData,b.searchData)},700)}},element:null,fareCount:4,fareId:0,model:null,relatedFaresController:null,searchWidgetController:null,view:null,options:function(){return{containerSelector:".c-search-widget"}},attach:function(){return this.listenTo(this.view,g.ON_SEARCH_BUTTON_CLICK,this.openTabBrowsing),this},getDependencies:function(){return new l([["model",function(){return new m({el:this.element})}],["relatedFaresController",function(){return new n(this.element,this.fareId,b.pageData.depAirportCode,b.pageData.arrAirportCode,{fareCount:this.fareCount})}],["searchWidgetController",function(){return new o(this.model)}],["view",function(){return new g({el:this.model.containerEl.find(this.options.containerSelector),model:this.model})}]])},openTabBrowsing:function(a){var b=d.extend({},this.model.getSearchDataQS(),this.model.getOtherDataQS(),this.model.getUnknownDataQS(),this.model.tests,{selectedAdId:a}),c=j.getDB5TabBrowsingUrl(b);return i.openTabBrowsingWindow(c),this},showHotels:function(b,c){var d=b.cityTAId,e=c.getDate1(),f=c.getDate2();if(!d)return this;var g={};e&&f&&(e=k.formatDate("yymmdd",e),f=k.formatDate("yymmdd",f),g={checkin:e,checkout:f});var h=j.getHotelsUrl(d,g);return a.location=h,this},STATIC:{autoInitialize:function(a){f.loadClass(r,a?a:"autoinit-shared-controllers-blender-popunder",!0)}}});r.autoInitialize(),c.ns("controllers.blenderPopunder",r)}(window);
//# sourceMappingURL=blenderPopunder.nano.js.map

// ===========================================
// DHTML Ads
// ===========================================
!function(a){"use strict";var b,c=a.stm,d=c.shared,e=a.jQuery,f=a._,g=d.models.ad;e(function(){b=a.BBAd});var h=g.extend({defaults:function(){var a=g.prototype.defaults.call(this);return f.extend(a,{iframeURL:null})},getIframeURL:function(){return this.get("iframeURL")},setIframeURL:function(a,b){return this.set("iframeURL",a,b)}},{});d.ns("models.dhtmlAd",h)}(window);
//# sourceMappingURL=dhtmlAd.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.shared,e=a.Backbone,f=a.jQuery,g=c.cookies,h=c.functional,i=c.dependenciesInjection,j=c.Popup;c.shared.linkUtils;f(function(){b=c.tracking.omniture});var k=e.View.extend({handleAdClick:function(){return!1},initialize:function(){this.bindMethods(),i.injectDependencies(this),f(a).resize(this.center)},options:function(){return{closeIconSelector:".close-icon"}},popup:null,onBodyClick:function(a){var b=f(a.target);b.is(this.$el)||this.$(b).length||this.hide()},onCloseIconClick:function(){this.hide()},onLayerClick:function(a){var b=f(a.target);b.is(this.options.closeIconSelector)||this.handleAdClick(b)&&(this.hide(),g.set(k.COOKIE_NAME,1))},appendRDImageTracking:function(){var a=f("<img />");return a.attr("src",this.createTrackingImageUrl(this.model.getUrl())).hide().appendTo("body"),this},attach:function(){var a=this,b=d.getWindow();return a.$el.on("click.dhtmlAd",a.options.closeIconSelector,a.onCloseIconClick),a.$el.on("click.dhtmlAd",a.onLayerClick),a.$el.parents("body").on("click.dhtmlAd",a.onBodyClick),a.model.getIframeURL()&&b.on("message.dhtmlAd",function(){a.$el.trigger("click")}),a},bindMethods:function(){return h.bindMethods(this,["onBodyClick","onCloseIconClick","onLayerClick","center"]),this},detach:function(){var a=d.getWindow();return this.$el.off(".dhtmlAd"),this.$el.parents("body").off(".dhtmlAd"),this.model.getIframeURL()&&a.off(".dthmlAd"),this},fitDealsIntoContainer:function(a,b,c,d){for(var e=this.$(c);a--&&e.height()>b;)e.find(d).last().remove();return this},getDependencies:function(){return{popup:function(){var a=new j;return a.useOptimalDimensions(),a}}},trackAdClickWithOmniture:function(){return b.trackSponsoredDHTMLAdClick(this.model.getId()),this},createRedirectUrl:function(a){return c.pageData.adHandlerUrl+"&"+a},createTrackingImageUrl:function(a){return c.pageData.adTrackingUrl+"&"+a},hide:function(){return this.$el.hide(),this.detach()},render:function(){return this.$el.appendTo("body").show(),this.center(),this.model.getIframeURL()&&this.$("iframe").attr("src",this.model.getIframeURL()),this.attach(),this},center:function(){var a=d.getWindow();this.$el.css("left",(a.width()-this.$el.width())/2)}},{COOKIE_NAME:"dhtml_ad_displayed"});d.ns("views.dhtmlAd",k)}(window);
//# sourceMappingURL=dhtmlAd.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.shared.views.dhtmlAd,f=e.extend({options:function(){var a=e.prototype.options.call(this);return d.extend(a,{dealSelector:".deal",dealsListingSelector:"#promolist"})},handleAdClick:function(a){var b;return b=a.is(this.options.dealSelector)?a:a.parents(this.options.dealSelector),b.is(this.options.dealSelector)?(this.popup.url=decodeURIComponent(b.data("dealUrl")),this.popup.tryPop(),this.popup.hasPopped?(this.trackAdClickWithOmniture(),this.appendRDImageTracking(),!0):!1):!1}});c.ns("views.dhtmlAd.avoya",f)}(window);
//# sourceMappingURL=avoya.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a._,f=b.dates,g=b.domState,h=b.functional,i=b.shared.metaClient,j=b.shared.metaUtils,k=b.shared.models.metaVendor,l=b.shared.views.dhtmlAd,m=l.extend({initialize:function(a){var b;this.mcid=this.loadDefaultMetaMCID(),l.prototype.initialize.call(this,a),b=this.$(this.options.dealSelector),b&&b.length&&g.add(b,m.STATE_PENDING),this.fetchMetaResults()},options:function(){var a=l.prototype.options.call(this);return e.extend(a,{dealSelector:"tr",dealsListingSelector:".dealsListing",dealPriceSelector:".metaPrice > div",maxDealsToRemove:10,maxHeight:220})},client:null,mcid:null,handleAdClick:function(a){var b;return this.openTabBrowsingWindow(a)?(b=this.$(this.options.dealsListingSelector),b.length<1?!1:(this.trackClick(a),!0)):!1},handleClientError:function(){var a=this.$(this.options.dealSelector),b=this;return a.each(function(){var a=parseInt(d(this).data("hotel-id"),10);b.setHotelState(a,k.STATE_UNKNOWN)}),this},handleDataLoaded:function(a){var b=this;return a.hotels.each(function(a){var c=!1;a.vendors.some(function(d){return d.isFeatured()?(b.updateHotelPrice(a.getId(),d),b.setHotelState(a.getId(),k.STATE_AVAILABLE),c=!0,!0):!1}),c||(b.setHotelState(a.getId(),k.STATE_UNAVAILABLE),a.vendors.first()&&b.setHotelVendor(a.getId(),a.vendors.first().getId()))}),this},bindMethods:function(){return l.prototype.bindMethods.call(this),h.bindMethods(this,["handleDataLoaded","handleClientError","handleAdClick","getAdMCID"]),this},fetchMetaResults:function(){var a,c=this.client,e=this.$(this.options.dealSelector),g=b.searchData.getDate1()||new Date,h=b.searchData.getDate2()||new Date(g.getDate()+14);return c.adults=b.searchData.getTravelers(),c.checkinDate=f.formatDate("mm/dd/yy",new Date(g)),c.checkoutDate=f.formatDate("mm/dd/yy",new Date(h)),e.each(function(){a=parseInt(d(this).data("hotel-id"),10),a>0&&c.hotels.add({id:a})}),c.subscribe(i.EVENT_LOADED,this.handleDataLoaded),c.subscribe(i.EVENT_ERROR,this.handleClientError),c.fetchUsingHotels(),this},getDependencies:function(){var a=l.prototype.getDependencies.call(this);return e.extend(a,{client:function(){var a={requestDelay:b.pageData.metaRequestInterval};return new i(this.mcid,a)}})},getAdMCID:function(){switch(this.model.getDisplayName()){case"BookingBuddyUSMetaAir":return 19005;case"BookingBuddyUSMetaHotel":return 19006;default:return this.mcid}},loadDefaultMetaMCID:function(){return b.pageData.metaMCID},openTabBrowsingWindow:function(a){var c,d,e,g,h,i,k,l=a.is(this.options.dealSelector)?a:a.parents(this.options.dealSelector);return l.is(this.options.dealSelector)?(c=b.searchData.getDate1()||new Date,d=b.searchData.getDate2()||new Date(c.getDate()+14),e=f.formatDate("mm/dd/yy",c),g=f.formatDate("mm/dd/yy",d),h=l.data("hotel-id"),i=l.data("vendor-id"),k=b.searchData.getTravelers(),j.openTabBrowsingWindow(h,e,g,k,i,this.getAdMCID()),!0):!1},render:function(){return l.prototype.render.call(this),this.fitDealsIntoContainer(this.options.maxDealsToRemove,this.options.maxHeight,this.options.dealsListingSelector,this.options.dealSelector),this},setHotelState:function(a,b){var c=this.$("tr[data-hotel-id="+a+"]");if(!c)return this;switch(g.clear(c),b){case k.STATE_AVAILABLE:g.add(c,m.STATE_AVAILABLE);break;case k.STATE_UNAVAILABLE:g.add(c,m.STATE_UNAVAILABLE);break;default:g.add(c,m.STATE_UNKNOWN)}return this},setHotelVendor:function(a,b){var c=this.$(this.options.dealSelector+"[data-hotel-id="+a+"]");return c?(c.data("vendor-id",b),this):this},trackClick:function(a){var b=a.data("vendor-id"),c=this.model.getUrl(),e={provider:b};return c+="&"+d.param(e),this.model.setUrl(c),this.appendRDImageTracking(),this.trackAdClickWithOmniture(),this},updateHotelPrice:function(a,b){var c,d,e=this.$(this.options.dealSelector+"[data-hotel-id="+a+"]");return e?(c=e.find(this.options.dealPriceSelector),d=b.getCurrency()+b.getPricePerNight(),c.html(d),e.data("vendor-id",b.getId()),this):this}},{STATE_AVAILABLE:"hasPrice",STATE_PENDING:"searching",STATE_UNAVAILABLE:"noAvailability",STATE_UNKNOWN:"hasAvailability"});c.ns("views.dhtmlAd.bookingBuddyUSMeta",m)}(window);
//# sourceMappingURL=bookingBuddyUSMeta.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=c.views.dhtmlAd,e=d.extend({handleAdClick:function(){var a=this.model.getUrl(),b=this.model.getId();return!a||a.length<1||!b||isNaN(b)?!1:(this.popup.url=this.createRedirectUrl(a),this.popup.tryPop(),this.popup.hasPopped?(this.trackAdClickWithOmniture(),!0):!1)}});c.ns("views.dhtmlAd.carRentals",e)}(window);
//# sourceMappingURL=carRentals.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=c.views.dhtmlAd,f=e.extend({options:function(){var a=e.prototype.options.call(this);return d.extend(a,{dealSelector:".deal",dealsListingSelector:".deals-listing"})},handleAdClick:function(a){var b;return b=a.is(this.options.dealSelector)?a:a.parents(this.options.dealSelector),b.is(this.options.dealSelector)?(this.popup.url=decodeURIComponent(b.data("dealUrl")),this.popup.tryPop(),this.popup.hasPopped?(this.trackAdClickWithOmniture(),this.appendRDImageTracking(),!0):!1):!1}});c.ns("views.dhtmlAd.cheapcaribbean",f)}(window);
//# sourceMappingURL=cheapcaribbean.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=c.views.dhtmlAd,e=d.extend({handleAdClick:function(){return this.appendRDImageTracking(),this.trackAdClickWithOmniture(),!0}});c.ns("views.dhtmlAd.cheapCruises",e)}(window);
//# sourceMappingURL=cheapCruises.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=c.views.dhtmlAd,f=e.extend({options:function(){var a=e.prototype.options.call(this);return d.extend(a,{dealSelector:"tr",dealsListingSelector:".deals-listing",maxDealsToRemove:10,maxHeight:220})},handleAdClick:function(a){var c;return c=a.is(this.options.dealSelector)?a:a.parents(this.options.dealSelector),c.is(this.options.dealSelector)?(this.popup.url=decodeURIComponent(c.data("dealUrl")),this.popup.tryPop(),this.popup.hasPopped?(this.appendRDImageTracking(),b.tracking.omniture.trackBBDNClick(c.data("dealId"),c.data("dealCpc")),!0):!1):!1},render:function(){return e.prototype.render.call(this),this.fitDealsIntoContainer(this.options.maxDealsToRemove,this.options.maxHeight,this.options.dealsListingSelector,this.options.dealSelector),this}});c.ns("views.dhtmlAd.hotelsCom",f)}(window);
//# sourceMappingURL=hotelsCom.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=c.views.dhtmlAd,e=d.extend({handleAdClick:function(){var a=this.model.getUrl(),b=this.model.getId();return!a||a.length<1||!b||isNaN(b)?!1:(this.popup.url=this.createRedirectUrl(a),this.popup.tryPop(),this.popup.hasPopped?(this.trackAdClickWithOmniture(),!0):!1)}});c.ns("views.dhtmlAd.hotelsCombined",e)}(window);
//# sourceMappingURL=hotelsCombined.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=c.views.dhtmlAd,f=(c.linkUtils,e.extend({options:function(){var a=e.prototype.options.call(this);return d.extend(a,{dealSelector:"tr",dealsListingSelector:".deals-listing",maxDealsToRemove:10,maxHeight:115,seeDealsSelector:".see-deals"})},handleAdClick:function(a){var b,c,d=!1;if(a.is(this.options.seeDealsSelector))c=this.createRedirectUrl(this.model.getUrl()),d=!0;else{if(b=a.is(this.options.dealSelector)?a:a.parents(this.options.dealSelector),!b.is(this.options.dealSelector))return!1;c=decodeURIComponent(b.data("dealUrl"))}return this.popup.url=c,this.popup.tryPop(),this.popup.hasPopped?(this.trackAdClickWithOmniture(),d===!1&&this.appendRDImageTracking(),!0):!1},render:function(){return e.prototype.render.call(this),this.fitDealsIntoContainer(this.options.maxDealsToRemove,this.options.maxHeight,this.options.dealsListingSelector,this.options.dealSelector),this}}));c.ns("views.dhtmlAd.hotwire",f)}(window);
//# sourceMappingURL=hotwire.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=c.views.dhtmlAd,f=e.extend({options:function(){var a=e.prototype.options.call(this);return d.extend(a,{dealSelector:"tr",dealsListingSelector:".deals-listing",maxDealsToRemove:10,maxHeight:165})},handleAdClick:function(a){var b;return b=a.is(this.options.dealSelector)?a:a.parents(this.options.dealSelector),b.is(this.options.dealSelector)?(this.popup.url=decodeURIComponent(b.data("dealUrl")),this.popup.tryPop(),this.popup.hasPopped?(this.trackAdClickWithOmniture(),this.appendRDImageTracking(),!0):!1):!1},render:function(){return e.prototype.render.call(this),this.fitDealsIntoContainer(this.options.maxDealsToRemove,this.options.maxHeight,this.options.dealsListingSelector,this.options.dealSelector),this}});c.ns("views.dhtmlAd.priceline",f)}(window);
//# sourceMappingURL=priceline.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=c.views.dhtmlAd,f=e.extend({options:function(){var a=e.prototype.options.call(this);return d.extend(a,{dealSelector:"tr",dealsListingSelector:".deals-listing",maxDealsToRemove:10,maxHeight:332})},handleAdClick:function(a){var b;return b=a.is(this.options.dealSelector)?a:a.parents(this.options.dealSelector),b.is(this.options.dealSelector)?(this.popup.url=decodeURIComponent(b.data("dealUrl")),this.popup.tryPop(),this.popup.hasPopped?(this.trackAdClickWithOmniture(),this.appendRDImageTracking(),!0):!1):!1},render:function(){return e.prototype.render.call(this),this.fitDealsIntoContainer(this.options.maxDealsToRemove,this.options.maxHeight,this.options.dealsListingSelector,this.options.dealSelector),this}});c.ns("views.dhtmlAd.travelzoo",f)}(window);
//# sourceMappingURL=travelzoo.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=c.views.dhtmlAd,e=d.extend({handleAdClick:function(){var a=this.model.getUrl(),b=this.model.getId();return!a||a.length<1||!b||isNaN(b)?!1:(this.popup.url=this.createRedirectUrl(a),this.popup.tryPop(),this.popup.hasPopped?(this.trackAdClickWithOmniture(),!0):!1)}});c.ns("views.dhtmlAd.smartfares",e)}(window);
//# sourceMappingURL=smartfares.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=c.views.dhtmlAd,e=d.extend({handleAdClick:function(){var a=this.model.getUrl(),b=this.model.getId();return!a||a.length<1||!b||isNaN(b)?!1:(this.popup.url=this.createRedirectUrl(a),this.popup.tryPop(),this.popup.hasPopped?(this.trackAdClickWithOmniture(),!0):!1)}});c.ns("views.dhtmlAd.goseek",e)}(window);
//# sourceMappingURL=goseek.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=b.shared,e=b.Popup,f=d.views.dhtmlAd,g=f.extend({events:{click:"onClick","click .darkener":"onClickDarkener"},onClick:function(a){var b=c(a.target);if(!b.closest(".close-icon, .darkener").length){var d=this.createRedirectUrl(this.model.getUrl()),f=b.closest("*[data-deal-url]").data("deal-url"),g=new e;g.useOptimalDimensions(),g.url=f||d,g.tryPop(),g.hasPopped&&(this.trackAdClickWithOmniture(),this.appendRDImageTracking())}},onClickDarkener:function(){this.hide()}});d.ns("views.dhtmlAd.turo",g)}(window);
//# sourceMappingURL=turo.nano.js.map
!function(a){"use strict";var b=a.jQuery,c=a.stm,d=c.shared,e=c.Popup,f=d.views.dhtmlAd,g=f.extend({events:{"click *[data-deal-url]":"clickDeal"},clickDeal:function(a){var c=b(a.target).closest("*[data-deal-url]").data("deal-url");a.preventDefault();var d=new e;d.useOptimalDimensions(),d.url=c,d.tryPop(),d.hasPopped&&(this.trackAdClickWithOmniture(),this.appendRDImageTracking())}});d.ns("views.dhtmlAd.rentalCars",g)}(window);
//# sourceMappingURL=rentalCars.nano.js.map
!function(a){"use strict";var b=a.jQuery,c=a.stm,d=c.shared.views.dhtmlAd,e=430,f=-50,g=25,h=d.extend({initialize:function(){d.prototype.initialize.apply(this,arguments);var c=new a.AjaxSubscription("dhtmlsignup_inline");c.step1(),this.$el.find("#dhtmlsignup_inline").css("top",Math.max(b(a).height()/2-e/2+f,g))}});c.shared.ns("views.dhtmlAd.bookingBuddyUSSub",h)}(window);
//# sourceMappingURL=bookingBuddyUSSub.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=c.views.dhtmlAd,e=d.extend({initialize:function(){d.prototype.initialize.apply(this,arguments),this.$("img").load(this.center)},handleAdClick:function(){return this.popup.url=this.createRedirectUrl(this.model.getUrl()),this.popup.tryPop(),this.popup.hasPopped?(this.trackAdClickWithOmniture(),!0):!1}});c.ns("views.dhtmlAd.staticdhtml",e)}(window);
//# sourceMappingURL=staticdhtml.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.dependenciesInjection,g=c.models.dhtmlAd,h=e({ABSTRACT:!0,"abstract getView":null,initialize:function(a,b){this.element=a,this.options=d.extend({},d.result(this,"options"),b),f.injectDependencies(this),this.view.model=this.ad,d.isFunction(this.view.render)&&this.view.render()},ad:null,element:null,options:function(){return{adData:null}},view:null,getDependencies:function(){return{ad:function(){return new g(this.options.adData)},view:function(){var a=this.getView();return new a({el:this.element})}}},STATIC:{}});c.ns("controllers.dhtmlAd",h)}(window);
//# sourceMappingURL=dhtmlAd.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=b.Chain,g=b.functional,h=c.models.searchData,i=e({initialize:function(a,c){this.element=a,this.options=d.extend({},d.result(this,"options"),c),b.searchData||(b.searchData=new h,b.searchData.fetch()),this.bindMethods().dispatch()},ABSTRACT:!0,"abstract sendClickstreamChainItem":null,"abstract sendOmnitureChainItem":null,"abstract setupTrackingChainItem":null,element:null,omnitureCheckCounter:0,options:function(){return{maxOmnitureChecks:4,omnitureCheckDelay:500}},bindMethods:function(){return g.bindMethods(this,["checkOmnitureChainItem","handleStupidIOSChainItem","redirectUserChainItem","sendClickstreamChainItem","sendOmnitureChainItem","setupTrackingChainItem"]),this},checkOmnitureChainItem:function(b){var c=a.s.pageImages[a.s.pageImages.length-1],e=c&&c.complete,f=++this.omnitureCheckCounter<this.options.maxOmnitureChecks;return e||!f?(b.runNext(),this):(d.delay(this.checkOmnitureChainItem,this.options.omnitureCheckDelay,b),this)},dispatch:function(){var a=new f;return a.append("setup tracking",d.partial(this.setupTrackingChainItem,a)),a.append("handle stupid iOS",d.partial(this.handleStupidIOSChainItem,a)),a.append("send omniture",d.partial(this.sendOmnitureChainItem,a)),a.append("check omniture completeness",d.partial(this.checkOmnitureChainItem,a)),a.append("send clickstream",d.partial(this.sendClickstreamChainItem,a)),a.append("redirect user",d.partial(this.redirectUserChainItem,a)),a.run(),this},handleStupidIOSChainItem:function(a){var c,d=b.pageData.deviceInfo.browser&&"safari"===b.pageData.deviceInfo.browser.toLowerCase(),e=b.pageData.deviceInfo.os&&"ios"===b.pageData.deviceInfo.os.toLowerCase(),f=[6,1,3],g=null;if(d&&e&&(g=b.pageData.deviceInfo.version.split("."),g&&g.length))for(c=0;c<f.length&&c<g.length&&!(isNaN(g[c])||g[c]>f[c]);c++)if(g[c]<f[c]){this.omnitureCheckCounter=this.options.maxOmnitureChecks;break}return a.runNext(),this},redirectUserChainItem:function(c){return a.location=b.pageData.goMetaGo.destinationUrl,c.runNext(),this},STATIC:{}});c.ns("controllers.goMetaGo",i)}(window);
//# sourceMappingURL=goMetaGo.nano.js.map

// ===========================================
// Related Hotels
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=(a.jQuery,b.functional),f=d.View.extend({initialize:function(){this.hiddenProperties=this.$("[data-relatedhotels-role=hiddenProperties]"),this.expandControl=this.$("[data-relatedhotels-role=expandList]"),this.collapseControl=this.$("[data-relatedhotels-role=collapseList]"),this.bindMethods().attach()},expandList:function(){this.hiddenProperties.slideDown(),this.expandControl.hide(),this.collapseControl.show()},collapseList:function(){this.hiddenProperties.slideUp(),this.collapseControl.hide(),this.expandControl.show()},bindMethods:function(){return e.bindMethods(this,["expandList","collapseList"]),this},attach:function(){return this.expandControl.on("click",this.expandList),this.collapseControl.on("click",this.collapseList),this}});c.ns("views.relatedHotels.container",f)}(window);
//# sourceMappingURL=container.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=a.jQuery,e=b.functional,f=c.View.extend({initialize:function(){this.metaDHTML=this.$("[data-relatedhotelmeta-role=metaDHTML]"),this.bindMethods().attach()},showDHTML:function(){d(this.el).trigger("RelatedHotelMeta:showDHTML"),this.metaDHTML.show()},hideDHTML:function(){this.metaDHTML.hide()},bindMethods:function(){return e.bindMethods(this,["showDHTML","hideDHTML"]),this},attach:function(){return this.$("[data-stm-role=submit]").on("click",this.showDHTML),this.metaDHTML.on("RelatedHotelMeta:hideDHTML",this.hideDHTML),this}},{setup:function(){d('[data-stm-role="stm.shared.views.relatedHotels.relatedHotelMeta"]').each(function(){new f({el:d(this)})})}});d(f.setup),b.ns("shared.views.relatedHotels.relatedHotelMeta",f)}(window);
//# sourceMappingURL=relatedHotelMeta.nano.js.map

// ===========================================
// HWD hotel Module
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a._,f=b.shared.linkUtils,g=b.define,h=b.dates,i=b.functional,j=function(){return b.tracking.omniture},k=g(null,{element:null,initialize:function(a,b){this.element=a,this.options=e.extend({},e.result(this,"options"),b),this.bindMethods().attach(),this.update()},options:function(){return{selector:".external_hwd_module",baseUrl:"/",numHotels:3,taSearchData:null}},bindMethods:function(){return i.bindMethods(this,["update"]),this},update:function(){var a=!1,c=this.element.find(this.options.selector);if(b.geoModule&&(b.geoModule.stop(),c.html(""),a=!0),!this.isValidData(this.options.taSearchData))return this;var e=h.formatDate("yymmdd",this.options.taSearchData.getDate1()),g=h.formatDate("yymmdd",this.options.taSearchData.getDate2()),i=this.options.numHotels,k=this.options.taSearchData.getLocation2CityId(),l=this.options.baseUrl+k+"TA/hotels",m={embedded:!0,pageSize:i,checkin:e,checkout:g};a&&(m.standalone=!0);var n=f.getFinalizedUrl(l,m);return d.get(n,function(a){j().trackTAMetaSearchVisit(),c.html(a)}),this},isValidData:function(a){return a&&a.getDate1()&&a.getDate2()&&a.getLocation2CityId()},attach:function(){return this.options.taSearchData.on("change:date1",this.update),this.options.taSearchData.on("change:date2",this.update),this}});c.ns("controllers.hwdModule",k)}(window);
//# sourceMappingURL=hwdModule.nano.js.map

// ===========================================
// Misc
// ===========================================
!function(a){"use strict";var b=a.stm,c=a._,d=b.define,e=b.shared,f=b.functional,g=b.mixins.observable,h=d(null,g,{initialize:function(a,b){this.element=a,this.options=c.extend({},c.result(this,"options"),b),this.bindMethods().attach()},element:null,options:function(){return{}},onClick:function(){this.hidePageMask()},attach:function(){return this.element.on("click",this.onClick),this},bindMethods:function(){return f.bindMethods(this,["onClick"]),this},hidePageMask:function(){return this.element.hide(),this.publish(h.EVENT_HIDE,this),this},showPageMask:function(){return this.element.css({position:"fixed",height:"100%",width:"100%"}),this.element.show(),this},STATIC:{EVENT_HIDE:"stm-shared-controllers-pageMask:event_hide"}});e.ns("controllers.pageMask",h)}(window);
//# sourceMappingURL=pageMask.nano.js.map


	
	
	


/***
 *     +-+-+-+-+-+-+-+-+-+-+-+-+ +-+-+
 *     |B|o|o|k|i|n|g|B|u|d|d|y| |U|S|
 *     +-+-+-+-+-+-+-+-+-+-+-+-+ +-+-+
 */

// ===========================================
// Shared
// ===========================================
!function(a){"use strict";var b,c,d=a.stm,e=d.shared,f=a.jQuery,g=d.define,h=e.controllers.goMetaGo;f(function(){b=a.BookingBuddy,c=a.TACheckRates});var i=g(h,{sendClickstreamChainItem:function(a){return b.Tracking.trackMetaWithClickStream(d.pageData.goMetaGo.vendorId,d.searchData.getDate1(),d.searchData.getDate2(),d.pageData.goMetaGo.trackingHash,d.pageData.goMetaGo.clickId,function(){a.runNext()}),this},sendOmnitureChainItem:function(a){return b.Tracking.trackTACheckrates(["__"+d.pageData.goMetaGo.trackingHash],d.searchData.getDate1(),d.searchData.getDate2(),!0,d.pageData.goMetaGo.clickId),a.runNext(),this},setupTrackingChainItem:function(a){var b=c.singleton("__"+d.pageData.goMetaGo.trackingHash);return b.isMeta=!0,b.setMetaData("author_name",d.pageData.goMetaGo.vendorAuthor),a.runNext(),this},STATIC:{}});e.ns("controllers.goMetaGo.bb",i)}(window);
//# sourceMappingURL=bb.nano.js.map
!function(a){"use strict";var b=a.stm,c=function(a,c){b.ns("bbus."+a,c)};b.ns("bbus.ns",c)}(window);
//# sourceMappingURL=base.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=a._,e=b.bbus,f=b.tracking.omniture,g=function(){return a.BookingBuddy};f.subscribe(f.BBDN_CLICK,function(a,b,c){g().Tracking.trackDealClick(null,a,"",b),d.isFunction(c)&&c()}),f.subscribe(f.CONFIG_CHANGED,function(a,c){a&&(b.OmnitureConfig={},f.setToBBOmnitureObject(b.OmnitureConfig),g().Tracking.loadOmniture(!0)),d.isFunction(c)&&c()}),f.subscribe(f.FEATURED_SEARCH_CLICK,function(a,b){c.publish("/page/featuredSearch",[[a]]),d.isFunction(b)&&b()}),f.subscribe(f.SPONSORED_DHTML_AD_CLICK,function(a,b){g().Tracking.trackBBSearchByAdId(a),d.isFunction(b)&&b()}),f.subscribe(f.EXIT_DHTML_AD_IMPRESSION,function(a,b){g().Tracking.trackExitDHTMLImpression(a),d.isFunction(b)&&b()}),f.subscribe(f.LOAD_DATA,function(){b.OmnitureConfig?f.updateFromBBOmnitureObject(b.OmnitureConfig):g().Tracking.tracker&&f.updateFromOmnitureObject(g().Tracking.tracker)}),f.subscribe(f.TA_META_SEARCH_VISIT,function(a){g().Tracking.trackTAMetaSearchVisit(),d.isFunction(a)&&a()}),f.subscribe(f.TA_META_CLICK,function(a,c){g().Tracking.trackTACheckrates(["__"+a],b.searchData.getDate1(),b.searchData.getDate2(),!0),d.isFunction(c)&&c()}),f.subscribe(f.SEND_EVAR,function(a,b,c){var e=(""+a).replace(/[^\d]+/,""),f=g()&&g().Tracking?g().Tracking.tracker:null;f&&(f.reset(),f.setVariable("eVar"+e,b),f.setTrackVar("eVar"+e),f.send("Sending eVar"+e)),d.isFunction(c)&&c()}),f.subscribe(f.SEND_EVENTS,function(a,b,c){var e=g()&&g().Tracking?g().Tracking.tracker:null;if(e){if(e.reset(),d.isArray(a))for(var f in a)e.setEvent(a[f]);else d.isString(a)&&e.setEvent(a);e.send(b)}d.isFunction(c)&&c()}),e.ns("shared.tracking.omniture",!0)}(window);
//# sourceMappingURL=omniture.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=b.shared,e=a.jQuery,f=a._,g=b.define,h=b.shared.controllers.pageMask,i=d.controllers.pagesWithMetaWidgets,j=g(i,{pageMaskController:null,attach:function(){return i.prototype.attach.call(this),e("[data-stm-role='stm.shared.views.relatedHotels.relatedHotelMeta']").on("RelatedHotelMeta:showDHTML",f.bind(this.pageMaskController.showPageMask,this.pageMaskController)),this.pageMaskController.subscribe(h.EVENT_HIDE,function(){e("[data-relatedhotelmeta-role=metaDHTML]").trigger("RelatedHotelMeta:hideDHTML")}),this},getDependencies:function(){var a=i.prototype.getDependencies.call(this);return a.pageMaskController=function(){return new h(this.element.find("#page_mask"))},a},STATIC:{}});c.ns("shared.controllers.pagesWithMetaWidgets",j)}(window);
//# sourceMappingURL=pagesWithMetaWidgets.nano.js.map

/*---- CORE-30873 --- START ----*/
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=b.bbus,e=c.Model.extend({getId:function(){return this.get("id")},setId:function(a,b){return this.set("id",a,b)},getLastClickedOn:function(){return this.get("lastClickedOn")},setLastClickedOn:function(a,b){return this.set("lastClickedOn",a,b)}});d.ns("shared.models.previousAdClick",e)}(window);
//# sourceMappingURL=previousAdClick.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=a.Backbone,e=a._,f=c.shared.models.previousAdClick,g=d.Collection.extend({comparator:"lastClickedOn",model:f,getIdsOfAdsClickedAfterCutoff:function(a){return e.chain(this.models).filter(function(b){return a<=b.getLastClickedOn()}).map(function(a){return a.getId()}).value()},removeAdsClickedBeforeCutoff:function(a){var b=this.filter(function(b){return a>b.getLastClickedOn()});this.remove(b)}});c.ns("shared.collections.previousAdClicks",g)}(window);
//# sourceMappingURL=previousAdClicks.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=(a._,b.bbus),e=d.shared.collections.previousAdClicks,f=c.Model.extend({initialize:function(){this.set("previousAdClicks",new e(this.get("previousAdClicks")))},getPreviousAdClicks:function(){return this.get("previousAdClicks")},setPreviousAdClicks:function(a,b){return this.set("previousAdClicks",a,b)},getDate1:function(){return this.get("date1")},setDate1:function(a,b){return this.set("date1",a,b)},getDate2:function(){return this.get("date2")},setDate2:function(a,b){return this.set("date2",a,b)},getDestinationId:function(){return this.get("destinationId")},setDestinationId:function(a,b){return this.set("destinationId",a,b)},getIdsOfAdsClickedAfterCutoff:function(a){return this.getPreviousAdClicks().getIdsOfAdsClickedAfterCutoff(a)},removeAdClicksBeforeCutoff:function(a){var b=this.getPreviousAdClicks(),c=b.filter(function(b){return a>b.getLastClickedOn()});return b.remove(c),this}});d.ns("shared.models.previousSearchClicks",f)}(window);
//# sourceMappingURL=previousSearchClicks.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=a.Backbone,e=c.shared.models.previousSearchClicks,f=d.Collection.extend({comparator:"destinationId",model:e,getPreviousSearchClicks:function(a,b,c){var d=this.filter(function(d){return a===d.getDestinationId()&&b===d.getDate1()&&c===d.getDate2()});return d.length>0?d[0]:null},removePreviousSearchClicks:function(a){var b=this.filter(function(b){return 1>b.getIdsOfAdsClickedAfterCutoff(a).length});return this.remove(b),this.forEach(function(b){b.removeAdClicksBeforeCutoff(a)}),this}});c.ns("shared.collections.previousSearchesClicks",f)}(window);
//# sourceMappingURL=previousSearchesClicks.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=b.bbus,e=b.define,f=b.functional,g=b.dates,h=d.shared.models.previousAdClick,i=d.shared.collections.previousAdClicks,j=d.shared.models.previousSearchClicks,k=d.shared.collections.previousSearchesClicks,l=(a.JSON,b.shared.models.pages.tabBrowsing),m=e(null,c.getBackboneEvents(),{initialize:function(a,b,c){this.persistentStorage=a,this.model=b,this.options=_.extend({},_.result(this,"options"),c),this.previousSearchesClicks=new k,this.loadPreviousSearchesClicksData(this.model.getSearchMode()),this.bindMethods(),this.attach()},options:function(){return{previousClicksCutoffThresholdInMilli:864e5,storageKeyPrefix:".searchesDataStore.",previouslyClickedAdIdsQueryParamName:"prevSrchInfo",adConversionEventProvider:null,adConversionEventName:"change:selected",supportsMultiAdsConversion:!1}},persistentStorage:null,model:null,previousSearchesClicks:null,onPageDataLoaded:function(){this.addPreviousClicksDataToQueryParams(),a.setTimeout(this.cleanPreviousSearchesClicksData,500)},onAdConversion:function(b){var c=this,d=[];if(c.options.supportsMultiAdsConversion===!0)d=c.model.tabAds.getSelectedAds();else if(b){if(!b.isSelected()||"tab"!=b.getDisplayPlacement())return;d=[b]}a.setTimeout(function(){c.handleAdClick(d)},0)},addPreviousClicksDataToQueryParams:function(){var a=this.getCutoffTimestamp();this.model.addQueryParams(this.options.previouslyClickedAdIdsQueryParamName,this.getPreviouslyClickedAdIdsAfterCutoff(a))},attach:function(){return this.listenTo(this.model,l.ON_PAGE_DATA_LOADED,this.onPageDataLoaded),this.listenTo(this.options.adConversionEventProvider,this.options.adConversionEventName,this.onAdConversion),this},bindMethods:function(){return f.bindMethods(this,["onPageDataLoaded","onAdConversion","cleanPreviousSearchesClicksData","handleAdClick"]),this},getCutoffTimestamp:function(){return(new Date).getTime()-this.options.previousClicksCutoffThresholdInMilli},getPreviouslyClickedAdIdsAfterCutoff:function(a){var b=[];return this.previousSearchesClicks.forEach(function(c){var d=c.getIdsOfAdsClickedAfterCutoff(a);d&&d.length>0&&b.push(c.getDestinationId()+"|"+c.getDate1()+"|"+c.getDate2()+"|"+d.join(";"))}),b.join(",")},getStorageKey:function(a){return this.options.storageKeyPrefix+a},loadPreviousSearchesClicksData:function(a){var b=this.persistentStorage.get(this.getStorageKey(a));return this.previousSearchesClicks.reset(b,{silent:!0}),this},savePreviousSearchesClicksData:function(){try{var a=this.previousSearchesClicks.toJSON();this.persistentStorage.set(this.getStorageKey(this.model.getSearchMode()),a)}catch(b){}return this},cleanPreviousSearchesClicksData:function(){if(1>this.previousSearchesClicks.length)return this;var a=this.getCutoffTimestamp();return this.previousSearchesClicks.removePreviousSearchClicks(a),this.savePreviousSearchesClicksData(),this},handleAdClick:function(a){var b,c,d,e=(new Date).getTime();if("cruise"===this.model.getSearchMode())b=this.model.searchData.getCruiseDestinationId(),c=this.model.searchData.getCruiseDate(),d=this.model.searchData.getCruiseLength();else{var f=this.model.searchData.getLocation2();f&&(b=f.id),c=g.formatDate("yy-mm-dd",this.model.searchData.getDate1()),d=g.formatDate("yy-mm-dd",this.model.searchData.getDate2())}var k=this.previousSearchesClicks.getPreviousSearchClicks(b,c,d);k||(k=new j,k.setDestinationId(b),k.setDate1(c),k.setDate2(d));var l=k.getPreviousAdClicks();l||(l=new i);for(var m in a){var n=new h({id:a[m].getId(),lastClickedOn:e});l.add(n,{merge:!0})}return k.setPreviousAdClicks(l),this.previousSearchesClicks.add(k,{merge:!0}),this.savePreviousSearchesClicksData(),this.addPreviousClicksDataToQueryParams(),this}});d.ns("shared.controllers.previousSearchesClicks",m)}(window);
//# sourceMappingURL=previousSearchesClicks.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=a._,e=b.shared.models.pages.tabbedEntry.multiSelect,f=e.extend({additionalQueryParams:{},addQueryParams:function(a,b){return this.additionalQueryParams[a]=b,this},getQueryString:function(){var a=e.prototype.getQueryString.call(this);return a=d.extend({},a,this.additionalQueryParams),b.pageData.queryString=a,a}});c.ns("pages.tabbedEntry.fancy.models.page",f)}(window);
//# sourceMappingURL=page.nano.js.map
/*---- CORE-30873 --- END ----*/

// ===========================================
// OPP Widgets
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=b.define,f=a.jQuery,g=(b.shared.models.searchData,b.strings),h=b.dates,i=e(null,c.getBackboneEvents(),{ad:null,initialize:function(a,b,c,e){e&&(f=e),this.supportedModes=a,this.activeMode=b,this.options=d.extend({},d.result(this,"options"),c),this.discoverInputElements(),this.bindMethods().attach()},start:function(){return this.initSANetwork(),this.options.loadAdsOnPageLoad&&this.initAd(),this.loadSAAsset(),this},initSANetwork:function(){var b=this;return a.SmarterTravelNetwork_ready=a.SmarterTravelNetwork_ready||[],a.SmarterTravelNetwork_ready.push(function(a){a.init({apiKey:b.options.apiKey,contextData:b.getContext,logLevel:a.Log.LOG_LEVELS.DEBUG}),SmarterTravelNetwork.Event.listen("comparison-ad:rendered",b.onAdsRendered)}),this},initAd:function(){var b=this;return a.SmarterTravelNetwork_ready.push(function(a){b.ad=b.createAd(a),a.loadPlacements(b.ad)}),this},loadSAAsset:function(){var a=document.createElement("script");a.src="//p.smartertravel.com/ext/lib/smarter-sdk.min.js",a.async=!0;var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)},setActiveMode:function(a){this.activeMode=a},supportedModes:null,activeMode:null,options:function(){return{apiKey:null,placementId:null,widgetModel:null,loadAdsOnPageLoad:!0,adContainerSelector:".smarterAdsContainer",ctaSelector:".cta",buttonSelector:".cta .button",context:{selectors:{air:{originName:'.searchWidget.air input[data-stm-role="location1Input"]',destinationName:'.searchWidget.air input[data-stm-role="location2Input"]',date1:'.searchWidget.air input[data-stm-role="date1"]',date2:'.searchWidget.air input[data-stm-role="date2"]',flightType:'.searchWidget.air input[data-stm-role="searchType"]',numTravelers:'.searchWidget.air select[data-stm-role="travelers"]'},hotel:{destinationName:'.searchWidget.hotel input[data-stm-role="location2Input"]',date1:'.searchWidget.hotel input[data-stm-role="date1"]',date2:'.searchWidget.hotel input[data-stm-role="date2"]',numTravelers:'.searchWidget.hotel select[data-stm-role="travelers"]'},vacation:{originName:'.searchWidget.vacation input[data-stm-role="location1Input"]',destinationName:'.searchWidget.vacation input[data-stm-role="location2Input"]',date1:'.searchWidget.vacation input[data-stm-role="date1"]',date2:'.searchWidget.vacation input[data-stm-role="date2"]',flightType:'.searchWidget.vacation input[data-stm-role="searchType"]',numTravelers:'.searchWidget.vacation select[data-stm-role="travelers"]'},car:{destinationName:'.searchWidget.car input[data-stm-role="location2Input"]',date1:'.searchWidget.car input[data-stm-role="date1"]',date2:'.searchWidget.car input[data-stm-role="date2"]'},cruise:{cruiseDestination:'.searchWidget.cruise select[data-stm-role="cruiseLocation"]',cruiseDeparture:'.searchWidget.cruise select[data-stm-role="cruiseDate"]',cruiseLength:'.searchWidget.cruise select[data-stm-role="cruiseLength"]',cruiseLine:'.searchWidget.cruise select[data-stm-role="cruiseLine"]',cruiseOver55:'.searchWidget.cruise input[data-stm-role="over55"]'}},elements:null,required:{air:["originName","destinationName","date1","date2"],air_oneway:["originName","destinationName","date1"],hotel:["destinationName","date1","date2"],vacation:["originName","destinationName","date1","date2"],car:["destinationName","date1","date2"],cruise:["cruiseDestination"]}},formChangeEvent:i.ON_FORM_CHANGE}},discoverInputElements:function(){this.options.context.elements={},d.each(this.supportedModes,function(a){var b={};d.each(this.options.context.selectors[a],function(a,c){b[c]=f(a)}),this.options.context.elements[a]=b},this)},bindMethods:function(){return d.bindAll(this,"start","createAd","getContext","onModeChange","onFormChange","onButtonClick","showAds","showCTA","onAdsRendered"),this},attach:function(){return d.each(this.supportedModes,function(a){d.each(this.options.context.elements[a],function(a){a.on("change",this.onFormChange)},this)},this),this.options.widgetModel.on("change:currentMode",this.onModeChange),f(this.options.buttonSelector).on("click",this.onButtonClick),this},createAd:function(a){var b=a.createComparisonAd({placementId:this.options.placementId,containerSelector:this.options.adContainerSelector});return this.on(this.options.formChangeEvent,function(){b.updateSearch()}),[b]},getContext:function(){var a={ad_vertical:this.activeMode};return b.pageData.smarterAdsCustomTracking&&d.each(b.pageData.smarterAdsCustomTracking,function(b,c){a[c]=b}),d.each(this.options.context.elements[this.activeMode],function(b,c){if(a[c]=b.val(),"flightType"===c){for(var d=0;d<b.length;d++)if(b[d].checked){a[c]=b[d].value;break}}else if("date1"===c||"date2"===c){var e=h.parseDate(i.DATE_FORMAT_FORMS,a[c]);a[c]=h.formatDate(i.DATE_FORMAT_SMARTER_ADS,e)}else if("cruiseDeparture"===c){var e=h.parseDate(i.DATE_FORMAT_CRUISE_FORMS,a[c]);a[c]=h.formatDate(i.DATE_FORMAT_SMARTER_ADS_CRUISE,e)}else if("cruiseDestination"===c){var g=f("option[value='"+a[c]+"']",b).text();a[c]=g}},this),a},getMissingFields:function(){var a=[],b=this.activeMode;return"air"==b&&"oneway"==this.getContext().flightType&&(b="air_oneway"),d.each(this.options.context.required[b],function(b){var c=this.options.context.elements[this.activeMode][b];c.val()&&("date1"!==b&&"date2"!==b||"mm/dd/yyyy"!==c.val())||a.push(c)},this),a},clearMissingFieldErrors:function(){d.each(this.options.context.elements[this.activeMode],function(a){a.removeClass("missingField")},!0)},setMissingFieldErrors:function(a){d.each(a,function(a){a.addClass("missingField")},!0)},onModeChange:function(){this.activeMode=this.options.widgetModel.getCurrentMode(),this.onFormChange()},onFormChange:function(){this.clearMissingFieldErrors();var a=this.getMissingFields();a.length?this.showCTA():this.loadAds()},onButtonClick:function(){this.clearMissingFieldErrors();var a=this.getMissingFields();a.length?(this.showCTA(),this.setMissingFieldErrors(a)):this.loadAds()},loadAds:function(){null===this.ad&&this.initAd(),this.trigger(this.options.formChangeEvent)},onAdsRendered:function(){this.showAds()},showAds:function(){f(this.options.adContainerSelector).show(),f(this.options.ctaSelector).hide()},showCTA:function(){f(this.options.adContainerSelector).hide(),f(this.options.ctaSelector).show()},STATIC:{ON_FORM_CHANGE:g.uniqueId(),DATE_FORMAT_FORMS:"mm/dd/yy",DATE_FORMAT_CRUISE_FORMS:"yy-mm-dd",DATE_FORMAT_SMARTER_ADS:"yy-mm-dd",DATE_FORMAT_SMARTER_ADS_CRUISE:"yy-mm"}});c.ns("controllers.opp.smarterAds",i)}(window);
//# sourceMappingURL=smarterAds.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=a.Backbone,e=d.Model.extend({defaults:{currentMode:null,dateFormat:"mm/dd/yy",target:"_blank",action:""},getCurrentMode:function(){return this.get("currentMode")},setCurrentMode:function(a){this.set("currentMode",a)},getDateFormat:function(){return this.get("dateFormat")},setDateFormat:function(a){this.set("dateFormat",a)},getTarget:function(){return this.get("target")},setTarget:function(a){this.set("target",a)},getAction:function(){return this.get("action")},setAction:function(a){this.set("action",a)}});c.ns("pages.oppWidgets.models.widget",e)}(window);
//# sourceMappingURL=widget.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=a.Backbone,e=d.View.extend({model:null,events:{click:"handleClick"},handleClick:function(){this.model.setCurrentMode(this.mode)},initialize:function(){this.mode=this.$el.data("mode"),this.model.on("change",this.render,this),this.render()},isSelected:function(){return this.mode===this.model.getCurrentMode()},render:function(){return this.$el.toggleClass("selected",this.isSelected()),this}});c.ns("pages.oppWidgets.views.tab",e)}(window);
//# sourceMappingURL=tab.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=a.jQuery,e=a._,f=b.Popup,g=(b.functional,b.shared.views.searchForm),h=g.extend({options:{widgetModel:null},events:{},initialize:function(){this.options=e.extend({},g.prototype.options,this.options),this.events=e.extend({},g.prototype.events,this.events),g.prototype.initialize.apply(this,[this.options]),this.date1.$el.datepicker("option","monthNames",d.datepicker._defaults.monthNamesShort),this.date2.$el.datepicker("option","monthNames",d.datepicker._defaults.monthNamesShort);var a=["S","M","T","W","T","F","S"];this.date1.$el.datepicker("option","dayNamesMin",a),this.date2.$el.datepicker("option","dayNamesMin",a),this.widgetModel=this.options.widgetModel,this.widgetModel.on("change",this.renderVisibility,this),this.listenTo(this.model,"change",this.renderVisibility),this.renderVisibility()},submit:function(){if(this.validate())switch(this.widgetModel.getTarget()){case"_blank":this.launchInNewWindow();break;case"_parent":default:this.$el.submit()}},launchInNewWindow:function(){var b=a.screenLeft?a.screenLeft:a.screenX,c=-1===this.widgetModel.getAction().search(/\?/)?"?":"&",d=this.widgetModel.getAction()+c+this.$el.serialize(),e={name:"tabSearchWindow",width:1e3,height:1e3,center:!1,left:b},g=new f(d,e);g.tryPop()},renderVisibility:function(){this.$el.toggle(this.widgetModel.getCurrentMode()===this.mode),this.$(".return_date").css("visibility","oneway"==this.model.getSearchType()?"hidden":"visible")}});c.ns("pages.oppWidgets.views.searchForm",h)}(window);
//# sourceMappingURL=searchForm.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=b.define,e=b.bbus,f=a.jQuery,g=a._,h=e.pages.oppWidgets.models.widget,i=e.pages.oppWidgets.views.searchForm,j=e.pages.oppWidgets.views.tab,k=b.shared.models.searchData,l=b.shared.controllers.opp.smarterAds,m={forms:[],tabs:[],widget:null},n={searchData:null,widget:null},o="mm/dd/yy",p=d(null,c.getBackboneEvents(),{init:function(){var a=this;f(function(){0!==f(".mvcView.page.opp.widget").length&&(a.setupModels(),o=n.widget.getDateFormat(),a.setupViews(),a.setupCalendar(),a.setupSmarterAds())})},setupModels:function(){return n.searchData=new k,n.searchData.fetch(),n.widget=new h(b.pageData.widgetPageModelData),g.each(["date1","date2"],function(a){n.searchData.has(a)&&n.searchData.get(a).isDefault&&n.searchData.set(a,null)}),this},setupViews:function(){return this.setupTabViews(),this.setupFormViews(),this},setupFormViews:function(){var a=f('[data-stm-role="oppWidgetForm"]');return g.each(a,function(a){var b=new i({model:n.searchData,widgetModel:n.widget,dateFormat:o,el:f(a)});m.forms.push(b)},this),this},setupTabViews:function(){var a=f('[data-stm-role="tab"]');return g.each(a,function(a){var b=new j({el:f(a),model:n.widget});m.tabs.push(b)},this),this},setupCalendar:function(){var a={numberOfMonths:1};return f.datepicker.setDefaults(a),this},setupSmarterAds:function(){if(b&&b.pageData&&b.pageData.useSmarterAds){var a=new l(b.pageData.supportedModes,b.pageData.mode,{widgetModel:n.widget,apiKey:b.pageData.smarterAdsAPIKey,placementId:b.pageData.smarterAdsPlacementId,loadAdsOnPageLoad:b.pageData.loadSAAdsOnPageLoad?!0:!1});a.start()}return this}});e.ns("pages.oppWidgets.controllers.main",p)}(window);
//# sourceMappingURL=main.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=c.pages.oppWidgets.controllers.main,e=new d;e.init(),c.ns("pages.oppWidgets.pageInit",{init:!0})}(window);
//# sourceMappingURL=pageInit.nano.js.map

// ===========================================
// BlueKai
// ===========================================
!function(a){"use strict";var b=a.jQuery,c=a.stm,d=c.bbus,e=c.define,f=c.shared.controllers.blueKai,g=e(f,{STATIC:{}});d.ns("shared.controllers.blueKai",g),b(function(){var a,c=b("[data-bluekai]").first();c&&(a=new g(c),a.shouldAutoInitialize()&&a.start())})}(window);
//# sourceMappingURL=blueKai.nano.js.map

// ===========================================
// DB5 Tab Browsing
// ===========================================

!function(a){"use strict";var b=a.stm,c=(b.shared,b.bbus),d=b.functional,e=a._,f=a.jQuery,g=b.strings,h=(b.dependenciesInjection,b.shared.models.searchData),i=Backbone.Model.extend({initialize:function(a,b){this.searchData=a,b&&b.newsletters&&(this.defaultNewsletters=b.newsletters,this.setNewsLetters(this.defaultNewsletters)),b&&b.searchMode&&(this.searchMode=b.searchMode),this.updateSubscriptionDataWithSearchData(),this.bindMethods().attach()},searchData:null,searchMode:null,defaultNewsletters:[],newsletters:[],getSearchMode:function(){return null!==this.searchMode?this.searchMode:""},getEmail:function(){return this.get(i.SUB_AJAX_FIELD_EMAIL1)},saveEmail:function(a){return this.set(i.SUB_AJAX_FIELD_EMAIL1,a),this.set(i.SUB_AJAX_FIELD_EMAIL2,a),this},setDepartureAirportCode:function(){var a=null!==this.searchData.getLocation1Code()?this.searchData.getLocation1Code():this.searchData.getLocation1ShortName();return this.set(i.SUB_AJAX_FIELD_DEPARTURE_CODE,a),this},getDepartureAirportCode:function(){return this.get(i.SUB_AJAX_FIELD_DEPARTURE_CODE)},setDestinationSId:function(){this.set(i.SUB_AJAX_FIELD_DESTINATION_SID,this.searchData.getLocation2SId())},getDestinationSId:function(){return this.get(i.SUB_AJAX_FIELD_DESTINATION_SID)},setArrivalAirportCode:function(){var a=null!==this.searchData.getLocation2Code()?this.searchData.getLocation2Code():"";return this.set(i.SUB_AJAX_FIELD_RETURN_CODE,a),this},getArrivalAirportCode:function(){return this.get(i.SUB_AJAX_FIELD_RETURN_CODE)},setNewsLetters:function(a){return e.isArray(a)&&(this.newsletters=a),this},addNewsLetters:function(a){return e.isArray(a)&&a.length>0&&(this.newsletters=e.union(this.defaultNewsletters,a)),this},getNewsletters:function(){return this.newsletters},getSubscriptionData:function(){var a={},b=this.newsletters,c=[];if(e.isArray(b)){for(var d in b)c.push(i.SUB_AJAX_FIELD_NL+"["+d+"]");a=e.object(c,b)}return a=e.extend(a,{e1:this.getEmail(),e2:this.getEmail(),ac1:this.getDepartureAirportCode(),ac2:this.getArrivalAirportCode(),cid:this.getDestinationSId()})},getTripDetails:function(){return this.searchData.getLocation1ShortName()+" - "+this.searchData.getLocation2ShortName()},getShortTripDetails:function(){var a=function(a){return a?a.replace(/,.*/,""):""};return a(this.searchData.getLocation1ShortName())+" - "+a(this.searchData.getLocation2ShortName())},isSearchDataSufficient:function(){return!this.searchData.validateByMode(this.getSearchMode())},getTrackingEventsBasedOnNewsletterTypes:function(){var a=this.getSubscriptionData(),b=e.values(a),c=[];for(var d in b){var f=b[d],g="";switch(f){case i.NL_BB_DEPARTURE:g=i.CLICK_TRACKING_SUBCRIPTION_DEPARTURE;break;case i.NL_BB_TOP_DEAL:g=i.CLICK_TRACKING_SUBCRIPTION_TOP_DEAL;break;case i.NL_BB_ROUTE:g=i.CLICK_TRACKING_SUBCRIPTION_ROUTE}g.length>0&&c.push(g)}return c.push(i.CLICK_TRACKING_SUBCRIPTION),c},fireSub:function(){this.trigger(i.ON_FIRE_SUB,{trigger:this}),f.ajax({type:"POST",url:"/ajax/sub.php",data:this.getSubscriptionData(),success:this.onSubmitDone})},updateSubscriptionDataWithSearchData:function(){return this.setDepartureAirportCode(),this.setArrivalAirportCode(),this.setDestinationSId(),this},attach:function(){return this.listenTo(this.searchData,"change",this.onSearchDataChange),this.listenTo(this.searchData,h.ON_FULL_UPDATE,this.onSearchDataChange),this},bindMethods:function(){return d.bindMethods(this,["onSearchDataChange","onSubmitDone"]),this},defaults:function(){return{e1:"",e2:"",ac1:"",ac2:"",sid2:"",newsletters:[]}},onSubmitDone:function(a){var a=JSON.parse(a);"success"===a.status?this.trigger(i.ON_SUB_SUCCEED,{trigger:this,response:a}):this.trigger(i.ON_SUB_FAILED,{trigger:this,response:a})},onSearchDataChange:function(){this.updateSubscriptionDataWithSearchData(),this.trigger(i.ON_UPDATE_SUB_DATA,{trigger:this})}},{SUB_AJAX_FIELD_NL:"nlp",SUB_AJAX_FIELD_EMAIL1:"e1",SUB_AJAX_FIELD_EMAIL2:"e2",SUB_AJAX_FIELD_DEPARTURE_CODE:"ac1",SUB_AJAX_FIELD_RETURN_CODE:"ac2",SUB_AJAX_FIELD_DESTINATION_SID:"sid2",NL_BB_DEPARTURE:"nl_product_bb_departure",NL_BB_TOP_DEAL:"nl_product_bbtd",NL_BB_TJI:"nl_product_tji",NL_BB_ROUTE:"nl_product_bb_route",NL_BB_HOTEL_WATCH:"nl_product_bb_hotel_watch",CLICK_TRACKING_SUBCRIPTION:"event4",CLICK_TRACKING_SUBCRIPTION_DEPARTURE:"event46",CLICK_TRACKING_SUBCRIPTION_ROUTE:"event48",CLICK_TRACKING_SUBCRIPTION_TOP_DEAL:"event49",ON_FIRE_SUB:g.uniqueId(),ON_SUB_SUCCEED:g.uniqueId(),ON_SUB_FAILED:g.uniqueId(),ON_UPDATE_SUB_DATA:g.uniqueId()});c.ns("pages.tabBrowsing.db5.models.subscription",i)}(window);
//# sourceMappingURL=subscription.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=a.Backbone,e=a.jQuery,f=a._,g=b.functional,h=b.shared.models.searchData,i=d.View.extend({initialize:function(){this.subscriptionHeaderTitleEL=this.$(this.options.titleSelector),this.subscriptionHeaderSucceedTitleEL=this.$(this.options.successTitleSelector),this.formEl=this.$(this.options.formSelector),this.formContainerEl=this.$(this.options.formContainerSelector),this.submitButtonEl=this.$(this.options.buttonSelector),this.submitErrorEl=this.$(this.options.errorSelector),this.submitInputFieldEl=this.$(this.options.emailSelector),this.submitSuccessEl=this.$(this.options.successSelector),this.submitContainerEl=this.$(this.options.containerSelector)},subscriptionHeaderSucceedTitleEL:null,subscriptionHeaderTitleEL:null,submitButtonEl:null,formEl:null,formContainerEl:null,submitErrorEl:null,submitSuccessEl:null,submitInputFieldEl:null,submitContainerEl:null,isError:!1,hasFadedIn:!1,options:function(){return{headerSelector:".header",titleSelector:".header-title",successTitleSelector:".header-title-succeed",formSelector:".subscription-form",formContainerSelector:".form-container",buttonSelector:"button",emailSelector:"input[name='email']",errorSelector:".form-error",successSelector:".form-success",containerSelector:".sub-container"}},getHasFadedIn:function(){return this.hasFadedIn},isShowingError:function(){return this.isError},fadeInShow:function(){return this.$el.fadeIn(i.TIME_FADE_INOUT),this.hasFadedIn=!0,this},hide:function(){return this.$el.hide(),this},render:function(){var a=this.model.getSearchMode();return this.subscriptionHeaderTitleEL.html(this.getTitleContent(a)),this},show:function(){return this.$el.show(),this},reset:function(){return this.hideSucceedTitle(),this.showDefaultTitle(),this.hideSuccessMessage(),this.showSubmitForm(),this},start:function(){return this.bindMethods().attach().render()},stop:function(){return this.$el.off(),this.stopListening(),this},onToggleClick:function(a){e(this.formContainerEl).removeClass("dismiss-auto"),e(this.formContainerEl).hasClass("succeed")?e(this.formContainerEl).removeClass("succeed"):(this.hideError(),e(this.formContainerEl).toggleClass("shown"))},onSubmitClick:function(a){this.trigger(i.ON_SUBMIT,{trigger:this})},onSubmitInputChange:function(a){var b=e(a.target);this.model.saveEmail(b.val())},onSubmitInputHitEnter:function(a){a.preventDefault(),e(this.formContainerEl).removeClass("dismiss-auto");var b=a.keyCode?a.keyCode:a.which;b===i.KEY_CODE_ENTER&&this.trigger(i.ON_SUBMIT,{trigger:this})},onMouseOutFormContainer:function(){e(this.formContainerEl).addClass("dismiss-auto"),this.formContainerEl.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",this.hideError)},onMouseEnterFormContainer:function(){e(this.formContainerEl).removeClass("dismiss-auto"),this.hideError()},attach:function(){return this.$el.on("click",this.options.headerSelector,this.onToggleClick),this.$el.on("click",this.options.buttonSelector,this.onSubmitClick),this.$el.on("change",this.options.emailSelector,this.onSubmitInputChange),this.$el.on("keyup",this.options.emailSelector,this.onSubmitInputHitEnter),this.$el.on("mouseleave",this.options.containerSelector,this.onMouseOutFormContainer),this.$el.on("mouseenter",this.options.containerSelector,this.onMouseEnterFormContainer),this},bindMethods:function(){return g.bindMethods(this,["onToggleClick","onSubmitClick","onSubmitInputChange","onSubmitInputHitEnter","onMouseOutFormContainer","onMouseEnterFormContainer","hideError"]),this},showSuccessMessage:function(){return e(this.submitSuccessEl).addClass("shown"),this},hideSuccessMessage:function(){return e(this.submitSuccessEl).removeClass("shown"),this},showError:function(){return e(this.submitErrorEl).fadeIn(),this.isError=!0,this},hideError:function(){return e(this.submitErrorEl).fadeOut(),this.isError=!1,this},hideSubmitForm:function(){return e(this.formEl).hide(),this},showSubmitForm:function(){return e(this.formEl).show(),this},hideSubmitEntry:function(){return e(this.formContainerEl).addClass("succeed"),this},showSucceedTitle:function(){return e(this.subscriptionHeaderSucceedTitleEL).addClass("shown"),this},hideSucceedTitle:function(){return e(this.subscriptionHeaderSucceedTitleEL).removeClass("shown"),this},hideDefaultTitle:function(){return e(this.subscriptionHeaderTitleEL).addClass("dismiss"),this},showDefaultTitle:function(){return e(this.subscriptionHeaderTitleEL).removeClass("dismiss"),this},hideSubField:function(){var a=this;return f.delay(function(){a.$el.fadeOut(i.TIME_FADE_OUT_HIDE_SUB)},i.TIME_DELAY_HIDE_SUB),this},getTitleContent:function(a){var b;switch(a){case h.SEARCH_MODE_AIR:case h.SEARCH_MODE_VACATION_PACKAGES:b="Send me fare alerts from "+this.model.getDepartureAirportCode();break;case h.SEARCH_MODE_CAR:case h.SEARCH_MODE_CRUISE:case h.SEARCH_MODE_HOTEL:b="Send me top travel deals";break;default:b=""}return b}},{TIME_FADE_INOUT:1500,TIME_FADE_OUT_HIDE_SUB:1e3,TIME_DELAY_HIDE_SUB:5e3,KEY_CODE_ENTER:13,ON_SUBMIT:"onSubmit"});c.ns("pages.tabBrowsing.db5.views.subscription",i)}(window);
//# sourceMappingURL=subscription.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=b.bbus,e=b.define,f=a._,g=b.dependenciesInjection,h=b.shared.models.searchData,i=b.bbus.pages.tabBrowsing.db5.models.subscription,j=b.bbus.pages.tabBrowsing.db5.views.subscription,k=e(null,c.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.subscriptionModel=this.model.subscriptionModel,this.options=f.extend({},f.result(this,"options"),b),g.injectDependencies(this)},model:null,options:function(){return{containerSelector:".c-subscription-top"}},view:null,subscriptionModel:null,start:function(){return this.setupSubscriptionModel(this.subscriptionModel.getSearchMode()),this.attach(),this.view.start(),this},stop:function(){return this.stopListening(),this.view.stop(),this},onSubDataUpdated:function(){this.view.render(),this.view.reset()},onSubscriptionSubmitClicked:function(a){this.subscriptionModel.fireSub()},onSubSucceed:function(){this.view.isShowingError()&&this.view.hideError(),this.view.hideSubmitForm(),this.view.showSucceedTitle(),this.view.showSuccessMessage(),this.view.hideSubmitEntry(),this.view.hideDefaultTitle(),this.view.hideSubField(),this.stop()},onSubFailed:function(){this.view.isShowingError()||this.view.showError()},onSubFired:function(){this.view.isShowingError()&&this.view.hideError()},onAdSelectedChange:function(a,b,c){this.view.getHasFadedIn()||this.view.fadeInShow()},attach:function(){return this.listenTo(this.subscriptionModel,i.ON_SUB_SUCCEED,this.onSubSucceed),this.listenTo(this.subscriptionModel,i.ON_SUB_FAILED,this.onSubFailed),this.listenTo(this.subscriptionModel,i.ON_FIRE_SUB,this.onSubFired),this.listenTo(this.subscriptionModel,i.ON_UPDATE_SUB_DATA,this.onSubDataUpdated),this.listenTo(this.model.tabAds,"change:selected",this.onAdSelectedChange),this.listenTo(this.view,j.ON_SUBMIT,this.onSubscriptionSubmitClicked),this},getDependencies:function(){var a=this;return{view:function(){return new j({el:a.options.containerSelector,model:a.subscriptionModel})}}},setupSubscriptionModel:function(a){var b=[];switch(a){case h.SEARCH_MODE_VACATION_PACKAGES:case h.SEARCH_MODE_AIR:b.push(i.NL_BB_DEPARTURE),b.push(i.NL_BB_ROUTE);break;case h.SEARCH_MODE_HOTEL:b.push(i.NL_BB_HOTEL_WATCH)}return this.subscriptionModel.addNewsLetters(b),this}});d.ns("pages.tabBrowsing.db5.controllers.subscription",k)}(window);
//# sourceMappingURL=subscription.nano.js.map

!function(a){"use strict";var b=a.stm,c=b.bbus,d=a._,e=b.shared.models.pages.tabBrowsing.db5,f=(b.shared.models.searchData,b.bbus.pages.tabBrowsing.db5.models.subscription),g=e.extend({additionalQueryParams:{},subscriptionModel:null,newPlatformRedirectUrl:null,getNewPlatformRedirectUrl:function(){return this.newPlatformRedirectUrl},addQueryParams:function(a,b){return this.additionalQueryParams[a]=b,this},getQueryString:function(){var a=e.prototype.getQueryString.call(this);return a=d.extend({},a,this.additionalQueryParams),b.pageData.queryString=a,a},onAdsRetrieval:function(a){var c=this;a&&a.core_28771&&(b.pageData=b.pageData?b.pageData:{},b.pageData.core_28771={userPool:a.core_28771.userPool}),this.newPlatformRedirectUrl=a.newPlatformRedirectUrl,e.prototype.onAdsRetrieval.call(c,a)},getDependencies:function(){var a=e.prototype.getDependencies.call(this);return d.extend(a,{subscriptionModel:function(){return new f(this.searchData,{searchMode:this.getSearchMode(),newsletters:[f.NL_BB_TOP_DEAL,f.NL_BB_TJI]})}})}},{});c.ns("pages.tabBrowsing.db5.models.page",g)}(window);
//# sourceMappingURL=page.nano.js.map

!function(a){"use strict";var b=a.stm,c=b.define,d=b.bbus,e=b.shared.controllers.tabBrowsing.db5.omniture,f=b.bbus.pages.tabBrowsing.db5.models.subscription,g=function(){return b.tracking?b.tracking.omniture:{}},h=c(e,{tabClicked:!1,initialize:function(a,b,c){this.subscriptionModel=b,e.prototype.initialize.call(this,a)},subscriptionModel:null,onAdSelectedChange:function(a,b,c){this.shouldTrackAdClick()&&e.prototype.onAdSelectedChange.call(this,a)},onSubscriptionSubmitSucceed:function(){var a=this.subscriptionModel.getTrackingEventsBasedOnNewsletterTypes();this.trackSubClick(a)},shouldTrackAdClick:function(){return!this.tabClicked&&b.pageData&&b.pageData.core_28771&&"firstclick"==b.pageData.core_28771.userPool.toLowerCase()?(this.tabClicked=!0,!1):!0},sendEvar:function(a,b,c){return this.loaded?(g().sendEvar(a,b,c),this):(_.delay(this.sendEvar.bind(this,a,b,c),500),this)},attach:function(){e.prototype.attach.call(this),this.listenTo(this.subscriptionModel,f.ON_SUB_SUCCEED,this.onSubscriptionSubmitSucceed)}});d.ns("pages.tabBrowsing.db5.controllers.omniture",h)}(window);
//# sourceMappingURL=omniture.nano.js.map

/*---- CORE-28771 --- START ----*/
!function(a){"use strict";var b=a.stm,c=(a._,b.bbus),d=Backbone.Model.extend({isEnabled:function(){return this.get("enabled")},setEnabled:function(a,b){return this.set("enabled",a,b)},getViewMode:function(){return this.get("viewMode")},setViewMode:function(a,b){return this.set("viewMode",a,b)},getUserInteractionTimeout:function(){return this.get("userInteractionTimeout")},setUserInteractionTimeout:function(a,b){return this.set("userInteractionTimeout",a,b)},isShown:function(){return this.get("shown")},setShown:function(a,b){return this.set("shown",a,b)},defaults:function(){return{enabled:!0,viewMode:null,userInteractionTimeout:null,shown:!1}}},{VIEW_MODES:{PAGE_LOAD:"pageload",FIRST_CLICK:"firstclick"},VACATION_CROSS_SELL_INTERSTITIAL_SELECTOR:".vacationCrossSellInterstitial",CONTENT_DIALOG_SELECTOR:".vacationCrossSellInterstitial .contentDialog",PRIMARY_BUTTON_SELECTOR:".vacationCrossSellInterstitial .contentDialog .buttonContainer .btn.primary",SECONDARY_BUTTON_SELECTOR:".vacationCrossSellInterstitial .contentDialog .buttonContainer .btn.secondary",CLOSE_SELECTOR:".vacationCrossSellInterstitial .contentDialog .close",MASK_SELECTOR:".vacationCrossSellInterstitial .mask",OMNITURE:{PRIMARY_BUTTON_CLICK_DESCRIPTION:"interstitial cross sell layer click - yes",SECONDARY_BUTTON_CLICK_DESCRIPTION:"interstitial cross sell layer click - no",IMPRESSION_DESCRIPTION:"interstitial cross sell layer impression",EVAR_TO_SEND:"eVar35"},TIMEOUT_CLOSE:5e3,FIRST_CLICK_OFFSET:{TOP:84,LEFT:-77},CURRENT_TAB_SELECTOR:".c-header .c-tabs-listing .tabs .wrapper .c-individual-tab.s-active"});c.ns("pages.tabBrowsing.db5.models.vacationCrossSellInterstitial",d)}(window);
//# sourceMappingURL=vacationCrossSellInterstitial.nano.js.map
!function(a){"use strict";var b=a.stm,c=a._,d=b.define,e=b.bbus,f=b.shared.linkUtils,g=b.shared.orderedHash,h=b.dependenciesInjection,i=b.shared.models.pages.tabBrowsing.db5,j=(b.shared.controllers.tabBrowsing.db5.adDisplay,b.shared.controllers.tabBrowsing.db5.traqLayer,b.shared.controllers.tabBrowsing.db5.omniture,b.bbus.pages.tabBrowsing.db5.models.vacationCrossSellInterstitial),k=d({initialize:function(a,b,d,e,f,g){this.$el=$j(a),this.pageModel=b,this.adDisplayController=d,this.traqLayerController=e,this.omnitureController=f,this.options=c.extend({},c.result(this,"options"),g),h.injectDependenciesWith(this,this.getDependencies(),this.options.dependencies),this.attach()},$el:null,model:null,pageModel:null,adDisplayController:null,traqLayerController:null,omnitureController:null,options:function(){return{}},onPrimaryButtonClick:function(a){a.preventDefault(),this.trackImpression(j.OMNITURE.PRIMARY_BUTTON_CLICK_DESCRIPTION,this.redirectToVacationMode)},onSecondaryButtonClick:function(a){a.preventDefault(),this.trackImpression(j.OMNITURE.SECONDARY_BUTTON_CLICK_DESCRIPTION),this.hideInterstitial()},onCloseClick:function(a){a.preventDefault(),this.hideInterstitial()},onInteractionTimeout:function(){this.hideInterstitial()},onOmnitureLoaded:function(){this.shouldShow()&&this.model.getViewMode()===j.VIEW_MODES.PAGE_LOAD&&this.showInterstitial()},onTabSelectedChanged:function(a){var b=this.$el.find(j.CURRENT_TAB_SELECTOR);if(this.shouldShow()&&this.model.getViewMode()===j.VIEW_MODES.FIRST_CLICK)if(b.length>0&&a&&!a.attributes.faux_tabs_enabled){var c=b.offset();c.top+=j.FIRST_CLICK_OFFSET.TOP,c.left+=j.FIRST_CLICK_OFFSET.LEFT,this.$el.find(j.VACATION_CROSS_SELL_INTERSTITIAL_SELECTOR).offset(c),this.showInterstitial()}else this.hideInterstitial()},attach:function(){return this.$el.find(j.PRIMARY_BUTTON_SELECTOR).on("click",c.bind(this.onPrimaryButtonClick,this)),this.$el.find(j.SECONDARY_BUTTON_SELECTOR).on("click",c.bind(this.onSecondaryButtonClick,this)),this.$el.find(j.MASK_SELECTOR).on("click",c.bind(this.onCloseClick,this)),this.$el.find(j.CLOSE_SELECTOR).on("click",c.bind(this.onCloseClick,this)),this.model.listenToOnce(this.pageModel,i.ON_OTHER_DATA_LOADED,c.bind(this.onOmnitureLoaded,this)),this.model.listenToOnce(this.pageModel.tabAds,"change:selected",c.bind(this.onTabSelectedChanged,this)),this},shouldShow:function(){if(!this.model.getViewMode()){if(!(b.pageData&&b.pageData.core_28771&&b.pageData.core_28771.userPool))return void this.model.setEnabled(!1);switch(b.pageData.core_28771.userPool.toLowerCase()){case j.VIEW_MODES.FIRST_CLICK:this.model.setViewMode(j.VIEW_MODES.FIRST_CLICK);break;case j.VIEW_MODES.PAGE_LOAD:this.model.setViewMode(j.VIEW_MODES.PAGE_LOAD);break;default:return void this.model.setEnabled(!1)}this.$el.find(j.VACATION_CROSS_SELL_INTERSTITIAL_SELECTOR).addClass(this.model.getViewMode())}return this.model.isEnabled()&&!this.model.isShown()&&b.pageData.mode===b.searchData.constructor.SEARCH_MODE_AIR},showInterstitial:function(){return this.model.setShown(!0),this.$el.find(j.VACATION_CROSS_SELL_INTERSTITIAL_SELECTOR).show(),this.startInteractionTimeout(),this.trackImpression(j.OMNITURE.IMPRESSION_DESCRIPTION),this},hideInterstitial:function(){return this.$el.find(j.VACATION_CROSS_SELL_INTERSTITIAL_SELECTOR).hide(),this.stopInteractionTimeout(),this.model.getViewMode()===j.VIEW_MODES.FIRST_CLICK&&(this.adDisplayController.onAdSelectedChange(this.pageModel.tabAds.activeAd,!0),this.omnitureController.onAdSelectedChange(this.pageModel.tabAds.activeAd)),this},redirectToVacationMode:function(){var a=f.parseUrlIntoParts(document.URL);a&&a.queryString&&a.queryString.mode&&(a.queryString.mode=b.searchData.constructor.SEARCH_MODE_VACATION_PACKAGES,document.location=f.getFinalizedUrl(a.url,a.queryString,a.hash))},startInteractionTimeout:function(){return this.stopInteractionTimeout(),this.model.setUserInteractionTimeout(setTimeout(c.bind(this.onInteractionTimeout,this),j.TIMEOUT_CLOSE)),this},stopInteractionTimeout:function(){return clearTimeout(this.model.getUserInteractionTimeout()),this},trackImpression:function(a,b){this.omnitureController.sendEvar(j.OMNITURE.EVAR_TO_SEND,a,b)},getDependencies:function(){var a=new g;return a.append("model",c.bind(function(){return new j({enabled:!this.traqLayerController.hasTraqComponents()})},this)),a}});e.ns("pages.tabBrowsing.db5.controllers.vacationCrossSellInterstitial",k)}(window);
//# sourceMappingURL=vacationCrossSellInterstitial.nano.js.map
/*---- CORE-28771 --- END ----*/

!function(a){"use strict";var b=a.stm,c=b.shared,d=b.bbus,e=a.Backbone,f=a.jQuery,g=a._,h=b.functional,i=b.shared.models.searchData,j=b.shared.views.tabBrowsing.db5.individualTab,k=e.View.extend({initialize:function(a){this.options=g.extend({},g.result(this,"options"),a),this.template=c.getTemplate(this.options.templateName)},options:function(){return{templateName:"subscription-layer",linkedTabTemplateName:"sub-linked-tab",titleSelector:".sub-header > .title",successTitleSelector:".sub-header > .title-success",closeSelector:".sub-header > .close",inputContentSelector:".sub-body > .input-content",buttonSelector:".sub-body > .input-content > button",emailInputSelector:"input[name='email']",errorSelector:".error",successContentSelector:".sub-body > .success-content",successMsgSelector:".msg",linkedTabSelector:".linked-tab",descriptionContentSelector:".sub-body > .description-content"}},template:null,inputContentEl:null,titleEl:null,successTitleEl:null,emailInputEl:null,errorMsgEl:null,successContentEl:null,successMsgEl:null,start:function(){return this.bindMethods().attach(),this.render(),this},stop:function(){return this.detachAll(),this.$el.hide(),this.stopListening(),this},render:function(){var a=this.model.getSearchMode(),b=this.template({title:this.getTitle(a),mode:a,successMsg:this.getSuccessMsg(a),tripDetails:this.model.getTripDetails(),shortTripDetails:this.model.getShortTripDetails()});return this.$el.html(b),this.$el.toggleClass("visible",this.model.isSearchDataSufficient()),this.titleEl=this.$el.find(this.options.titleSelector),this.successTitleEl=this.$el.find(this.options.successTitleSelector),this.inputContentEl=this.$el.find(this.options.inputContentSelector),this.emailInputEl=this.inputContentEl.find(this.options.emailInputSelector),this.errorMsgEl=this.inputContentEl.find(this.options.errorSelector),this.successContentEl=this.$el.find(this.options.successContentSelector),this.descriptionContentEl=this.$el.find(this.options.descriptionContentSelector),this.successMsgEl=this.successContentEl.find(this.options.successMsgSelector),this},renderLinkedTab:function(a){var b=this.successContentEl.find(this.options.linkedTabSelector);b.html("");var c=new j({model:a,templateName:this.options.linkedTabTemplateName,el:b});return this.successContentEl.append(c),c.render(),this},updateSearchInfoLabels:function(){this.successMsgEl.html(this.getSuccessMsg(this.model.getSearchMode()))},hideInputContent:function(){return this.inputContentEl.hide(),this.detachInputContentHandlers(),this},showSuccessContent:function(a){this.titleEl.hide(),this.successTitleEl.show(),this.renderLinkedTab(a),this.hideInputContent(),this.successContentEl.show(),this.descriptionContentEl.hide(),f(".c-footer-fancy").hide(),f(".core30693C .c-subscription .sub-header .title").show(),f(".tripDetails").hide(),f(".trip").hide(),f(".success").show(),f(".core30693B .core30693b-success").show();var b="Success!<p>You're Signed Up.</p>";return f(".tripDetailsContainer .static-label").html(b),this},showError:function(){return this.errorMsgEl.show(),f(".input-content").css("height","86px"),this},hideError:function(){return this.errorMsgEl.hide(),this},onCloseClick:function(a){this.stop(),this.trigger(k.ON_CLOSE,{trigger:this})},onSubmitClick:function(a){this.processSubscribeAction()},onMouseEnter:function(a){f(".core30693C").addClass("hovered")},onEmailInputKeyUp:function(a){var b=a.keyCode?a.keyCode:a.which;b===k.KEY_CODE_ENTER&&(a.preventDefault(),this.processSubscribeAction())},processSubscribeAction:function(){var a=this.emailInputEl.val();return a?(a=f.trim(a),""==a?(this.showError(),this):(this.trigger(k.ON_SUBMIT,{trigger:this,email:a}),this)):(this.showError(),this)},attach:function(){return this.$el.on("click",this.options.closeSelector,this.onCloseClick),this.$el.on("click",this.options.buttonSelector,this.onSubmitClick),this.$el.on("keyup",this.options.emailInputSelector,this.onEmailInputKeyUp),this.$el.on("mouseenter",f(".tripDetailsRecipeC"),this.onMouseEnter),this},detachInputContentHandlers:function(){return this.$el.off("click",this.options.buttonSelector),this.$el.off("keyup",this.options.emailInputSelector),this},detachAll:function(){return this.$el.off(),this},bindMethods:function(){return h.bindMethods(this,["onCloseClick","onSubmitClick","onEmailInputKeyUp"]),this},getTitle:function(a){return a==i.SEARCH_MODE_AIR||a==i.SEARCH_MODE_VACATION_PACKAGES?"Send me low fare alerts from <b>"+this.model.getDepartureAirportCode()+"</b>":"Send me top travel deals"},getSuccessMsg:function(a){var b="Click to see today's lowest ",c="<b>"+this.model.getDepartureAirportCode()+"</b>",d="<b>"+this.model.getArrivalAirportCode()+"</b>";return a==i.SEARCH_MODE_AIR||a==i.SEARCH_MODE_VACATION_PACKAGES?b+c+" to "+d+" fare":a==i.SEARCH_MODE_HOTEL?b+d+" hotel deal":a==i.SEARCH_MODE_CAR?b+d+" rental deal":a==i.SEARCH_MODE_CRUISE?b+c+" cruise deal":""}},{KEY_CODE_ENTER:13,ON_SUBMIT:"DB5VerticalSubscriptionView:onSubmit",ON_CLOSE:"DB5VerticalSubscriptionView:onClose"});d.ns("pages.tabBrowsing.db5.vertical.views.subscription",k)}(window);
//# sourceMappingURL=subscription.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=b.bbus,e=b.define,f=a._,g=b.dependenciesInjection,h=(b.functional,b.shared.models.pages.tabBrowsing.db5),i=b.shared.models.searchData,j=b.bbus.pages.tabBrowsing.db5.models.subscription,k=b.bbus.pages.tabBrowsing.db5.vertical.views.subscription,l=e(null,c.getBackboneEvents(),{initialize:function(a,b,c){this.model=a,this.subscriptionModel=b,this.options=f.extend({},f.result(this,"options"),c),g.injectDependencies(this)},model:null,options:function(){return{containerSelector:".c-subscription"}},view:null,subscriptionModel:null,start:function(){return this.setupSubscriptionModel(this.subscriptionModel.getSearchMode()),this.attach(),this.view.start(),this},stop:function(){return this.view.stop(),this.stopListening(),this},onSubDataUpdated:function(){this.view.updateSearchInfoLabels(),this.view.render()},onSubscriptionSubmitClicked:function(a){a&&a.email&&(this.subscriptionModel.saveEmail(a.email),this.subscriptionModel.fireSub())},onSubSucceed:function(){this.view.showSuccessContent(this.getAdModelForLinkedTab()),this.listenTo(this.model,h.ON_ADS_FOUND,this.onAdlineupChange)},onSubFailed:function(){this.view.showError()},onSubFired:function(){this.view.hideError()},onAdSelectedChange:function(){this.stop()},onSubscriptionWidgetClose:function(){this.stop()},onAdlineupChange:function(){this.view.renderLinkedTab(this.getAdModelForLinkedTab())},attach:function(){return this.listenTo(this.model.tabAds,"change:selected",this.onAdSelectedChange),this.listenTo(this.subscriptionModel,j.ON_SUB_SUCCEED,this.onSubSucceed),this.listenTo(this.subscriptionModel,j.ON_SUB_FAILED,this.onSubFailed),this.listenTo(this.subscriptionModel,j.ON_FIRE_SUB,this.onSubFired),this.listenTo(this.subscriptionModel,j.ON_UPDATE_SUB_DATA,this.onSubDataUpdated),this.listenTo(this.view,k.ON_SUBMIT,this.onSubscriptionSubmitClicked),this.listenTo(this.view,k.ON_CLOSE,this.onSubscriptionWidgetClose),this},getDependencies:function(){var a=this;return{view:function(){return new k({el:a.options.containerSelector,model:a.subscriptionModel})}}},setupSubscriptionModel:function(a){var b=[];switch(a){case i.SEARCH_MODE_VACATION_PACKAGES:case i.SEARCH_MODE_AIR:b.push(j.NL_BB_DEPARTURE),b.push(j.NL_BB_ROUTE);break;case i.SEARCH_MODE_HOTEL:b.push(j.NL_BB_HOTEL_WATCH)}return this.subscriptionModel.addNewsLetters(b),this},getAdModelForLinkedTab:function(){return this.model.tabAds.findWhere({rank:1})}});d.ns("pages.tabBrowsing.db5.vertical.controllers.subscription",l)}(window);
//# sourceMappingURL=subscription.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=(a._,b.shared.views.tabBrowsing.db5.tabsListing),e=b.shared.controllers.tabBrowsing.db5.tabsListing,f=71,g=b.define(e,{onDownArrowClick:function(){this.containerView.$(".tabs");this.scrollTabs("+="+f)},onUpArrowClick:function(){this.containerView.$(".tabs");this.scrollTabs("-="+f)},slideTabIntoVisibility:function(a){if(a){var b=a.$el.position().top+a.$el.height()+16-a.$el.parents(".tabs").height();b>0&&this.scrollTabs("+="+b)}},scrollTabs:function(a){var b=this,c=this.containerView.$(".tabs");c.animate({scrollTop:a},400,"swing",function(){b.ensureOptimalDisplay()})},ensureOptimalDisplay:function(){var a=this.containerView.$(".tabs"),b=this.containerView.$(".wrapper"),c=b.height()-(a.scrollTop()+a.height());return a.scrollTop()<=0?this.containerView.upArrowEl.fadeOut():this.containerView.upArrowEl.fadeIn(),0>=c?this.containerView.downArrowEl.fadeOut():this.containerView.downArrowEl.fadeIn(),this},executeInitialEffect:function(){var a=this,b=400,d=15,e=0,f=this.containerView.$(".c-individual-tab").not(".c-start-tab"),g=this.model.tabAds.findWhere({selected:!0});if(g){var h=this.itemViews.get(g.getId());this.slideTabIntoVisibility(h)}return f.each(function(a,f){var g=c(f),h=function(){g.addClass("s-universalLogoType"),g.removeClass("s-noLogoType")};g.css("margin-left",-300),g.delay(e).animate({"margin-left":d},b),g.hasClass("s-universalLogoType")&&(g.removeClass("s-universalLogoType"),g.addClass("s-noLogoType"),g.find("img").load(h),setTimeout(h,3e3)),e+=b}),setTimeout(function(){a.ensureOptimalDisplay()},Math.min(7*b,b*f.length)),this},attach:function(){var b=this;return e.prototype.attach.call(this),this.listenTo(this.containerView,d.ON_DOWN_ARROW_CLICK,this.onDownArrowClick),this.listenTo(this.containerView,d.ON_UP_ARROW_CLICK,this.onUpArrowClick),c(a).resize(function(){b.ensureOptimalDisplay()}),this}});b.shared.ns("controllers.tabBrowsing.db5.verticalTabsListing",g)}(window);
//# sourceMappingURL=verticalTabsListing.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.define,d=b.shared.controllers.tabBrowsing.db5.adDisplay,e=c(d,{getFauxLocationAndDimensions:function(){var a=(this.containerView.$el,d.prototype.getFauxLocationAndDimensions.call(this));return a.height+=20,a.width-=300,a.left+=290,a}});b.shared.ns("controllers.tabBrowsing.db5.verticalAdDisplay",e)}(window);
//# sourceMappingURL=verticalAdDisplay.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=b.define,e=(a._,b.shared.linkUtils),f=b.shared.pages.tabBrowsing.controllers.db5,g=f.prototype,h=b.bbus.shared.controllers.blueKai,i=b.bbus.pages.tabBrowsing.db5.controllers.omniture,j=c.pages.tabBrowsing.db5.models.page,k=b.shared.models.searchData,l=b.shared.featuredSearchUtils,m=c.pages.tabBrowsing.db5.vertical.controllers.subscription,n=b.bbus.pages.tabBrowsing.db5.models.subscription,o=b.bbus.pages.tabBrowsing.db5.controllers.vacationCrossSellInterstitial,p=b.browser,q=b.bbus.shared.controllers.previousSearchesClicks,r=b.localStorage,s=d(f,{blueKaiController:null,isOneClickOneWindowSupported:!1,subscriptionController:null,subscriptionModel:null,vacationCrossSellInterstitialController:null,previousSearchesClicksController:null,initialize:function(c,d){l.shouldSendToMobileSearchResultPage(b.pageData.mode)?a.location=e.getMobileSearchResultPageForPhoneUrl():f.prototype.initialize.apply(this,[c,d]),this.activateSubscriptionController()},activateSubscriptionController:function(){return b.pageData.mode!==k.SEARCH_MODE_VACATION_RENTALS&&!this.traqLayerController.hasTraqComponents()&&this.subscriptionController&&this.subscriptionController.start(),this},onAdsDataLoaded:function(a){var b=this.model.getOtherDataQS();return this.model.getNewPlatformRedirectUrl()?void this.redirectToNewPlatformTabs():(a.response.srchsite_1415&&(b.srchsite_1415_userPool=a.response.srchsite_1415.userPool,b.srchsite_1415_eVar=a.response.srchsite_1415.eVar),l.shouldOpenOneClickOneWindow(this.model.searchData.mode)&&this.redirectToOneClickOneWindow(),b&&a&&a.response&&(a.response.core_28771&&(b.core_28771_userPool=a.response.core_28771.userPool,b.core_28771_eVar=a.response.core_28771.evar),a.response.core_30873&&(b.core_30873_userPool=a.response.core_30873.userPool,b.core_30873_eVar=a.response.core_30873.evar)),this.blueKaiController&&!this.blueKaiController.shouldAutoInitialize()&&this.blueKaiController.start(),void g.onAdsDataLoaded.call(this,a))},onBlueKaiTagFired:function(){this.blueKaiController.stop()},redirectToNewPlatformTabs:function(){var b=this.model.getNewPlatformRedirectUrl();b&&(a.location=b)},attachPost:function(){return this.listenTo(this.blueKaiController,h.ON_BLUEKAI_TAG_FIRED,this.onBlueKaiTagFired),g.attachPost.call(this)},isCore30873ABTestSupported:function(){return!p.isIPhone&&!p.isAndroidPhone&&(!p.Platform||!p.Platform.isTablet)&&r.isSupported()},getDependenciesPre:function(){var a=g.getDependenciesPre.call();return a.set("model",function(){return new j({el:this.element})}),a.set("subscriptionModel",function(){return new n(this.model.searchData,{searchMode:b.pageData.mode,newsletters:[n.NL_BB_TOP_DEAL,n.NL_BB_TJI]})}),b.pageData.db5TabBrowsing.showSubscription&&a.set("subscriptionController",function(){return new m(this.model,this.subscriptionModel)}),this.isCore30873ABTestSupported()&&a.set("previousSearchesClicksController",function(){return new q(r,this.model,{adConversionEventProvider:this.model.tabAds,adConversionEventName:"change:selected",supportsMultiAdsConversion:!1})}),a},getDependenciesPost:function(){var a=g.getDependenciesPost.call();return a.set("blueKaiController",function(){var a=this.element.find(this.options.blueKaiSelector).first();return a?new h(a,this.model.searchData):null}),a.set("omnitureController",function(){return new i(this.model,this.subscriptionModel)}),a.set("vacationCrossSellInterstitialController",function(){return new o(this.element,this.model,this.adDisplayController,this.traqLayerController,this.omnitureController)}),a},STATIC:{MINIMUM_SCREEN_WIDTH_FOR_SIDE_SELECTOR:1e3}});c.ns("pages.tabBrowsing.db5.controllers.main",s)}(window);
//# sourceMappingURL=main.nano.js.map

// ===========================================
// Destination Landing
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.bbus,d=b.shared,e=a._,f=b.define,g=b.autoInitialize,h=d.controllers.layerMetaWidget,i=d.models.searchData,j=f({initialize:function(a,c){this.element=a,this.options=e.extend({},e.result(this,"options"),c),b.searchData||(b.searchData=new i,b.searchData.fetch()),this.layerMetaWidgetController=new h(this.element)},element:null,options:function(){return{}},layerMetaWidgetController:null,STATIC:{autoInitialize:function(a){g.loadClass(j,a?a:"autoinit-bbus-destination-landing",!0)}}});j.autoInitialize(),c.ns("pages.destinationLanding.controllers.main",j)}(window);
//# sourceMappingURL=main.nano.js.map

// ===========================================
// Hotel Listings
// ===========================================

!function(a){var b=a.stm,c=a.Backbone,d=a.jQuery,e=a._,f="/api/locations/{{tids}}/images",g=c.Model.extend({initialize:function(){this.tids={}},addTid:function(a){this.tids[a+""]=!0,this.fetchImages()},fetchImages:e.debounce(function(){var a=this,b=e.filter(e.keys(this.tids),function(b){return!a.has(b)});e.isEmpty(b)||d.getJSON(this.createURL(b),function(b){a.set(b)})},1),getImages:function(a){return this.get(a+"")||[]},createURL:function(a){return f.replace("{{tids}}",e.map(a,function(a){return encodeURIComponent("p"+a)}).join(";"))},findImages:function(a,b){var c=this;b=e.once(b);var d=function(){return e.every(a,c.has,c)?(c.off("change",d),b(c.attributes),!0):!1};e.each(a,this.addTid,this),this.on("change",d),setTimeout(d,1)}},{getInstance:function(){return this._instance||(this._instance=new this)}});b.ns("shared.models.hotelImageGallery",g)}(window);
//# sourceMappingURL=hotelImageGallery.nano.js.map
!function(a){var b=a.stm,c=a.Backbone,d=a.jQuery,e=a._,f="http://i.slimg.com/bookingbuddy/generic-hotel.gif",g=c.View.extend({events:{"mouseover .hotel_image_gallery_thumbhand img":"activateThumbnail","click .photogallery-next":"onClickNext","click .photogallery-previous":"onClickPrevious"},initialize:function(a){this.tid=a.tid,this.thumbnailCount=a.thumbnailCount,this.image_index=0,this.listenTo(this.model,"change:"+this.tid,this.render),this.$el.addClass("initialized"),this.template=e.template(this.$el.find('[data-template-name="hotel-image-gallery"]').html()),this.render()},render:function(){this.$el.html(this.template({hero_url:this.getHeroURL(),thumbnail_urls:this.getThumbnailURLs()}))},activateThumbnail:function(a){var b=d(a.target);this.image_index=b.index(),this.render()},getHeroURL:function(){var a=this.model.getImages(this.tid);return a[this.image_index]?a[this.image_index].image:f},getThumbnailURLs:function(){return e.map(this.model.getImages(this.tid),function(a){return a.thumbnail}).slice(0,this.thumbnailCount)},onClickNext:function(a){var b=this.image_index;this.image_index=(b+1)%this.thumbnailCount,this.render()},onClickPrevious:function(){var a=this.image_index;this.image_index=(this.thumbnailCount+a-1)%this.thumbnailCount,this.render()}});b.ns("shared.views.hotelImageGallery",g)}(window);
//# sourceMappingURL=hotelImageGallery.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a._,e=c.controllers.leaveBehindPopunder,f=b.define(e,{options:function(){return d.extend(e.prototype.options.apply(this,arguments),{holdingWindowUrl:"/c/popunder/prepop.html"})}});b.bbus.ns("shared.controllers.leaveBehindPopunder",f)}(window);
//# sourceMappingURL=leaveBehindPopunder.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.Backbone,e=a.jQuery,f=a._,g=b.functional,h=b.shared.controllers.metaWidget,i=d.View.extend({initialize:function(a){this.options=f.extend({},f.result(this,"options"),a),this.container=e(this.options.containerSelector),this.hideResults(),this.bindMethods().attach()},options:function(){return{minHotelIndexToShow:4,maxHotelsToShow:3,containerSelector:".hotelMiniListingResultsContainer",hotelSelector:".miniListing",vendorSelector:".chevronVendorContainer"}},container:null,onHotelsFetched:function(){this.hideResults(),this.showResults()},onHotelClicked:function(a){var b=e(a.currentTarget),c=b.find(this.options.vendorSelector).first(),d=c.data("metaVendor"),f=b.data(h.DATA_KEY_CONTAINER_VIEW);a.stopPropagation(),f.doVendorClick(d)},attach:function(){return e.subscribe("metaWidget:updateCompleted",this.onHotelsFetched),this.container.on("click",this.options.hotelSelector,this.onHotelClicked),this},bindMethods:function(){return g.bindMethods(this,["onHotelsFetched","onHotelClicked"]),this},hideResults:function(){return this.container.hide(),this.container.find(this.options.hotelSelector).hide(),this},showResults:function(){var a=this,b=0;return this.container.find(this.options.hotelSelector).each(function(c){return b>=a.options.maxHotelsToShow?!1:void(c>=a.options.minHotelIndexToShow&&e(this).has(a.options.vendorSelector).length&&(e(this).show(),b++))}),b>0&&this.container.show(),this}},{});c.ns("views.hotelMiniListingResults",i)}(window);
//# sourceMappingURL=hotelMiniListingResults.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=b.shared,e=a.jQuery,f=b.define,g=b.functional,h=d.views.metaWidget.container,i=d.controllers.metaWidget,j=f(i,{options:function(){var a=i.prototype.options.call(this);return a.createContainer=function(a,b){return new h(b,{el:a,showDatepickerOnNoDates:!!a.data("showDatepickerOnNoDates"),chevronVendorsToShowForLarge:3,basicVendorsToShowForRegular:4,basicVendorsToShowForLarge:2})},a.updateOnConstruction=!1,a.trackMetrics=!0,a},attach:function(){var a=this;return i.prototype.attach.call(a),e.subscribe("BBHotelListing:hotelsFetched",function(){i.prototype.update.call(a)}),this},update:function(){e.publish("MetaWidget:searchCriteriaChanged")},bindMethods:function(){return i.prototype.bindMethods.call(this),g.bindMethods(this,["update"]),this},STATIC:{}});c.ns("pages.hotelListings.controllers.metaWidget",j)}(window);
//# sourceMappingURL=metaWidget.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=a.jQuery,e=a._,f=b.define,g=b.autoInitialize,h=b.functional,i=b.shared.controllers.exitDHTML.meta,j=b.shared.models.exitDHTML,k=b.bbus.shared.controllers.leaveBehindPopunder,l=b.shared.factories.metaBubble,m=b.bbus.pages.hotelListings.controllers.metaWidget,n=b.bbus.shared.controllers.pagesWithMetaWidgets,o=n.prototype,p=b.shared.views.relatedHotels.relatedHotelMeta,q=b.shared.views.relatedHotels.container,r=b.shared.models.searchData,s=b.shared.controllers.windowAutoExpander,t=b.shared.models.hotelImageGallery,u=b.shared.views.hotelImageGallery,v=b.shared.views.hotelMiniListingResults,w=function(){return b.pageData.taMeta||{}},x=f(n,{initialize:function(a,b){n.prototype.initialize.call(this,a,b),new s(a,b),this.metaBubbleController=l.createMainController(this.metaWidgetController),this.metaBubbleController.start()},options:function(){var a=o.options.call(this);return e.extend(a,{pageTitleSelector:"h1.page_title"})},onDateChanged:function(){return d.ajax({url:j.EXIT_DHTML_URL,data:{search_mode:r.SEARCH_MODE_HOTEL,site_page:"Hotel Listings"},success:e.bind(this.updateExitDHTML,this)}),this},onHotelsFetched:function(){var a=t.getInstance();d(".hotel_image_gallery:not(.initialized)").each(function(){var b=d(this).data("tid"),c=d(this).data("thumbnail-count");a.addTid(b);new u({el:this,model:a,tid:b,thumbnailCount:c})})},updateExitDHTML:function(a){this.exitDHTMLController.reloadAd(a)},attach:function(){return n.prototype.attach.call(this),d.subscribe("datesChanged",e.debounce(this.onDateChanged,500)),d.subscribe("BBHotelListing:hotelsFetched",this.onHotelsFetched),this},bindMethods:function(){return n.prototype.bindMethods.call(this),h.bindMethods(this,["onDateChanged"]),this},getDependencies:function(){var a=n.prototype.getDependencies.call(this);return a.exitDHTMLController=function(){var a=e.isObject(w())&&e.isObject(w().hotel)?w().hotel.id:0;return new i(a)},a.metaPopunderController=function(){return new k(this.element)},a.metaWidgetController=function(){return new m(this.element)},a.relatedHotelsContainer=function(){return new q({el:d(this.element).find('[data-stm-role="stm.shared.views.relatedHotels.container"]')})},a.relatedHotels=function(){var a=[];return d('[data-stm-role="stm.shared.views.relatedHotels.relatedHotelMeta"]').each(function(){var b=new p({el:this});a.push(b)}),a},a.hotelMiniListingResults=function(){var a={minHotelIndexToShow:4,maxHotelsToShow:3,containerSelector:".hotelMiniListingResultsContainer",hotelSelector:".miniListing",vendorSelector:".chevronVendorContainer"};return new v(a)},a},STATIC:{autoInitialize:function(a){g.loadClass(x,a?a:"bbus-hotelListings",!0)}}});x.autoInitialize(),c.ns("pages.hotelListings.controllers.main",x)}(window);
//# sourceMappingURL=main.nano.js.map

// ===========================================
// Hotels Step 1
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.bbus,d=b.shared,e=a._,f=b.define,g=b.autoInitialize,h=d.controllers.layerMetaWidget,i=d.models.searchData,j=f({initialize:function(a,c){this.element=a,this.options=e.extend({},e.result(this,"options"),c),b.searchData||(b.searchData=new i,b.searchData.fetch()),this.layerMetaWidgetController=new h(this.element)},element:null,options:function(){return{}},layerMetaWidgetController:null,STATIC:{autoInitialize:function(a){g.loadClass(j,a?a:"autoinit-bbus-hotels-step1",!0)}}});j.autoInitialize(),c.ns("pages.hotelsStep1.controllers.main",j)}(window);
//# sourceMappingURL=main.nano.js.map

// ===========================================
// Meta Tab Browsing
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.bbus,d=b.autoInitialize,e=b.define,f=b.shared.controllers.metaTabBrowsing,g=e(f,{STATIC:{autoInitialize:function(a){d.loadClass(g,a?a:"bbus-tab-browsing-check-rates",!0)}}});g.autoInitialize(),c.ns("pages.metaTabBrowsing.controllers.main",g)}(window);
//# sourceMappingURL=main.nano.js.map

// ===========================================
// Go Meta Go
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.bbus,d=b.shared,e=a.jQuery,f=b.define,g=b.autoInitialize,h=d.controllers.goMetaGo.bb,i=f(h,{STATIC:{autoInitialize:function(a){g.loadClass(i,a?a:"bbus-go-meta-go",!0)}}});e.subscribe("/bbtracking/init",i.autoInitialize),c.ns("pages.goMetaGo.controllers.main",i)}(window);
//# sourceMappingURL=main.nano.js.map

// ===========================================
// Step 2
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.bbus,d=b.shared,e=b.define,f=d.views.dhtmlAd.avoya,g=d.views.dhtmlAd.bookingBuddyUSMeta,h=d.views.dhtmlAd.bookingBuddyUSSub,i=d.views.dhtmlAd.carRentals,j=d.views.dhtmlAd.cheapcaribbean,k=d.views.dhtmlAd.cheapCruises,l=d.views.dhtmlAd.hotelsCom,m=d.views.dhtmlAd.hotelsCombined,n=d.views.dhtmlAd.hotwire,o=d.views.dhtmlAd.priceline,p=d.controllers.dhtmlAd,q=d.views.dhtmlAd.travelzoo,r=d.views.dhtmlAd.smartfares,s=d.views.dhtmlAd.goseek,t=d.views.dhtmlAd.staticdhtml,u=d.views.dhtmlAd.turo,v=d.views.dhtmlAd.rentalCars,w=e(p,{getView:function(){switch(this.options.adData.display_name){case"CarRentals":return i;case"Cheapcaribbean_Hotel":case"Cheapcaribbean_Vacation":return j;case"CheapCruises.com":return k;case"Hotels_com":return l;case"HotelsCombined":return m;case"Hotwire":return n;case"Priceline":return o;case"Avoya":return f;case"BookingBuddyUSMetaAir":case"BookingBuddyUSMetaHotel":return g;case"BookingBuddyUSSubAir":case"BookingBuddyUSSubHotel":return h;case"Travelzoo":return q;case"SmartFares":return r;case"GoSeek":return s;case"StaticDHTML":return t;case"Turo":return u;case"RentalCars":return v;default:return function(){}}},STATIC:{}});c.ns("pages.step2.controllers.dhtmlAd",w)}(window);
//# sourceMappingURL=dhtmlAd.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=b.shared,e=a._,f=a.jQuery,g=b.define,h=b.autoInitialize,i=c.pages.step2.controllers.dhtmlAd,j=d.controllers.metaWidget,k=d.models.searchData,l=g({initialize:function(a,c){this.element=a,this.options=e.extend({},e.result(this,"options"),c),b.searchData||(b.searchData=new k,b.searchData.fetch()),this.fetchDhtmlAd(),this.metaWidgetController=new j(this.element,{updateOnConstruction:!0})},dhtmlAdController:null,element:null,metaWidgetController:null,options:function(){return{}},fetchDhtmlAd:function(){var a=this,c=document.location.href.match(/\?.+/)||"";f.getJSON("/api/step2-dhtml-creative"+c,function(c){if(c){var d=c.data,e=c.html,g=f(e.trim()).appendTo("body");b.pageData.dhtmlAd=d,a.dhtmlAdController=new i(g,b.pageData.dhtmlAd)}})},STATIC:{autoInitialize:function(a){h.loadClass(l,a?a:"autoinit-bbus-step2",!0)}}});l.autoInitialize(),c.ns("pages.step2.controllers.main",l)}(window);
//# sourceMappingURL=main.nano.js.map

// ===========================================
// Tab Lander
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.bbus,d=b.autoInitialize,e=b.define,f=b.shared.controllers.tabLander,g=e(f,{STATIC:{autoInitialize:function(a){d.loadClass(g,a?a:"autoinit-bbus-pages-tabLander",!0)}}});g.autoInitialize(),c.ns("controllers.tabLander",g)}(window);
//# sourceMappingURL=main.nano.js.map

// ===========================================
// Tabbed Entry
// ===========================================
!function(a){var b=a.stm,c=b.shared.controllers.tabbedEntry.omniture,d=b.bbus.pages.tabBrowsing.db5.models.subscription,e=b.define(c,{initialize:function(a,b){this.subscriptionModel=b,c.prototype.initialize.call(this,a)},onSubscriptionSubmitSucceed:function(){var a=this.subscriptionModel.getTrackingEventsBasedOnNewsletterTypes();b.tracking.omniture.sendEvents(a,"A user has been subscribed to a newsletter")},attach:function(){c.prototype.attach.call(this),this.listenTo(this.subscriptionModel,d.ON_SUB_SUCCEED,this.onSubscriptionSubmitSucceed)}});b.bbus.ns("pages.tabbedEntry.fancy.controllers.omniture",e)}(window);
//# sourceMappingURL=omniture.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=b.define,e=(a._,b.shared.linkUtils),f=b.shared.pages.tabbedEntry.controllers.fancy,g=f.prototype,h=(b.dependenciesInjection,b.shared.featuredSearchUtils),i=b.shared.views.tabbedEntry.backgroundImage,j=b.bbus.pages.tabbedEntry.fancy.controllers.omniture,k=c.pages.tabBrowsing.db5.vertical.controllers.subscription,l=b.bbus.pages.tabBrowsing.db5.models.subscription,m="bb_affiliate_bookingbuddy_com",n=b.browser,o=b.bbus.shared.controllers.previousSearchesClicks,p=b.localStorage,q=b.bbus.pages.tabbedEntry.fancy.models.page,r=d(f,{previousSearchesClicksController:null,initialize:function(c,d){h.shouldSendToMobileSearchResultPage(b.pageData.tabbedEntry.mode)?a.location=e.getMobileSearchResultPageForPhoneUrl():g.initialize.apply(this,[c,d]),this.activateSubscriptionController()},activateSubscriptionController:function(){return this.subscriptionController&&this.subscriptionController.start(),this},isCore30873ABTestSupported:function(){return!n.isIPhone&&!n.isAndroidPhone&&(!n.Platform||!n.Platform.isTablet)&&p.isSupported()},onSearchModeChange:function(a){this.previousSearchesClicksController&&this.previousSearchesClicksController.loadPreviousSearchesClicksData(a.mode),g.onSearchModeChange.call(this,a)},getDependencies:function(){var a=g.getDependencies.call(this);return a.set("model",function(){return new q({el:this.element},{dependencies:{preSelectFirstAd:this.shouldPreSelectFirstAd()}})}),a.append("backgroundImageView",function(){return new i({model:this.model.searchData,el:this.element,forceDefault:this.model.getAffiliateName()==m,defaultImageURL:f.DEFAULT_BACKGROUND_IMAGE})}),a.append("subscriptionModel",function(){return new l(this.model.searchData,{searchMode:b.pageData.tabbedEntry.mode,newsletters:[l.NL_BB_TOP_DEAL,l.NL_BB_TJI,l.NL_BB_DEPARTURE]})}),a.append("subscriptionController",function(){return new k(this.model,this.subscriptionModel)}),a.remove("omnitureController"),a.append("omnitureController",function(){return new j(this.model,this.subscriptionModel)}),this.isCore30873ABTestSupported()&&a.append("previousSearchesClicksController",function(){return new o(p,this.model,{adConversionEventProvider:this,adConversionEventName:f.ON_AD_OPENED,supportsMultiAdsConversion:this.shouldShowCompareButton()})}),a}});c.ns("pages.tabbedEntry.fancy.controllers.main",r)}(window);
//# sourceMappingURL=main.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus.pages.tabbedEntry.fancy.controllers.main,d=b.shared.views.tabbedEntry.backgroundImage,e="http://i.slimg.com/core-sites/bbus/MVCView/Page/TabbedEntry/LowestFare/",f=b.define(c,{getDependencies:function(){var a=c.prototype.getDependencies.call(this);return a.append("backgroundImageView",function(){var a="hotel"==this.model.searchData.mode?!0:!1,b="hotel"==this.model.searchData.mode?e+"Hallway.jpg?q=2015030901":e+"tropical-pier.jpg?q=2015030901";return new d({model:this.model.searchData,el:this.element,forceDefault:a,defaultImageURL:b})}),a}});b.bbus.ns("pages.tabbedEntry.fancy.controllers.lowestFare",f)}(window);
//# sourceMappingURL=lowestFare.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus.pages.tabbedEntry.fancy.controllers.main,d=b.shared.views.tabbedEntry.backgroundImage,e="http://i.slimg.com/core-sites/bbus/MVCView/Page/TabbedEntry/Kayak/tropical-beach.jpg?q=2015071601",f=b.define(c,{getDependencies:function(){var a=c.prototype.getDependencies.call(this);return a.append("backgroundImageView",function(){return new d({model:this.model.searchData,el:this.element,defaultImageURL:e})}),a}});b.bbus.ns("pages.tabbedEntry.fancy.controllers.kayak",f)}(window);
//# sourceMappingURL=kayak.nano.js.map
!function(a){"use strict";var b="https://www.priceline.com/rentalcars/opaqueContractPageDisplay.do",c="http://www.priceline.com/qp.asp?productid=8",d=191,e=153339,f="/c/lander/lowest-fare.html",g=a.jQuery,h=a.stm,i=h.strings,j=a.LocationSuggest||function(){},k=h.shared.models.locationDataStore,l=h.tracking.omniture,m=h.browser,n=Backbone.View.extend({events:{"submit form.searchWidget":"onSubmit","click .searchWidget .save-now":"onButtonClick","LocationSuggest:valid":"render","LocationSuggest:invalid":"render"},initialize:function(){this.locationDataStore=new k,this.locationSuggest=new j(g("[data-stm-role=location2Input]"),"airport",null,{},null,g("[data-stm-role=location2TaId]")),g("input[name=date1], input[name=date2]").datepicker();var a=this.queryString();this.location2=this.locationDataStore.lookup(a.location2),g("input[name=date1]").val(this.convertDate(a.date1)),g("input[name=date2]").val(this.convertDate(a.date2)),g("select[name=time1]").val(a.time1),g("select[name=time2]").val(a.time2),g("input[name=location2Text]").val(this.buildLocationDisplayName()),g("input[name=location2TaId]").val(a.location2),l.triggerConfigChanged({account:"www.bookingbuddy.com"==document.location.hostname?"slbbbcom":"slbbbcomdev",adImpressionIds:[],events:[],searchMode:"car",source:"S"+(a.source||"none"),substate:!1,trackingServer:"stats.bookingbuddy.com",vars:{eVar38:this.getDeviceText()+" | Full Site",channel:"car",pageName:"car-LowestFare_Car_NYOP"}}),this.render()},render:function(){var a=g("input[name=location2TaId]").val();a!=this.location2.taId&&(this.location2=this.locationDataStore.lookup(a));var b=this.getCityName(),c=b?"We found more car deals in "+b+". Save up to 40% now!":"We have more car deals. Save up to 40% now!";this.$(".c-trip-details p").text(c)},getCityName:function(){return this.$("*[name=location2Text]").val().replace(/,.*/,"")},getDeviceText:function(){return m.isIPhone||m.isAndroidPhone?"Mobile Device":m.Platform.isTablet?"Tablet Device":"Other Device"},buildLocationDisplayName:function(){var a=this.location2.displayName||"";return!a.match(/\(/)&&this.location2.code&&(a+=" ("+this.location2.code+")"),a},queryString:function(){return _.extend(i.parseQueryString(a.location.search.replace(/^\?/,"")),i.parseQueryString(a.location.hash.replace(/^#/,"")))},convertDate:function(a){var b=(a||"").match(/(\d+)-(\d+)-(\d+)/);return b?b[2]+"/"+b[3]+"/"+b[1]:""},onButtonClick:function(){var h={vehicleCode:this.$("*[name=type]").val(),pickUpSearchAirportString:this.location2.code,dropOffSearchAirportString:this.location2.code,pickupDate:this.$("*[name=date1]").val(),pickupTime:this.$("*[name=time1]").val(),dropoffDate:this.$("*[name=date2]").val(),dropoffTime:this.$("*[name=time2]").val(),currencyCode:"USD",offerPrice:~~this.$("*[name=price]").val()},i=null;return i=this.location2.countryId===d||this.location2.countryId===e?b+"?"+g.param(h):c+"&"+g.param(h),g("label").removeClass("error"),h.pickUpSearchAirportString?h.offerPrice<=0?void g("label.price").addClass("error"):(l.sendEvar("eVar35","NYOP Car Click"),void(this.isRedirectToLowestFare()?(a.open(i,"_blank","width=1000,height=1000"),setTimeout(function(){var a=document.location;a.href=a.protocol+"//"+a.hostname+f+a.search+a.hash},1e3)):a.location=i)):void g("label.location2").addClass("error")},onSubmit:function(a){a.preventDefault()},isRedirectToLowestFare:function(){return"1"==this.queryString().redirectToLowestFare}});h.bbus.ns("pages.tabbedEntry.views.nyop",n)}(window);
//# sourceMappingURL=nyop.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus.pages.tabbedEntry.fancy.controllers.main,d=b.shared.views.tabbedEntry.backgroundImage,e="http://i.slimg.com/core-sites/bbus/MVCView/Page/TabbedEntry/Kayak/tropical-beach.jpg?q=2015071601",f=b.define(c,{getDependencies:function(){var a=c.prototype.getDependencies.call(this);return a.append("backgroundImageView",function(){return new d({model:this.model.searchData,el:this.element,defaultImageURL:e})}),a}});b.bbus.ns("pages.tabbedEntry.fancy.controllers.hoteling",f)}(window);
//# sourceMappingURL=hoteling.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus.pages.tabbedEntry.fancy.controllers.main,d=b.define(c,{getDependencies:function(){var a=c.prototype.getDependencies.call(this);return a.append("backgroundImageView",function(){return null}),a}});b.bbus.ns("pages.tabbedEntry.fancy.controllers.ta",d)}(window);
//# sourceMappingURL=ta.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus.pages.tabbedEntry.fancy.controllers.main,d=b.shared.views.tabbedEntry.backgroundImage,e="http://i.slimg.com/core-sites/bbus/MVCView/Page/TabbedEntry/Kayak/tropical-beach.jpg?q=2015071601",f=b.define(c,{getDependencies:function(){var a=c.prototype.getDependencies.call(this);return a.append("backgroundImageView",function(){return new d({model:this.model.searchData,el:this.element,defaultImageURL:e})}),a}});b.bbus.ns("pages.tabbedEntry.fancy.controllers.farePortal",f)}(window);
//# sourceMappingURL=farePortal.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus.pages.tabbedEntry.fancy.controllers.main,d=b.shared.views.tabbedEntry.backgroundImage,e="http://i.slimg.com/core-sites/bbus/MVCView/Page/TabbedEntry/CheapFlights/lagoon.jpg?q=20160224",f=b.define(c,{getDependencies:function(){var a=c.prototype.getDependencies.call(this);return a.append("backgroundImageView",function(){return new d({model:this.model.searchData,el:this.element,defaultImageURL:e})}),a}});b.bbus.ns("pages.tabbedEntry.fancy.controllers.cheapFlights",f)}(window);
//# sourceMappingURL=cheapFlights.nano.js.map
!function(a){"use strict";var b=Backbone.View.extend({initialize:function(){this.listenTo(this.model,"all",this.render.bind(this)),this.render()},render:function(){var a=this.model.getDestinationCityName();a?this.$el.text("Looking to stay in "+a+"? We have the hotel for you!"):this.$el.text("Looking for a place to stay? We have the hotel for you!")}});stm.bbus.ns("pages.tabbedEntry.views.overlayHeadline",b)}(window);
//# sourceMappingURL=overlayHeadline.nano.js.map
!function(a){"use strict";var b=jQuery,c=a.stm,d=c.shared.views.tabbedEntry.iframeAdView,e=c.bbus.pages.tabbedEntry.fancy.controllers.main,f=c.bbus.pages.tabbedEntry.views.overlayHeadline,g=c.define(e,{initialize:function(a){e.prototype.initialize.apply(this,arguments),this.closeOverlay=this.closeOverlay.bind(this),b(a).delegate(".fancy-overlay-close","click",this.closeOverlay),this.on(g.ON_AD_OPENED,this.closeOverlay)},getDependencies:function(){var a=e.prototype.getDependencies.call(this);return a.append("backgroundImageView",function(){return null}),a.append("iframeAdView",function(){var a=new d({model:this.model});return a.$el.appendTo("body"),a}),a.append("overlayHeadlineView",function(){return new f({model:this.model,el:b(".fancy-overlay-header")})}),a},closeOverlay:function(){this.iframeAdView.hideShade(),b(".c-page-content-fancy, .c-header-fancy, .c-footer-fancy").hide()}});c.bbus.ns("pages.tabbedEntry.fancy.controllers.overlay",g)}(window);
//# sourceMappingURL=overlay.nano.js.map

// ===========================================
// Tripping Search Lander
// ===========================================
!function(a){"use strict";var b=a.stm,c=b.bbus,d=b.shared.models.searchData,e=d.extend({validateModel:function(a){var b={},c=this.isValidDate(a.date1),d=this.isValidDate(a.date2);switch(this.mode){case e.SEARCH_MODE_AIR:a.location1||(b.location1="Please enter a departure airport in the 'Flying From' field to continue."),a.location2?this.isIdenticalLocation(a.location1,a.location2)&&(b.location2="Please enter different 'from' and 'to' locations to continue."):b.location2="Please enter an arrival airport in the 'Flying To' field to continue.",a.date1?a.oneway&&!c&&(b.date1="Flights are only available up to 330 days in advance."):b.date1="Departure date is required.",a.oneway||(a.date2?a.date1>a.date2?b.date2="Departure date must precede return date.":c||d||(b.date2="Flights are only available up to 330 days in advance."):b.date2="Return date is required.");break;case e.SEARCH_MODE_CAR:a.location2||(b.location2="Please enter a city in the 'Pick-up city' field."),a.date1||(b.date1="Pick-up date is required."),a.date2?a.date1>a.date2?b.date2="Pick-up date must precede drop-off date.":c||d||(b.date2="Car rentals are only available up to 330 days in advance."):b.date2="Drop-off date is required."}return b}},{});c.ns("pages.searchLander.tripping.models.searchData",e)}(window);
//# sourceMappingURL=searchData.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=b.shared,e=a.jQuery,f=a._,g=b.functional,h=function(){return b.pageData||{}},i=b.shared.models.pages.tabBrowsing,j=i.prototype,k=b.bbus.pages.searchLander.tripping.models.searchData,l=i.extend({fetchData:function(){return e.ajax({url:l.URL_MAIN_DATA,data:this.getQueryString(),success:this.onDataRetrieval}),this},getSourceIdByMode:function(a){var b=null;switch(a){case k.SEARCH_MODE_AIR:b=l.SOURCE_ID_AIR;break;case k.SEARCH_MODE_CAR:b=l.SOURCE_ID_CAR}return b},getSearchMode:function(){return h().mode},onDataRetrieval:function(a){this.searchData.updateFromCookie(),a.omniture&&(this.omnitureData=a.omniture,this.trigger(l.ON_OMNITURE_DATA_LOADED,{trigger:this})),this.trigger(l.ON_ALL_DATA_LOADED,{trigger:this})},attach:function(){return this.listenTo(this.searchData,"change",this.onSearchDataChange),this.listenTo(this.searchData,l.ON_FULL_UPDATE,this.onSearchDataChange),d.getWindow().on("resize",f.debounce(this.onWindowResize,200)),this},bindMethods:function(){return g.bindMethods(this,["onDataRetrieval"]),j.bindMethods.call(this),this},getDependencies:function(){var a=j.getDependencies.call(this);return f.extend({},a,{searchData:function(){return new k}})}},{AFFILIATE_ID:20453651,OPP_LANDER_ID:349,SOURCE_ID_AIR:53128,SOURCE_ID_CAR:53129,URL_MAIN_DATA:"/tripping/getMain.html",URL_TRIPPING_LANDER:"/tripping.html",ON_ALL_DATA_LOADED:"onAllDataLoaded"});c.ns("pages.searchLander.tripping.models.page",l)}(window);
//# sourceMappingURL=page.nano.js.map

!function(a){"use strict";var b=a.stm,c=Backbone.View.extend({events:{change:"onChange"},initialize:function(){this.listenTo(this.model,"change",this.render),this.render()},render:function(){this.$el.val(this.model.getSearchType())},onChange:function(){this.model.setSearchType(this.$el.val())}});b.bbus.ns("pages.searchLander.tripping.views.flightTypeSelect",c)}(window);
//# sourceMappingURL=flightTypeSelect.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=a._,e=a.Backbone,f=b.dependenciesInjection,g=b.functional,h=b.shared.views.searchInput.date1,i=b.shared.views.searchInput.date2,j=b.domState,k=b.shared.views.searchInput.searchType,l=b.bbus.pages.searchLander.tripping.views.flightTypeSelect,m=b.shared.views.searchInput.location1,n=b.shared.views.searchInput.location2,o=b.shared.views.searchInput.nonStop,p=b.bbus.pages.searchLander.tripping.models.searchData,q=b.shared.views.searchInput.time1,r=b.shared.views.searchInput.time2,s=e.View.extend({initialize:function(a){this.options=d.extend({},d.result(this,"options"),a),this.date2LabelEl=this.$(this.options.date2LabelSelector),this.errorContainerEl=this.$(this.options.errorContainerSelector),f.injectDependencies(this)},date2LabelEl:null,date1View:null,date2View:null,errorContainerEl:null,isPlaceholderSupported:!0,location1View:null,location2View:null,model:null,nonstopView:null,flightTypeView:null,options:function(){return{date1Selector:".date1 > [data-stm-role=date1]",date2Selector:".date2 > [data-stm-role=date2]",date2LabelSelector:".date2 > .label",errorContainerSelector:".c-errors",inputContainerSelector:"label",location1ContainerSelector:".location1",location1Selector:"[data-stm-role=location1Input]",location2ContainerSelector:".location2",location2Selector:"[data-stm-role=location2Input]",nonstopSelector:"[data-stm-role=nonstop]",flightTypeSelector:"[data-stm-role=flightType]",flightTypeSelectSelector:".flightTypeSelect",time1Selector:"[data-stm-role=time1]",time2Selector:"[data-stm-role=time2]",searchButtonSelector:"button.search-button",textInputSelector:":text",pseudoPlaceholderSelector:".placeholder"}},clearErrors:function(){return j.clear(this.$el),j.clear(this.$(this.options.inputContainerSelector)),this.errorContainerEl.html("").hide(),this},displayErrors:function(a,b){var c,e,f=this;return this.clearErrors(),d.isEmpty(a)||($j.each(a,function(a,d){e=f.$("."+a),c=e.find(f.options.textInputSelector),b&&c.data(s.ATTRIBUTE_VISITED)!==!0||(f.markFieldInvalid(e),f.addErrorMessage(d))}),this.errorContainerEl.fadeIn(s.DURATION_ERROR_FADE_MS)),this},hide:function(){return this.$el.fadeOut(),this},render:function(){var a=this;return this.date1View&&this.date1View.render(),this.date2View&&this.date2View.render(),this.location1View&&this.location1View.render(),this.location2View&&this.location2View.render(),this.nonstopView&&this.nonstopView.render(),this.flightTypeView&&this.flightTypeView.render(),this.time1View&&this.time1View.render(),this.time2View&&this.time2View.render(),this.updateInputVisibility(),this.isPlaceholderSupported||this.$(this.options.textInputSelector).each(function(b,c){a.togglePlaceholder($j(c))}),this},start:function(){return this.bindMethods().attach().detectPlaceholderSupport()},onOnewayChange:function(a,b,c){this.updateInputVisibility()},onSearchButtonClick:function(a){a.preventDefault(),this.trigger(s.ON_SEARCH_BUTTON_CLICK,{trigger:this})},onInputBlur:function(a){var b=$j(a.target);this.isPlaceholderSupported||this.togglePlaceholder(b)},onInputFocus:function(a){var b=$j(a.target);this.isPlaceholderSupported||this.togglePlaceholder(b),b.data(s.ATTRIBUTE_VISITED,!0)},onSearchDataChange:function(a,b){var c=a.validateByMode();this.displayErrors(c,!0)},attach:function(){return this.listenTo(this.model,"change",this.onSearchDataChange),this.listenTo(this.model,"change:oneway",this.onOnewayChange),this.$el.on("click",this.options.searchButtonSelector,this.onSearchButtonClick),this.$el.on("focus",this.options.textInputSelector,this.onInputFocus),this.$el.on("blur",this.options.textInputSelector,this.onInputBlur),this},bindMethods:function(){return g.bindMethods(this,["onOnewayChange","onInputBlur","onInputFocus","onSearchButtonClick","onSearchDataChange"]),this},addErrorMessage:function(a){var b=$j("<li />").text(a);return this.errorContainerEl.append(b),this},markFieldInvalid:function(a){return j.add(a,s.STATE_ERROR),this},getDependencies:function(){var a=this;return{date1View:function(){var b=this.$(a.options.date1Selector);return b.length?new h({el:b,dateFormat:b.data("date-format"),model:this.model}):null},date2View:function(){var b=this.$(a.options.date2Selector);return b.length?new i({el:b,dateFormat:b.data("date-format"),model:this.model}):null},location1View:function(){var b=this.$(a.options.location1ContainerSelector);return b.length?new m({el:b,mode:this.model.mode,model:this.model}):null},location2View:function(){var b=this.$(a.options.location2ContainerSelector);return b.length?new n({el:b,mode:this.model.mode,model:this.model}):null},nonstopView:function(){var b=this.$(a.options.nonstopSelector);return b.length?new o({el:b,model:this.model}):null},flightTypeView:function(){var b=this.$(a.options.flightTypeSelector);return b.length?new k({el:b,model:this.model}):null},flightTypeSelectView:function(){return new l({el:this.$(a.options.flightTypeSelectSelector),model:this.model})},time1View:function(){var b=this.$(a.options.time1Selector);return b.length?new q({el:b,model:this.model}):null},time2View:function(){var b=this.$(a.options.time2Selector);return b.length?new r({el:b,model:this.model}):null}}},togglePlaceholder:function(a){var b,c,d=a.attr("placeholder");return a.is(this.options.textInputSelector)&&d?(b=a.is(":focus"),a.is(this.options.location1Selector)||a.is(this.options.location2Selector)?(c=this.getPseudoPlaceholder(a),b?c.hide():b||""!==a.val()||c.show()):b&&a.val()===d?a.val(""):b||""!==a.val()||a.val(d),this):this},getPseudoPlaceholder:function(a){var b,c=a.siblings(this.options.pseudoPlaceholderSelector),d=a.attr("placeholder");return c.length<1&&(b=this.options.pseudoPlaceholderSelector.substr(1),c=$j("<span />").addClass(b).text(d).insertBefore(a)),c},detectPlaceholderSupport:function(){return this.isPlaceholderSupported=void 0!==document.createElement("input").placeholder,this},updateInputVisibility:function(){var a;return this.model.mode===p.SEARCH_MODE_AIR&&(a=this.model.isRoundTrip(),this.date2LabelEl.toggle(a),this.date2View.$el.toggle(a),this.time2View&&this.time2View.$el.toggle(a)),this}},{DURATION_ERROR_FADE_MS:300,STATE_ERROR:"hasError",ATTRIBUTE_VISITED:"visited",ON_SEARCH_DATA_CHANGE:"onSearchDataChange",ON_SEARCH_BUTTON_CLICK:"onSearchButtonClick"});c.ns("pages.searchLander.tripping.views.searchWidget",s)}(window);
//# sourceMappingURL=searchWidget.nano.js.map

!function(a){"use strict";var b=a.stm,c=b.bbus,d=b.shared,e=a._,f=b.define,g=b.bbus.pages.searchLander.tripping.models.page,h=function(){return b.tracking?b.tracking.omniture:null},i=f(null,d.getBackboneEvents(),{initialize:function(a,b){this.model=a},loaded:!1,model:null,start:function(){return this.attach()},trackPageLoad:function(){var a=h();return this.loaded&&e.isObject(a)?(this.model.omnitureData&&a.triggerConfigChanged(this.model.omnitureData),this):(e.delay(this.trackPageLoad.bind(this),500),this)},onConfigDataLoaded:function(a){var b=h();e.isObject(b)&&(b.triggerConfigChanged(this.model.omnitureData),this.loaded=!0)},attach:function(){return this.listenTo(this.model,g.ON_OMNITURE_DATA_LOADED,this.onConfigDataLoaded),this},STATIC:{}});c.ns("pages.searchLander.tripping.controllers.omniture",i)}(window);
//# sourceMappingURL=omniture.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=b.shared,e=a._,f=b.define,g=b.dependenciesInjection,h=b.shared.orderedHash,i=b.bbus.pages.searchLander.tripping.views.searchWidget,j=f(null,d.getBackboneEvents(),{initialize:function(a,b){this.model=a,this.options=e.extend({},e.result(this,"options"),b),g.injectDependencies(this)},model:null,options:function(){return{containerSelector:".c-search-widget"}},view:null,start:function(){return this.attach(),this.view.start(),this},clearErrors:function(){return this.view.clearErrors(),this},displayErrors:function(a,b){return this.view.displayErrors(a,b),this},onSearchDataChange:function(a){this.trigger(j.ON_SEARCH_DATA_CHANGE,{trigger:this})},onSearchButtonClick:function(a){this.trigger(j.ON_SEARCH_BUTTON_CLICK,{trigger:this})},attach:function(){return this.listenTo(this.view,i.ON_SEARCH_DATA_CHANGE,this.onSearchDataChange),this.listenTo(this.view,i.ON_SEARCH_BUTTON_CLICK,this.onSearchButtonClick),this},getDependencies:function(){var a=this;return new h([["view",function(){return new i({el:this.model.containerEl.find(a.options.containerSelector),model:this.model.searchData})}]])},STATIC:{ON_SEARCH_DATA_CHANGE:"onSearchDataChange",ON_SEARCH_BUTTON_CLICK:"onSearchButtonClick"}});c.ns("pages.searchLander.tripping.controllers.searchWidget",j)}(window);
//# sourceMappingURL=searchWidget.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bbus,d=b.shared,e=a._,f=a.jQuery,g=b.define,h=b.dependenciesInjection,i=b.shared.featuredSearchUtils,j=b.shared.linkUtils,k=b.bbus.pages.searchLander.tripping.controllers.omniture,l=b.shared.orderedHash,m=b.bbus.pages.searchLander.tripping.models.page,n=b.bbus.pages.searchLander.tripping.controllers.searchWidget,o=g(null,d.getBackboneEvents(),{initialize:function(a,b){this.element=a,this.options=e.extend({},e.result(this,"options"),b),h.injectDependencies(this)},element:null,model:null,omnitureController:null,searchWidgetController:null,start:function(){return this.attach(),this.searchWidgetController.start(),this.omnitureController.start(),this.model.loadPageDataFromQueryString(),this.model.fetchData(),this},onDataLoaded:function(a){this.searchWidgetController.view.render()},onHashChange:function(a){this.model.loadPageDataFromQueryString(),this.model.fetchData()},onSearchButtonClick:function(a){var b=this.model.searchData.validateByMode();e.isEmpty(b)?(this.searchWidgetController.clearErrors(),this.openTabBrowsing()):this.searchWidgetController.displayErrors(b,!1)},attach:function(){return d.getWindow().on("hashchange"+o.EVENT_NAMESPACE,this.onHashChange.bind(this)),this.listenTo(this.model,m.ON_ALL_DATA_LOADED,this.onDataLoaded),this.listenTo(this.searchWidgetController,n.ON_SEARCH_BUTTON_CLICK,this.onSearchButtonClick),this},getDependencies:function(){var a=this;return new l([["model",function(){return new m({el:a.element})}],["searchWidgetController",function(){return new n(a.model)}],["omnitureController",function(){return new k(this.model)}]])},openTabBrowsing:function(){var a,b=this.model.searchData.mode,c=e.extend({},this.model.getSearchDataQS(),this.model.getOtherDataQS(),this.model.getUnknownDataQS(),this.model.tests,{af:m.AFFILIATE_ID,oppLanderId:m.OPP_LANDER_ID,source:this.model.getSourceIdByMode(b)}),d={useOptimalDimensions:!0};return a=i.shouldOpenOneClickOneWindow(b)?j.getFancyLanderOneClickOneWindowUrl(c):j.getDB5TabBrowsingUrl(c),i.openTabBrowsingWindow(a,d),this},STATIC:{EVENT_NAMESPACE:".stm.bbus.pages.searchLander.tripping.controllers.main",AUTO_INITIALIZE_SELECTOR:"[data-js-autoinit='stm.bbus.pages.searchLander.tripping.controllers.main']"}});c.ns("pages.searchLander.tripping.controllers.main",o),f(function(){var a,b=f(o.AUTO_INITIALIZE_SELECTOR).first();b.length>0&&(a=new o(b),a.start())})}(window);
//# sourceMappingURL=main.nano.js.map

// ==========================================
// Deals popunder
// ==========================================
!function(a){"use strict";var b=a.stm,c=b.shared,d=a.jQuery,e=a._,f=b.define,g=b.functional,h=(b.dates,b.dependenciesInjection),i=b.Popup,j=b.cookies,k=f({initialize:function(a,b){this.isEnabled()&&(this.element=a,this.options=e.extend({},e.result(this,"options"),b),h.injectDependencies(this),this.bindMethods().attach())},options:function(){return{cookieName:"BBDPopunder",cookieOptions:{offset:24,type:"hours"},dealsUrl:"/popunder/deals_popunder.php?action=A2",adLookupUrl:"/popunder/deals_popunder.php?action=A1",holdingWindowUrl:"/prepop.php",dealsWindowWidth:560,dealsWindowHeight:730,adWindowWidth:1e3,adWindowHeight:1040,adRedirectTriggerSelectors:{forms:["#bb_widget form","#step_1_widget form","#dhtml_edit_details form","#hotel_bbsearch_form","#air_widget_form",'form[action="/step2.php"]'],buttons:[".submitTrigger","div.submit div.submit_btn input","div.submit_btn"]}}},popupObj:null,adId:null,onClick:function(a){if(a){var b=d(a.target);if(b.hasClass("noFirstClick")||b.parents(".noFirstClick").length)return}this.popupObj.popupWindow||this.launchPopunder(),this.element.off("click."+k.EVENT_NAMESPACE,this.onClick),this.element.off("datepicker:beforeClose."+k.EVENT_NAMESPACE,this.onClick)},attach:function(){this.element.on("click."+k.EVENT_NAMESPACE,this.onClick),this.element.on("datepick:beforeClose."+k.EVENT_NAMESPACE,this.onClick);var a=this.options.adRedirectTriggerSelectors,b=d(a.forms.join(", "));if(b.length>0){var c=d(a.buttons.join(", "),b);c.length>0&&c.one("click",e.once(this.loadAd))}return this},bindMethods:function(){return g.bindMethods(this,["onClick","launchPopunder","buildUrl","loadAd","redirectToAd"]),this},getDependencies:function(){return{popupObj:function(){return new i(null,{name:"stmDealsPopunder",allowRepeat:!0,popunder:!0,width:this.options.dealsWindowWidth,height:this.options.dealsWindowHeight,holdingWindowUrl:this.options.holdingWindowUrl})}}},buildUrl:function(a,b){return-1===a.indexOf("?")?a+="?":a.indexOf("?")!==a.length-1&&(a+="&"),a+d.param(b)},launchPopunder:function(){var a=this.options.dealsUrl;return this.popupObj.url===a?this:(this.popupObj.url=a,this.popupObj.tryPop(),this.popupObj.hasPopped&&(d.publish(k.EVENT_DEALS_POPUNDER_POPPED,[this.popupObj]),j.set(this.options.cookieName,"true",this.options.cookieOptions)),this)},loadAd:function(a){var c=null,e=d(a.target).parents("form:first");if(e.length){var f=d("[data-stm-role=mode]",e);f.length&&(c=f.val())}var g=this.buildUrl(this.options.adLookupUrl,{mode:c}),h=this;d.ajax({type:"GET",async:!1,url:g,error:function(a){},success:function(a){var c=b.parseJSON(a);c&&(b.browser&&b.browser.chrome?setTimeout(function(){h.redirectToAd(c)},1):h.redirectToAd(c))}})},redirectToAd:function(a){if(!a.ad)return this;var b=a.ad.id,c=BBAd.singleton(b);if(c.setMetaDataMulti(a.ad),this.adId!=b&&this.popupObj.popupWindow){var e=[b];d.publish("/page/featuredSearch",[e]),this.popupObj.popupWindow.resizeTo(this.options.adWindowWidth,this.options.adWindowHeight),this.popupObj.popupWindow.location.href=a.url,this.adId=b}return this},isEnabled:function(){return b.pageData&&b.pageData.noDealsPopunder===!0?!1:"true"===j.get("BBDPopunder")?!1:0===d("#firstClickBBDPopunder").length?!1:this.isUnsupportedIpad()?!1:this.isUnsupportedBrowser()?!1:!0},isUnsupportedIpad:function(){return b.pageData&&b.pageData.deviceInfo&&b.pageData.deviceInfo.isTablet&&"ios"===b.pageData.deviceInfo.os&&"5.1.1"===b.pageData.deviceInfo.version?!0:!1},isUnsupportedBrowser:function(){return b.browser&&b.browser.safari&&(b.browser.Platform.win||b.browser.version>=7)?!0:!1},STATIC:{EVENT_DEALS_POPUNDER_POPPED:"stm-shared-controllers-dealsPopunder:popped"}});c.ns("controllers.dealsPopunder",k)}(window);
//# sourceMappingURL=dealsPopunder.nano.js.map


	
	
	


// ===========================================
// Legacy
// @deprecated
// ===========================================
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=b.shared.models.searchData;c(function(){if(!b.searchData){b.searchData=new d;var a=c(".mvcView.pageView.hotelListing, .hacHotelsListCell");if(1===a.length){var e={date1:null,date2:null};b.searchData.set(e)}b.searchData.fetch()}})}(window);
//# sourceMappingURL=Search.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=b.shared.collections.ad;c(function(){b.bbAdCollection=new d,b.pageData.bbAdData&&b.bbAdCollection.reset(b.pageData.bbAdData)})}(window);
//# sourceMappingURL=BBAd.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=a.jQuery,e=b.cookies,f=c.Model.extend({cookieName:"alertonclose",defaults:function(){return{enabled:!1}},isEnabled:function(){return this.get("enabled")},setEnabled:function(a){this.set("enabled",a)},writeToCookie:function(){var a={offset:0};e.setJSONEncoded(this.cookieName,this.isEnabled(),a)},updateFromCookie:function(){var a=e.getJSONDecoded(this.cookieName);null!==a&&this.setEnabled(a)},sync:function(a){switch(a){case"create":case"update":this.writeToCookie();break;case"read":this.updateFromCookie()}}},{setup:function(){b.alertOnClose=new f,b.alertOnClose.fetch()}});d(f.setup),b.ns("Models.AlertOnClose",f)}(window);
//# sourceMappingURL=AlertOnClose.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=c.Model.extend({initialize:function(){},defaults:{id:null,display_name:null,author_name:null,provider_key:null,external_url:null,tracking_id:null,_checked:!1,_opened:!1,_advertiser_opened:!1},getId:function(){return this.get("id")},getDisplayName:function(){return this.get("display_name")},getAuthorName:function(){return this.get("author_name")},getProviderKey:function(){return this.get("provider_key")},getExternalUrl:function(){return this.get("external_url")},getTrackingId:function(){return this.get("tracking_id")},isChecked:function(){return this.get("_checked")},setChecked:function(a){return this.set("_checked",a),this},isOpened:function(){return this.get("_opened")},setOpened:function(a){return this.set("_opened",a),this},isAdvertiserOpened:function(){return this.get("_advertiser_opened")},setAdvertiserOpened:function(a){this.set("_advertiser_opened",a)},sync:function(){}}),e=c.Collection.extend({model:d,initialize:function(){this.on("change:_opened",this.updateViewedState,this)},comparator:function(a,b){var c=(a.isChecked()?1:0)+(a.isAdvertiserOpened()?0:2),d=(b.isChecked()?1:0)+(b.isAdvertiserOpened()?0:2);return c===d?0:c>d?-1:1},getCheckedAds:function(){return this.sort({silent:!0}),this.filter(function(a){return a.isChecked()})},getUnopenedAds:function(){return this.sort({silent:!0}),this.filter(function(a){return!a.isOpened()})}});b.ns("Models.CheckRates.Ad",d),b.ns("Collections.CheckRates.AdCollection",e)}(window);
//# sourceMappingURL=CheckRatesAd.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=a._,e=b.Collections.CheckRates.AdCollection,f=c.Model.extend({initialize:function(){},defaults:function(){return{id:null,name:null,ta_rating:null,_selected:!1,_ad_collection:new e,_leave_behind:!1}},getId:function(){return this.get("id")},getName:function(){return this.get("name")},getTARating:function(){return this.get("ta_rating")},setSelected:function(a){return this.set("_selected",a),this},isSelected:function(){return this.get("_selected")},getAdCollection:function(){return this.get("_ad_collection")},getAd:function(a){return this.getAdCollection().get(a)},getCheckedAds:function(){return this.getAdCollection().getCheckedAds()},getUnopenedAds:function(){return this.getAdCollection().getUnopenedAds()},addAdsToCollection:function(a){return a.forEach(function(a){d.contains(this.collection.viewedAdvertisers,a.getAuthorName())&&a.setAdvertiserOpened(!0)},this),this.getAdCollection().add(a),this.collection.globalAds.add(a),this},isLeaveBehind:function(){return this.get("_leave_behind")},sync:function(){}}),g=c.Collection.extend({model:f,viewedAdvertisers:[],globalAds:null,initialize:function(){this.globalAds=new e,this.on("change:_selected",this.onHotelSelected,this),this.globalAds.on("change:_opened",this.onAdOpened,this)},onHotelSelected:function(a,b){b===!0&&this.without(a).forEach(function(a){a.setSelected(!1)})},onAdOpened:function(a){d.contains(this.viewedAdvertisers,a.getAuthorName())||this.viewedAdvertisers.push(a.getAuthorName()),this.globalAds.each(function(b){b.getAuthorName()===a.getAuthorName()&&b.setAdvertiserOpened(!0)})},getLeaveBehindHotels:function(){return this.filter(function(a){return a.isLeaveBehind()})}});b.ns("Models.CheckRates.Hotel",f),b.ns("Collections.CheckRates.HotelCollection",g),b.ns("CheckRates.hotelCollection",new g)}(window);
//# sourceMappingURL=CheckRatesHotel.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=a.jQuery,e=a._,f=c.View.extend({tagName:"li",className:"hotel check_rates_wrapper use_taid showNow hide",template:null,events:{'click [data-stm-role="submit"]':"onShowPricesClick","click .hotelName":"onHotelNameClick"},initialize:function(){this.template=e.template(d("#MVCView_CheckRatesLeaveBehind-Hotel").html()),this.searchModel=b.searchData},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},destroy:function(){this.undelegateEvents(),this.remove()},onShowPricesClick:function(a){a.preventDefault();var c=this.model.getAdCollection().getCheckedAds();b.windowManager.launchCheckRates(c,this.searchModel.getDate1(),this.searchModel.getDate2(),this.searchModel.getTravelers()),this.model.setSelected(!0)},onHotelNameClick:function(){this.$(".hotel_img").click()}});b.ns("Views.CheckRatesLeaveBehind.HotelItem",f)}(window);
//# sourceMappingURL=HotelItem.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=a.jQuery,e=a._,f=c.View.extend({tagName:"li",className:"provider",template:null,model:null,events:{click:"onProviderClick"},initialize:function(){this.template=e.template(d("#MVCView_CheckRatesLeaveBehind-Provider").html()),this.model.on("change:_opened",this.onOpened,this),this.searchModel=b.searchData},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},destroy:function(){this.undelegateEvents(),this.remove()},onProviderClick:function(a){a.preventDefault(),b.windowManager.launchCheckRates([this.model],this.searchModel.getDate1(),this.searchModel.getDate2(),this.searchModel.getTravelers())},onOpened:function(){this.model.isOpened()?this.$el.addClass("opened"):this.$el.removeClass("opened")}});b.ns("Views.CheckRatesLeaveBehind.ProviderItem",f)}(window);
//# sourceMappingURL=ProviderItem.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=a.jQuery,e=a._,f=b.autoInitialize,g=b.AutoResizeImage,h=b.Models.CheckRates.Hotel,i=b.TAHotelImages,j=b.Views.CheckRatesLeaveBehind.HotelItem,k=b.Views.CheckRatesLeaveBehind.ProviderItem,l=c.View.extend({el:'[data-stm-role="stm.Views.CheckRatesLeaveBehind"]',model:null,collection:null,providerListViews:[],hotelListViews:[],events:{'click [data-checkrates-role="close"]':"hide"},initialize:function(){this.$mask=d("<div />"),this.$mask.css({display:"none",position:"absolute",top:0,left:0,"background-color":"#333",opacity:.5,"z-index":999}),this.$mask.insertAfter(this.$el),this.$providerModule=this.$('[data-checkrates-role="provider-module"]'),this.$hotelModule=this.$('[data-checkrates-role="hotel-module"]'),this.$providerList=this.$('[data-checkrates-role="provider-list"]'),this.$hotelList=this.$('[data-checkrates-role="hotel-list"]'),this.$hotelName=this.$('[data-checkrates-role="hotel-name"]'),this.collection=b.CheckRates.hotelCollection,this.collection.on("change:_selected",this.onHotelSelected,this),b.pageData&&b.pageData.checkRatesMoreHotels&&b.pageData.checkRatesMoreHotels.forEach(function(a){this.collection.add(new h(a))},this)},setSearchData:function(a,b,c){this.searchData={date1:a,date2:b,travelers:c}},onHotelSelected:function(a){a.isSelected()&&(this.model=a,this.render())},render:function(){var b=d(a);this.$hotelName.text(this.model.getName()),this.addProviders(),this.addHotels(),this.$el.show(),this.$mask.show(),this.$mask.css({top:b.scrollTop(),width:b.width()+"px",height:b.height()+"px"}),this.$el.css({top:b.scrollTop()+40+"px",left:"40px"})},hide:function(){this.model&&this.model.setSelected(!1),this.model=null,this.$el.hide(),this.$mask.hide()},addProviders:function(){for(;this.providerListViews.length>0;)this.providerListViews.pop().destroy();var a=this.model.getUnopenedAds();a.length>0?(a.forEach(this.addProvider,this),this.$providerModule.show()):this.$providerModule.hide()},addProvider:function(a){var b=new k({model:a,searchData:this.searchData});this.providerListViews.push(b),this.$providerList.append(b.render().el)},addHotels:function(){var a=this.collection.getLeaveBehindHotels();a.forEach(this.addHotel,this);var b=e.without(a,this.model).slice(0,4);this.hotelListViews.forEach(function(a){e.contains(b,a.model)?this.$hotelList.append(a.el):a.$el.detach()},this),this.fetchCheckRatesProviders(),this.fetchImages()},addHotel:function(a){var b=!1;if(d.each(this.hotelListViews,function(){var c=this;return c.model.id===a.id?(b=!0,!1):void 0}),!b){var c=new j({model:a,searchData:this.searchData});this.hotelListViews.push(c),this.$hotelList.append(c.render().el)}},fetchImages:function(){i.insertImages(this.$(".hotelImage"),function(){f.loadClass(g,"check-rates-resize-image",!1)})},fetchCheckRatesProviders:function(){}});b.ns("Views.CheckRatesLeaveBehind.Container",l)}(window);
//# sourceMappingURL=CheckRatesLeaveBehind.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.Backbone,e=a.jQuery,f=b.functional,g=d.View.extend({defaultEmailText:"",emailEl:null,nlOptions:[],initialize:function(){this.nlOptions=this.$("input[type=checkbox]"),this.email=this.$("[data-stm-role=inlineSubscriptionEmail]"),this.emailEl=this.email.find(":text").first(),this.defaultEmailText=this.emailEl.prop("placeholder"),this.bindMethods().attach().render()},attach:function(){return this.model.on("change",this.render,this),this.nlOptions.on("change",this.render),this.emailEl.on("focus",this.onEmailFocus),this.emailEl.on("blur",this.onEmailBlur),this},bindMethods:function(){return f.bindMethods(this,["onEmailBlur","onEmailFocus","render"]),this},render:function(){return this.$el.show(),this.email.toggle(this.nlOptions.filter(":checked").length>0),this},onEmailFocus:function(a){var b=e(a.target);b.val()===this.defaultEmailText&&b.val("")},onEmailBlur:function(a){var b=e(a.target);""===b.val()&&b.val(this.defaultEmailText)}});c.ns("Views.InlineSubscription",g)}(window);
//# sourceMappingURL=inlineSubscription.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=(a.jQuery,a._),e=c.Views.InlineSubscription,f=e.extend({initialize:function(){this.departureTemplate=d.template("Alert me when fares drop from <strong> <%= location1Name %> </strong>"),this.routeTemplate=d.template("Alert me when fares drop from <strong> <%= location1Name %> </strong> to <strong> <%= location2Name %> </strong>"),this.departure=this.$("[data-stm-role=inlineSubscriptionDeparture]"),this.departureLabel=this.$("[data-stm-role=inlineSubscriptionDeparture] span"),this.departureCheckbox=this.$("[data-stm-role=inlineSubscriptionDeparture] :checkbox"),this.route=this.$("[data-stm-role=inlineSubscriptionRoute]"),this.routeLabel=this.$("[data-stm-role=inlineSubscriptionRoute] span"),this.routeCheckbox=this.$("[data-stm-role=inlineSubscriptionRoute] :checkbox"),e.prototype.initialize.apply(this,[this.options])},getAirportCode:function(a){var b=a?a.match(/\(([\w]{3})\)/):[];return b?b[1]:""},render:function(){var a,b=this.model.getLocation1AsAirport(),c=this.model.getLocation2AsAirport();b?(a=this.departureTemplate({location1Name:b.name}),this.departureLabel.html(a),this.departure.show()):(this.departureCheckbox.prop("checked",!1),this.departure.hide()),b&&c?(a=this.routeTemplate({location1Name:b.name,location2Name:c.name}),this.routeLabel.html(a),this.route.show()):(this.routeCheckbox.prop("checked",!1),this.route.hide()),e.prototype.render.apply(this)}});c.ns("Views.InlineSubscription.Air",f)}(window);
//# sourceMappingURL=Air.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a._,e=c.Views.InlineSubscription,f=e.extend({initialize:function(){this.hotelTemplate=d.template("Send me top <%= location2Name %> hotel deals"),this.hotel=this.$("[data-stm-role=inlineSubscriptionHotel]"),this.hotelLabel=this.$("[data-stm-role=inlineSubscriptionHotel] span"),this.hotelCheckbox=this.$("[data-stm-role=inlineSubscriptionHotel] :checkbox"),this.privacyPolicy=this.$(".nl_sub_inline_hotel_watch_pp"),e.prototype.initialize.apply(this,[this.options])},render:function(){var a=this.model.getLocation2AsGeo();this.privacyPolicy.toggle(this.nlOptions.filter(":checked").length>0),a?(this.hotelLabel.html("Send me hotel deal alerts from Hotelwatchdog"),this.hotel.show()):(this.hotelCheckbox.prop("checked",!1),this.hotel.hide()),e.prototype.render.apply(this)}});c.ns("Views.InlineSubscription.Hotel",f)}(window);
//# sourceMappingURL=Hotel.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a._,e=c.Views.InlineSubscription,f=e.prototype,g=e.extend({initialize:function(a){this.options=d.extend({},d.result(this,"options"),a),this.containerEl=this.$(this.options.containerElSelector),this.subscriptionEl=this.$(this.options.subscriptionElSelector),this.subscriptionLabelEl=this.$(this.options.subscriptionLabelElSelector),this.subscriptionTemplate=d.template(this.options.subscriptionTemplate),f.initialize.apply(this,[this.options])},options:function(){return{containerElSelector:"[data-stm-role=inlineSubscriptionTopDeals]",subscriptionLabelElSelector:"[data-stm-role=inlineSubscriptionTopDeals] span",subscriptionElSelector:"[data-stm-role=inlineSubscriptionTopDeals] :checkbox",subscriptionTemplate:"Send me top travel deals"}},containerEl:null,subscriptionLabelEl:null,subscriptionEl:null,subscriptionTemplate:null,render:function(){var a=this.model.getLocation2(),b=this.subscriptionTemplate({});return a?(this.subscriptionLabelEl.text(b),this.containerEl.show()):(this.subscriptionEl.prop("checked",!1),this.containerEl.hide()),f.render.apply(this),this}});c.ns("Views.InlineSubscription.Car",g)}(window);
//# sourceMappingURL=Car.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a._,e=c.Views.InlineSubscription,f=e.prototype,g=e.extend({initialize:function(a){this.options=d.extend({},d.result(this,"options"),a),this.containerEl=this.$(this.options.containerElSelector),this.subscriptionEl=this.$(this.options.subscriptionElSelector),this.subscriptionLabelEl=this.$(this.options.subscriptionLabelElSelector),this.subscriptionTemplate=d.template(this.options.subscriptionTemplate),f.initialize.apply(this,[this.options])},options:function(){return{containerElSelector:"[data-stm-role=inlineSubscriptionDeparture]",subscriptionElSelector:"[data-stm-role=inlineSubscriptionDeparture] :checkbox",subscriptionLabelElSelector:"[data-stm-role=inlineSubscriptionDeparture] span",subscriptionTemplate:"Send me top travel deals departing from <%= location %>"}},subscriptionTemplate:null,containerEl:null,subscriptionEl:null,subscriptionLabelEl:null,render:function(){var a,b=this.model.getLocation1AsAirport();return b?(a=this.subscriptionTemplate({location:b.name}),this.subscriptionLabelEl.html(a),this.containerEl.show()):(this.subscriptionEl.prop("checked",!1),this.containerEl.hide()),f.render.apply(this),this}});c.ns("Views.InlineSubscription.Vacation",g)}(window);
//# sourceMappingURL=Vacation.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.Backbone,e=a.jQuery,f=b.dates,g=d.View.extend({options:function(){return{model:b.searchData}},events:{"click [data-stm-role=closeLayer]":"closeLayer"},initialize:function(){this.pageMask=e("#page_mask"),this.hpLink=e("#hotelplanner_go"),this.popup=e("#hotelplanner_popup"),this.model.on("change:rooms",this.render,this),this.model.on("change:location2",this.render,this)},closeLayer:function(){this.popup.hide(),this.pageMask.hide(),this.model.setRooms(1),this.model.save()},modifyLink:function(){var a=b.pageData.adHandlerUrl?b.pageData.adHandlerUrl:"http://r.bookingbuddy.com/go?",c={location2:"g"+this.model.getLocation2CityId(),date1:f.formatDate("yy-mm-dd",this.model.getDate1()),date2:f.formatDate("yy-mm-dd",this.model.getDate2()),num_travelers:this.model.getTravelers(),num_rooms:this.model.getRooms(),provider:this.model.getProvider()},d=e.extend({},this.hpLink.data("trackingInfo"),c),g=a+"&"+e.param(d);this.hpLink.unbind(),this.generateJsLink(g)},generateJsLink:function(b){this.hpLink.one("click",function(){a.open(b)})},render:function(){var c=null===(this.model.validateByMode("hotel")||null);if("vacation_rental"!==b.pageData.mode&&3==this.model.getRooms()&&c){var d=this.popup.position(),f=(e(a).height()-this.popup.outerHeight())/2,g=(e(a).width()-this.popup.outerWidth())/2;d.top=Math.max(f-100,0),d.left=Math.max(g,0),this.popup.css({top:d.top+"px",left:d.left+"px"}),this.modifyLink(),this.pageMask.css({height:e(a.document).height()+"px",width:e(a.document).width()+"px"}).show(),this.popup.show()}}},{setup:function(){e('[data-stm-role="stm.bb.Views.Hotelplanner"]').each(function(){new g({el:e(this)})})}});e(g.setup),c.ns("Views.Hotelplanner",g)}(window);
//# sourceMappingURL=Hotelplanner.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.Backbone,e=a._,f=b.shared.featuredSearchUtils,g=b.shared.linkUtils,h=d.View.extend({initialize:function(){this.inlineSubsEl=this.$("[data-stm-role=inlineSubscription]").first()},inlineSubsEl:null,inlineSubsView:null,submitHandler:function(){var c,d,h;if(c=this.$el.serializeArray(),d={},e.each(c,function(a){d[a.name]=a.value}),b.pageData&&!b.pageData.userShouldRedirectToNewPlatform&&f.shouldOpenOneClickOneWindow(b.pageData.mode))h=g.getFancyLanderOneClickOneWindowUrl(d);else{var i={};h=g.getDB5TabBrowsingUrl(d,i)}f.openTabBrowsingWindow(h),a.opener&&"stmTabBrowsingWindow"===a.name||(b.pageData=b.pageData||{},b.pageData.ignoreAlertOnClose=!0,this.$el.submit())}});c.ns("Views.searchForm.OpenTabBrowsingAndSubmit",h)}(window);
//# sourceMappingURL=OpenTabBrowsingAndSubmit.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.bb,e=a.jQuery,f=d.Views.InlineSubscription.Air,g=d.Views.searchForm.OpenTabBrowsingAndSubmit;e(function(){b=a.LocationSuggest});var h=g.extend({LOCATION_INPUT_DEFAULT_TEXT_FROM:"Flying from",LOCATION_INPUT_DEFAULT_TEXT_TO:"Flying to",events:{"change [data-stm-role=time1]":"changeTime1","change [data-stm-role=time2]":"changeTime2","change [data-stm-role=serviceClass]":"changeServiceClass","change [data-stm-role=travelers]":"changeTravelers","change [data-stm-role=nonstop]":"changeNonStop","change [data-stm-role=searchType]":"changeSearchType","focus [data-stm-role=location1]":"focusLocation1","focus [data-stm-role=location2]":"focusLocation2","LocationSuggest:valid [data-stm-role=location1]":"changeLocation1","LocationSuggest:invalid [data-stm-role=location1]":"changeLocation1","LocationSuggest:valid [data-stm-role=location2]":"changeLocation2","LocationSuggest:invalid [data-stm-role=location2]":"changeLocation2","click [data-stm-role=submit]":"submit"},initialize:function(){g.prototype.initialize.apply(this,[this.options]),this.model.bind("change",this.render,this),this.date1=new c.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new c.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.date2Block=this.$("[data-stm-role=date2Block]"),this.time1=this.$("[data-stm-role=time1]"),this.time2=this.$("[data-stm-role=time2]"),this.serviceClass=this.$("[data-stm-role=serviceClass]"),this.searchTypes=this.$("[data-stm-role=searchType]"),this.location1=this.$("[data-stm-role=location1]"),this.location1Id=this.$("[data-stm-role=location1Id]"),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.nonstop=this.$("[data-stm-role=nonstop]"),this.travelers=this.$("[data-stm-role=travelers]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.inlineSubsEl&&(this.inlineSubsView=new f({el:this.inlineSubsEl,model:this.model})),this.ls1=new b(this.location1,["airport"],null,{},this.location1Id),this.ls2=new b(this.location2,["airport"],null,{},this.location2Id),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(){this.resetError();var a=this.model.validateByMode("air");a?this.renderError(this.model,a):this.submitHandler()},changeTime1:function(){this.model.setTime1(this.time1.val()),this.model.save()},changeTime2:function(){this.model.setTime2(this.time2.val()),this.model.save()},changeServiceClass:function(){this.model.setServiceClass(this.serviceClass.val()),this.model.save()},changeTravelers:function(){this.model.setTravelers(this.travelers.val()),this.model.save()},changeNonStop:function(){this.model.setNonstop(this.nonstop.is(":checked")),this.model.save()},changeLocation1:function(){this.model.setLocation1(this.location1.data("locationData")),this.model.save()},changeLocation2:function(){this.model.setLocation2(this.location2.data("locationData")),this.model.save()},changeSearchType:function(){this.model.setSearchType(this.$("[data-stm-role=searchType]:checked").val()),this.model.save()},focusLocation1:function(){this.location1.val()==this.LOCATION_INPUT_DEFAULT_TEXT_FROM&&this.location1.val("")},focusLocation2:function(){this.location2.val()==this.LOCATION_INPUT_DEFAULT_TEXT_TO&&this.location2.val("")},render:function(){this.time1.val(this.model.getTime1()),this.time2.val(this.model.getTime2()),this.serviceClass.val(this.model.getServiceClass());var a=this.model.getSearchType();this.searchTypes.each(function(b,c){var d=e(c);d.prop("checked",d.val()===a)});var b="roundtrip"===a;this.date2Block.toggle(b),this.date1.setTripHighlight(b),this.nonstop.prop("checked",this.model.isNonstop()),this.travelers.val(this.model.getTravelers());var d=this.model.getLocation1AsAirport();d?(this.location1.val(d.name),this.location1Id.val(d.said)):(c.pageData&&c.pageData.core29124&&-1!==e.inArray(c.pageData.core29124.userPool,["B","C","D"])?this.location1.val(this.LOCATION_INPUT_DEFAULT_TEXT_FROM):this.location1.val(""),this.location1Id.val(""));var f=this.model.getLocation2AsAirport();return f?(this.location2.val(f.name),this.location2Id.val(f.said)):(c.pageData&&c.pageData.core29124&&"A"!==c.pageData.core29124.userPool?this.location2.val(this.LOCATION_INPUT_DEFAULT_TEXT_TO):this.location2.val(""),this.location2Id.val("")),this}},{setup:function(){e('[data-stm-role="stm.bb.Views.searchForm.OpenTabBrowsingAndSubmit.Air"]').each(function(){new h({el:e(this),model:c.searchData})})}});e(h.setup),d.ns("Views.searchForm.OpenTabBrowsingAndSubmit.Air",h)}(window);
//# sourceMappingURL=Air.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.bb,e=a.jQuery,f=d.Views.InlineSubscription.Hotel,g=d.Views.searchForm.OpenTabBrowsingAndSubmit;e(function(){b=a.LocationSuggest});var h=g.extend({LOCATION_INPUT_DEFAULT_TEXT:"Going to",events:{"change [data-stm-role=travelers]":"changeTravelers","change [data-stm-role=rooms]":"changeRooms","change [data-stm-role=provider]":"changeProvider","focus [data-stm-role=location2]":"focusLocation2","LocationSuggest:valid [data-stm-role=location2]":"changeLocation2","LocationSuggest:invalid [data-stm-role=location2]":"changeLocation2","click [data-stm-role=submit]":"submit"},initialize:function(){g.prototype.initialize.apply(this,[this.options]),this.model.bind("change",this.render,this),this.date1=new c.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new c.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.rooms=this.$("[data-stm-role=rooms]"),this.travelers=this.$("[data-stm-role=travelers]"),this.provider=this.$("[data-stm-role=provider]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.inlineSubsEl&&(this.inlineSubsView=new f({el:this.inlineSubsEl,model:this.model})),this.ls2=new b(this.location2,["city"],null,{},this.location2Id),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(){this.resetError();var a=this.model.validateByMode("hotel");a?this.renderError(this.model,a):this.submitHandler()},changeTravelers:function(){this.model.setTravelers(this.travelers.val()),this.model.save()},changeRooms:function(){this.model.setRooms(this.rooms.val()),this.model.save()},changeLocation2:function(){this.model.setLocation2(this.location2.data("location-data")),this.model.save()},changeProvider:function(){this.model.setProvider(this.provider.val()),this.model.save()},focusLocation2:function(){this.location2.val()==this.LOCATION_INPUT_DEFAULT_TEXT&&this.location2.val("")},render:function(){this.travelers.val(this.model.getTravelers()),this.rooms.val(this.model.getRooms()),this.provider.val(this.model.getProvider());var a=this.model.getLocation2AsGeo();return a?(this.location2.val(a.name),this.location2Id.val(a.sid)):(c.pageData&&c.pageData.core29124&&"A"!==c.pageData.core29124.userPool?this.location2.val(this.LOCATION_INPUT_DEFAULT_TEXT):this.location2.val(""),this.location2Id.val("")),this}},{setup:function(){e('[data-stm-role="stm.bb.Views.searchForm.OpenTabBrowsingAndSubmit.Hotel"]').each(function(){new h({el:e(this),model:c.searchData})})}});e(h.setup),d.ns("Views.searchForm.OpenTabBrowsingAndSubmit.Hotel",h)}(window);
//# sourceMappingURL=Hotel.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.bb,e=a.jQuery,f=d.Views.searchForm.OpenTabBrowsingAndSubmit,g=d.Views.InlineSubscription.Car;e(function(){b=a.LocationSuggest});var h=f.extend({LOCATION_INPUT_DEFAULT_TEXT:"Picking up",events:{"change [data-stm-role=time1]":"changeTime1","change [data-stm-role=time2]":"changeTime2","focus [data-stm-role=location2]":"focusLocation2","LocationSuggest:valid [data-stm-role=location2]":"changeLocation2","LocationSuggest:invalid [data-stm-role=location2]":"changeLocation2","click [data-stm-role=submit]":"submit"},initialize:function(){f.prototype.initialize.apply(this,[this.options]),this.model.bind("change",this.render,this),this.date1=new c.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new c.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.time1=this.$("[data-stm-role=time1]"),this.time2=this.$("[data-stm-role=time2]"),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.inlineSubsEl&&(this.inlineSubsView=new g({el:this.inlineSubsEl,model:this.model})),this.ls2=new b(this.location2,["city","airport"],null,{},this.location2Id),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(){this.resetError();var a=this.model.validateByMode("car");a?this.renderError(this.model,a):this.submitHandler()},changeTime1:function(){this.model.setTime1(this.time1.val()),this.model.save()},changeTime2:function(){this.model.setTime2(this.time2.val()),this.model.save()},changeLocation2:function(){this.model.setLocation2(this.location2.data("location-data")),this.model.save()},focusLocation2:function(){this.location2.val()==this.LOCATION_INPUT_DEFAULT_TEXT&&this.location2.val("")},render:function(){this.time1.val(this.model.getTime1()),this.time2.val(this.model.getTime2());var a=this.model.getLocation2();return a?(this.location2.val(a.name),this.location2Id.val(a.sid)):(c.pageData&&c.pageData.core29124&&"A"!==c.pageData.core29124.userPool?this.location2.val(this.LOCATION_INPUT_DEFAULT_TEXT):this.location2.val(""),this.location2Id.val("")),this}},{setup:function(){e('[data-stm-role="stm.bb.Views.searchForm.OpenTabBrowsingAndSubmit.Car"]').each(function(){new h({el:e(this),model:c.searchData})})}});e(h.setup),d.ns("Views.searchForm.OpenTabBrowsingAndSubmit.Car",h)}(window);
//# sourceMappingURL=Car.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.jQuery,e=c.Views.searchForm.OpenTabBrowsingAndSubmit,f=e.extend({events:{"change [data-stm-role=cruiseLocation]":"changeCruiseLocation","change [data-stm-role=cruiseLine]":"changeCruiseLine","change [data-stm-role=cruiseDate]":"changeCruiseDate","change [data-stm-role=cruiseLength]":"changeCruiseLength","change [data-stm-role=over55]":"changeOver55","click [data-stm-role=submit]":"submit"},initialize:function(){e.prototype.initialize.apply(this,[this.options]),this.model.bind("change",this.render,this),this.cruiseLocation=this.$("[data-stm-role=cruiseLocation]"),this.cruiseLine=this.$("[data-stm-role=cruiseLine]"),this.cruiseDate=this.$("[data-stm-role=cruiseDate]"),this.cruiseLength=this.$("[data-stm-role=cruiseLength]"),this.over55=this.$("[data-stm-role=over55]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(){this.resetError();var a=this.model.validateByMode("cruise");a?this.renderError(this.model,a):this.submitHandler()},changeCruiseLocation:function(){this.model.setCruiseDestination({id:this.cruiseLocation.val(),name:this.cruiseLocation[0].selectedOptions[0].label}),this.model.save()},changeCruiseLine:function(){this.model.setCruiseLine(this.cruiseLine.val()),this.model.save()},changeCruiseDate:function(){this.model.setCruiseDate(this.cruiseDate.val()),this.model.save()},changeCruiseLength:function(){this.model.setCruiseLength(this.cruiseLength.val()),this.model.save()},changeOver55:function(){this.model.setOver55(this.over55.is(":checked")),this.model.save()},render:function(){return this.cruiseLocation.val(this.model.getCruiseDestinationId()),this.cruiseLine.val(this.model.getCruiseLine()),this.model.getCruiseDate()&&this.cruiseDate.val(this.model.getCruiseDate()),this.cruiseLength.val(this.model.getCruiseLength()),this.over55.prop("checked",this.model.isOver55()),this}},{setup:function(){d('[data-stm-role="stm.bb.Views.searchForm.OpenTabBrowsingAndSubmit.Cruise"]').each(function(){new f({el:d(this),model:b.searchData})})}});d(f.setup),c.ns("Views.searchForm.OpenTabBrowsingAndSubmit.Cruise",f)}(window);
//# sourceMappingURL=Cruise.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.bb,e=a.jQuery,f=d.Views.searchForm.OpenTabBrowsingAndSubmit,g=d.Views.InlineSubscription.Vacation;e(function(){b=a.LocationSuggest});var h=f.extend({LOCATION_INPUT_DEFAULT_TEXT_FROM:"Flying from",LOCATION_INPUT_DEFAULT_TEXT_TO:"Flying to",events:{"change [data-stm-role=travelers]":"changeTravelers","focus [data-stm-role=location1]":"focusLocation1","focus [data-stm-role=location2]":"focusLocation2","LocationSuggest:valid [data-stm-role=location1]":"changeLocation1","LocationSuggest:invalid [data-stm-role=location1]":"changeLocation1","LocationSuggest:valid [data-stm-role=location2]":"changeLocation2","LocationSuggest:invalid [data-stm-role=location2]":"changeLocation2","click [data-stm-role=submit]":"submit"},initialize:function(){f.prototype.initialize.apply(this,[this.options]),this.model.bind("change",this.render,this),this.date1=new c.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new c.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.location1=this.$("[data-stm-role=location1]"),this.location1Id=this.$("[data-stm-role=location1Id]"),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.travelers=this.$("[data-stm-role=travelers]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.inlineSubsEl&&(this.inlineSubsView=new g({el:this.inlineSubsEl,model:this.model})),this.ls1=new b(this.location1,["airport"],null,{},this.location1Id),this.ls2=new b(this.location2,["airport"],null,{},this.location2Id),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(){this.resetError();var a=this.model.validateByMode("vacation");a?this.renderError(this.model,a):this.submitHandler()},changeTravelers:function(){this.model.setTravelers(this.travelers.val()),this.model.save()},changeLocation1:function(){this.model.setLocation1(this.location1.data("location-data")),this.model.save()},changeLocation2:function(){this.model.setLocation2(this.location2.data("location-data")),this.model.save()},focusLocation1:function(){this.location1.val()==this.LOCATION_INPUT_DEFAULT_TEXT_FROM&&this.location1.val("")},focusLocation2:function(){this.location2.val()==this.LOCATION_INPUT_DEFAULT_TEXT_TO&&this.location2.val("")},render:function(){this.travelers.val(this.model.getTravelers());var a=this.model.getLocation1AsAirport();a?(this.location1.val(a.name),this.location1Id.val(a.said)):(c.pageData&&c.pageData.core29124&&"A"!==c.pageData.core29124.userPool?this.location1.val(this.LOCATION_INPUT_DEFAULT_TEXT_FROM):this.location1.val(""),this.location1Id.val(""));var b=this.model.getLocation2AsAirport();return b?(this.location2.val(b.name),this.location2Id.val(b.said)):(c.pageData&&c.pageData.core29124&&"A"!==c.pageData.core29124.userPool?this.location2.val(this.LOCATION_INPUT_DEFAULT_TEXT_TO):this.location2.val(""),this.location2Id.val("")),this}},{setup:function(){e('[data-stm-role="stm.bb.Views.searchForm.OpenTabBrowsingAndSubmit.Vacation"]').each(function(){new h({el:e(this),model:c.searchData})})}});e(h.setup),d.ns("Views.searchForm.OpenTabBrowsingAndSubmit.Vacation",h)}(window);
//# sourceMappingURL=Vacation.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.bb,e=a.jQuery,f=d.Views.searchForm.OpenTabBrowsingAndSubmit;e(function(){b=a.LocationSuggest});var g=f.extend({events:{"change [data-stm-role=rooms]":"changeRooms","LocationSuggest:valid [data-stm-role=location2]":"changeLocation2","LocationSuggest:invalid [data-stm-role=location2]":"changeLocation2","click [data-stm-role=submit]":"submit"},initialize:function(){f.prototype.initialize.apply(this,[this.options]),this.model.bind("change",this.render,this),this.date1=new c.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new c.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.location2=this.$("[data-stm-role=location2]"),this.rooms=this.$("[data-stm-role=rooms]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.ls2=new b(this.location2,["city","state","region"],null,{},this.location2Id),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(){this.resetError();var a=this.model.validateByMode("vacation_rental");a?this.renderError(this.model,a):this.submitHandler()},changeLocation2:function(){this.model.setLocation2(this.location2.data("location-data")),this.model.save()},changeRooms:function(){this.model.setRooms(this.rooms.val()),this.model.save()},render:function(){var a=this.model.getLocation2AsGeo();return a?(this.location2.val(a.name),this.location2Id.val(a.sid)):(this.location2.val(""),this.location2Id.val("")),this.rooms.val(this.model.getRooms()),this}},{setup:function(){e('[data-stm-role="stm.bb.Views.searchForm.OpenTabBrowsingAndSubmit.VacationRental"]').each(function(){new g({el:e(this),model:c.searchData})})}});e(g.setup),d.ns("Views.searchForm.OpenTabBrowsingAndSubmit.VacationRental",g)}(window);
//# sourceMappingURL=VacationRental.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.Backbone,e=b.shared.featuredSearchUtils,f=b.shared.linkUtils,g=d.View.extend({submitHandler:function(){var c={tid:this.tid},d=f.getHotelListingUrl(c);d.length>0&&(e.openTabBrowsingWindow(d,{name:"stmMetaWindow",scrollbars:1}),a.opener&&"stmHotelListingWindow"===a.name||(b.pageData=b.pageData||{},b.pageData.ignoreAlertOnClose=!0,this.$el.submit()))}});c.ns("Views.searchForm.OpenHotelListing",g)}(window);
//# sourceMappingURL=OpenHotelListing.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.bb,e=a.jQuery,f=d.Views.InlineSubscription.Hotel,g=d.Views.searchForm.OpenHotelListing;e(function(){b=a.LocationSuggest});var h=g.extend({events:{"change [data-stm-role=travelers]":"changeTravelers","change [data-stm-role=rooms]":"changeRooms","change [data-stm-role=provider]":"changeProvider","LocationSuggest:valid [data-stm-role=location2]":"changeLocation2","LocationSuggest:invalid [data-stm-role=location2]":"changeLocation2","click [data-stm-role=submit]":"submit"},tid:0,initialize:function(){g.prototype.initialize.apply(this,[this.options]),this.model.bind("change",this.render,this),this.date1=new c.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new c.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.rooms=this.$("[data-stm-role=rooms]"),this.travelers=this.$("[data-stm-role=travelers]"),this.provider=this.$("[data-stm-role=provider]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.inlineSubs=new f({el:this.$("[data-stm-role=inlineSubscription]"),model:this.model}),this.ls2=new b(this.location2,["city"],null,{},this.location2Id),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(){this.resetError();var a=this.model.validateByMode("hotel");a?this.renderError(this.model,a):this.submitHandler()},changeTravelers:function(){this.model.setTravelers(this.travelers.val()),this.model.save()},changeRooms:function(){this.model.setRooms(this.rooms.val()),this.model.save()},changeLocation2:function(){this.model.setLocation2(this.location2.data("location-data")),this.model.save()},changeProvider:function(){this.model.setProvider(this.provider.val()),this.model.save()},render:function(){this.travelers.val(this.model.getTravelers()),this.rooms.val(this.model.getRooms()),this.provider.val(this.model.getProvider());var a=this.model.getLocation2AsGeo();return a?(this.location2.val(a.name),this.location2Id.val(a.sid),this.tid=a.cid):(this.location2.val(""),this.location2Id.val("")),this}},{setup:function(){e('[data-stm-role="stm.bb.Views.searchForm.OpenHotelListing.Hotel"]').each(function(){new h({el:e(this),model:c.searchData})})}});e(h.setup),d.ns("Views.searchForm.OpenHotelListing.Hotel",h)}(window);
//# sourceMappingURL=Hotel.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.Backbone,d=c.View.extend({options:function(){return{model:b.searchData}},initialize:function(){this.mode=this.$("[data-stm-role=mode]").val(),this.stmOptions=this.$el.data("stmOptions"),this.errorMessages=this.$("[data-stm-role=errors]"),this.stmOptions&&this.stmOptions.validateOnInitialize&&this.validate()},validate:function(){this.resetError();var a=this.model.validateByMode(this.mode);return a?(this.renderError(this.model,a),!1):!0},submit:function(){this.validate()&&this.$el.submit()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)}});b.ns("Views.searchForm.BasicSubmit",d)}(window);
//# sourceMappingURL=BasicSubmit.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=a.jQuery,e=c.Views.searchForm.BasicSubmit;d(function(){b=a.LocationSuggest});var f=e.extend({events:{"change [data-stm-role=time1]":"changeTime1","change [data-stm-role=time2]":"changeTime2","change [data-stm-role=serviceClass]":"changeServiceClass","change [data-stm-role=travelers]":"changeTravelers","change [data-stm-role=nonstop]":"changeNonStop","change [data-stm-role=searchType]":"changeSearchType","LocationSuggest:valid [data-stm-role=location1]":"changeLocation1","LocationSuggest:invalid [data-stm-role=location1]":"changeLocation1","LocationSuggest:valid [data-stm-role=location2]":"changeLocation2","LocationSuggest:invalid [data-stm-role=location2]":"changeLocation2","click [data-stm-role=submit]":"submit"},initialize:function(){e.prototype.initialize.apply(this,[this.options]),this.model.bind("change",this.render,this),this.date1=new c.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new c.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.date2Block=this.$("[data-stm-role=date2Block]"),this.time1=this.$("[data-stm-role=time1]"),this.time2=this.$("[data-stm-role=time2]"),this.serviceClass=this.$("[data-stm-role=serviceClass]"),this.searchTypes=this.$("[data-stm-role=searchType]"),this.location1=this.$("[data-stm-role=location1]"),this.location1Id=this.$("[data-stm-role=location1Id]"),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.nonstop=this.$("[data-stm-role=nonstop]"),this.travelers=this.$("[data-stm-role=travelers]"),this.ls1=new b(this.location1,["airport"],null,{},this.location1Id),this.ls2=new b(this.location2,["airport"],null,{},this.location2Id),this.firstRun=!0,this.render()},changeTime1:function(){this.model.setTime1(this.time1.val()),this.model.save()},changeTime2:function(){this.model.setTime2(this.time2.val()),this.model.save()},changeServiceClass:function(){this.model.setServiceClass(this.serviceClass.val()),this.model.save()},changeTravelers:function(){this.model.setTravelers(this.travelers.val()),this.model.save()},changeNonStop:function(){this.model.setNonstop(this.nonstop.is(":checked")),this.model.save()},changeLocation1:function(){this.model.setLocation1(this.location1.data("location-data")),this.model.save()},changeLocation2:function(){this.model.setLocation2(this.location2.data("location-data")),this.model.save()},changeSearchType:function(){this.model.setSearchType(this.$("[data-stm-role=searchType]:checked").val()),this.model.save()},render:function(){this.time1.val(this.model.getTime1()),this.time2.val(this.model.getTime2()),this.serviceClass.val(this.model.getServiceClass());var a=this.model.getSearchType();this.searchTypes.each(function(){var b=d(this);b.prop("checked",b.val()==a)});var b="roundtrip"===a;this.date2Block.toggle(b),this.date1.setTripHighlight(b),this.nonstop.prop("checked",this.model.isNonstop()),this.travelers.val(this.model.getTravelers());var c=this.model.getLocation1AsAirport();c?(this.location1.val(c.name),this.location1Id.val(c.said)):(this.location1.val(""),this.location1Id.val(""));var e=this.model.getLocation2AsAirport();return e?(this.location2.val(e.name),this.location2Id.val(e.said)):(this.location2.val(""),this.location2Id.val("")),this.firstRun?this.firstRun=!1:this.validate(),this}},{init:function(){d('[data-stm-role="stm.Views.searchForm.BasicSubmit.Air"]').each(function(){new f({el:d(this)})})}});d(f.init),c.ns("Views.searchForm.BasicSubmit.Air",f)}(window);
//# sourceMappingURL=Air.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=a.jQuery,e=c.Views.searchForm.BasicSubmit;d(function(){b=a.LocationSuggest});var f=e.extend({events:{"change [data-stm-role=travelers]":"changeTravelers","change [data-stm-role=rooms]":"changeRooms","change [data-stm-role=provider]":"changeProvider","LocationSuggest:valid [data-stm-role=location2]":"changeLocation2","LocationSuggest:invalid [data-stm-role=location2]":"changeLocation2","click [data-stm-role=submit]":"submit"},initialize:function(){e.prototype.initialize.apply(this,[this.options]),this.model.bind("change",this.render,this),this.date1=new c.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new c.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.rooms=this.$("[data-stm-role=rooms]"),this.travelers=this.$("[data-stm-role=travelers]"),this.provider=this.$("[data-stm-role=provider]"),this.ls2=new b(this.location2,["city"],null,{},this.location2Id),this.firstRun=!0,this.render()},changeTravelers:function(){this.model.setTravelers(this.travelers.val()),this.model.save()},changeRooms:function(){this.model.setRooms(this.rooms.val()),this.model.save()},changeLocation2:function(){this.model.setLocation2(this.location2.data("location-data")),this.model.save()},changeProvider:function(){this.model.setProvider(this.provider.val()),this.model.save()},render:function(){this.travelers.val(this.model.getTravelers()),this.rooms.val(this.model.getRooms()),this.provider.val(this.model.getProvider());var a=this.model.getLocation2AsGeo();return a?(this.location2.val(a.name),this.location2Id.val(a.sid)):(this.location2.val(""),this.location2Id.val("")),this.firstRun?this.firstRun=!1:this.validate(),this}},{setup:function(){d('[data-stm-role="stm.Views.searchForm.BasicSubmit.Hotel"]').each(function(){new f({el:d(this)})})}});d(f.setup),c.ns("Views.searchForm.BasicSubmit.Hotel",f)}(window);
//# sourceMappingURL=Hotel.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=a.jQuery,e=c.Views.searchForm.BasicSubmit;d(function(){b=a.LocationSuggest});var f=e.extend({events:{"change [data-stm-role=time1]":"changeTime1","change [data-stm-role=time2]":"changeTime2","LocationSuggest:valid [data-stm-role=location2]":"changeLocation2","LocationSuggest:invalid [data-stm-role=location2]":"changeLocation2","click [data-stm-role=submit]":"submit"},initialize:function(){e.prototype.initialize.apply(this,[this.options]),this.model.bind("change",this.render,this),this.date1=new c.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new c.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.time1=this.$("[data-stm-role=time1]"),this.time2=this.$("[data-stm-role=time2]"),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.ls2=new b(this.location2,["city","airport"],null,{},this.location2Id),this.firstRun=!0,this.render()},changeTime1:function(){this.model.setTime1(this.time1.val()),this.model.save()},changeTime2:function(){this.model.setTime2(this.time2.val()),this.model.save()},changeLocation2:function(){this.model.setLocation2(this.location2.data("location-data")),this.model.save()},render:function(){this.time1.val(this.model.getTime1()),this.time2.val(this.model.getTime2());var a=this.model.getLocation2();return a?(this.location2.val(a.name),this.location2Id.val(a.sid)):(this.location2.val(""),this.location2Id.val("")),this.firstRun?this.firstRun=!1:this.validate(),this}},{setup:function(){d('[data-stm-role="stm.Views.searchForm.BasicSubmit.Car"]').each(function(){new f({el:d(this)})})}});d(f.setup),c.ns("Views.searchForm.BasicSubmit.Car",f)}(window);
//# sourceMappingURL=Car.nano.js.map
!function(a){"use strict";var b=a.stm,c=a.jQuery,d=b.Views.searchForm.BasicSubmit,e=d.extend({events:{"change [data-stm-role=cruiseLocation]":"changeCruiseLocation","change [data-stm-role=cruiseLine]":"changeCruiseLine","change [data-stm-role=cruiseDate]":"changeCruiseDate","change [data-stm-role=cruiseLength]":"changeCruiseLength","change [data-stm-role=over55]":"changeOver55","click [data-stm-role=submit]":"submit"},initialize:function(){d.prototype.initialize.apply(this,[this.options]),this.model.bind("change",this.render,this),this.cruiseLocation=this.$("[data-stm-role=cruiseLocation]"),this.cruiseLine=this.$("[data-stm-role=cruiseLine]"),this.cruiseDate=this.$("[data-stm-role=cruiseDate]"),this.cruiseLength=this.$("[data-stm-role=cruiseLength]"),this.over55=this.$("[data-stm-role=over55]"),this.render()},changeCruiseLocation:function(){this.model.setCruiseDestination({id:this.cruiseLocation.val(),name:this.cruiseLocation[0].selectedOptions[0].label}),this.model.save()},changeCruiseLine:function(){this.model.setCruiseLine(this.cruiseLine.val()),this.model.save()},changeCruiseDate:function(){this.model.setCruiseDate(this.cruiseDate.val()),this.model.save()},changeCruiseLength:function(){this.model.setCruiseLength(this.cruiseLength.val()),this.model.save()},changeOver55:function(){this.model.setOver55(this.over55.is(":checked")),this.model.save()},render:function(){return this.cruiseLocation.val(this.model.getCruiseDestinationId()),this.cruiseLine.val(this.model.getCruiseLine()),this.model.getCruiseDate()&&this.cruiseDate.val(this.model.getCruiseDate()),this.cruiseLength.val(this.model.getCruiseLength()),this.over55.prop("checked",this.model.isOver55()),this}},{setup:function(){c('[data-stm-role="stm.Views.searchForm.BasicSubmit.Cruise"]').each(function(){new e({el:c(this)})})}});c(e.setup),b.ns("Views.searchForm.BasicSubmit.Cruise",e)}(window);
//# sourceMappingURL=Cruise.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=a.jQuery,e=c.Views.searchForm.BasicSubmit;d(function(){b=a.LocationSuggest});var f=e.extend({events:{"change [data-stm-role=travelers]":"changeTravelers","LocationSuggest:valid [data-stm-role=location1]":"changeLocation1","LocationSuggest:invalid [data-stm-role=location1]":"changeLocation1","LocationSuggest:valid [data-stm-role=location2]":"changeLocation2","LocationSuggest:invalid [data-stm-role=location2]":"changeLocation2","click [data-stm-role=submit]":"submit"},initialize:function(){e.prototype.initialize.apply(this,[this.options]),this.model.bind("change",this.render,this),this.date1=new c.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new c.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.location1=this.$("[data-stm-role=location1]"),this.location1Id=this.$("[data-stm-role=location1Id]"),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.travelers=this.$("[data-stm-role=travelers]"),this.ls1=new b(this.location1,["airport"],null,{},this.location1Id),this.ls2=new b(this.location2,["airport"],null,{},this.location2Id),this.firstRun=!0,this.render()},changeTravelers:function(){this.model.setTravelers(this.travelers.val()),this.model.save()},changeLocation1:function(){this.model.setLocation1(this.location1.data("location-data")),this.model.save()},changeLocation2:function(){this.model.setLocation2(this.location2.data("location-data")),this.model.save()},render:function(){this.travelers.val(this.model.getTravelers());var a=this.model.getLocation1AsAirport();a?(this.location1.val(a.name),this.location1Id.val(a.said)):(this.location1.val(""),this.location1Id.val(""));var b=this.model.getLocation2AsAirport();return b?(this.location2.val(b.name),this.location2Id.val(b.said)):(this.location2.val(""),this.location2Id.val("")),this.firstRun?this.firstRun=!1:this.validate(),this}},{setup:function(){d('[data-stm-role="stm.Views.searchForm.BasicSubmit.Vacation"]').each(function(){new f({el:d(this)})})}});d(f.setup),c.ns("Views.searchForm.BasicSubmit.Vacation",f)}(window);
//# sourceMappingURL=Vacation.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=a.jQuery,e=c.Views.searchForm.BasicSubmit;d(function(){b=a.LocationSuggest});var f=e.extend({events:{"change [data-stm-role=rooms]":"changeRooms","LocationSuggest:valid [data-stm-role=location2]":"changeLocation2","LocationSuggest:invalid [data-stm-role=location2]":"changeLocation2","click [data-stm-role=submit]":"submit"},initialize:function(){e.prototype.initialize.apply(this,[this.options]),this.model.bind("change",this.render,this),this.date1=new c.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new c.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.location2=this.$("[data-stm-role=location2]"),this.rooms=this.$("[data-stm-role=rooms]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.ls2=new b(this.location2,["city","state","region"],null,{},this.location2Id),this.firstRun=!0,this.render()},changeLocation2:function(){this.model.setLocation2(this.location2.data("location-data")),this.model.save()},changeRooms:function(){this.model.setRooms(this.rooms.val()),this.model.save()},render:function(){var a=this.model.getLocation2AsGeo();return a?(this.location2.val(a.name),this.location2Id.val(a.sid)):(this.location2.val(""),this.location2Id.val("")),this.rooms.val(this.model.getRooms()),this.firstRun?this.firstRun=!1:this.validate(),this}},{setup:function(){d('[data-stm-role="stm.Views.searchForm.BasicSubmit.VacationRental"]').each(function(){new f({el:d(this)})})}});d(f.setup),c.ns("Views.searchForm.BasicSubmit.VacationRental",f)}(window);
//# sourceMappingURL=VacationRental.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.bb,e=a.Backbone,f=a.jQuery,g=a._,h=c.popup;f(function(){b=a.BBAd});var i=e.View.extend({events:{"click div.BBAdCell":"submit"},initialize:function(a){this.ads=this.$("div.BBAdCell"),this.options=g.extend({},g.result(this,"options"),a),g.each(this.ads,this.processAd,this)},options:function(){return{windowHeight:788,windowWidth:1200,windowInitialTop:35,windowInitialLeft:170,windowTopIncrement:35,windowLeftIncrement:50}},totalWindows:0,processAd:function(a){var c=f(a),d=c.data("stmOptions");d&&d.id&&(c.data("adData",d),b.singleton(d.id).setMetaDataMulti(d))},adClickHandler:function(a){var b=f(a.currentTarget),c=b.data("url-components");c&&(this.openAdWindow(c),this.trackClick(c.ad_id))},openAdWindow:function(a){var b=c.pageData.adHandlerUrl+"&"+f.param(a),d={width:this.options.windowWidth,height:this.options.windowHeight,top:this.options.windowInitialTop+this.totalWindows*this.options.windowTopIncrement,left:this.options.windowInitialLeft+this.totalWindows*this.options.windowLeftIncrement,center:!1,name:"BookingBuddy_Step2_1C1W_"+a.ad_id},e=new h(b,d);return e.tryPop(),this.totalWindows++,this},trackClick:function(a){return f.publish("/page/featuredSearch",[a]),this}});d.ns("Views.searchForm.OneClickOneWindow",i)}(window);
//# sourceMappingURL=OneClickOneWindow.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.jQuery,e=c.Views.searchForm.OneClickOneWindow,f=e.extend({initialize:function(){e.prototype.initialize.apply(this,[this.options]),this.date1=new b.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new b.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.date2Block=this.$("[data-stm-role=date2Block]"),this.time1=this.$("[data-stm-role=time1]"),this.time2=this.$("[data-stm-role=time2]"),this.serviceClass=this.$("[data-stm-role=serviceClass]"),this.searchType=this.$("[data-stm-role=searchType]"),this.location1=this.$("[data-stm-role=location1]"),this.location1Id=this.$("[data-stm-role=location1Id]"),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.nonstop=this.$("[data-stm-role=nonstop]"),this.travelers=this.$("[data-stm-role=travelers]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(a){this.resetError();var b=this.model.validateByMode("air");b?this.renderError(this.model,b):this.adClickHandler(a)},render:function(){this.time1.val(this.model.getTime1()),this.time2.val(this.model.getTime2()),this.serviceClass.val(this.model.getServiceClass()),this.searchType.val(this.model.getSearchType()),this.nonstop.val(this.model.isNonstop()?"1":"0"),this.travelers.val(this.model.getTravelers());var a=this.model.getLocation1AsAirport();a?(this.location1.val(a.name),this.location1Id.val(a.said)):(this.location1.val(""),this.location1Id.val(""));var b=this.model.getLocation2AsAirport();b?(this.location2.val(b.name),this.location2Id.val(b.sid)):(this.location2.val(""),this.location2Id.val(""));var c=this.model.getSearchType(),d="roundtrip"===c;return this.date2Block.toggle(d),this.date1.setTripHighlight(d),this}},{init:function(){d('[data-stm-role="stm.bb.Views.searchForm.OneClickOneWindow.Air"]').each(function(){new f({el:d(this),model:b.searchData})})}});d(f.init),c.ns("Views.searchForm.OneClickWindow.Air",f)}(window);
//# sourceMappingURL=Air.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.jQuery,e=c.Views.searchForm.OneClickOneWindow,f=e.extend({initialize:function(){e.prototype.initialize.apply(this,[this.options]),this.date1=new b.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new b.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.rooms=this.$("[data-stm-role=rooms]"),this.travelers=this.$("[data-stm-role=travelers]"),this.provider=this.$("[data-stm-role=provider]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(a){this.resetError();var b=this.model.validateByMode("hotel");b?this.renderError(this.model,b):this.adClickHandler(a)},render:function(){this.travelers.val(this.model.getTravelers()),this.rooms.val(this.model.getRooms()),this.provider.val(this.model.getProvider());var a=this.model.getLocation2AsGeo();return a?(this.location2.val(a.name),this.location2Id.val(a.sid)):(this.location2.val(""),this.location2Id.val("")),this}},{setup:function(){d('[data-stm-role="stm.bb.Views.searchForm.OneClickOneWindow.Hotel"]').each(function(){new f({el:d(this),model:b.searchData})})}});d(f.setup),c.ns("Views.searchForm.OneClickOneWindow.Hotel",f)}(window);
//# sourceMappingURL=Hotel.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.jQuery,e=c.Views.searchForm.OneClickOneWindow,f=e.extend({initialize:function(){e.prototype.initialize.apply(this,[this.options]),this.date1=new b.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new b.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.time1=this.$("[data-stm-role=time1]"),this.time2=this.$("[data-stm-role=time2]"),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(a){this.resetError();var b=this.model.validateByMode("car");b?this.renderError(this.model,b):this.adClickHandler(a)},render:function(){this.time1.val(this.model.getTime1()),this.time2.val(this.model.getTime2());var a=this.model.getLocation2();return a?(this.location2.val(a.name),this.location2Id.val(a.sid)):(this.location2.val(""),this.location2Id.val("")),this}},{setup:function(){d('[data-stm-role="stm.bb.Views.searchForm.OneClickOneWindow.Car"]').each(function(){new f({el:d(this),model:b.searchData})})}});d(f.setup),c.ns("Views.searchForm.OneClickOneWindow.Car",f)}(window);
//# sourceMappingURL=Car.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.jQuery,e=c.Views.searchForm.OneClickOneWindow,f=e.extend({initialize:function(){e.prototype.initialize.apply(this,[this.options]),this.cruiseLocation=this.$("[data-stm-role=cruiseLocation]"),this.cruiseLine=this.$("[data-stm-role=cruiseLine]"),this.cruiseDate=this.$("[data-stm-role=cruiseDate]"),this.cruiseLength=this.$("[data-stm-role=cruiseLength]"),this.over55=this.$("[data-stm-role=over55]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(a){this.resetError();var b=this.model.validateByMode("cruise");b?this.renderError(this.model,b):this.adClickHandler(a)},render:function(){return this.cruiseLocation.val(this.model.getCruiseDestinationId()),this.cruiseLine.val(this.model.getCruiseLine()),this.model.getCruiseDate()&&this.cruiseDate.val(this.model.getCruiseDate()),this.cruiseLength.val(this.model.getCruiseLength()),this.over55.val(this.model.isOver55()?"1":"0"),this}},{setup:function(){d('[data-stm-role="stm.bb.Views.searchForm.OneClickOneWindow.Cruise"]').each(function(){new f({el:d(this),model:b.searchData})})}});d(f.setup),c.ns("Views.searchForm.OneClickOneWindow.Cruise",f)}(window);
//# sourceMappingURL=Cruise.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.jQuery,e=c.Views.searchForm.OneClickOneWindow,f=e.extend({initialize:function(){e.prototype.initialize.apply(this,[this.options]),this.date1=new b.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new b.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.location1=this.$("[data-stm-role=location1]"),this.location1Id=this.$("[data-stm-role=location1Id]"),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.travelers=this.$("[data-stm-role=travelers]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(a){this.resetError();var b=this.model.validateByMode("vacation");b?this.renderError(this.model,b):this.adClickHandler(a)},render:function(){this.travelers.val(this.model.getTravelers());var a=this.model.getLocation1AsAirport();a?(this.location1.val(a.name),this.location1Id.val(a.said)):(this.location1.val(""),this.location1Id.val(""));var b=this.model.getLocation2AsAirport();return b?(this.location2.val(b.name),this.location2Id.val(b.said)):(this.location2.val(""),this.location2Id.val("")),this}},{setup:function(){d('[data-stm-role="stm.bb.Views.searchForm.OneClickOneWindow.Vacation"]').each(function(){new f({el:d(this),model:b.searchData})})}});d(f.setup),c.ns("Views.searchForm.OneClickOneWindow.Vacation",f)}(window);
//# sourceMappingURL=Vacation.nano.js.map
!function(a){"use strict";var b,c,d=a.stm,e=d.bb,f=a.Backbone,g=a.jQuery,h=a._,i=d.shared.featuredSearchUtils,j=d.shared.linkUtils;g(function(){c=a.BookingBuddy,b=a.BBAd});var k=f.View.extend({events:{"click [data-stm-role=submit]":"submit","click [name=all_checkboxes]":"checkAll","click .BBAdCell input":"selectAd"},initialize:function(){this.selectAll=this.$("[name=all_checkboxes]"),this.ads=this.$(".BBInputCheckBox"),this.dropdown=this.$("#BBAdDropdown"),this.initDropdown(),this.selectAll.prop("checked",!0),this.ads.filter("[name!=]").prop("checked",!0)},initDropdown:function(){var a=this.dropdown.data("stmOptions");if(a&&a.dropdownAds){var d=a.dropdownAds,e=h.keys(d);h.each(d,function(a,c){b.singleton(c).setMetaDataMulti(a)}),g.dhtmlDropdown.utils.revSearch(this.$el,this.dropdown),this.dropdown.dhtmlDropdownFactory(e,{tpt_premium:c.Strings.DHTMLDropdown.PremiumAdTemplate,tpt_basic:c.Strings.DHTMLDropdown.BasicAdTemplate,tpt_placeholder:c.Strings.DHTMLDropdown.PlaceholderAdTemplate})}},selectAd:function(a){var b=g(a.currentTarget),c=b.parents(".BBAdCell"),d=g(".BBInputCheckBox",c);b.hasClass("BBInputCheckBox")||d.prop("checked",!d.prop("checked")),this.selectAll.prop("checked",this.ads.filter(":checked").length===this.ads.length)},submitHandler:function(){var a,b=function(){var a=parseInt(g(this).attr("name").replace("i",""),10);return isNaN(a)?void 0:a},e=this.ads.filter(":checked").map(b).toArray(),f=this.$el.serialize();if(i.shouldOpenOneClickOneWindow(d.pageData.mode))a=j.getFancyLanderOneClickOneWindowUrl(d.strings.parseQueryString(f)),i.openTabBrowsingWindow(a);else{f+="&r="+e.join(",");var h=c.TabbedWindowHandler,k=h.openTabbedWindow(f);k&&k.focus()}},checkAll:function(){this.ads.prop("checked",this.selectAll.is(":checked"))}});e.ns("Views.searchForm.BBAdsToTabBrowsing",k)}(window);
//# sourceMappingURL=BBAdsToTabBrowsing.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.jQuery,e=c.Views.searchForm.BBAdsToTabBrowsing,f=e.extend({initialize:function(){e.prototype.initialize.apply(this,[this.options]),this.date1=new b.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new b.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.date2Block=this.$("[data-stm-role=date2Block]"),this.time1=this.$("[data-stm-role=time1]"),this.time2=this.$("[data-stm-role=time2]"),this.serviceClass=this.$("[data-stm-role=serviceClass]"),this.searchType=this.$("[data-stm-role=searchType]"),this.location1=this.$("[data-stm-role=location1]"),this.location1Id=this.$("[data-stm-role=location1Id]"),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.nonstop=this.$("[data-stm-role=nonstop]"),this.travelers=this.$("[data-stm-role=travelers]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(){this.resetError();var a=this.model.validateByMode("air");a?this.renderError(this.model,a):this.submitHandler()},render:function(){this.time1.val(this.model.getTime1()),this.time2.val(this.model.getTime2()),this.serviceClass.val(this.model.getServiceClass()),this.searchType.val(this.model.getSearchType()),this.nonstop.val(this.model.isNonstop()?"1":"0"),this.travelers.val(this.model.getTravelers());var a=this.model.getLocation1AsAirport();a?(this.location1.val(a.name),this.location1Id.val(a.said)):(this.location1.val(""),this.location1Id.val(""));var b=this.model.getLocation2AsAirport();b?(this.location2.val(b.name),this.location2Id.val(b.said)):(this.location2.val(""),this.location2Id.val(""));var c=this.model.getSearchType(),d="roundtrip"===c;return this.date2Block.toggle(d),this.date1.setTripHighlight(d),this}},{init:function(){d('[data-stm-role="stm.bb.Views.searchForm.BBAdsToTabBrowsing.Air"]').each(function(){new f({el:d(this),model:b.searchData})})}});d(f.init),c.ns("Views.searchForm.BBAdsToTabBrowsing.Air",f)}(window);
//# sourceMappingURL=Air.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.jQuery,e=c.Views.searchForm.BBAdsToTabBrowsing,f=e.extend({initialize:function(){e.prototype.initialize.apply(this,[this.options]),this.date1=new b.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new b.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.rooms=this.$("[data-stm-role=rooms]"),this.travelers=this.$("[data-stm-role=travelers]"),this.provider=this.$("[data-stm-role=provider]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(){this.resetError();var a=this.model.validateByMode("hotel");a?this.renderError(this.model,a):this.submitHandler()},render:function(){this.travelers.val(this.model.getTravelers()),this.rooms.val(this.model.getRooms()),this.provider.val(this.model.getProvider());var a=this.model.getLocation2AsGeo();return a?(this.location2.val(a.name),this.location2Id.val(a.sid)):(this.location2.val(""),this.location2Id.val("")),this}},{setup:function(){d('[data-stm-role="stm.bb.Views.searchForm.BBAdsToTabBrowsing.Hotel"]').each(function(){new f({el:d(this),model:b.searchData})})}});d(f.setup),c.ns("Views.searchForm.BBAdsToTabBrowsing.Hotel",f)}(window);
//# sourceMappingURL=Hotel.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.jQuery,e=c.Views.searchForm.BBAdsToTabBrowsing,f=e.extend({initialize:function(){e.prototype.initialize.apply(this,[this.options]),this.date1=new b.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new b.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.time1=this.$("[data-stm-role=time1]"),this.time2=this.$("[data-stm-role=time2]"),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(){this.resetError();var a=this.model.validateByMode("car");a?this.renderError(this.model,a):this.submitHandler()},render:function(){this.time1.val(this.model.getTime1()),this.time2.val(this.model.getTime2());var a=this.model.getLocation2();return a?(this.location2.val(a.name),this.location2Id.val(a.sid)):(this.location2.val(""),this.location2Id.val("")),this}},{setup:function(){d('[data-stm-role="stm.bb.Views.searchForm.BBAdsToTabBrowsing.Car"]').each(function(){new f({el:d(this),model:b.searchData})})}});d(f.setup),c.ns("Views.searchForm.BBAdsToTabBrowsing.Car",f)}(window);
//# sourceMappingURL=Car.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.jQuery,e=c.Views.searchForm.BBAdsToTabBrowsing,f=e.extend({initialize:function(){e.prototype.initialize.apply(this,[this.options]),this.date1=new b.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new b.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.location1=this.$("[data-stm-role=location1]"),this.location1Id=this.$("[data-stm-role=location1Id]"),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.travelers=this.$("[data-stm-role=travelers]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(){this.resetError();var a=this.model.validateByMode("vacation");a?this.renderError(this.model,a):this.submitHandler()},render:function(){this.travelers.val(this.model.getTravelers());var a=this.model.getLocation1AsAirport();a?(this.location1.val(a.name),this.location1Id.val(a.sid)):(this.location1.val(""),this.location1Id.val(""));var b=this.model.getLocation2AsAirport();return b?(this.location2.val(b.name),this.location2Id.val(b.said)):(this.location2.val(""),this.location2Id.val("")),this}},{init:function(){d('[data-stm-role="stm.bb.Views.searchForm.BBAdsToTabBrowsing.Vacation"]').each(function(){new f({el:d(this),model:b.searchData})})}});d(f.init),c.ns("Views.searchForm.BBAdsToTabBrowsing.Vacation",f)}(window);
//# sourceMappingURL=Vacation.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.jQuery,e=c.Views.searchForm.BBAdsToTabBrowsing,f=e.extend({initialize:function(){e.prototype.initialize.apply(this,[this.options]),this.date1=new b.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new b.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.location2=this.$("[data-stm-role=location2]"),this.rooms=this.$("[data-stm-role=rooms]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(){this.resetError();var a=this.model.validateByMode("vacation_rental");a?this.renderError(this.model,a):this.submitHandler()},render:function(){var a=this.model.getLocation2AsGeo();return a?(this.location2.val(a.name),this.location2Id.val(a.sid)):(this.location2.val(""),this.location2Id.val("")),this.rooms.val(this.model.getRooms()),this}},{init:function(){d('[data-stm-role="stm.bb.Views.searchForm.BBAdsToTabBrowsing.VacationRental"]').each(function(){new f({el:d(this),model:b.searchData})})}});d(f.init),c.ns("Views.searchForm.BBAdsToTabBrowsing.VacationRental",f)}(window);
//# sourceMappingURL=VacationRental.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.jQuery,e=a._,f=c.Views.searchForm.BBAdsToTabBrowsing,g=f.extend({events:function(){return e.extend({},f.prototype.events,{"change [data-stm-role=travelers]":"changeTravelers"})},initialize:function(){f.prototype.initialize.apply(this,[this.options]),this.model.bind("change",this.render,this),this.date1=new b.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new b.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.travelers=this.$("[data-stm-role=travelers]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]");var a=this.model.getLocation2AsGeo();a?(this.location2.val(a.name),this.location2Id.val(a.sid)):(this.location2.val(""),this.location2Id.val("")),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(){this.resetError();var a=this.model.validateByMode("hotel");a?this.renderError(this.model,a):this.submitHandler()},changeTravelers:function(){this.model.setTravelers(this.travelers.val()),this.model.save()},render:function(){return this.travelers.val(this.model.getTravelers()),this}},{setup:function(){d('[data-stm-role="stm.bb.Views.searchForm.BBAdsToTabBrowsing.HotelListing"]').each(function(){new g({el:d(this),model:b.searchData})})}});d(g.setup),c.ns("Views.searchForm.BBAdsToTabBrowsing.HotelListing",g)}(window);
//# sourceMappingURL=HotelListing.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.bb,e=a.jQuery,f=a._,g=d.Views.searchForm.BBAdsToTabBrowsing;e(function(){b=a.LocationSuggest});var h=g.extend({events:function(){return f.extend({},g.prototype.events,{"change [data-stm-role=travelers]":"changeTravelers","change [data-stm-role=rooms]":"changeRooms","LocationSuggest:valid [data-stm-role=location2]":"changeLocation2","LocationSuggest:invalid [data-stm-role=location2]":"changeLocation2"})},initialize:function(){g.prototype.initialize.apply(this,[this.options]),this.model.bind("change",this.render,this),this.date1=new c.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new c.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.rooms=this.$("[data-stm-role=rooms]"),this.travelers=this.$("[data-stm-role=travelers]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.mode=this.$("[data-stm-role=mode]"),this.ls2=new b(this.location2,["city"],null,{},this.location2Id),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(){this.resetError();var a=this.model.validateByMode("hotel");a?this.renderError(this.model,a):this.submitHandler()},changeTravelers:function(){this.model.setTravelers(this.travelers.val()),this.model.save()},changeRooms:function(){this.model.setRooms(this.rooms.val()),this.model.save()},changeLocation2:function(){this.model.setLocation2(this.location2.data("location-data")),this.model.save()},render:function(){this.travelers.val(this.model.getTravelers()),this.rooms.val(this.model.getRooms());var a=this.model.getLocation2AsGeo();return a?(this.location2.val(a.name),this.location2Id.val(a.sid)):(this.location2.val(""),this.location2Id.val("")),this}},{setup:function(){e('[data-stm-role="stm.bb.Views.searchForm.BBAdsToTabBrowsing.CityDealsPage"]').each(function(){new h({el:e(this),model:c.searchData})})}});e(h.setup),d.ns("Views.searchForm.BBAdsToTabBrowsing.CityDealsPage",h)}(window);
//# sourceMappingURL=CityDealsPage.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.bb,e=a.Backbone,f=a.jQuery;f(function(){b=a.BookingBuddy});var g=e.View.extend({events:{"change [data-stm-role=travelers]":"changeTravelers","click [data-stm-role=submit]":"submit"},initialize:function(){this.model.bind("change",this.render,this),this.date1=new c.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new c.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.travelers=this.$("[data-stm-role=travelers]"),this.errorMessages=this.$("[data-stm-role=errors]"),this.hotelId=this.$('[data-stm-role="hotel_id"]').val(),this.hotelName=this.$('[data-stm-role="hotel_name"]').val(),this.render()},resetError:function(){this.renderError(this.model,[])},renderError:function(a,b){var c=b.map(function(a){return"<div>"+a+"</div>"}).join("");this.errorMessages.html(c)},submit:function(a){a.preventDefault(),this.resetError();var b=this.model.validateByMode("checkrates");b?this.renderError(this.model,b):this.submitHandler()},submitHandler:function(){var a,d,e,g;if(c.pageData&&"checkRatesMoreHotels"in c.pageData){this.hotelId=this.$('[data-stm-role="hotel_id"]').val(),a=this.$('input[type="checkbox"]'),d=this.model.getDate1(),e=this.model.getDate2(),g=this.model.getTravelers();var h=c.CheckRates.hotelCollection.get(this.hotelId);a.each(function(a,b){var c=f(b),d=c.attr("name"),e=d.slice(0,d.lastIndexOf("_")),g=h.getAd(e);g&&g.setChecked(c.is(":checked"))});var i=h.getCheckedAds();i.length>0&&(c.windowManager.launchCheckRates(i,d,e,g),h.setSelected(!0)),a.prop("checked",!1),this.$el.parents("#dhtml_hotel_search").length>0&&this.$el.parents("#dhtml_hotel_search").hide()}else{var j=b.bbSubmitHandlers;a=this.$("input:checked");var k=a.map(function(){return f(this).attr("name")}).toArray();d=this.model.getDate1(),e=this.model.getDate2(),g=this.model.getTravelers(),j.launchCheckrates(k,d,e,g),a.prop("checked",!1)}},changeTravelers:function(){this.model.setTravelers(this.travelers.val()),this.model.save()},render:function(){return this.travelers.val(this.model.getTravelers()),this}},{setup:function(){f('[data-stm-role="stm.bb.Views.searchForm.Checkrates"]').each(function(){new g({el:f(this),model:c.searchData})})}});f(g.setup),d.ns("Views.searchForm.Checkrates",g)}(window);
//# sourceMappingURL=Checkrates.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.jQuery,e=c.Views.searchForm.Checkrates,f=e.extend({initialize:function(){e.prototype.initialize.apply(this,[this.options])},submitHandler:function(){}},{setup:function(){d('[data-stm-role="stm.bb.Views.searchForm.CheckratesSpeedBump"]').each(function(){new f({el:d(this),model:b.searchData})})}});c.ns("Views.searchForm.CheckratesSpeedBump",f)}(window);
//# sourceMappingURL=SpeedBump.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.bb,e=a.Backbone,f=a.jQuery;f(function(){b=a.LocationSuggest});var g=e.View.extend({events:{"change [data-stm-role=travelers]":"changeTravelers","change [data-stm-role=rooms]":"changeRooms","LocationSuggest:valid [data-stm-role=location2]":"changeLocation2","LocationSuggest:invalid [data-stm-role=location2]":"changeLocation2"},initialize:function(){this.model.bind("change",this.render,this),this.date1=new c.shared.views.searchInput.date1({el:this.$("[data-stm-role=date1]"),model:this.model,tripHighlight:!0}),this.date2=new c.shared.views.searchInput.date2({el:this.$("[data-stm-role=date2]"),model:this.model,tripHighlight:!0}),this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.rooms=this.$("[data-stm-role=rooms]"),this.travelers=this.$("[data-stm-role=travelers]"),this.mode=this.$("[data-stm-role=mode]"),this.ls2=new b(this.location2,["city"],null,{},this.location2Id),this.render()},changeTravelers:function(){this.model.setTravelers(this.travelers.val()),this.model.save()},changeRooms:function(){this.model.setRooms(this.rooms.val()),this.model.save()},changeLocation2:function(){this.model.setLocation2(this.location2.data("location-data")),this.model.save()},render:function(){this.travelers.val(this.model.getTravelers()),this.rooms.val(this.model.getRooms());var a=this.model.getLocation2AsGeo();return a?(this.location2.val(a.name),this.location2Id.val(a.sid)):(this.location2.val(""),this.location2Id.val("")),this}},{setup:function(){f('[data-stm-role="stm.bb.Views.searchForm.HotelListingFilter"]').each(function(){new g({el:f(this),model:c.searchData})})}});f(g.setup),d.ns("Views.searchForm.HotelListingFilter",g)}(window);
//# sourceMappingURL=HotelListingFilter.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.bb,e=a.jQuery,f=c.Views.CheckRatesLeaveBehind.Container;c.shared.views.metaWidget.chevronVendors,c.shared.metaUtils,c.shared.models.metaVendor,c.Popup;e(function(){b=a.BBInit});var g=f.extend({initialize:function(){f.prototype.initialize.apply(this,[this.options])},fetchCheckRatesProviders:function(){b.taCheckRates()}});e(function(){c.checkRatesLeaveBehind=new g({})}),d.ns("Views.CheckRatesLeaveBehind.Container",g)}(window);
//# sourceMappingURL=BBUSCheckRatesLeaveBehind.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.bb,e=a.Backbone,f=a.jQuery;f(function(){b=a.LocationSuggest});var g=e.View.extend({events:{"click [data-stm-role=submit]":"submit"},initialize:function(){this.location2=this.$("[data-stm-role=location2]"),this.location2Id=this.$("[data-stm-role=location2Id]"),this.error=this.$("[data-stm-role=errors]"),this.ls2=new b(this.location2,["city"],null,{},this.location2Id)},submit:function(){this.error.hide(),0!==this.location2Id.val().length&&0!==this.location2.val().length?this.$el.submit():this.error.html("'destination' is a required field").show()}},{init:function(){f('[data-stm-role="stm.bb.Views.Destinations"]').each(function(){new g({el:f(this)})})}});f(g.init),d.ns("Views.Destinations",g)}(window);
//# sourceMappingURL=Destinations.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.Backbone,e=a.jQuery,f=d.View.extend({options:function(){return{model:b.searchData}},initialize:function(){this.closeButton=this.$("#dhtml_edit_details_hide"),this.model.on("change",this.render,this),this.stmOptions=this.$el.data("stmOptions"),this.mode=null,this.stmOptions&&this.stmOptions.mode&&(this.mode=this.stmOptions.mode),0===b.pageData.tabBrowsing.tabAdIds.length&&this.hideClose(),this.render()},render:function(){if(this.mode){var a=this.model.validateByMode(this.mode);a&&this.$el.show()}return this},hideClose:function(){this.closeButton.hide()}},{setup:function(){e('[data-stm-role="stm.bb.Views.TabBrowsing.EditDetailsDHTML"]').each(function(){new f({el:e(this)})})}});e(f.setup),c.ns("Views.TabBrowsing.EditDetailsDHTML",f)}(window);
//# sourceMappingURL=EditDetailsDHTML.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.Backbone,e=a.jQuery,f=a._,g=b.Browser,h=d.View.extend({tagName:"li",className:"client-item",events:{click:"onEntryClick"},initialize:function(){this.templateElement=e("#Model_TabBrowsing_ClientListItem"),0!==this.templateElement.length&&(this.template=f.template(this.templateElement.html()),this.$el.html(this.template(this.model.toJSON())),this.model.on("change",this.render,this),this.$logo=this.$(".logo"),this.setBackground(),this.render())},setBackground:function(){g.ie?this.$logo.css({background:"url("+this.model.getLogo()+")"}):this.$logo.css({"background-image":"-webkit-linear-gradient(top, rgba(0,0,0,0) 0%,rgba(0,0,0,0.1) 100%), url("+this.model.getLogo()+")"}).css({"background-image":"-moz-linear-gradient(top, rgba(0,0,0,0) 0%, rgba(0,0,0,0.1) 100%), url("+this.model.getLogo()+")"}).css({"background-image":"-ms-linear-gradient(top, rgba(0,0,0,0) 0%, rgba(0,0,0,0.1) 100%), url("+this.model.getLogo()+")"}).css({"background-image":"linear-gradient(to bottom, rgba(0,0,0,0) 0%, rgba(0,0,0,0.1) 100%), url("+this.model.getLogo()+")"})},render:function(){return this.$el.toggleClass("active",this.model.isTab()),this},onEntryClick:function(a){a.preventDefault(),this.model.isTab()||this.model.setTab(!0)}});c.ns("Views.TabBrowsing.ClientListItem",h)}(window);
//# sourceMappingURL=ClientListItem.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.Backbone,e=a.jQuery,f=a._,g=c.Views.TabBrowsing.ClientListItem,h=d.View.extend({initialize:function(){this.collection=b.bbAdCollection,this.addAll()},addOne:function(a){var b=new g({model:a});this.$el.append(b.render().el)},addAll:function(){f.each(this.collection.getPremiumAds(),this.addOne,this)}},{setup:function(){e('[data-stm-role="stm.bb.Views.TabBrowsing.ClientListPremium"]').each(function(){new h({el:e(this)})})}});e(h.setup),c.ns("Views.TabBrowsing.ClientListPremium",h)}(window);
//# sourceMappingURL=ClientListPremium.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.Backbone,e=a.jQuery,f=a._,g=c.Views.TabBrowsing.ClientListItem,h=d.View.extend({initialize:function(){this.collection=b.bbAdCollection,this.addAll()},addOne:function(a){var b=new g({model:a});this.$el.append(b.render().el)},addAll:function(){f.each(this.collection.getPremiumLargeAds(),this.addOne,this)}},{setup:function(){e('[data-stm-role="stm.bb.Views.TabBrowsing.ClientListPremiumLarge"]').each(function(){new h({el:e(this)})})}});e(h.setup),c.ns("Views.TabBrowsing.ClientListPremiumLarge",h)}(window);
//# sourceMappingURL=ClientListPremiumLarge.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.Backbone,e=a.jQuery,f=a._,g=c.Views.TabBrowsing.ClientListItem,h=d.View.extend({initialize:function(){this.collection=b.bbAdCollection,this.addAll()},addOne:function(a){var b=new g({model:a});this.$el.append(b.render().el)},addAll:function(){f.each(this.collection.getSecondaryAds(),this.addOne,this)}},{setup:function(){e('[data-stm-role="stm.bb.Views.TabBrowsing.ClientListSecondary"]').each(function(){new h({el:e(this)})})}});e(h.setup),c.ns("Views.TabBrowsing.ClientListSecondary",h)}(window);
//# sourceMappingURL=ClientListSecondary.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.bb,e=a.Backbone,f=a.jQuery,g=a._;f(function(){b=a.BookingBuddy});var h=e.View.extend({msgTemplates:{air:"Wait! Lower prices may be available for your <%= geo %> flight. Click the tabs above to show flight prices for your trip.",car:"Wait! Lower prices may be available for your <%= geo %> car rental. Click the tabs above to show car rental prices for your trip.",car_uk:"Wait! Lower prices may be available for your <%= geo %> car hire. Click the tabs above to show car hire prices for your trip.",cruise:"Wait! Lower prices may be available for your <%= geo %> cruise. Click the tabs above to show cruise prices for your trip.",hotel:"Wait! Lower prices may be available for your <%= geo %> hotel. Click the tabs above to show hotel prices for your trip.",vacation:"Wait! Lower prices may be available for your <%= geo %> vacation package. Click the tabs above to show vacation package prices for your trip.",vacation_rental:"Wait! Lower prices may be available for your <%= geo %> vacation rental. Click the tabs above to show vacation rental prices for your trip.",holiday:"Wait! Lower prices may be available for your <%= geo %> holiday package. Click the tabs above to show holiday package prices for your trip."},initialize:function(){this.model=c.alertOnClose,this.collection=c.bbAdCollection,this.searchModel=c.searchData,f(a).on("beforeunload",g.bind(this.alertUser,this))},alertUser:function(){return this.model.isEnabled()?this.getMessage():void 0},getMessage:function(){var a=c.pageData.mode;if(a in this.msgTemplates){var d=g.template(this.msgTemplates[a]),e={geo:""},f=null,h=null;switch(b.searchMode){case"air":case"vacation":f=this.searchModel.getLocation1AsAirport(),h=this.searchModel.getLocation2AsAirport(),f&&h&&(e.geo=f.name+" to "+h.name);break;case"hotel":h=this.searchModel.getLocation2AsGeo(),h&&(e.geo=h.name);break;case"car":case"vacation_rental":h=this.searchModel.getLocation2AsAirport(),h&&(e.geo=h.name);break;case"cruise":e.geo=this.searchModel.getCruiseDestinationName()}return e.geo.length>0&&(e.geo=e.geo.replace(/ - All Airports/g,"")),d(e)}}},{setup:function(){f('[data-stm-role="stm.bb.Views.TabBrowsing.AlertOnClose"]').each(function(){new h})}});f(h.setup),d.ns("Views.TabBrowsing.AlertOnClose",h)}(window);
//# sourceMappingURL=AlertOnClose.nano.js.map
!function(a){"use strict";var b,c,d=a.stm,e=d.bb,f=a.Backbone,g=a.jQuery,h=a._;g(function(){b=a.BookingBuddy,c=a.s});var i=f.View.extend({tagName:"li",className:"tab-bar-item",events:{"click .close":"closeTab","click .name":"onTabItemSelected"},initialize:function(){this.firstClick=!0,this.templateElement=g("#Model_TabBrowsing_TabBarItem"),0!==this.templateElement.length&&(this.template=h.template(this.templateElement.html()),this.$el.html(this.template(this.model.toJSON())),this.model.on("change:_tab",this.removeTab,this),this.alertMsg=this.$('[data-stm-role="tabPopOver"]'),this.alertMsg.popover({placement:"bottom",trigger:"manual"}))},highlightTab:function(b){this.$el.animate({opacity:.25},500).animate({opacity:1},500),b&&a.setTimeout(g.proxy(function(){this.alertMsg.popover("show"),a.setTimeout(g.proxy(function(){this.alertMsg.popover("hide")},this),3e3)},this),500)},render:function(){return this},removeTab:function(){this.model.isTab()||this.remove()},trackClick:function(){var a=b.Tracking.tracker;a.setEvent(this.model.isFeatured()?"event30":"event31"),a.setProperty("products",";bb_"+this.model.getId()).setTrackVar("products"),c.channel&&a.setVariable("eVar24",c.channel),c.pageName&&a.setVariable("eVar25",c.pageName),a.send("BB Search")},closeTab:function(){this.model.setTab(!1)},onTabItemSelected:function(){this.firstClick&&this.trackClick(),this.model.setTabFocused(!0),this.firstClick=!1}});e.ns("Views.TabBrowsing.TabBarItem",i)}(window);
//# sourceMappingURL=TabBarItem.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.Backbone,e=a.jQuery,f=c.Views.TabBrowsing.TabBarItem,g=d.View.extend({initialize:function(){this.collection=b.bbAdCollection,this.alertOnCloseModel=b.alertOnClose,this.tabOpenCount=0,this.collection.on("change:_tab",this.updateTab,this),this.collection.on("change:_tab_focused",this.focusAd,this)},focusAd:function(a){a.isTabFocused()&&++this.tabOpenCount>=2&&this.alertOnCloseModel.setEnabled(!1)},updateTab:function(a){a.isTab()?this.addOne(a):this.$("li.tab-bar-item:last .name").click()},addOne:function(a){var b=new f({model:a});b.render().$el.insertAfter(this.$el.children("li").last());var c=this.collection.getTabAds().length<=1;b.highlightTab(c)}},{setup:function(){e('[data-stm-role="stm.bb.Views.TabBrowsing.TabBar"]').each(function(){new g({el:e(this)})})}});e(g.setup),c.ns("Views.TabBrowsing.TabBar",g)}(window);
//# sourceMappingURL=TabBar.nano.js.map
!function(a){"use strict";var b,c=a.stm,d=c.bb,e=a.Backbone,f=a.jQuery,g=a._,h=c.Browser,i=c.Popup;f(function(){b=a.BookingBuddy});var j=e.View.extend({tagName:"div",className:"tab-pane",events:{"click .clientName":"focusFauxTab"},initialize:function(){this.templateElement=f("#Model_TabBrowsing_PanelListItem"),0!==this.templateElement.length&&(this.template=g.template(this.templateElement.html()),this.isFireFox=h.firefox,this.isIE=h.ie,this.$el.html(this.template(this.model.toJSON())),this.$el.attr("id",this.model.getId()),this.model.on("change:_tab",this.removeTab,this),this.model.isFauxTabsEnabled()&&this.model.on("change:_tab_focused",this.focusFauxTab,this),this.model.isTracked()||(b.Tracking.trackBBSearch([this.model.getId()]),this.model.setTracked(!0)),!this.isFireFox&&!this.isIE||this.model.isFauxTabsEnabled()||this.iframeHacks())},iframeHacks:function(){f(a).on("resize.bb_Views_TabBrowsing_PanelListItem",g.bind(this.resize,this)),this.resize()},resize:function(){var a=this.getFauxTabWindowSettings().height+60;this.$el.height(a)},removeTab:function(){if(!this.model.isTab()){if(f(a).off("resize.bb_Views_TabBrowsing_PanelListItem"),this.model.getPopup()){var b=this.model.getPopup().popupWindow;b&&b.close(),this.model.setPopup(null)}this.remove()}},focusFauxTab:function(){if(this.model.isFauxTabsEnabled()&&this.model.isTabFocused()){var a=this.model.getPopup();if(!a||!a.popupWindow||a.popupWindow.closed){var b=this.getFauxTabWindowSettings();a=new i(this.model.getUrl(),b),this.model.setPopup(a),a.tryPop()}a.popupWindow.focus()}},getFauxTabWindowSettings:function(){var b="undefined"!=typeof a.screenY?a.screenY:a.screenTop,c="undefined"!=typeof a.screenX?a.screenX:a.screenLeft,d=0,e=0,g=f(a).height(),i=this.options.container.offset().top+6,j=g-i;if(h.ie){var k=h.version;switch(k){case 7:case 8:e=73;break;case 9:default:e=80,d=a.outerHeight-g-5}}else e=58,d=a.outerHeight-g-5;var l=f(a).width()+2,m=j-e,n=b+d+i,o=c;return{height:m,width:l,top:n,left:o}}});d.ns("Views.TabBrowsing.PanelListItem",j)}(window);
//# sourceMappingURL=PanelListItem.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.Backbone,e=a.jQuery,f=c.Views.TabBrowsing.PanelListItem,g=d.View.extend({initialize:function(){this.collection=b.bbAdCollection,this.collection.on("change:_tab",this.updateTab,this)},updateTab:function(a){a.isTab()&&this.addOne(a)},addOne:function(a){var b=new f({model:a,container:this.$el});this.$el.append(b.render().el)}},{setup:function(){e('[data-stm-role="stm.bb.Views.TabBrowsing.PanelList"]').each(function(){new g({el:e(this)})})}});e(g.setup),c.ns("Views.TabBrowsing.PanelList",g)}(window);
//# sourceMappingURL=PanelList.nano.js.map
!function(a){"use strict";var b=a.stm,c=b.bb,d=a.Backbone,e=a.jQuery,f=d.View.extend({initialize:function(){this.collection=b.bbAdCollection,this.$clientCount=this.$('[data-stm-role="clientCount"]'),this.$clientCount.text(this.collection.getPremiumLargeAds().length+this.collection.getPremiumAds().length)}},{setup:function(){e('[data-stm-role="stm.bb.Views.TabBrowsing.HomePanelItem"]').each(function(){new f({el:e(this)})})}});e(f.setup),c.ns("Views.TabBrowsing.HomePanelItem",f)}(window);
//# sourceMappingURL=HomePanelItem.nano.js.map


!function(){$j(document).on("click",".HotelAIMLink",function(){$j.publish("/click/HotelAIM",[this])}),$j(document).on("click","a.newWindow",function(a){a.stopPropagation(),a.preventDefault(),$j.publish("/click/newWindow",[this])}),$j(document).on("click","a.openNLWindow",function(a){a.stopPropagation(),a.preventDefault(),$j.publish("/click/openNLWindow",[this])}),$j(document).on("change","#hotel_num_rooms",function(a){"3"===$j(this).val()&&(a.stopPropagation(),a.preventDefault(),$j.publish("/change/hotelNumRooms3Plus",[this]))}),$j(document).on("STMToggle:complete","#bb_widget",function(){$j("#bb_widget .toggleActive").each(function(){$j.publish("/click/widgetRadioButton",[this])})}),$j(document).on("click",".hotelListingFavorites",function(){$j.publish("/click/hotelListingFavorites",[this])}),$j(document).on("click",".logout",function(a){a.stopPropagation(),a.preventDefault(),$j.publish("/click/logout",[this])}),$j(document).on("click",".nl_sub_inline_ttd",function(){$j.publish("/click/inlineSubs",[this])}),$j(document).on("click",".mvcView.mobileSiteLink .close",function(){var a=$j(this).parents(".mvcView.mobileSiteLink");$j.publish("/mvcView/mobileSiteLink/close",[a])})}();
//# sourceMappingURL=EventPub.nano.js.map
!function(a){a.subscribe("/click/bbdeal",function(b,c){var d=a(c).find("a");d[0]?url=d.attr("href"):url=b.url,url&&openDealWindow(url,d),"undefined"!=typeof stm&&stm.OmnitureConfig?BookingBuddy.Tracking.trackDealClick(d,b.omnitureProductId,b.pageTitle,b.cpcCode):omnitureDealClick(d,b.omnitureProductId,b.pageTitle,b.cpcCode)}),a.subscribe("/click/dealsPopunderDealLink",function(a,b){if(b&&b.url)openDealWindow(b.url,a),"undefined"!=typeof stm&&stm.OmnitureConfig?BookingBuddy.Tracking.trackDealClick(a,b.omnitureProductId,b.pageTitle,b.cpcCode):omnitureDealClick(a,b.omnitureProductId,b.pageTitle,b.cpcCode);else{var c=(screen.width-1096)/2,d=(screen.height-825)/2;window.open(a.href,"bbdealswindow","status=1,toolbar=1,location=1,menubar=1,resizable=1,scrollbars=1,height=729,width=1064,top="+d+",left="+c),"undefined"!=typeof stm&&stm.OmnitureConfig?BookingBuddy.Tracking.trackPopunderClick():trackDealsPopunderClicks()}}),a.subscribe("/click/dartAd",function(a,b){var c=new Popup(a,b);c.tryPop(),omnitureDartClick(a)}),a.subscribe("/click/HotelAIM",function(b){var c=a(b).attr("data-href"),d=null;c&&(BookingBuddy.Tracking.trackAIMThumbnailClick(),d=new stm.Popup(c),d.useOptimalDimensions(),d.tryPop())}),a.subscribe("/click/newWindow",function(b){var c=a(b),d=null;c.find("span.linkId")[0]&&(d=c.find("span.linkId").html(),-1!==d.indexOf("ta_")&&STMClickstream.trackTAAIMClick(BookingBuddy.redirectUrl,BookingBuddy.taHotelPhotosMCID)),openLinkInNewWindow(b,d),c.blur()}),a.subscribe("/click/openNLWindow",function(b){var c="latestNL",d="status=1,resizable=1,scrollbars=1,height=608,width=795,top=35,left=0",e=a(b).attr("href"),f=window.open(e,c,d);a.isNullOrUndefined(f)&&BookingBuddy.Search.showBlockedPopUpMessage("BookingBuddyDealsBlockedPopUpDivID"),a(b).blur()}),a.subscribe("/click/widgetRadioButton",function(b){var c=a(b).attr("id").replace("_show-searchforms",""),d=a("form#"+c),e=c.replace("_widget_form","");1==d.length&&!d.hasClass("UKLocale")&&d.is(":visible")&&BookingBuddy.Tracking.trackSiteSectionVisit(e)}),a.subscribe("/click/FindFare/step1",function(b,c){var d=2e3,e=new DHTMLPopup_Loader(b.attr("id")),f=STMTracking.singleton();e.show(),e.hide(d),window.setTimeout(function(){a("#air_departure_city").val(c.from),a("#air_arrival_city").val(c.to),a("#air_date1").val(c.dep_date),a("#air_date2").val(c.ret_date)},d),c.omniture_desc+="|S1",f.setVariable("eVar35",c.omniture_desc),f.send(c.omniture_desc)}),a.subscribe("/click/FindFare/tabbedSearch",function(b){for(var c=$j(".smartForm.bbSearch:first").serializeArray(),d=c.length,e="",f=STMTracking.singleton(),g=0;d>g;g++)"departure_date"==c[g].name?c[g].value=b.dep_date:"return_date"==c[g].name&&(c[g].value=b.ret_date);e=a.param(c),BookingBuddy.TabbedWindowHandler.openTabbedWindow(e),"deal_listing"==b.page_type?b.omniture_desc+="|HD1":b.omniture_desc+="|S2",f.setVariable("eVar35",b.omniture_desc),f.send(b.omniture_desc)}),a.subscribe("/sub/login",function(b,c,d,e){return"dealssub"===b.attr("id")?(b.find(".existing_reg").show(),void b.find(".unsubscribed").hide()):void(d&&a(".deals_module.top_deals .deals_sub").slideUp())}),a.subscribe("/sub/new",function(b,c){var d="dealssub"===b.attr("id");d&&(b.find(".new_reg").show(),b.find(".unsubscribed").hide());var e=STMTracking.singleton();e.getProperty("purchaseID")&&e.setProperty("purchaseID",null),a.each(c,function(a,b){"Fare Alert Departure"==b?e.setEvent("event46"):"Fare Alert Route"==b?e.setEvent("event48"):"Default"==b?e.setEvent("event49"):"Snique Away"==b?e.setEvent("event43"):"Hotel Watch"==b?e.setEvent("event50"):"ST Deal Alert"==b&&e.setEvent("event44"),"Snique Away"===b||"ST Deal Alert"===b||e.isEventSet("event4")||e.setEvent("event4")}),a.inArray("Default",c)&&(d||a(".deals_module.top_deals .deals_sub").slideUp()),e.send("A user has been subscribed to a newsletter")}),a.subscribe("/dhtmlPopup/googleMap",function(){var a=STMTracking.singleton();a.setVariable("eVar35","OnMap click"),a.send("dhtml google map opened")}),a.subscribe("/show/recentSearchData",function(a){setTimeout(function(){omnitureTrackBBRecentSearches(a.mode)},4e3)}),a.subscribe("/page/featuredSearch",function(a,b){"number"==typeof a&&(a=[a]),BookingBuddy.clickCapping&&BookingBuddy.clickCapping.countClick(a),b||BookingBuddy.Tracking.trackBBSearch(a)}),a.subscribe("/load/module/bbdeal",function(b){if("top_deals"===b){var c=BookingBuddy.abTests.bbs1602;!c||"b"!==c&&"c"!==c&&"d"!==c||(BBIPLocation.populate("airport","dealssub_ac1",!1),a(".deals_module."+b+" .deals_sub").show())}}),a.subscribe("/click/hotelListingFavorites",function(a){var b=STMTracking.singleton();b.getProperty("purchaseID")&&b.setProperty("purchaseID",null),b.setVariable("eVar35","Mark as Favorite"),b.send("Mark as Favorites Submittion")}),a.subscribe("/click/logout",function(b){var c="/sub/logout.php",d=a(b).find(".redirect").text();d&&(c+="?url="+d),window.location=c}),a.subscribe("/hide/TraqLander",function(){if(BookingBuddy.getQSParam("cross_promo")){var a="Hotel tabbed lander popunder";"vacation"==BookingBuddy.searchMode&&(a="Vacation tabbed lander popunder"),tracker=STMTracking.singleton(),tracker.setVariable("eVar14",a),tracker.send("Exit Popunder Cross Promo Tab Click")}}),a.subscribe("/click/inlineSubs",function(){BookingBuddy.createCookie("inline_subs_used",!0,1440)}),a.subscribe("/mvcView/mobileSiteLink/close",function(a){a.remove()})}(jQuery);
//# sourceMappingURL=EventSub.nano.js.map

!function(a){DHTMLPopup=Object.subClass({cookie_name:null,init:function(b,c){this.popup=a("#"+b),a.isNullOrUndefined(c)&&(c=!1),this.id=b,this.use_iframe=c,a("#"+b+" .closePopup").each(a.proxy(function(c,d){var e=a(d).closest(".dhtml_popup");(e.length<=0||e.attr("id")==b)&&(e=this),a(d).click(function(a){return a.stopPropagation(),a.preventDefault(),e.hide(),!1})},this)),a.data(this.popup.get(0),"dhtmlpopup",this),this.popup.hasClass("showNow")&&this.showNow(),this.initialized=!0,this.popup.trigger("dhtmlpopup:init")},setCookieName:function(a){this.cookie_name=a},setIframe:function(a){},visible:function(){return a(this.popup).is(":visible")},setPageMask:function(b){this.page_mask=a("#"+b).length>0?a("#"+b):!1},resizePageMask:function(){this.page_mask.css({height:a(document).height()+"px",width:a(document).width()+"px"})},show:function(b,c){if(this.visible())return!1;if(this.cookie_name){if(BookingBuddy.getCookie(this.cookie_name))return!1;BookingBuddy.createCookie(this.cookie_name,!0,1440)}!this.page_mask||stm.Browser.ie&&6==stm.Browser.version||(document.body&&(this.resizePageMask(),a(window).bind("resize",a.proxy(this.resizePageMask,this))),this.popup.css("zIndex")&&a(this.page_mask).css("zIndex",this.popup.css("zIndex")-1),a(this.page_mask).show());var d=null;if(a.isBoolean(b)?d={top:0,left:0}:a.isString(b)?(b=/[\w\d]+/.exec(b),d=b?a("#"+b).position():this._getCenterPos()):d=b?b.position():this._getCenterPos(),c&&(d.top=Math.max(d.top+c.top,0),d.left=Math.max(d.left+c.left,0)),this.popup.css({top:d.top+"px",left:d.left+"px"}),this.popup.show(),this.popup.trigger("dhtmlpopup:show"),!this.iframe&&this.use_iframe){var e=this.popup.attr("id")+"_iframe";this.iframe=this._createIframe(e)}return this.use_iframe&&this.iframe.show(),!0},showNow:function(){this.show()},hide:function(a){this.iframe&&this.use_iframe&&this.iframe.hide(),this.page_mask&&this.page_mask.hide(),this.popup.hide(),this.popup.trigger("dhtmlpopup:hide")},maskClick:function(b){a("#"+b).bind("click",a.proxy(this.hide,this))},_createIframe:function(b){var c=a("iframe",{id:b,src:"",frameBorder:"0",scrolling:"no"}),d=this.page_mask?this.page_mask.css("zIndex"):this.popup.css("zIndex");return c.css({"background-color":"transparent",display:"none",position:"absolute",top:parseInt(this.popup.css("top"),10)+10+"px",left:parseInt(this.popup.css("left"),10)+10+"px",height:this.popup.outerHeight()-20+"px",width:this.popup.outerWidth()-20+"px",border:"0","z-index":d-1}),a(c).insertAfter(this.popup),c},_getCenterPos:function(){var b=(a(window).height()-this.popup.outerHeight())/2,c=(a(window).width()-this.popup.outerWidth())/2;return{top:b,left:c}}}),DHTMLPopup_Layer=DHTMLPopup.subClass({init:function(b,c){this.base=a("#"+b),this.max_zIndex=null,this.popups=[]},addElement:function(b){var c=this,d=a("#"+b);a("#"+b+" .closePopup").each(function(e,f){var g=a(f).closest(".dhtml_popup");(g.length<=0||g.attr("id")==b)&&(g=d),a(f).click(function(a){c.hide()})});var e=d.css("zIndex");e&&e>this.max_zIndex&&(this.max_zIndex=e),this.popups.push(d)},show:function(b){if(0===this.popups.length)return!1;if(a.isNullOrUndefined(b)&&(b=!1),!this.page_mask||stm.Browser.ie&&6==stm.Browser.version||(document.body&&(this.resizePageMask(),a(window).bind("resize",a.proxy(this.resizePageMask,this))),this.max_zIndex&&this.page_mask.css("zIndex",this.max_zIndex-1),a(this.page_mask).show()),b){var c=[],d=function(a){return a.shift().fadeIn(1e3,function(){c.push($j(this)),0!==a.length&&d(a)}),c};this.popups=d(this.popups)}else a.each(this.popups,function(a,b){b.show()});return this.base.trigger("dhtmlpopup:show"),!0},hide:function(b){this.page_mask&&this.page_mask.hide(),a.each(this.popups,function(a,b){b.hide()}),this.base.trigger("dhtmlpopup:hide")}}),DHTMLPopup_Sub=DHTMLPopup.subClass({api_url:"/ajax/sub.php",init:function(b,c){this._super(b,c),this.popup_form=a(this.popup).find("form"),this.popup_form.length>1&&(this.popup_form=a(this.popup).find(".step1 form"))},setAPIURL:function(a){this.api_url=a},appendRDImageTracking:function(){var a=$j("<img />"),b=window.stm;return b.pageData&&b.pageData.dhtmlAd&&b.pageData.dhtmlAd.adData&&b.pageData.dhtmlAd.adData.url&&b.pageData.adTrackingUrl&&b.pageData.dhtmlAd.adData.display_name&&"BookingBuddyUSSubAir"==b.pageData.dhtmlAd.adData.display_name&&a.attr("src",b.pageData.adTrackingUrl+"&"+b.pageData.dhtmlAd.adData.url).hide().appendTo("body"),this},submit:function(b){if(!this.submitting){var c=this.popup_form.serialize();a.post(this.api_url,c,a.proxy(function(a){"error"==a.status?this.popup.trigger("dhtmlpopup:sub:error",[a]):(this.popup.trigger("dhtmlpopup:sub:success",[a]),this.appendRDImageTracking()),this.submitting=!1},this),"json")}return!1}}),DHTMLPopup_CheckRates=DHTMLPopup.subClass({init:function(b,c){this._super(b,c),this.triggers=a(".checkHotelRatesTrigger"),$j(document).on("click",this.triggers.selector,a.proxy(function(b){var c=a(b.currentTarget);if(c.parents("[data-showing-meta]").length)return void a.publish("fromOldWorld:metaLayerPop",[b]);var d=c.attr("id"),e=d.substr(d.lastIndexOf("_")+1);a("#hotelcheckrates_form_aderrors").hide();var f=!1;switch(BookingBuddy.affiliateName){case"world_travel_guide":case"uk_holiday_weather":case"uk_airfaresflights":case"holidaywatchdog":case"holidayweatherguide":case"top_rated_travel":case"bargain_travel_4_u":f=!0;break;default:f=!1}this.show(e,f)},this))},show:function(b,c){var d="check_rates_popup_location_"+b;if(a.emptyString(b))d=a("#check_rates_popup_location").length>0?"check_rates_popup_location":!1;else{this.hide();var e=(a("#check_rates_popup_location_"+b),a("#hotel_name_"+b).html());a("#hotelcheckrates_id").length>0&&a("#hotelcheckrates_id").val(b),a.emptyString(e)||(a("#dhtml_hotel_search_title").html(e),a("#hotelcheckrates_provider").val(e),a("#hotelcheckrates_provider").data("hotel_id",b),a("#hotelcheckrates_provider").change(),a("#hotelcheckrates_provider").blur()),c&&(d=a("#check_rates_popup_location").length>0?"check_rates_popup_location":!1)}this._super(d)},showNow:function(){var b=a(".popup_location");if(b.length>0){var c=b.attr("id"),d=c.substr(c.lastIndexOf("_")+1);this.show(d,!0)}}}),DHTMLPopup_Loader=DHTMLPopup.subClass({init:function(b,c){"string"==typeof b?this.target=a("#"+b):this.target=a(b),a(".iframe_overlay").length?this.overlay=a(".iframe_overlay").hide():this.overlay=a('<div class="iframe_overlay"><h1 class="interstitialTitle"></h1><div class="iframe_loader"></div></div>').appendTo("body").hide()},show:function(a,b){var c=this.target.offset(),d=this.target.height(),e=this.target.width();this.overlay.height(d).width(e),this.overlay.css({top:c.top+"px",left:c.left+"px"}),this.overlay.show()},hide:function(a){a||(a=0),this.overlay.delay(a).hide(0)}}),DHTMLPopup_GoogleMap=DHTMLPopup.subClass({map:null,mapData:null,loader:null,init:function(b){var c=this;c._super(b,!1);var d=a("#"+b);d.length&&(c.mapId=d.find(".dhtml_map").attr("id"),c.mapId&&(c.loader=new DHTMLPopup_Loader(c.mapId),$j(document).on(GoogleMap.constants.EVENT_LOADING+" "+GoogleMap.constants.EVENT_LOADED,"#"+c.mapId,function(a){c.loader&&(a.type==GoogleMap.constants.EVENT_LOADING?c.loader.show():c.loader.hide())}),c.triggers=a(".showDhtmlMap."+c.mapId),$j(document).on("click",c.triggers.selector,function(b){b.stopPropagation(),b.preventDefault();var d=a(b.currentTarget).attr("id"),e=d.split("-"),f=e[0];c.show(f)}),d.bind("stmmaps::showDhtmlMap",function(a,b){b&&c.show(b.action)}),c.filters=d.find(".filter"),d.delegate("input.filter","change",function(b){if(c.map){var d=a(b.currentTarget),e=d.attr("name"),f=d.prop("checked");c.updateMap(e,f)}})))},show:function(b){if(this._super(),!this.map){this.mapData=BookingBuddy.Maps.Data.singleton(this.mapId);var c=this.mapData.getCenterPoint(),d=this.mapData.getEvents();this.map=a("#"+this.mapId).googleMapFactory(c,null,d)}this.updateMap(b,!0)},hide:function(a){this.map&&this.map.blur(),this._super(a)},updateMap:function(a,b){var c=a.split("_");if(!(c.length<2)){var d=c[0],e=c[1],f=null;"all"==e?"hotel"==d?(f=this.mapData.getLocations(),BookingBuddy.Maps.loadLocationData(this.map,f,b),this.filters.filter(".location").prop("checked",b)):"attraction"==d&&(f=this.mapData.getPOIsByType("attraction"),BookingBuddy.Maps.loadPOIs(this.map,f,b),this.filters.filter(".attraction").prop("checked",b)):(f=this.mapData.getLocation(e),BookingBuddy.Maps.loadLocationData(this.map,f,b),this.filters.filter("."+e).prop("checked",b),b||this.filters.filter(".all").prop("checked",!1))}}}),DHTMLPopup_Factory={types:{base:DHTMLPopup,sub:DHTMLPopup_Sub,checkRates:DHTMLPopup_CheckRates,loader:DHTMLPopup_Loader,googleMap:DHTMLPopup_GoogleMap,layer:DHTMLPopup_Layer},create:function(b){var c=null;if(!a.emptyString(b.id)){var d=this.types[b.type];a.isNullOrUndefined(d)&&(d=this.types.base),c=new d(b.id,b.use_iframe)}return c}}}(jQuery);
//# sourceMappingURL=dhtml_popup.nano.js.map
var ExternalPopup=function(a){if(this.win=null,this.isPopped=!1,this.firstClickPaused=!1,a&&a.params&&"string"==typeof a.params){var b={};$j.each(a.params.split(","),function(a,c){var d=c.split("=");2===d.length&&(b[d[0]]=d[1])}),a.params=b}this.options=$j.extend(!0,{},ExternalPopup.defaults,a),this.updateDimensions(this.options.width,this.options.height),this.init()};$j.extend(ExternalPopup,{TYPES:{NORMAL:0,FIRSTCLICK:1,ONEXIT:2,EVERYCLICK:3},LOCATIONS:{ABOVE:0,UNDER:1},PLACEMENTS:{TOPRIGHT:0,BOTTOMRIGHT:1,TOPLEFT:2,BOTTOMLEFT:3,CENTER:4,PARENT:5,CUSTOM:6}}),$j.extend(ExternalPopup,{defaults:{cookieName:null,url:"about:blank",name:null,params:{toolbar:0,location:0,directories:0,status:1,menubar:0,scrollbars:1,resizable:1},type:ExternalPopup.TYPES.NORMAL,location:ExternalPopup.LOCATIONS.ABOVE,placement:ExternalPopup.PLACEMENTS.CUSTOM,posX:screen.width/2,posY:screen.height/2,height:500,width:500,delay:null,triggerElement:""},prototype:{init:function(){switch($j(this).bind("ExternalPopup:setUrl",$j.proxy(function(a,b){var c=b.url;c&&this.setUrl(c)},this)),$j(this).bind("ExternalPopup:resizeWindow",$j.proxy(function(a,b){var c=b.width,d=b.height;c&&d&&this.resizeWindow(c,d)},this)),$j(this).bind("ExternalPopup:setFirstClickPaused",$j.proxy(function(a,b){var c=b.paused;$j.isUndefined(c)||(this.firstClickPaused=c)},this)),this.options.type){case ExternalPopup.TYPES.FIRSTCLICK:this.firstClick();break;case ExternalPopup.TYPES.ONEXIT:this.popOnExit();break;case ExternalPopup.TYPES.EVERYCLICK:this.everyClick();break;case ExternalPopup.TYPES.NORMAL:this.launch()}},updateDimensions:function(a,b){this.options.width=a,this.options.height=b,this.options.params.width=a,this.options.params.height=b},setUrl:function(a){this.options.url=a,this.win&&!this.win.closed&&(this.win.location.href=this.options.url)},resizeWindow:function(a,b){if(this.updateDimensions(a,b),this.win&&!this.win.closed)try{this.win.resizeTo(a,b)}catch(c){}},launch:function(){this.options.delay&&this.options.delay>0?setTimeout($j.proxy(this.pop,this),this.options.delay):this.pop()},pop:function(){if(this.options.location==ExternalPopup.LOCATIONS.UNDER){var a=new stm.Popup(this.options.url,{height:this.options.height,width:this.options.width,left:window.screenLeft?window.screenLeft:window.screenX,top:window.screenTop?window.screenTop:window.screenY,popunder:!0});a.tryPop(),this.win=a.popupWindow,this.isPopped=!0,$j(this).trigger("ExternalPopup:popped")}else{switch(popUp=null,this.options.placement){case ExternalPopup.PLACEMENTS.TOPRIGHT:popUp=new stm.Popup(this.options.url,{height:this.options.height,width:this.options.width,left:screen.width});break;case ExternalPopup.PLACEMENTS.BOTTOMRIGHT:popUp=new stm.Popup(this.options.url,{height:this.options.height,width:this.options.width,left:screen.width,top:screen.height});break;case ExternalPopup.PLACEMENTS.TOPLEFT:popUp=new stm.Popup(this.options.url,{height:this.options.height,width:this.options.width,left:0,top:0});break;case ExternalPopup.PLACEMENTS.BOTTOMLEFT:popUp=new stm.Popup(this.options.url,{height:this.options.height,width:this.options.width,left:0,top:screen.height});break;case ExternalPopup.PLACEMENTS.CENTER:popUp=new stm.Popup(this.options.url,{height:this.options.height,width:this.options.width,left:(screen.width-this.options.width)/2,top:(screen.height-this.options.height)/2});break;case ExternalPopup.PLACEMENTS.PARENT:popUp=new stm.Popup(this.options.url,{height:this.options.height,width:this.options.width,left:window.screenLeft?window.screenLeft:window.screenX,top:window.screenTop?window.screenTop:window.screenY})}popUp&&(popUp.tryPop(),this.win=popUp.popupWindow,this.isPopped=!0,$j(this).trigger("ExternalPopup:popped"))}},popOnExit:function(){$j("form[action!=],a[target!=_blank][href!=#][href!=]").each($j.proxy(function(a,b){var c=$j(b);if(c.hasClass("noPopOnExit"))return!0;var d="",e="";return c.is("a")?(e=b.href,d="click"):(e=b.action,d="submit"),0!==e.indexOf("/")&&-1==e.indexOf(window.location.host)&&c.bind(d,$j.proxy(function(){this.launch()},this)),!0},this))},firstClick:function(){var a=this;this.isPopped||BookingBuddy.getCookie(this.options.cookieName)||$j(document).on(stm.Popup.popunderEvent+".popunder",function(b){var c=$j(b.target);c.hasClass("noFirstClick")||c.parents(".noFirstClick").length||a.firstClickPaused||c.parents("#BBLocationSuggest").length||stm.pageData.noDealsPopunder||($j(document).off(stm.Popup.popunderEvent+".popunder"),$j(a).on("ExternalPopup:popped",function(){a.options.cookieName&&BookingBuddy.createCookie(a.options.cookieName,"true",1440)}),BookingBuddy.getCookie(a.options.cookieName)||a.launch())})},everyClick:function(){var a=this;this.options.triggerElement&&($elm=$j(this.options.triggerElement),$elm.click(function(b){b.stopPropagation(),b.preventDefault(),a.launch()}))}}});
//# sourceMappingURL=external_popup.nano.js.map
function omnitureTrackBBSearch(a,b,c,d){"undefined"==typeof d&&(d=!1),s=s_gi(s_account);var e="";if(e=d?"event30,":"event5,",a.match(/dropdown(?!_premium)/))e=d?"event31,":"event6,";else{if(!d)switch(BookingBuddy.searchMode){case"air":e+="event33,";break;case"hotel":e+="event34,";break;case"car":e+="event35,";break;case"vacation":e+="event36,";break;case"cruise":e+="event37,";break;case"vacation_rental":e+="event38,"}var f=BookingBuddy.getCookie("v40mode"),g=null===f?[]:stm.parseJSON(f),h=-1==$j.inArray(BookingBuddy.searchMode,g);h&&(e+="event40,",g.push(BookingBuddy.searchMode),BookingBuddy.createCookie("v40mode",JSON.stringify(g)))}e+="event7,","string"==typeof b&&0===b.indexOf("i")&&(b=b.substr(1)),"undefined"==typeof is_promo_page||is_promo_page===!1?bb_product_id="bb_"+b:bb_product_id="bb_lp_"+b;var i=BBAd.singleton(b),j=i.getMetaData("currency_code");s.currencyCode=j?j:"USD",s.linkTrackVars="products,events",d||(e+="purchase"),s.linkTrackEvents=e;var k=BookingBuddy.getCookie("blocker_alert");1==k&&"bookingbuddy.co.uk"!==BookingBuddy.domain&&(s.eVar8="blocker_search",s.linkTrackVars+=",eVar8",BookingBuddy.createCookie("blocker_alert",0)),"string"==typeof test_affiliate&&(s.eVar18=test_affiliate,s.linkTrackVars+=",eVar18"),"time"!=BookingBuddy.getCookie("entry_time")&&(s.eVar11=BookingBuddy.getESTHour(),s.linkTrackVars+=",eVar11"),BookingBuddy.createCookie("entry_time","time"),s.products=";"+bb_product_id+";1;"+i.getMetaData("tracking_hash"),s.events=e;var l=null;if(("bookingbuddy.co.uk"==BookingBuddy.domain||"bookingbuddy.in"==BookingBuddy.domain)&&"air"==BookingBuddy.searchMode){var m=$j("#air_departure_city").val();l=$j("#air_arrival_city").val();var n=m,o=l,p=l.indexOf("(");-1!=p&&(o=l.substr(p+1,3)),p=m.indexOf("("),-1!=p&&(n=m.substr(p+1,3)),n&&o&&(s.linkTrackVars+=",eVar21",s.eVar21="Air | DEP - "+n+" | ARR - "+o)}if("bookingbuddy.co.uk"==BookingBuddy.domain&&"hotel"==BookingBuddy.searchMode&&(l=$j("#hotel_arrival_city").val(),l&&(s.linkTrackVars+=",eVar21",s.eVar21="Hotel | "+l)),"bookingbuddy.co.uk"==BookingBuddy.domain){var q=getBrowserInfo(),r=q.name,t=q.version,u=0,v=0,w="";if(a.match(/\bdropdown\b/))w="dropdown";else if(a.match(/\btargeted_priced\b/))w="pricedad";else if(a.match(/\btargeted\b/)){var x=BookingBuddy.UK.checkboxTrackingInfo;w=x.from_lightbox?"lightbox":"checkbox",u=x.current,v=x.total}var y=r+t+"|"+w+"|"+u+" of "+v+"|"+bb_product_id;s.linkTrackVars+=",eVar33",s.eVar33=y}var z=new Date;s.purchaseID=Math.floor(999999*Math.random()+1)+""+z.getTime(),s.pageName&&(s.eVar25=s.pageName,s.linkTrackVars+=",eVar25"),s.channel&&(s.eVar24=s.channel,s.linkTrackVars+=",eVar24"),s.tl(!0,"o",a),s.linkTrackVars="None",s.linkTrackEvents="None"}function getBrowserInfo(){var a,b,c=navigator.userAgent,d=navigator.appName,e=""+parseFloat(navigator.appVersion);-1!=(b=c.indexOf("MSIE"))?(d="Microsoft Internet Explorer",e=c.substring(b+5)):-1!=(b=c.indexOf("Opera"))?(d="Opera",e=c.substring(b+6)):-1!=(b=c.indexOf("Chrome"))?(d="Chrome",e=c.substring(b+7)):-1!=(b=c.indexOf("Safari"))?(d="Safari",e=c.substring(b+7)):-1!=(b=c.indexOf("Firefox"))?(d="Firefox",e=c.substring(b+8)):(a=c.lastIndexOf(" ")+1)<(b=c.lastIndexOf("/"))&&(d=c.substring(a,b),e=c.substring(b+1),d.toLowerCase()==d.toUpperCase()&&(d=navigator.appName)),e=e.match(/^\d+\.\d+/);var f={name:d,version:e};return f}function omnitureTrackBBRecentSearches(a){s=s_gi(s_account),s.eVar13="Recent Search - "+a.toUpperCase(),s.linkTrackVars="eVar13",s.linkTrackEvents="None",s.tl(!0,"o","A recent search has been clicked."),s.linkTrackVars="None",s.linkTrackEvents="None",s.eVar13=""}function blockedPopUp(){trackPopUpBlocker("search")}function trackPopUpBlocker(a){var b=BookingBuddy.getCookie("blocker_alert");1!=b&&(s=s_gi(s_account),s.linkTrackVars="eVar8",s.linkTrackEvents="None",s.eVar8="deal"==a?"deal_blocker_alert":"blocker_alert",s.tl(!0,"o","deal"==a?"Deal click blocked by popup blocker":"Search blocked by popup blocker"),s.linkTrackVars="None",s.linkTrackEvents="None",s.eVar8="",BookingBuddy.createCookie("blocker_alert",1))}function trackVendorLink(a,b){s=s_gi(s_account);var c=new Date;s.purchaseID=Math.floor(999999*Math.random()+1)+""+c.getTime(),s.linkTrackVars="products,events",s.linkTrackEvents="purchase,event27",s.products=b,s.events="purchase,","string"==typeof test_affiliate&&(s.eVar18=test_affiliate,s.linkTrackVars+=",eVar18"),-1!=b.indexOf("afs")?(s.events+="event27",s.linkTrackEvents+=",event27"):(s.events+="event22",s.linkTrackEvents+=",event22"),s.currencyCode="USD",s.channel&&(s.eVar24=s.channel,s.linkTrackVars+=",eVar24"),s.pageName&&(s.eVar25=s.pageName,s.linkTrackVars+=",eVar25"),s.tl(!0,"o","Vendor Click")}function omnitureDartClick(a){var b="",c="";c="bb_disp"+BookingBuddy.searchMode+"_1",b=";"+c+";1;"+c,trackVendorLink(a,b)}function omnitureTACheckRatesClick(a){var b="",c="",d=null,e=a.split("_");switch(4==e.length&&(d=e[3]),BookingBuddy.domain){case"bookingbuddy.co.uk":c="bbuk_taad_1";break;default:c="bb_taad_1"}$j.isNullOrUndefined(d)&&(d=c),b=";"+c+";1;"+d,trackVendorLink(a,b),trackLinkShareClick("tacheckrates")}function trackAIMThumbnailClick(){var a="";switch(BookingBuddy.domain){case"bookingbuddy.com":a=";bb_taaim_1;1;bb_taaim_1";break;case"bookingbuddy.co.uk":a=";bbuk_taaim_1;1;bbuk_taaim_1";break;default:a=";taaim_1;1;taaim_1"}trackVendorLink("",a)}function trackHolidayPriceClick(){s=s_gi(s_account);var a=new Date;s.purchaseID=Math.floor(999999*Math.random()+1)+""+a.getTime(),s.linkTrackVars="products,events",s.linkTrackEvents="purchase,event22",s.events="purchase,event22",s.products=";bbuk_prhol_1;1;bbuk_prhol_1",s.currencyCode="GBP",s.channel&&(s.eVar24=s.channel,s.linkTrackVars+=",eVar24"),s.pageName&&(s.eVar25=s.pageName,s.linkTrackVars+=",eVar25"),s.tl(!0,"o","Vendor Click")}function trackTravelInsuranceClick(){s=s_gi(s_account);var a=new Date;s.purchaseID=Math.floor(999999*Math.random()+1)+""+a.getTime(),s.linkTrackVars="products,events",s.linkTrackEvents="purchase,event22",s.events="purchase,event22",s.products=";bbuk_ins_1;1;bbuk_ins_1",s.currencyCode="GBP",s.channel&&(s.eVar24=s.channel,s.linkTrackVars+=",eVar24"),s.pageName&&(s.eVar25=s.pageName,s.linkTrackVars+=",eVar25"),s.tl(!0,"o","Vendor Click")}function omnitureBBDDealClick(a,b,c){s=s_gi(s_account),s.linkTrackVars="products,events,server",s.linkTrackEvents="purchase,event16,event24";var d=BookingBuddy.getCookie("blocker_alert");1==d&&(s.eVar8="blocker_deal",s.linkTrackVars+=",eVar8",BookingBuddy.createCookie("blocker_alert",0)),"time"!=BookingBuddy.getCookie("entry_time")&&(s.eVar11=BookingBuddy.getESTHour(),s.linkTrackVars+=",eVar11"),"string"==typeof test_affiliate&&(s.eVar18=test_affiliate,s.linkTrackVars+=",eVar18"),BookingBuddy.createCookie("entry_time","time"),s.channel&&(s.eVar24=s.channel,s.linkTrackVars+=",eVar24"),s.pageName&&(s.eVar25=s.pageName,s.linkTrackVars+=",eVar25"),s.products=";"+b+";1;"+b,s.events="purchase,event16,event24";var e=new Date;s.purchaseID=Math.floor(999999*Math.random()+1)+""+e.getTime(),s.lnk=s_co(a),s.tl(!0,"o","BBDN Deal Click")}function omnitureDealClick(a,b,c,d){s=s_gi(s_account),s.linkTrackVars="products,events,server",s.linkTrackEvents="purchase,event16,event24";var e=BookingBuddy.getCookie("blocker_alert");1==e&&(s.eVar8="blocker_deal",s.linkTrackVars+=",eVar8",BookingBuddy.createCookie("blocker_alert",0)),"time"!=BookingBuddy.getCookie("entry_time")&&(s.eVar11=BookingBuddy.getESTHour(),s.linkTrackVars+=",eVar11"),"string"==typeof test_affiliate&&(s.eVar18=test_affiliate,s.linkTrackVars+=",eVar18"),BookingBuddy.createCookie("entry_time","time"),s.channel&&(s.eVar24=s.channel,s.linkTrackVars+=",eVar24"),s.pageName&&(s.eVar25=s.pageName,s.linkTrackVars+=",eVar25"),s.products=";"+b+";1;"+d,s.events="purchase,event16,event24";var f=new Date;s.purchaseID=Math.floor(999999*Math.random()+1)+""+f.getTime(),s.tl(!0,"o","BBDN Deal Click"),trackLinkShareClick("bbdn")}function omnitureSendEvents(a,b){s=s_gi(s_account),s.linkTrackVars="events",s.linkTrackEvents=a,s.events=a,s.tl(!0,"o",b),s.linkTrackVars="",s.linkTrackEvents="",s.events=""}function omnitureSendEvar(a,b){s=s_gi(s_account),s.linkTrackVars=a,s[a]=b,s.tl(!0,"o",b),s.linkTrackVars=""}function openDealWindow(a,b){var c=$j(b);c[0]&&c.addClass("visited");var d=new Date,e="bb_deal_"+d.getTime(),f="status=1,toolbar=1,location=1,menubar=1,resizable=1,scrollbars=1,height=700,width=925,top=35,left=0",g=window.open(a,e,f);return g?!0:(trackPopUpBlocker("deal"),BookingBuddy.Search.showBlockedPopUpMessage("BookingBuddyDealsBlockedPopUpDivID"),!1)}function openInfoPopup(a,b,c,d){d||(d="scrollbars=1,resizable=1,width=460,height=300");var e=window.open("/popup.php?id="+a+"&title="+b,c,d);e&&e.focus()}function openLinkInNewWindow(a,b){return a.href?($j.emptyString(b)?b="nl_sample":"undefined"!=typeof useRefactoredOmni?BookingBuddy.Tracking.trackVendorLink(b):trackVendorLink(a,b),window.open(a.href,b,"scrollbars=1,resizable=1,width=750,height=800,toolbar=yes")?!1:!0):!0}function setEngagementCookie(){BookingBuddy.getCookie("engage")||BookingBuddy.createCookie("engage","engage")}function trackOrganicSource(a){var b=BookingBuddy.getCookie("BBsprop10");if(b&&(s.prop10=b),!BookingBuddy.getQSParam("source")){var c=document.referrer.split("?");if(0!==c.length){var d=null,e=null;(d=/^http:\/\/www.google.(.+?)\//i.exec(c[0]))?e="org_google":(d=/^http:\/\/(.+?)earch.yahoo.com\/search/i.exec(c[0]))?e="org_yahoo":(d=/^http:\/\/www.bing.(.+?)\/search/i.exec(c[0]))?e="org_bing":(d=/^http:\/\/.+?aol.(.+?)\/aol\/search/i.exec(c[0]))&&(e="org_aol"),null!==e&&(a.eVar7=s.eVar9=s.campaign=s.prop10=e,BookingBuddy.createCookie("BBsprop10",s.prop10))}}}function trackEntryTime(a){if("time"!=BookingBuddy.getCookie("entry_time")&&(a.eVar11=BookingBuddy.getESTHour(),a.linkTrackVars+=",eVar11"),BookingBuddy.createCookie("entry_time","time"),1!=BookingBuddy.getCookie("last_visited_sent")){var b=new Date;if(BookingBuddy.getCookie("last_visited")){var c=b.getTime()-BookingBuddy.getCookie("last_visited"),d=Math.floor(c/864e5);a.eVar28=d}BookingBuddy.createCookie("last_visited",b.getTime(),525600)}BookingBuddy.createCookie("last_visited_sent",1,30)}function trackDealsPopunderClicks(){s=s_gi(s_account),s.eVar14="Vacation Cross Promotion",s.linkTrackVars="eVar14",s.linkTrackEvents="None",s.tl(!0,"o","BB Deal Popunder Click")}function trackBBUKProductImpressions(a){var b=$j("#"+BookingBuddy.searchMode+"_departure_city").length>0?$j("#"+BookingBuddy.searchMode+"_departure_city").val():!1,c=$j("#"+BookingBuddy.searchMode+"_arrival_city").length>0?$j("#"+BookingBuddy.searchMode+"_arrival_city").val():!1;(BookingBuddy.UK.step2displayed||$j("#targetingNoStep2").length>0)&&a.length>0&&c&&(b===!1||""!==b)&&(s=s_gi(s_account),s.events="prodView",s.products=";bb_"+a.join(",;bb_"),s.linkTrackVars="products,events",s.channel&&(s.eVar24=s.channel,s.linkTrackVars+=",eVar24"),s.pageName&&(s.eVar25=s.pageName,s.linkTrackVars+=",eVar25"),s.linkTrackEvents="prodView",s.tl(!0,"o","BBUK tracking"))}function trackSiteSectionVisit(a){var b=BookingBuddy.getCookie("vss_mode"),c=null===b?[]:stm.parseJSON(b),d=-1==$j.inArray(a,c);d&&(omnitureSendEvents("event39","Site Section Visited - "+a),c.push(a),BookingBuddy.createCookie("vss_mode",JSON.stringify(c)))}function trackLinkShareClick(a){if(!$j.isNullOrUndefined(BookingBuddy.getCookie("linkshare"))){var b={click_id:a};$j.asyncLoad("#linkshare_click_"+a,"linkshare_tracking",function(){},b)}}function getCheckRatesCheckedProviderList(a){var b="";return a&&a.length||(a=$j("form#hotelcheckrates_form .check_rates_checkbox_input:visible:checked")),a&&a.length&&a.each(function(a,c){var d=$j(c).parent().text();d=d.replace(/^\s\s*/,"").replace(/\s\s*$/,""),b+=b?","+d:d}),b}function trackCheckRatesClickStream(a,b){a||(a=getCheckRatesCheckedProviderList()),from_date=$j("#hotelcheckrates_date1").val(),to_date=$j("#hotelcheckrates_date2").val(),from_date||to_date||(from_date=$j("#hotelcheckrates_arrival_date").val(),to_date=$j("#hotelcheckrates_departure_date").val()),from_date||to_date||!b||(from_date=$j(b).find(".departureDate").val(),to_date=$j(b).find(".returnDate").val()),STMClickstream.trackCheckRatesClick($j("#siteRedirectUrl").text(),$j("#TACheckRatesMCID").text(),a,from_date,to_date,"")}
//# sourceMappingURL=bb-tracking.nano.js.map
var STMTracking=Object.subClass({delegate:null,delegate_img:null,events:null,init_done:!1,link_tracking:null,variables:null,init:function(a,b){window.omnitureLogging&&window.omnitureLogging(),this.clear(),this.delegate=a,this.setProperty("trackingServer",b)},isEventSet:function(a){return!$j.isNullOrUndefined(this.events[a])},setEvent:function(a){return $j.isString(a)&&(this.events[a]=!0,this.setTrackVar("events")),this},getVariable:function(a){return $j.isUndefined(this.variables[a])?null:this.variables[a]},setVariable:function(a,b){return $j.isString(a)&&(this.variables[a]=b,this.setTrackVar(a)),this},getProperty:function(a){return $j.isUndefined(this.delegate[a])?null:this.delegate[a]},setProperty:function(a,b){return $j.isString(a)&&(this.delegate[a]=b),this},setTrackVar:function(a){return this.link_tracking[a]=!0,this},_setSendParams:function(a,b,c){var d=$j.getKeys(a).join(",");return this.setProperty("linkTrackEvents",d),this.setProperty("events",d),$j.each(b,$j.proxy(function(a,b){this.setProperty(a,b)},this)),this.setProperty("linkTrackVars",$j.getKeys(c).join(",")),this},_getTrackingImage:function(){if(null!==this.delegate_img)return this.delegate_img;var a="s_i_"+this.delegate.fun;return $j.isUndefined(this.delegate.wd[a])?null:this.delegate.wd[a]},setup:function(){if(this.init_done)return this;this._setSendParams(this.events,this.variables,this.link_tracking),this.delegate.t(),this.reset();var a=this._getTrackingImage(),b=$j.proxy(function(){this.init_done=!0,$j.publish("/stmtracking/init")},this);return a&&$j(a).one("load",b),this.clear()},send:function(a){var b=$j.extend({},this.events),c=$j.extend({},this.variables),d=$j.extend({},this.link_tracking),e=$j.proxy(function(){this._setSendParams(b,c,d),this.delegate.tl(!0,"o",a),this.reset()},this);return this.init_done?e():$j.subscribe("/stmtracking/init",e),this.clear()},clear:function(){return this.variables={},this.events={},this.link_tracking={},this},reset:function(){return this.setProperty("linkTrackVars",""),this.setProperty("linkTrackEvents",""),this.setProperty("events",""),this.setProperty("purchaseID",""),this},sendEvents:function(a,b){return $j.isString(a)&&(a=a.split(",")),$j.each(a,$j.proxy(function(a,b){this.setEvent(b)},this)),this.send(b),this},sendVariable:function(a,b){return this.setVariable(a,b),this.send(b),this}});STMTracking.instance=null,STMTracking.singleton=function(a,b,c){if($j.isNullOrUndefined(STMTracking.instance)||"undefined"!=typeof c&&c===!0){if($j.isUndefined(a)||$j.isUndefined(b))throw"STMTracking: cannot initialize: missing tracker object and/or server params";STMTracking.instance=new STMTracking(a,b)}return STMTracking.instance},function(a){a.extend(a.fn,{track:function(b,c){if(!this.length)return this;var d="string"==typeof c?STMTrackingHandlers[c]:c;return a.isUndefined(d)?this:(a(this[0]).bind(b,function(a){try{d(a)}catch(c){throw"STMTracking: failed to run tracking handler for event "+b+": "+c}}),this)}})}(jQuery);var STMTrackingHandlers={};
//# sourceMappingURL=STMTracking.nano.js.map

var STMClickstream={trackTASearchClick:function(a,b,c,d,e,f,g,h,i,j,k){var l=this.parseRDUrl(a,["rd_tags","host","loc1","loc2","ucid","ad_user_tracking"]),m=l.qsParams;a=l.baseUrl;var n=a+"/ajax/?"+(null!==m?$j.param(m):"")+"&service=Log.write&parse_type=hotel-check-rates&crmcid="+b+"&"+c+"="+d+"&from_date="+e+"&to_date="+f+"&window_group_id="+g+"&page="+encodeURIComponent(this.getReferringUrl())+"&trackingHash="+encodeURIComponent(h)+"&sa_ref_req_id="+encodeURIComponent(i)+"&meta_click_id="+encodeURIComponent(j)+"&jsoncallback=?";$j.getJSON(n,{async:!1}).always(function(){k&&k()})},trackCheckRatesClick:function(a,b,c,d,e,f,g){STMClickstream.trackTASearchClick(a,b,"provider_list",c,d,e,f,"","","",g)},trackMetaClick:function(a,b,c,d,e,f,g,h,i,j){STMClickstream.trackTASearchClick(a,b,"vendorId",c,d,e,f,g,h,i,j)},trackTAAIMClick:function(a,b,c){var d=this.parseRDUrl(a,["rd_tags","host","loc1","loc2","ucid","ad_user_tracking"]),e=d.qsParams;a=d.baseUrl;var f=a+"/ajax/?"+(null!==e?$j.param(e):"")+"&service=Log.write&parse_type=ta-aim&aimmcid="+b+"&page="+encodeURIComponent(this.getReferringUrl())+"&jsoncallback=?";$j.getJSON(f,{async:!1}).always(function(){c&&c()})},getNewUUID:function(){for(var a,b="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),c=b,d=new Array(36),e=0,f=0;36>f;f++)8==f||13==f||18==f||23==f?d[f]="-":14==f?d[f]="4":(2>=e&&(e=33554432+16777216*Math.random()|0),a=15&e,e>>=4,d[f]=c[19==f?3&a|8:a]);return d.join("")},parseRDUrl:function(a,b){var c={baseUrl:null,qsParams:null},d=a.indexOf("?");if(-1!==d){var e=a.substring(0,d);if("/"==e.substring(e.length-1)&&(e=e.substring(0,e.length-1)),c.baseUrl=e,b&&b.length>0){var f={};qs=a.substring(d+1),paramPairs=qs.split("&");for(var g=0;g<paramPairs.length;g++)param=paramPairs[g].split("="),2==param.length&&-1!==$j.inArray(param[0],b)&&(f[param[0]]=decodeURIComponent(param[1]));c.qsParams=f}}else"/"==a.substring(a.length-1)&&(a=a.substring(0,a.length-1)),c.baseUrl=a;return c},getReferringUrl:function(){var a=window.location.href;return a?("#"==a.substring(a.length-1)&&(a=a.substring(0,a.length-1)),a):""}};
//# sourceMappingURL=STMClickstream.nano.js.map

function s_c2fe(a){for(var b,c,d,e="",f=0;;){if(b=a.indexOf('"',f),c=a.indexOf("\\",f),d=a.indexOf("\n",f),(0>b||c>=0&&b>c)&&(b=c),(0>b||d>=0&&b>d)&&(b=d),!(b>=0))return e+a.substring(f);e+=(b>f?a.substring(f,b):"")+(b==d?"\\n":"\\"+a.substring(b,b+1)),f=b+1}return a}function s_c2fa(a){for(var b,c=a.indexOf("(")+1,d=a.indexOf(")"),e="";c>=0&&d>c;)b=a.substring(c,c+1),","==b?e+='","':"\n\r	 ".indexOf(b)<0&&(e+=b),c++;return e?'"'+e+'"':e}function s_c2f(cc){cc=""+cc;var fc="var f=new Function(",s=cc.indexOf(";",cc.indexOf("{")),e=cc.lastIndexOf("}"),o,a,d,q,c,f,h,x;for(fc+=s_c2fa(cc)+',"var s=new Object;',c=cc.substring(s+1,e),s=c.indexOf("function");s>=0;){for(d=1,q="",x=0,f=c.substring(s),a=s_c2fa(f),e=o=c.indexOf("{",s),e++;d>0;)h=c.substring(e,e+1),q?(h!=q||x||(q=""),x="\\"==h?x?0:1:0):(('"'==h||"'"==h)&&(q=h),"{"==h&&d++,"}"==h&&d--),d>0&&e++;c=c.substring(0,s)+"new Function("+(a?a+",":"")+'"'+s_c2fe(c.substring(o+1,e))+'")'+c.substring(e+1),s=c.indexOf("function")}return fc+=s_c2fe(c)+';return s");',eval(fc),f}function s_gi(un,pg,ss){var c="function s_c(un,pg,ss){var s=this;s.wd=window;s.pageImages=[];if(!s.wd.s_c_in){s.wd.s_c_il=new Array;s.wd.s_c_in=0;}s._il=s.wd.s_c_il;s._in=s.wd.s_c_in;s._il[s._in]=s;s.wd.s_c_in++;s.m=function(m){return (''+m).indexOf('{')<0};s.fl=function(x,l){return x?(''+x).substring(0,l):x};s.co=function(o){if(!o)return o;var n=new Object,x;for(x in o)if(x.indexOf('select')<0&&x.indexOf('filter')<0)n[x]=o[x];return n};s.num=function(x){x=''+x;for(var p=0;p<x.length;p++)if(('0123456789').indexOf(x.substring(p,p+1))<0)return 0;return 1};s.rep=function(x,o,n){var i=x.indexOf(o);while(x&&i>=0){x=x.substring(0,i)+n+x.substring(i+o.length);i=x.indexOf(o,i+n.length)}return x};s.ape=function(x){var s=this,h='0123456789ABCDEF',i,c=s.charSet,n,l,e,y='';c=c?c.toUpperCase():'';if(x){x=''+x;if(c=='AUTO'&&('').charCodeAt){for(i=0;i<x.length;i++){c=x.substring(i,i+1);n=x.charCodeAt(i);if(n>127){l=0;e='';while(n||l<4){e=h.substring(n%16,n%16+1)+e;n=parseInt(n/16);l++}y+='%u'+e}else if(c=='+')y+='%2B';else y+=escape(c)}x=y}else{x=x?s.rep(escape(''+x),'+','%2B'):x;if(x&&c&&s.em==1&&x.indexOf('%u')<0&&x.indexOf('%U')<0){i=x.indexOf('%');while(i>=0){i++;if(h.substring(8).indexOf(x.substring(i,i+1).toUpperCase())>=0)return x.substring(0,i)+'u00'+x.substring(i);i=x.indexOf('%',i)}}}}return x};s.epa=function(x){var s=this;return x?unescape(s.rep(''+x,'+',' ')):x};\ns.pt=function(x,d,f,a){\n  var s=this,t=x,z=0,y,r;\n  while(t){\n    y=t.indexOf(d);\n    y=y<0?t.length:y;\n    t=t.substring(0,y);\n    r=s.m(f)?s[f](t,a):f(t,a);\n    if(r)\n      return r;\n    z+=y+d.length;\n    t=x.substring(z,x.length);\n    t=z<x.length?t:''\n  }\n  return ''\n};\ns.isf=function(t,a){var c=a.indexOf(':');if(c>=0)a=a.substring(0,c);if(t.substring(0,2)=='s_')t=t.substring(2);return (t!=''&&t==a)};s.fsf=function(t,a){var s=this;if(s.pt(a,',','isf',t))s.fsg+=(s.fsg!=''?',':'')+t;return 0};s.fs=function(x,f){var s=this;s.fsg='';s.pt(x,',','fsf',f);return s.fsg};s.c_d='';s.c_gdf=function(t,a){var s=this;if(!s.num(t))return 1;return 0};s.c_gd=function(){var s=this,d=s.wd.location.hostname,n=s.fpCookieDomainPeriods,p;if(!n)n=s.cookieDomainPeriods;if(d&&!s.c_d){n=n?parseInt(n):2;n=n>2?n:2;p=d.lastIndexOf('.');if(p>=0){while(p>=0&&n>1){p=d.lastIndexOf('.',p-1);n--}s.c_d=p>0&&s.pt(d,'.','c_gdf',0)?d.substring(p):d}}return s.c_d};s.c_r=function(k){var s=this;k=s.ape(k);var c=' '+s.d.cookie,i=c.indexOf(' '+k+'='),e=i<0?i:c.indexOf(';',i),v=i<0?'':s.epa(c.substring(i+2+k.length,e<0?c.length:e));return v!='[[B]]'?v:''};s.c_w=function(k,v,e){var s=this,d=s.c_gd(),l=s.cookieLifetime,t;v=''+v;l=l?(''+l).toUpperCase():'';if(e&&l!='SESSION'&&l!='NONE'){t=(v!=''?parseInt(l?l:0):-60);if(t){e=new Date;e.setTime(e.getTime()+(t*1000))}}if(k&&l!='NONE'){s.d.cookie=k+'='+s.ape(v!=''?v:'[[B]]')+'; path=/;'+(e&&l!='SESSION'?' expires='+e.toGMTString()+';':'')+(d?' domain='+d+';':'');return s.c_r(k)==v}return 0};s.eh=function(o,e,r,f){var s=this,b='s_'+e+'_'+s._in,n=-1,l,i,x;if(!s.ehl)s.ehl=new Array;l=s.ehl;for(i=0;i<l.length&&n<0;i++){if(l[i].o==o&&l[i].e==e)n=i}if(n<0){n=i;l[n]=new Object}x=l[n];x.o=o;x.e=e;f=r?x.b:f;if(r||f){x.b=r?0:o[e];x.o[e]=f}if(x.b){x.o[b]=x.b;return b}return 0};s.cet=function(f,a,t,o,b){var s=this,r;if(s.apv>=5&&(!s.isopera||s.apv>=7))eval('try{r=s.m(f)?s[f](a):f(a)}catch(e){r=s.m(t)?s[t](e):t(e)}');else{if(s.ismac&&s.u.indexOf('MSIE 4')>=0)r=s.m(b)?s[b](a):b(a);else{s.eh(s.wd,'onerror',0,o);r=s.m(f)?s[f](a):f(a);s.eh(s.wd,'onerror',1)}}return r};s.gtfset=function(e){var s=this;return s.tfs};s.gtfsoe=new Function('e','var s=s_c_il['+s._in+'];s.eh(window,\"onerror\",1);s.etfs=1;var c=s.t();if(c)s.d.write(c);s.etfs=0;return true');s.gtfsfb=function(a){return window};s.gtfsf=function(w){var s=this,p=w.parent,l=w.location;s.tfs=w;if(p&&p.location!=l&&p.location.host==l.host){s.tfs=p;return s.gtfsf(s.tfs)}return s.tfs};s.gtfs=function(){var s=this;if(!s.tfs){s.tfs=s.wd;if(!s.etfs)s.tfs=s.cet('gtfsf',s.tfs,'gtfset',s.gtfsoe,'gtfsfb')}return s.tfs};\ns.mr=function(sess,q,ta){\n  var s=this,dc=s.dc,t1=s.trackingServer,t2=s.trackingServerSecure,ns=s.visitorNamespace,\n    unc=s.rep(s.fun,'_','-'),imn='s_i_'+s.fun,im,b,e,\n    rs='http'+(s.ssl?'s':'')+'://'+(t1?(s.ssl&&t2?t2:t1):((ns?ns:(s.ssl?'102':unc))+'.'+(s.dc?s.dc:112)+'.2o7.net'))+'/b/ss/'+s.un+'/1/H.10-Pdvu-2/'+sess+'?[AQB]&ndh=1'+(q?q:'')+(s.q?s.q:'')+'&[AQE]';\n  if(s.isie&&!s.ismac){\n    if(s.apv>5.5)\n      rs=s.fl(rs,4095);\n    else\n      rs=s.fl(rs,2047)\n  }\n  if(s.d.images&&s.apv>=3&&(!s.isopera||s.apv>=7)&&(s.ns6<0||s.apv>=6.1)){\n    im=s.wd[imn]=new Image;\n    im.src=rs;\n    s.pageImages[s.pageImages.length]=im;\n    if(rs.indexOf('&pe=')>=0&&(!ta||ta=='_self'||ta=='_top'||(s.wd.name&&ta==s.wd.name))){\n      b=e=new Date;\n      while(e.getTime()-b.getTime()<500)\n    e=new Date\n    }\n    return ''\n  }\n  return '<im'+'g sr'+'c=\"'+rs+'\" width=1 height=1 border=0 alt=\"\">'\n};\ns.gg=function(v){var s=this;return s.wd['s_'+v]};s.glf=function(t,a){if(t.substring(0,2)=='s_')t=t.substring(2);var s=this,v=s.gg(t);if(v)s[t]=v};\ns.gl=function(v){\n  var s=this;\n  if(s.pg)\n    s.pt(v,',','glf',0)\n};\ns.gv=function(v){var s=this;return s['vpm_'+v]?s['vpv_'+v]:(s[v]?s[v]:'')};s.havf=function(t,a){var s=this,b=t.substring(0,4),x=t.substring(4),n=parseInt(x),k='g_'+t,m='vpm_'+t,q=t,v=s.linkTrackVars,e=s.linkTrackEvents;s[k]=s.gv(t);if(s.lnk||s.eo){v=v?v+','+s.vl_l:'';if(v&&!s.pt(v,',','isf',t))s[k]='';if(t=='events'&&e)s[k]=s.fs(s[k],e)}s[m]=0;if(t=='visitorID')q='vid';else if(t=='pageURL'){q='g';s[k]=s.fl(s[k],255)}else if(t=='referrer'){q='r';s[k]=s.fl(s[k],255)}else if(t=='vmk')q='vmt';else if(t=='charSet'){q='ce';if(s[k]&&s[k].toUpperCase()=='AUTO')s[k]='ISO8859-1';else if(s[k]&&s.em==2)s[k]='UTF-8'}else if(t=='visitorNamespace')q='ns';else if(t=='cookieDomainPeriods')q='cdp';else if(t=='cookieLifetime')q='cl';else if(t=='variableProvider')q='vvp';else if(t=='currencyCode')q='cc';else if(t=='channel')q='ch';else if(t=='transactionID')q='xact';else if(t=='campaign')q='v0';else if(s.num(x)){if(b=='prop')q='c'+n;else if(b=='eVar')q='v'+n;else if(b=='hier'){q='h'+n;s[k]=s.fl(s[k],255)}}if(s[k]&&t!='linkName'&&t!='linkType')s.qav+='&'+q+'='+s.ape(s[k]);return ''};s.hav=function(){var s=this;s.qav='';s.pt(s.vl_t,',','havf',0);return s.qav};s.lnf=function(t,h){t=t?t.toLowerCase():'';h=h?h.toLowerCase():'';var te=t.indexOf('=');if(t&&te>0&&h.indexOf(t.substring(te+1))>=0)return t.substring(0,te);return ''};s.ln=function(h){var s=this,n=s.linkNames;if(n)return s.pt(n,',','lnf',h);return ''};s.ltdf=function(t,h){t=t?t.toLowerCase():'';h=h?h.toLowerCase():'';var qi=h.indexOf('?');h=qi>=0?h.substring(0,qi):h;if(t&&h.substring(h.length-(t.length+1))=='.'+t)return 1;return 0};s.ltef=function(t,h){t=t?t.toLowerCase():'';h=h?h.toLowerCase():'';if(t&&h.indexOf(t)>=0)return 1;return 0};s.lt=function(h){var s=this,lft=s.linkDownloadFileTypes,lef=s.linkExternalFilters,lif=s.linkInternalFilters;lif=lif?lif:s.wd.location.hostname;h=h.toLowerCase();if(s.trackDownloadLinks&&lft&&s.pt(lft,',','ltdf',h))return 'd';if(s.trackExternalLinks&&(lef||lif)&&(!lef||s.pt(lef,',','ltef',h))&&(!lif||!s.pt(lif,',','ltef',h)))return 'e';return ''};s.lc=new Function('e','var s=s_c_il['+s._in+'],b=s.eh(this,\"onclick\");s.lnk=s.co(this);s.t();s.lnk=0;if(b)return this[b](e);return true');s.bc=new Function('e','var s=s_c_il['+s._in+'],f;if(s.d&&s.d.all&&s.d.all.cppXYctnr)return;s.eo=e.srcElement?e.srcElement:e.target;eval(\"try{if(s.eo&&(s.eo.tagName||s.eo.parentElement||s.eo.parentNode))s.t()}catch(f){}\");s.eo=0');s.ot=function(o){var a=o.type,b=o.tagName;return (a&&a.toUpperCase?a:b&&b.toUpperCase?b:o.href?'A':'').toUpperCase()};s.oid=function(o){var s=this,t=s.ot(o),p=o.protocol,c=o.onclick,n='',x=0;if(!o.s_oid){if(o.href&&(t=='A'||t=='AREA')&&(!c||!p||p.toLowerCase().indexOf('javascript')<0))n=o.href;else if(c){n=s.rep(s.rep(s.rep(s.rep(''+c,\"\\r\",''),\"\\n\",''),\"\\t\",''),' ','');x=2}else if(o.value&&(t=='INPUT'||t=='SUBMIT')){n=o.value;x=3}else if(o.src&&t=='IMAGE')n=o.src;if(n){o.s_oid=s.fl(n,100);o.s_oidt=x}}return o.s_oid};s.rqf=function(t,un){var s=this,e=t.indexOf('='),u=e>=0?','+t.substring(0,e)+',':'';return u&&u.indexOf(','+un+',')>=0?s.epa(t.substring(e+1)):''};s.rq=function(un){var s=this,c=un.indexOf(','),v=s.c_r('s_sq'),q='';if(c<0)return s.pt(v,'&','rqf',un);return s.pt(un,',','rq',0)};s.sqp=function(t,a){var s=this,e=t.indexOf('='),q=e<0?'':s.epa(t.substring(e+1));s.sqq[q]='';if(e>=0)s.pt(t.substring(0,e),',','sqs',q);return 0};s.sqs=function(un,q){var s=this;s.squ[un]=q;return 0};s.sq=function(q){var s=this,k='s_sq',v=s.c_r(k),x,c=0;s.sqq=new Object;s.squ=new Object;s.sqq[q]='';s.pt(v,'&','sqp',0);s.pt(s.un,',','sqs',q);v='';for(x in s.squ)s.sqq[s.squ[x]]+=(s.sqq[s.squ[x]]?',':'')+x;for(x in s.sqq)if(x&&s.sqq[x]&&(x==q||c<2)){v+=(v?'&':'')+s.sqq[x]+'='+s.ape(x);c++}return s.c_w(k,v,0)};s.wdl=new Function('e','var s=s_c_il['+s._in+'],r=true,b=s.eh(s.wd,\"onload\"),i,o,oc;if(b)r=this[b](e);for(i=0;i<s.d.links.length;i++){o=s.d.links[i];oc=o.onclick?\"\"+o.onclick:\"\";if((oc.indexOf(\"s_gs(\")<0||oc.indexOf(\".s_oc(\")>=0)&&oc.indexOf(\".tl(\")<0)s.eh(o,\"onclick\",0,s.lc);}return r');s.wds=function(){var s=this;if(s.apv>3&&(!s.isie||!s.ismac||s.apv>=5)){if(s.b&&s.b.attachEvent)s.b.attachEvent('onclick',s.bc);else if(s.b&&s.b.addEventListener)s.b.addEventListener('click',s.bc,false);else s.eh(s.wd,'onload',0,s.wdl)}};s.vs=function(x){var s=this,v=s.visitorSampling,g=s.visitorSamplingGroup,k='s_vsn_'+s.un+(g?'_'+g:''),n=s.c_r(k),e=new Date,y=e.getYear();e.setYear(y+10+(y<1900?1900:0));if(v){v*=100;if(!n){if(!s.c_w(k,x,e))return 0;n=x}if(n%10000>v)return 0}return 1};s.dyasmf=function(t,m){if(t&&m&&m.indexOf(t)>=0)return 1;return 0};s.dyasf=function(t,m){var s=this,i=t?t.indexOf('='):-1,n,x;if(i>=0&&m){var n=t.substring(0,i),x=t.substring(i+1);if(s.pt(x,',','dyasmf',m))return n}return 0};s.uns=function(){var s=this,x=s.dynamicAccountSelection,l=s.dynamicAccountList,m=s.dynamicAccountMatch,n,i;s.un.toLowerCase();if(x&&l){if(!m)m=s.wd.location.host;if(!m.toLowerCase)m=''+m;l=l.toLowerCase();m=m.toLowerCase();n=s.pt(l,';','dyasf',m);if(n)s.un=n}i=s.un.indexOf(',');s.fun=i<0?s.un:s.un.substring(0,i)};s.sa=function(un){var s=this;s.un=un;if(!s.oun)s.oun=un;else if((','+s.oun+',').indexOf(un)<0)s.oun+=','+un;s.uns()};\ns.t=function(){\n  var should_suppress = false;\n  var dc = document.cookie;\n  var prefix = 'bb_watir_test=';\n  var idx = dc.indexOf('; ' + prefix);\n  if (idx != -1) {\n    should_suppress = true;\n  }else{\n    idx = dc.indexOf(prefix);\n    if (idx === 0) {\n      should_suppress = true;\n    }\n  }\n  if(should_suppress){\n    return;\n  }\n  var s=this,trk=1,tm=new Date,sed=Math&&Math.random?Math.floor(Math.random()*10000000000000):tm.getTime(),\n      sess='s'+Math.floor(tm.getTime()/10800000)%10+sed,yr=tm.getYear(),\n      vt=tm.getDate()+'/'+tm.getMonth()+'/'+(yr<1900?yr+1900:yr)+' '+tm.getHours()+':'+tm.getMinutes()+':'+tm.getSeconds()+' '+tm.getDay()+' '+tm.getTimezoneOffset(),\n      tfs=s.gtfs(),ta='',q='',qs='';\n  s.gl(s.vl_g);\n  s.uns();\n  if(!s.q){\n    var tl=tfs.location,a,o,i,x='',c='',v='',p='',bw='',bh='',j='1.0',k=s.c_w('s_cc','true',0)?'Y':'N',hp='',ct='',\n    pn=0,ps;\n    if(String&&String.prototype){\n      j=\"1.1\";\n      if(j.match){\n    j=\"1.2\";\n    if(tm.setUTCDate){\n      j=\"1.3\";\n      if(s.isie&&s.ismac&&s.apv>=5)\n        j=\"1.4\";\n      if(pn.toPrecision){\n        j=\"1.5\";a=new Array;\n        if(a.forEach){\n          j=\"1.6\";\n          i=0;\n          o=new Object;\n          eval(\"try{i=new Iterator(o)}catch(e){}\");\n          if(i&&i.next)\n        j=\"1.7\"\n        }\n      }\n    }\n      }\n    }\n    if(s.apv>=4)\n      x=screen.width+'x'+screen.height;\n    if(s.isns||s.isopera){\n      if(s.apv>=3){\n    v=s.n.javaEnabled()?'Y':'N';\n    if(s.apv>=4){\n      c=screen.pixelDepth;\n      bw=s.wd.innerWidth;\n      bh=s.wd.innerHeight;\n    }\n      }\n      s.pl=s.n.plugins\n    } else if(s.isie){\n      if(s.apv>=4){\n    v=s.n.javaEnabled()?'Y':'N';\n    c=screen.colorDepth;\n    if(s.apv>=5){\n      bw=s.d.documentElement.offsetWidth;\n      bh=s.d.documentElement.offsetHeight;\n      if(!s.ismac&&s.b){\n        eval(\"try{s.b.addBehavior('#default#homePage');hp=s.b.isHomePage(tl)?'Y':'N'}catch(e){}\");\n        eval(\"try{s.b.addBehavior('#default#clientCaps');ct=s.b.connectionType}catch(e){}\")\n      }\n    }\n      } else\n    r=''\n    }\n    if(s.pl)\n      while(pn<s.pl.length&&pn<30){\n    ps=s.fl(s.pl[pn].name,100)+';';\n    if(p.indexOf(ps)<0)\n      p+=ps;pn++\n      }\n    s.q=(x?'&s='+s.ape(x):'')+(c?'&c='+s.ape(c):'')+(j?'&j='+j:'')+(v?'&v='+v:'')+(k?'&k='+k:'')+(bw?'&bw='+bw:'')+(bh?'&bh='+bh:'')+(ct?'&ct='+s.ape(ct):'')+(hp?'&hp='+hp:'')+(p?'&p='+s.ape(p):'')\n  }\n  if(s.usePlugins)\n    s.doPlugins(s);\n  var l=s.wd.location,r=tfs.document.referrer;\n  if(!s.pageURL)\n    s.pageURL=l;\n  if(!s.referrer)\n    s.referrer=r;\n  if(s.lnk||s.eo){\n    var o=s.eo?s.eo:s.lnk;\n    if(!o)\n      return '';\n    var p=s.gv('pageName'),w=1,t=s.ot(o),n=s.oid(o),x=o.s_oidt,h,l,i,oc;\n    if(s.eo&&o==s.eo){\n      while(o&&!n&&t!='BODY'){\n    o=o.parentElement?o.parentElement:o.parentNode;\n    if(!o)\n      return '';\n    t=s.ot(o);\n    n=s.oid(o);\n    x=o.s_oidt\n      }\n      oc=o.onclick?''+o.onclick:'';\n      if((oc.indexOf(\"s_gs(\")>=0&&oc.indexOf(\".s_oc(\")<0)||oc.indexOf(\".tl(\")>=0)\n    return ''\n    }\n    ta=n?o.target:1;\n    h=o.href?o.href:'';\n    i=h.indexOf('?');\n    h=s.linkLeaveQueryString||i<0?h:h.substring(0,i);\n    l=s.linkName?s.linkName:s.ln(h);\n    t=s.linkType?s.linkType.toLowerCase():s.lt(h);\n    if(t&&(h||l))\n      q+='&pe=lnk_'+(t=='d'||t=='e'?s.ape(t):'o')+(h?'&pev1='+s.ape(h):'')+(l?'&pev2='+s.ape(l):'');\n    else\n      trk=0;\n    if(s.trackInlineStats){\n      if(!p){\n    p=s.gv('pageURL');\n    w=0\n      }\n      t=s.ot(o);\n      i=o.sourceIndex;\n      if(s.gg('objectID')){\n    n=s.gg('objectID');\n    x=1;i=1\n      }\n      if(p&&n&&t)\n    qs='&pid='+s.ape(s.fl(p,255))+(w?'&pidt='+w:'')+'&oid='+s.ape(s.fl(n,100))+(x?'&oidt='+x:'')+'&ot='+s.ape(t)+(i?'&oi='+i:'')\n    }\n  }\n  if(!trk&&!qs)\n    return '';\n  if(s.p_r)\n    s.p_r();\n  var code='';\n  if(trk&&s.vs(sed))\n    code=s.mr(sess,(vt?'&t='+s.ape(vt):'')+s.hav()+q+(qs?qs:s.rq(s.un)),ta);\n  s.sq(trk?'':qs);\n  s.lnk=s.eo=s.linkName=s.linkType=s.wd.s_objectID=s.ppu='';\n  if(s.pg)\n    s.wd.s_lnk=s.wd.s_eo=s.wd.s_linkName=s.wd.s_linkType='';\n  return code\n};s.tl=function(o,t,n){\n  var s=this;\n  s.lnk=s.co(o);\n  s.linkType=t;\n  s.linkName=n;\n  s.t()\n};\ns.ssl=(s.wd.location.protocol.toLowerCase().indexOf('https')>=0);\ns.d=document;\ns.b=s.d.body;\ns.n=navigator;\ns.u=s.n.userAgent;\ns.ns6=s.u.indexOf('Netscape6/');\nvar apn=s.n.appName,v=s.n.appVersion,ie=v.indexOf('MSIE '),o=s.u.indexOf('Opera '),i;\nif(v.indexOf('Opera')>=0||o>0)\n  apn='Opera';\ns.isie=(apn=='Microsoft Internet Explorer');\ns.isns=(apn=='Netscape');\ns.isopera=(apn=='Opera');\ns.ismac=(s.u.indexOf('Mac')>=0);\nif(o>0)\n  s.apv=parseFloat(s.u.substring(o+6));\nelse if(ie>0){\n  s.apv=parseInt(i=v.substring(ie+5));\n  if(s.apv>3)\n    s.apv=parseFloat(i)\n} else if(s.ns6>0)\n  s.apv=parseFloat(s.u.substring(s.ns6+10));\nelse\n s.apv=parseFloat(v);\ns.em=0;\nif(String.fromCharCode){\n  i=escape(String.fromCharCode(256)).toUpperCase();\n  s.em=(i=='%C4%80'?2:(i=='%U0100'?1:0))\n}\ns.sa(un);\ns.vl_l='visitorID,vmk,ppu,charSet,visitorNamespace,cookieDomainPeriods,cookieLifetime,pageName,pageURL,referrer,currencyCode,purchaseID';\ns.vl_t=s.vl_l+',variableProvider,channel,server,pageType,transactionID,campaign,state,zip,events,products,linkName,linkType';\nfor(var n=1;n<100;n++)\n  s.vl_t+=',prop'+n+',eVar'+n+',hier'+n;\ns.vl_g=s.vl_t+',trackDownloadLinks,trackExternalLinks,trackInlineStats,linkLeaveQueryString,linkDownloadFileTypes,linkExternalFilters,linkInternalFilters,linkNames';\ns.pg=pg;\ns.gl(s.vl_g);\nif(!ss)\n  s.wds()\n}\n",l=window.s_c_il,n=navigator,u=n.userAgent,v=n.appVersion,e=v.indexOf("MSIE "),m=u.indexOf("Netscape6/"),a,i,s;if(l)for(i=0;i<l.length;i++){if(s=l[i],s.oun==un)return s;if(s.fs(s.oun,un))return s.sa(un),s}return e>0?(a=parseInt(i=v.substring(e+5)),a>3&&(a=parseFloat(i))):a=m>0?parseFloat(u.substring(m+10)):parseFloat(v),a>=5&&v.indexOf("Opera")<0&&u.indexOf("Opera")<0?(eval(c),new s_c(un,pg,ss)):(s=s_c2f(c))(un,pg,ss)}function s_co(a){var b=s_gi("^",1,1);return b.co(a)}function s_gs(a){var b=s_gi(a,1,1);return b.t()}function s_dc(a){var b=s_gi(a,1);return b.t()}BookingBuddy.Tracking={tracker:null,init:function(){return"undefined"!=typeof isMobile?$j(document).delegate("div[data-role=page]","pageinit",$j.proxy(this.loadOmniture,this)):"undefined"!=typeof useRefactoredOmni?$j("document").ready($j.proxy(this.loadOmniture,this)):this.loadOmniture(),$j(document).ready(function(){$j(document).on("click",'form[data-stm-role="stm.bb.Views.searchForm.Checkrates"] .submitTrigger',function(){BookingBuddy.Tracking.trackShowPricesClick()}),$j(document).on("mouseup",'[data-stm-role="stm.Views.CheckRatesLeaveBehind"] [data-stm-role="submit"]',function(){BookingBuddy.Tracking.trackShowPricesClick()}),$j("div#hotel_results, div.check_rates_wrapper").delegate("form.checkHotelRates.UKLocale .check_rates_btn","click",function(){BookingBuddy.Tracking.trackShowPricesClick()}),$j("div#hotel_results").delegate('form[data-stm-role="stm.bb.Views.searchForm.Checkrates"] button[data-stm-role="submit"]',"click",function(){BookingBuddy.Tracking.trackShowPricesClick()})}),this},loadOmniture:function(a){var b;if(!(stm&&stm.OmnitureConfig&&stm.OmnitureConfig.configDataLoaded&&"no"===stm.OmnitureConfig.configDataLoaded))if("undefined"!=typeof stm&&stm.OmnitureConfig){if(BookingBuddy.Tracking.setupOmniture(stm.OmnitureConfig.account),this.tracker=STMTracking.singleton(s,stm.OmnitureConfig.trackingServer,a),this.tracker.setProperty("pageName",stm.OmnitureConfig.pageName),this.tracker.setVariable("eVar25",stm.OmnitureConfig.pageName),stm.OmnitureConfig.evars){var c=stm.OmnitureConfig.evars,d=c.length,e=null,f=null,g=null;for(b=d;b--;)e=c[b],f=e.name,f=f.replace("s_",""),g=e.value,this.tracker.setVariable(f,g)}if(stm.OmnitureConfig.events){var h=stm.OmnitureConfig.events,i=null;for(b=h.length;b--;)i=h[b],this.tracker.setEvent(i)}if(stm.OmnitureConfig.adImpressionIds){var j=stm.OmnitureConfig.adImpressionIds;j.length&&(this.tracker.setEvent("prodView"),this.tracker.setVariable("products",";bb_"+j.join(",;bb_")),this.tracker.setTrackVar("products"))}var k="none";stm.OmnitureConfig.channel&&(k=stm.OmnitureConfig.channel),this.tracker.setProperty("channel",k),this.tracker.setVariable("eVar24",k),stm.OmnitureConfig.substate&&this.tracker.setProperty("prop9",stm.OmnitureConfig.substate),this.tracker.setEvent("event15"),this.tracker.setVariable("eVar40",stm.OmnitureConfig.expediaSource),this.trackEntryTime(),-1===stm.OmnitureConfig.account.indexOf("slbbuk")&&this.deriveSiteSectionVisitEvent(stm.OmnitureConfig.searchMode,this.tracker),window.disableOnLoadOmniture?(this.tracker.reset(),this.tracker.clear(),this.tracker.init_done=!0):this.tracker.setup(),$j.publish("/bbtracking/init")}else window.s_account&&(this.tracker=STMTracking.singleton(s_gi(s_account),s_trackingServer))},deriveSiteSectionVisitEvent:function(a,b){var c=BookingBuddy.getCookie("vss_mode"),d=null===c?[]:stm.parseJSON(c),e=-1==$j.inArray(a,d);e&&(this.tracker.setEvent("event39"),d.push(a),BookingBuddy.createCookie("vss_mode",JSON.stringify(d)))},trackSiteSectionVisit:function(a){var b=$j.proxy(function(){BookingBuddy.Tracking.deriveSiteSectionVisitEvent(a,this.tracker),this.tracker.send("Site Section Visited - "+a)},this);this.tracker?b():$j.subscribe("/bbtracking/init",b)},trackShowPricesClick:function(){var a=this.tracker;a.setProperty("purchaseID",""),a.setVariable("eVar35","TA Checkrates Show Prices Button II"),a.send("Show Prices click")},trackBBSearch:function(a){var b=2e3,c=200,d=this;$j.each(a,function(a,e){setTimeout(function(){d.trackBBSearchByAdId(e)},b),b+=c})},trackBBSearchByAdId:function(a){var b=this.tracker,c={},d=BookingBuddy.searchMode||"invalid_search_mode",e=BookingBuddy.domain||"invalid_domain",f=null,g=BookingBuddy.getCookie("blocker_alert"),h=BookingBuddy.getCookie("entry_time"),i={air:"event33",hotel:"event34",car:"event35",vacation:"event36",cruise:"event37",vacation_rental:"event38"},j=/\d+/.exec(a),c=BBAd.singleton(j),f="bb_"+j,k=c.getMetaData("tier")||c.getMetaData("tracking_name")||"",l=c.getMetaData("currency_code")||"USD",m=c.getMetaData("tracking_hash"),n=0;if(k.match(/dropdown(?!_premium)/))b.setEvent("event6");else if(b.setEvent("event5"),-1!==e.indexOf("bookingbuddy")){i[d]&&b.setEvent(i[d]);var o=BookingBuddy.getCookie("v40mode"),p=null===o?[]:stm.parseJSON(o),q=-1==$j.inArray(d,p);q&&(b.setEvent("event40"),p.push(d),BookingBuddy.createCookie("v40mode",JSON.stringify(p)))}b.setEvent("event7"),b.setEvent("purchase"),b.setProperty("currencyCode",l).setTrackVar("currencyCode"),"bookingbuddy.co.uk"==e?BookingBuddy.Tracking.trackUKSearchSettings(c):1==g&&(b.setVariable("eVar8","blocker_search"),BookingBuddy.createCookie("blocker_alert",0)),BookingBuddy.Tracking.trackEntryTime(),"time"!=h&&b.setVariable("eVar11",BookingBuddy.getESTHour()),BookingBuddy.createCookie("entry_time","time"),b.setProperty("products",";"+f+";1;"+m).setTrackVar("products"),n=Math.floor(999999*Math.random()+1)+""+Number(new Date),b.setProperty("purchaseID",n).setTrackVar("purchaseID"),s.channel&&b.setVariable("eVar24",s.channel),s.pageName&&b.setVariable("eVar25",s.pageName),BookingBuddy.clickCapping&&b.setVariable("eVar3",BookingBuddy.clickCapping.getClickCount(j)),b.send("BB Search")},trackUKSearchSettings:function(a){var b=this.tracker,c=getBrowserInfo(),d=c.name,e=c.version,f=0,g=0,h="",i="",j=a.getMetaData("tracking_name"),k=BookingBuddy.searchMode,l=a.getID();if("air"==k){var m=$j("#air_departure_city").val(),n=$j("#air_arrival_city").val(),o=m,p=n,q=n.indexOf("(");-1!=q&&(p=n.substr(q+1,3)),q=m.indexOf("("),-1!=q&&(o=m.substr(q+1,3)),o&&p&&b.setVariable("eVar21","Air | DEP - "+o+" | ARR - "+p)}else"hotel"===k&&(n=$j("#hotel_arrival_city").val(),n&&b.setVariable("eVar21","Hotel | "+n));j.match(/\bdropdown\b/)?h="dropdown":j.match(/\btargeted_priced\b/)?h="pricedad":j.match(/\btargeted\b/)?h="checkbox":j.match(/\btab\b/)&&(h="tab"),i=d+e+"|"+h+"|"+f+" of "+g+"|"+l,b.setVariable("eVar33",i)},trackExitDHTMLImpression:function(a){var b=STMTracking.singleton();b.reset(),b.clear(),b.setEvent("prodView"),b.setVariable("products",";bb_"+a),b.setTrackVar("products"),b.send("Exit DHTML Impression")},trackTAMetaSearchVisit:function(){var a=STMTracking.singleton();a.setEvent("event23"),a.send("TA Meta Search Visit")},sendEvar:function(a,b){var c=STMTracking.singleton();c.setVariable(a,b),c.send(b)},trackProductImpression:function(a){var b=this.tracker;a.length>0&&(b.setEvent("prodView"),b.setVariable("products",";bb_"+a.join(",;bb_")),s.channel&&b.setVariable("eVar24",s.channel),s.pageName&&b.setVariable("eVar25",s.pageName),b.send("BB Tracking"))},trackUKProductImpression:function(a){if(a&&0!==a.length){var b=this.tracker;b.setEvent("prodView"),b.setVariable("products",";bb_"+a.join(",;bb_")),s.channel&&b.setVariable("eVar24",s.channel),s.pageName&&b.setVariable("eVar25",s.pageName),b.send("BBUK Tracking")}},trackTACheckrates:function(a,b,c,d,e){var f=[];$j.each(a,function(a,b){var c,d="bookingbuddy.co.uk"===BookingBuddy.domain?"bbuk_taad_2":"bb_taad_2",g=TACheckRates.singleton(b),h=b.split("_"),i=3===h.length?h[2]:!1,j=g.getMetaData("author_name");f.push(j),i||(i=d),c=";"+d+";1;"+i,BookingBuddy.Tracking.trackVendorLink(c,!0,e),BookingBuddy.Tracking.trackLinkShareClick("tacheckrates")}),f.length>0&&!d&&BookingBuddy.Tracking.trackTACheckRatesWithClickStream(f,b,c)},trackTACheckRatesWithClickStream:function(a,b,c,d){STMClickstream.trackCheckRatesClick(BookingBuddy.redirectUrl,BookingBuddy.taCheckRatesMCID,a,BookingBuddy.Tracking.formatDate(b),BookingBuddy.Tracking.formatDate(c),"",d)},trackMetaWithClickStream:function(a,b,c,d,e,f){STMClickstream.trackMetaClick(BookingBuddy.redirectUrl,BookingBuddy.taCheckRatesMCID,a,BookingBuddy.Tracking.formatDate(b),BookingBuddy.Tracking.formatDate(c),"",d,"",e,f)},formatDate:function(a){var b=[],c=parseInt(a.getMonth()+1,10),d=parseInt(a.getDate(),10),e=parseInt(a.getFullYear(),10);return b.push(10>c?"0"+c:c),b.push(10>d?"0"+d:d),b.push(e),b.join("/")},trackTAHotelReview:function(a){var b=BookingBuddy.taReviewsMCID,c=BookingBuddy.redirectUrl,d="",e=c.indexOf("?");-1!==e&&(c=c.substring(0,e)),"/"==c.substring(c.length-1)&&(c=c.substring(0,c.length-1));var f=window.location.href?window.location.href:"";f&&"#"==f.substring(f.length-1)&&(f=f.substring(0,f.length-1));var g=c+"/ajax/?service=Log.write&parse_type=ta-hotel-review&revmcid="+b+"&hotel_id="+a+"&page="+encodeURIComponent(f)+"&jsoncallback=?";switch($j.getJSON(g),BookingBuddy.domain){case"bookingbuddy.com":d=";bb_tareviews_1;1;bb_tareviews_1";break;case"bookingbuddy.co.uk":d=";bbuk_tareviews_1;1;bbuk_tareviews_1";break;default:d=";tareviews_1;1;tareviews_1"}BookingBuddy.Tracking.trackVendorLink(d)},trackAIMThumbnailClick:function(){var a=BookingBuddy.taHotelPhotosMCID,b="";switch(BookingBuddy.domain){case"bookingbuddy.com":b=";bb_taaim_1;1;bb_taaim_1";break;case"bookingbuddy.co.uk":b=";bbuk_taaim_1;1;bbuk_taaim_1";break;default:b=";taaim_1;1;taaim_1"}BookingBuddy.Tracking.trackVendorLink(b),STMClickstream.trackTAAIMClick(BookingBuddy.redirectUrl,a)},trackVendorLink:function(a,b,c){var d,e=this.tracker,f=Math.floor(999999*Math.random()+1)+""+Number(new Date);e.setProperty("purchaseID",f).setTrackVar("purchaseID"),e.setProperty("currencyCode","USD").setTrackVar("currencyCode"),e.setProperty("products",a).setTrackVar("products"),e.setEvent("purchase"),e.setEvent("event22"),b===!0?(d="Active TA Meta Search Visit",e.setEvent("event9")):d="Vendor Click",s.channel&&e.setVariable("eVar24",s.channel),s.pageName&&e.setVariable("eVar25",s.pageName),c&&e.setVariable("eVar5",c),e.send(d)},trackLinkShareClick:function(a){if(!$j.isNullOrUndefined(BookingBuddy.getCookie("linkshare"))){var b={click_id:a};$j.asyncLoad("#linkshare_click_"+a,"linkshare_tracking",function(){},b)}},trackRevSearches:function(a){var b=null,c="",d="",e="",f=";",g="",h=";",i="",j=!0,k="",l=this.tracker;purchase_id=Math.floor(999999*Math.random()+1)+""+Number(new Date),l.setProperty("purchaseID",purchase_id).setTrackVar("purchaseID"),$j.each(a,function(a,i){b=BBAd.singleton(i),c=b.getMetaData("tier")||b.getMetaData("tracking_name")||b.getMetaData("ad_tier.name"),d=b.getMetaData("tracking_hash"),c&&!d&&(-1!=c.indexOf("dropdown ")?(e=!0,f+="bb_"+i+";1;"+d+";event29=1,;"):(g=!0,h+="bb_"+i+";1;"+d+";event28=1,;"))}),g&&e?(i=h.slice(0,-1)+f,i=i.slice(0,-2),l.setProperty("products",i).setTrackvar("products"),l.setVariable("eVar33",a.length),l.setEvent("event28"),l.setEvent("event29"),k="Featured and Dropdown Checked Search - BB REV"):g?(i=h.slice(0,-2),l.setProperty("products",i).setTrackvar("products"),l.setVariable("eVar33",a.length),l.setEvent("event28"),l.setEvent("event29"),k="Featured Checked Search - BB REV"):!g&&e?(i=f.slice(0,-2),l.setProperty("products",i).setTrackvar("products"),l.setEvent("event29"),k="Featured Dropdown Checked Search - BB REV"):j=!1,j&&("string"==typeof test_affiliate&&l.setVariable("eVar18",test_affiliate),l.send(k))},trackDealClick:function(a,b,c,d){var e=this.tracker;e.setEvent("purchase"),e.setEvent("event16"),e.setEvent("event24"),purchase_id=Math.floor(999999*Math.random()+1)+""+Number(new Date),e.setProperty("purchaseID",purchase_id).setTrackVar("purchaseID");var f=BookingBuddy.getCookie("blocker_alert");1==f&&(e.setVariable("eVar8","blocker_deal"),BookingBuddy.createCookie("blocker_alert",0)),"string"==typeof test_affiliate&&e.setVariable("eVar18",test_affiliate),this.tracker.setVariable("eVar25",stm.OmnitureConfig.pageName);var g="none";stm.OmnitureConfig.channel&&(g=stm.OmnitureConfig.channel),this.tracker.setVariable("eVar24",g),this.trackEntryTime(),e.setProperty("products",";"+b+";1;"+d),e.setTrackVar("products"),e.send("BBDN Deal Click"),this.trackLinkShareClick("bbdn"),e.setProperty("purchaseID","")},trackPopunderPopped:function(){var a,b=this.tracker;a="undefined"!=typeof stm&&stm.OmnitureConfig?stm.OmnitureConfig.channel:b.getProperty("channel"),b.setVariable("eVar35","Popunder opened from - "+a),b.send("Popunder popped")},trackPopunderClick:function(){var a=this.tracker;a.setVariable("eVar14","Vacation Cross Promotion");var b="none";stm.OmnitureConfig.channel&&(b=stm.OmnitureConfig.channel),a.send("BB Deal Popunder Click")},trackEntryTime:function(){var a=this.tracker;if("time"!=BookingBuddy.getCookie("entry_time")&&(a.setVariable("eVar11",BookingBuddy.getESTHour()),a.setTrackVar("eVar11")),BookingBuddy.createCookie("entry_time","time"),1!=BookingBuddy.getCookie("last_visited_sent")){var b=new Date;if(BookingBuddy.getCookie("last_visited")){var c=b.getTime()-BookingBuddy.getCookie("last_visited"),d=Math.floor(c/864e5);a.setVariable("eVar28",d)}BookingBuddy.createCookie("last_visited",b.getTime(),525600)}BookingBuddy.createCookie("last_visited_sent",1,30)},writeOmnitureEvar:function(a,b){var c=this.tracker;c.setVariable(a,b),c.send(b)},splitQueryParams:function(a){var b,c,d,e={};if(a&&a.length){b=a.split("&");for(var f=0;f<b.length;f++)c=b[f],d=c.split("="),d[0]&&d[0].length&&!e.hasOwnProperty(d[0])&&(d.length>1?e[d[0]]=decodeURIComponent(d[1]):d.length&&(e[d[0]]=""))}else e=0;return e||""},parseUrlIntoQueryParams:function(a){var b,c=a.wd.location.hash||"",d=a.wd.location.search||"";return c&&c.length&&"#"===c[0]&&(c="&"+c.substr(1)),d&&d.length&&"?"===d[0]&&(d=d.substr(1)),b=this.splitQueryParams(d+c),b||""},getQueryParamFromUrl:function(a,b){var c=this.parseUrlIntoQueryParams(b);return c[a]||""},setupOmniture:function(a){s=s_gi(a),domainName=document.domain.match(/\.([a-z0-9-]+\.[a-z0-9-]+)$/i),domainName&&domainName[1].length<8&&(domainName=document.domain.match(/\.([a-z0-9-]+\.[a-z0-9-]+\.[a-z0-9-]+)$/i)),domainName=domainName?domainName[1]:"bookingbuddy.com";try{window.optimizely=window.optimizely||[],window.optimizely.push("activateSiteCatalyst")}catch(b){}s.trackDownloadLinks=!1,s.trackExternalLinks=!0,s.trackInlineStats=!0,s.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,doc,pdf,xls",s.linkInternalFilters="javascript:,slimg.com,"+domainName,s.linkLeaveQueryString=!1,s.linkTrackVars="None",s.linkTrackEvents="None",s.dc=112,s.vmk="485017AC",s.currencyCode="USD",s.eVarCFG="",s.cookieDomainPeriods="2",s.fpCookieDomainPeriods="2",domainName.indexOf(".co.uk")>-1&&(s.cookieDomainPeriods="3",s.fpCookieDomainPeriods="3"),s.usePlugins=!0,s_doPlugins=function(a){var b="";b=a.getValOnce("eVar22","e_Var22",0),b&&(a.eVar22=a.pageName);for(var c=null,d=document.cookie.split(";"),e=0;e<d.length;e++){var f=d[e].trim(),g="usrsrc=";if(0===f.indexOf(g)){
var h=stm.parseJSON(decodeURIComponent(f.substring(g.length,f.length)));c=h.source;break}}if(!c){var c=BookingBuddy.User.getSource("source");c||(c=BookingBuddy.Tracking.getQueryParamFromUrl("source",a).replace(/[^\w\-\.]/,""))}a.prop10=c,b=a.getValOnce(c,"s_p1_s_campaign"),b&&(a.campaign=b),b=a.getValOnce(c,"s_p1_s_eVar7"),b&&(a.eVar7=b),b=a.getValOnce(c,"s_p1_s_eVar9"),b&&(a.eVar9=b),b=a.getValOnce(BookingBuddy.Tracking.getQueryParamFromUrl("taparam",a).replace(/[^\w\-\.]/,""),"s_p1_s_eVar29"),b&&(a.eVar29=b),b=a.getValOnce(BookingBuddy.Tracking.getQueryParamFromUrl("traqparam",a),"s_p1_s_eVar31"),b&&(a.eVar31=b),b=a.getValOnce(BookingBuddy.Tracking.getQueryParamFromUrl("pubid",a),"s_p1_s_eVar39"),b&&(a.eVar39=b),b=a.getValOnce(BookingBuddy.Tracking.getQueryParamFromUrl("supmt",a),"s_p1_s_eVar36"),b&&(a.eVar36=b)},s.doPlugins=s_doPlugins,sendAnalyticsEvent=function(){s.pageName=s_pageName?s_pageName:null,s.eVar10=s_eVar10?s_eVar10:null,(s_pageName||s_eVar10)&&s.t()},s.getValOnce=new Function("v","c","e","var s=this,k=s.c_r(c),a=new Date;e=e?e:0;if(v){a.setTime(a.getTime()+e*86400000);s.c_w(c,v,e?a:0);}return v==k?'':v"),s.getQueryParam=new Function("p","d","u","var s=this,v='',i,t;d=d?d:'';u=u?u:(s.pageURL?s.pageURL:s.wd.location);if(u=='f')u=s.gtfs().location;while(p){i=p.indexOf(',');i=i<0?p.length:i;t=s.p_gpv(p.substring(0,i),u+'');if(t)v+=v?d+t:t;p=p.substring(i==p.length?i:i+1)}return v"),s.getQueryParam=new Function("p","d","u","var s=this,v='',i,t;d=d?d:'';u=u?u:(s.pageURL?s.pageURL:s.wd.location);if(u=='f')u=s.gtfs().location;while(p){i=p.indexOf(',');i=i<0?p.length:i;t=s.p_gpv(p.substring(0,i),u+'');if(t){t=t.indexOf('#')>-1?t.substring(0,t.indexOf('#')):t;}if(t)v+=v?d+t:t;p=p.substring(i==p.length?i:i+1)}return v"),s.p_gpv=new Function("k","u","var s=this,v='',i=u.indexOf('?'),q;if(k&&i>-1){q=u.substring(i+1);v=s.pt(q,'&','p_gvf',k)}return v"),s.p_gvf=new Function("t","k","if(t){var s=this,i=t.indexOf('='),p=i<0?t:t.substring(0,i),v=i<0?'True':t.substring(i+1);if(p.toLowerCase()==k.toLowerCase())return s.epa(v)}return ''"),s.p_gpv=new Function("k","u","var s=this,v='',i=u.indexOf('?'),q;if(k&&i>-1){q=u.substring(i+1);v=s.pt(q,'&','p_gvf',k)}return v"),s.p_gvf=new Function("t","k","if(t){var s=this,i=t.indexOf('='),p=i<0?t:t.substring(0,i),v=i<0?'True':t.substring(i+1);if(p.toLowerCase()==k.toLowerCase())return s.epa(v)}return ''")}}.init();var s_objectID;
//# sourceMappingURL=BBTracking.nano.js.map
!function(a){BookingBuddy.bbSubmitHandlers={getCheckRatesURL:function(b,c){var d={},e=null,f="",g=b.prop("arrival_date").value.split("/"),h=b.prop("departure_date").value.split("/"),i=b.prop("num_travelers").value,j={};return 3==g.length&&(j.inMonth=g[0]+" "+g[2],j.inDay=g[1]),3==h.length&&(j.outMonth=h[0]+" "+h[2],j.outDay=h[1]),i&&(j.adults=i),j="&"+a.toQueryString(j),a.each(c,function(a,b){e=TACheckRates.singleton(b),f=e.getMetaData("external_url")+j,d[b]=f}),d},getFormType:function(a){return 0===a.find(".adIdCheckBox").length?"one_search":a.find(".check_rates_providers .ta_checkrates:visible").length>0?"ta_checkrates":BookingBuddy.TabbedWindowHandler&&BookingBuddy.TabbedWindowHandler.tabbed?"tabbed_browsing":"multiple_checked_searches"},submitFormByType:function(b,c){for(var d=BookingBuddy.submitHandlers,e=BookingBuddy.bbSubmitHandlers,f=e.getFormType(b),g=0,h=c.length,i=[];d.prepopWindows.length>h;)d.prepopWindows.pop().win_obj.close();switch(f){case"ta_checkrates":c.each(function(){var b=a(this).attr("name");b&&i.push(b)}),e.searchCheckRates(b,i);break;case"one_search":var j=$j.data(b[0],"smartForm"),k=/\d+/.exec(j.submitTrigger.id)[0];this.popAds(b,[k]);break;case"tabbed_browsing":case"multiple_checked_searches":c.each(function(){g=/\d+/.exec(a(this)[0].id),i.push(g)}),d.setFormRedirectUrl(b)&&("tabbed_browsing"==f?e.searchTabBrowsing(b,i):e.searchAd(b,i));break;default:return!1}return!0},submitForm:function(b,c,d){"undefined"!=typeof d&&(d.stopPropagation(),d.preventDefault()),b=b||BookingBuddy.searchMode+"_bbsearch",c=c||"_blank";var e=a(b),f=a.data(b,"smartForm"),g=e.find(".adIdCheckBox:visible:checked"),h=BookingBuddy.submitHandlers,i=BookingBuddy.bbSubmitHandlers;f.submitHandlerData.trigger_id=f.submitTrigger.id,f.submitHandlerData.submit_type=a(f.submitTrigger).hasClass("default")?"default":"runSearch","default"==f.submitHandlerData.submit_type?(a(b).attr("action",""),h.defaultHandler(b,c,d)):i.submitFormByType(e,g)},popAds:function(a,b){var c,d,e,f,g,h,i,j,k=BookingBuddy.submitHandlers,l=BookingBuddy.bbSubmitHandlers,m=[],n=[],o=k.prepopWindows.length>0?k.openMultiWindow(b.length,k.prepopWindows):k.openMultiWindow(b.length);o.reverse();for(var p=0;p<o.length;p++){d=o[p],e=b.shift(),f="bb_search_"+Number(new Date)+e,g=BBAd.singleton(e),h=g.getMetaData("url").split("?"),i=h[0],j=$j.toQueryObject(h[1]),a.prop("action",i);for(c in j)k.setOrAddFormValue(c,j[c],a);d&&d.win_name&&d.win_obj?(-1!==d.win_name.indexOf("prepop")&&k.prepopWindows.pop(),d.win_name=f,d.win_obj.name=f,k.searchWindows.push({win_obj:d.win_obj,win_name:f}),a[0].target=d.win_name,a[0].submit(),m.push(e)):n.push(e)}n=n.concat(b.reverse()),n.length&&l.loadBlockedPopup(a,n,m),$j.publish("/page/featuredSearch",[[m]])},searchAd:function(b,c){var d=BookingBuddy.submitHandlers,e=BookingBuddy.bbSubmitHandlers,f=[],g=[],h="",i=c.length,j=(e.getFormType(b),[]);j=d.prepopWindows.length>0?d.openMultiWindow(i,d.prepopWindows):d.openMultiWindow(i),j.reverse(),a.each(j,function(){if(h=c.shift(),this.win_obj&&this.win_name){-1!==this.win_name.indexOf("prepop")&&d.prepopWindows.pop(),this.win_name=this.win_obj.name="bb_search_"+Number(new Date)+h,d.searchWindows.push({win_obj:this.win_obj,win_name:this.win_name});var e=BBAd.singleton(h),i=e.getMetaData("tracking_info");i&&a.each(i,function(a,c){b.find("input[name="+a+"]").remove(),$j("<input />").attr({type:"hidden",name:a}).val(c).appendTo(b)}),b.prop("r").value="i"+h,b[0].target=this.win_name,b[0].submit(),i&&a.each(i,function(a){b.find("input[name="+a+"]").remove()}),g.push(h)}else f.push(h)}),f=f.concat(c.reverse()),f.length&&e.loadBlockedPopup(b,f,g),a.publish("/page/featuredSearch",[g])},searchTabBrowsing:function(b,c){for(var d=b.find(":input").not(".BBInputCheckBox").serializeArray(),e=d.length,f="",g=0;e>g;g++)"r"==d[g].name&&(d[g].value=c.join());f=a.param(d),BookingBuddy.TabbedWindowHandler.openTabbedWindow(f)},searchCheckRates:function(a,b){var c=new Date(Date.parse(a.prop("arrival_date").value)),d=new Date(Date.parse(a.prop("departure_date").value)),e=parseInt(a.prop("num_travelers").value,10);this.launchCheckrates(b,c,d,e)},launchCheckrates:function(b,c,d,e){for(var f=BookingBuddy.submitHandlers,g=BookingBuddy.bbSubmitHandlers,h=function(a){var b=[],c=parseInt(a.getMonth()+1,10),d=(parseInt(a.getDate(),10),parseInt(a.getFullYear(),10));return b.push(10>c?"0"+c:c),b.push(d),b.join(" ")},i={inDay:c.getDate(),inMonth:h(c),outDay:d.getDate(),outMonth:h(d),adults:e};f.prepopWindows.length>b.length;)f.prepopWindows.pop().win_obj.close();var j=b.length,k=f.prepopWindows.length>0?f.openMultiWindow(j,f.prepopWindows):f.openMultiWindow(j),l=[],m=[];$j.each(k,function(c,d){var e=b.shift();if(this.win_obj&&this.win_name){-1!==this.win_name.indexOf("prepop")&&f.prepopWindows.pop(),this.win_name=this.win_obj.name="search_"+Number(new Date)+e,f.searchWindows.push({win_obj:this.win_obj,win_name:this.win_name});var g=TACheckRates.singleton(e);this.win_obj.location.href=g.getMetaData("external_url")+"&"+a.toQueryString(i),l.push(e)}else m.push(e)}),k.reverse(),k.forEach(function(a){a.win_obj.focus()}),m=m.concat(b.reverse()),m.length&&g.showBlockedCheckratesPopup(l,m,c,d,e),BookingBuddy.Tracking.trackTACheckrates(l,c,d),$j.publish("/submit/checkRatesForm")},loadBlockedPopupCheckRates:function(b,c,d){var e=[],f="",g="check_rates";a.each(d,function(a,b){f=TACheckRates.singleton(b),e.push({ad_id:b,logo_class:g,display_name:f.getMetaData("display_name"),visited:"visited"})}),a.each(c,function(a,b){f=TACheckRates.singleton(b),e.push({ad_id:b,logo_class:g,display_name:f.getMetaData("display_name"),visited:""})}),BookingBuddy.bbSubmitHandlers.showBlockedPopup(b,e)},loadBlockedPopup:function(b,c,d){var e=[],f="";a.each(d,function(a,b){f=BBAd.singleton(b),e.push({ad_id:b,logo_class:"",logo_url:f.getMetaData("logo"),display_name:f.getMetaData("display_name"),visited:"visited"})}),a.each(c,function(a,b){f=BBAd.singleton(b),e.push({ad_id:b,logo_class:"",logo_url:f.getMetaData("logo"),display_name:f.getMetaData("display_name"),visited:""})}),BookingBuddy.bbSubmitHandlers.showBlockedPopup(b,e)},linkTemplate:'<div class="popup_logo #{logo_class}" id="logo_#{ad_id}"></div><div class="popup_name #{visited}" id="name_#{ad_id}">#{display_name}</div>',outputTemplate:'<div class=""><div class="popup_checked_img"><div class="popup_checked_chkmrk #{visited}" id="chkmrk_#{ad_id}"></div></div></div>',adjustPopupBlockerPosition:function(b){b.css({left:20,top:a(window).scrollTop()+50})},focusedSearchWindow:function(a){var b=BookingBuddy.submitHandlers.searchWindows,c=b.length,d=0;for(d=0;c>d;d++)if(-1!==b[d].win_name.indexOf(a)&&!b[d].win_obj.closed)return b[d].win_obj.focus(),!0;return!1},showBlockedPopup:function(b,c){var d=BookingBuddy.submitHandlers,e=BookingBuddy.bbSubmitHandlers,f=e.linkTemplate,g=e.outputTemplate;a.asyncLoad("#dhtml_checkboxes","popup_blocked_msg",function(h){var i=c.length,j=a("#popup_on_logos"),k=a("#dhtml_checkboxes"),l=a("#checkboxes_success"),m=new DHTMLPopup(a(h).attr("id")),n=0,o=0;j.html(""),m.setPageMask("page_mask"),m.show(),e.adjustPopupBlockerPosition(k),k.find(".closePopup").click(function(){d.resetCheckedMultiWindowOptions()}),a.each(c,function(c,d){"visited"==d.visited&&n++;var h=d.ad_id,m=d.logo_url||"",p=a(),q=a(),r=a.tmpl(f,d),s=a.tmpl(g,d),t=a("<a />",{html:r,click:function(c){c.preventDefault(),c.stopPropagation(),e.focusedSearchWindow(h)||(form_type=e.getFormType(b),"ta_checkrates"===form_type?e.searchCheckRates(b,[h]):e.searchAd(b,[h]),e.adjustPopupBlockerPosition(k),p=a(this).next(),q=a(this).find(".popup_name"),Number(l.html())<i&&p.is(":hidden")&&(o=Number(l.html())+1,l.html(o+" ")),q.addClass("visited"),p.addClass("visited"))}});s=a(s),a(".popup_checked_img",s).prepend(t),j.append(s),m&&a("#dhtml_checkboxes #logo_"+h).css("background-image","url("+m+")")}),l.html(n+" "),a("#checkboxes_total").html(i+" ")},{popup_class:"bbus"})},showBlockedCheckratesPopup:function(b,c,d,e,f){var g=[],h="",i="check_rates";a.each(b,function(a,b){h=TACheckRates.singleton(b),g.push({ad_id:b,logo_class:i,display_name:h.getMetaData("display_name"),visited:"visited"})}),a.each(c,function(a,b){h=TACheckRates.singleton(b),g.push({ad_id:b,logo_class:i,display_name:h.getMetaData("display_name"),visited:""})});var j=BookingBuddy.submitHandlers,k=BookingBuddy.bbSubmitHandlers,l=k.linkTemplate,m=k.outputTemplate;a.asyncLoad("#dhtml_checkboxes","popup_blocked_msg",function(b){var c=g.length,h=a("#popup_on_logos"),i=a("#dhtml_checkboxes"),n=a("#checkboxes_success"),o=new DHTMLPopup(a(b).attr("id")),p=0,q=0;h.html(""),o.setPageMask("page_mask"),o.show(),k.adjustPopupBlockerPosition(i),i.find(".closePopup").click(function(){j.resetCheckedMultiWindowOptions()}),a.each(g,function(b,g){"visited"==g.visited&&p++;var j=g.ad_id,o=g.logo_url||"",r=a(),s=a(),t=a.tmpl(l,g),u=a.tmpl(m,g),v=a("<a />",{html:t,click:function(b){b.preventDefault(),b.stopPropagation(),k.focusedSearchWindow(j)||(k.launchCheckrates([j],d,e,f),k.adjustPopupBlockerPosition(i),r=a(this).next(),s=a(this).find(".popup_name"),Number(n.html())<c&&r.is(":hidden")&&(q=Number(n.html())+1,n.html(q+" ")),s.addClass("visited"),r.addClass("visited"))}});u=a(u),a(".popup_checked_img",u).prepend(v),h.append(u),o&&a("#dhtml_checkboxes #logo_"+j).css("background-image","url("+o+")")}),n.html(p+" "),a("#checkboxes_total").html(c+" ")},{popup_class:"bbus"})},skipStep2:function(b,c,d){var e=BookingBuddy.TabbedWindowHandler,f=BookingBuddy.submitHandlers,g=!1;return e.tabbed&&(g=e.openTabbedWindow(a(b).serialize()),g&&g.focus()),f.defaultHandler(b,c,d)},bbsToTabbed:function(b,c,d){var e=BookingBuddy.TabbedWindowHandler,f=(BookingBuddy.submitHandlers,!1);return e.tabbed&&(f=e.openTabbedWindow(a(b).serialize()),f&&f.focus()),!1},resetCheckBoxes:function(b){a(".adIdCheckBox",b).prop("checked",!1)}}}(jQuery);
//# sourceMappingURL=BBSubmitHandlers.nano.js.map

!function(a){"use strict";var b=a.stm||{},c=a.jQuery;b.TraqLander=b.define({STATIC:{REGEX_PARAMS:/([A-Z]\d)+?/g,REGEX_PARAM:/([A-Z])(\d)/,ITEM_OPTIONS:{A:{type:"popup",styles:{1:{display:!0,id:"CTM_A1"},2:{display:!0,id:"CTM_A2"},3:{display:!0,id:"CTM_A3"},4:{display:!0,id:"CTM_A4"},5:{display:!0,id:"CTM_A5"}}},B:{type:"popup",styles:{1:{display:!0,id:"side_popup",css_class:"pink"}}},C:{type:"title",styles:{1:{display:!0,id:"page_title",enable_scrolling:!1},2:{display:!0,id:"page_title",enable_scrolling:!0,scroll_delay:150}}}},defaults:{params:"",splash_container:"",page_mask:"",maximizeOnTraqClose:!1,fade:!0}},elements:[],options:{},dhtml:{},processParams:function(){var a=this.options.params.match(b.TraqLander.REGEX_PARAMS),c=a?a.length:0,d=0,e={},f=null,g=null;for(d=0;c>d;d++)g=a[d].match(b.TraqLander.REGEX_PARAM),e={param_key:g[1],param_code:g[2]},f=b.TraqLanderItem_Factory.create(e),this.addItem(f)},addItem:function(a){"popup"==a.options.type&&a.options.id&&a.options.display&&(this.dhtml.addElement(a.options.id),this.dhtml.maskClick(a.options.id)),this.elements.push(a)},display:function(){c.each(this.elements,function(a,b){b.display()}),this.dhtml.show(this.options.fade),c.publish("/show/TraqLander")},maximizeWindow:function(){if(!b.pageData.queryString||"true"!==b.pageData.queryString.iframe){var a=screen.availWidth,c=screen.availHeight,d=0,e=0;window.moveTo(d,e),window.resizeTo(a,c)}},resizeTip:function(){var a=c(window).width(),b=491;if(b>=a){var d=407,e=b-a,f=d-e,g=206;if(f>=g){c("div[id^='CTM_A']").css("width",f);var h=c(".tip");if(h.length){var i=130;h.css("margin-left",i-e/2)}}}},hide:function(){c.each(this.elements,function(a,b){b.hide()}),this.options.maximizeOnTraqClose&&this.maximizeWindow(),c.publish("/hide/TraqLander")},constructor:function(a){this.options=c.extend({},b.TraqLander.defaults,a),this.dhtml=DHTMLPopup_Factory.create({type:"layer",id:this.options.splash_container}),this.options.page_mask&&(this.dhtml.setPageMask(this.options.page_mask),this.dhtml.maskClick(this.options.page_mask)),this.processParams(),this.resizeTip(),c(window).on("resize",this.resizeTip),this.dhtml.base.on("dhtmlpopup:hide",c.proxy(this.hide,this))}}),b.TraqLanderItem=b.define({defaults:{id:"",css_class:"",param_key:"",param_code:0,display:!0},display:function(){this.element&&this.options.css_class&&this.element.addClass(this.options.css_class)},hide:function(){},constructor:function(a){this.options=c.extend({},this.defaults,a),this.element=this.options.id?c("#"+this.options.id):null}}),b.TraqLanderItem_Title=b.define(b.TraqLanderItem,{defaults:{id:"",page_title:"",param_key:"",param_code:0,display:!1,enable_scrolling:!1,scrolling_delimiter:" ___ ",scroll_delay:150},updateTitle:function(a){if(!this.options.enable_scrolling)return void(document.title=this.options.page_title);var b=this,c=this.options.page_title+this.options.scrolling_delimiter,d=c.length;document.title=c.substring(a,d)+c.substring(0,a),setTimeout(function(){b.updateTitle(a==d?0:a+1)},b.options.scroll_delay)},display:function(){this.options.display&&this.options.page_title&&this.updateTitle(0)},hide:function(){this.options.enable_scrolling=!1},constructor:function(a){a=c.extend({},this.defaults,a),b.TraqLanderItem.call(this,a),this.element&&(this.options.page_title=this.element.html())}}),b.TraqLanderItem_Factory=b.define({STATIC:{types:{popup:b.TraqLanderItem,title:b.TraqLanderItem_Title},create:function(a){var d=null;this.options={};var e=b.TraqLander.ITEM_OPTIONS;if(a.param_key in e&&(a.param_code in e[a.param_key].styles&&(this.options=c.extend({},a,e[a.param_key].styles[a.param_code])),"type"in e[a.param_key]&&(this.options.type=e[a.param_key].type)),this.options.type){var f=this.types[this.options.type];c.isNullOrUndefined(f)&&(f=this.types.popup),d=new f(this.options)}return d}}})}(window);
//# sourceMappingURL=traqlander.nano.js.map
!function(a){function b(c,d,e){for(var f in b.properties){if("undefined"==typeof d[f])return this;this[f]=d[f]}return this.options=a.extend({},b.options,e),this.container=a(c),this.tabContainer=a(document.createElement("ul")),this.popupWindowNames={},this.adIds=[],this.isSafariTablet=!1,this.mustFocusBeforeClose=!1,this.loadingOverlay=null,this.init(),this.options.showAlertOnClose&&this.alertOnClose.run(this.container),this}function c(b,c){if(this.tabIframe=a(),this.tabElem=a(),this.cookieWindow=null,this.popupHTML=a(),"object"!=typeof c)return null;if(this.searchMode=c.searchMode,!(b instanceof BBAd))return null;if(this.adDisplayName=b.getMetaData("display_name"),!this.adDisplayName)return null;var d=b.getMetaData("rank")||null,e=b.getMetaData("placement"),f=b.getMetaData("tracking_hash");this.adId=b.getID(),this.adLogo=b.getMetaData("tab_logo"),this.squareAdLogo=b.getMetaData("logo"),this.adUrl=c.adHandlerUrl+"r=i"+this.adId+"&ad_rank="+d+"&"+c.searchQueryString,this.searchAdapterUrl=b.getMetaData("search_adapter_url"),c.adURLAppendTracking&&(this.adUrl+="&trackingHash="+f,this.adUrl+="&adTier="+e);var g=b.getTrackingInfoAsQueryString();return g&&(this.adUrl+="&"+g),this.shouldPopNewWindow=function(){if(c.oneTab)return!1;if(stm.Browser&&stm.Browser.safari&&stm.Browser.Platform&&(stm.Browser.Platform.mac||stm.Browser.Platform.win))return!0;var d=b.getMetaData("faux_tabs");return d?"string"==typeof d?"always"===d||"ie"===d&&stm.Browser.ie:-1!==a.inArray("always",d)||-1!==a.inArray("ie",d)&&stm.Browser.ie||-1!==a.inArray("ipad",d)&&c.isSafariTablet:!1}(this),this}var d=stm.define({options:{queryString:"",tripAlertIfCountUnder:1},messages:{air:"Wait! Lower prices may be available for your #{geo} flight. Click the tabs above to show flight prices for your trip.",car:"Wait! Lower prices may be available for your #{geo} car rental. Click the tabs above to show car rental prices for your trip.",car_uk:"Wait! Lower prices may be available for your #{geo} car hire. Click the tabs above to show car hire prices for your trip.",cruise:"Wait! Lower prices may be available for your #{geo} cruise. Click the tabs above to show cruise prices for your trip.",hotel:"Wait! Lower prices may be available for your #{geo} hotel. Click the tabs above to show hotel prices for your trip.",vacation:"Wait! Lower prices may be available for your #{geo} vacation package. Click the tabs above to show vacation package prices for your trip.",vacation_rental:"Wait! Lower prices may be available for your #{geo} vacation rental. Click the tabs above to show vacation rental prices for your trip.",holiday:"Wait! Lower prices may be available for your #{geo} holiday package. Click the tabs above to show holiday package prices for your trip."},searchCount:0,trippedAlerts:0,updatingDetails:!1,getMessage:function(){var b="",c=this.options.queryString;c.departure_city?b=c.departure_city:c.dc&&(b=c.dc),c.arrival_city?(b&&(b+=" to "),b+=c.arrival_city):c.ac&&(b&&(b+=" to "),b+=c.ac),c.pickup_city&&(b=c.pickup_city),c.destination&&(b=c.destination),b.length>0&&(b=b.replace(" - All Airports",""));var d="";return c.search_mode?d=c.search_mode:c.sm&&(d=c.sm),"bookingbuddy_co_uk"===BookingBuddy.affiliateName&&"car"===d&&(d="car_uk"),a.tmpl(this.messages[d],{geo:b})},onBeforeUnload:function(){return this.searchCount&&!(this.searchCount<this.options.tripAlertIfCountUnder)||0!==this.trippedAlerts||this.updatingDetails?void 0:(this.trippedAlerts=1,this.getMessage())},onFareDetailUpdate:function(){return this.updatingDetails=!0,this},onTabDisplay:function(){return++this.searchCount,this},run:function(a){return a.bind("tabBrowsing:tabDisplayed",this.onTabDisplay),this.runOnce()},runOnce:function(){window.onbeforeunload=this.onBeforeUnload,a("form .submit").bind("click",this.onFareDetailUpdate);var b=this;return this.runOnce=function(){return b},this},constructor:function(b){this.options=a.extend({},b),stm.functional.bindMethods(this,["onBeforeUnload","onFareDetailUpdate","onTabDisplay"])}});a.extend(b,{properties:{searchMode:null,headerElem:a(),panelElem:a(),dropdownElem:a(),tabIds:[],adList:{},searchParams:{},siteRedirectUrl:null,adHandlerUrl:null},options:{suppressInstructionsHTML:!1,loadFirstTab:!1,maxTabDisplay:7,tabIncrement:102,fadeInSpeed:500,reverseFading:!1,animateCounter:!0,delayTabFadeIn:!1,showHotelCount:!1,bypassFSTracking:!1,adURLAppendTracking:!1,maximizeOnLoad:!1,showSearchTip:!0,showAlertOnClose:!1,showDevilHorns:!1,isUKAffiliate:!1,selectedAdId:null,logoLinkAffiliate:null},prototype:{init:function(){var b=this;for(var c in b.adList){var e=b.adList[c];b.adIds.push(e.getID())}b.siteRedirectUrl+=-1!==b.siteRedirectUrl.indexOf("?")?"&":"?",b.adHandlerUrl+=-1!==b.adHandlerUrl.indexOf("?")?"&":"?",b.searchParams=a.extend({},b.searchParams),delete b.searchParams.r,b.searchQueryString=a.param(b.searchParams),b.options.maximizeOnLoad&&b.maximizeWindow();var f=stm.pageData.deviceInfo;if(f&&f.isTablet&&"ios"===f.os){var g=parseFloat(f.version,10);b.isSafariTablet=!0,b.mustFocusBeforeClose=6>g}b.searchParams.alert&&(b.options.showAlertOnClose=!0,stm.cookies.set("alertonclose","true")),b.options.showAlertOnClose&&(b.alertOnClose=new d({queryString:b.searchParams,tripAlertIfCountUnder:2})),b.windowResizeHandler(),a(window).bind("resize",a.proxy(b.windowResizeHandler,b)),a.each(b.tabIds,function(a,c){b.addTab(c)}),b.container.append(b.tabContainer),b.loadTabEventHandler(),b.options.loadFirstTab?b.loadFirstTab():b.isAdInLineup(b.options.selectedAdId)&&!this.options.delayTabFadeIn?b.loadSelectedAd():b.options.suppressInstructionsHTML||b.showInstructionsHtml(),b.fadeInTabs(b.options.fadeInSpeed,b.options.animateCounter),b.toggleArrows(),b.container.bind("tabBrowsing:tabMovedToDropdown tabBrowsing:tabAddedToContainer",a.proxy(b.toggleArrows,b)),b.loadDropdown(),b.loadLogoHandler()},isAdInLineup:function(a){return this.getPlaceInLineup(a)>-1},getPlaceInLineup:function(b){var c=this.tabContainer.find("li"),d=[];for(i=0;i<c.length;i++){var e=$j(c[i]).data("tabObj").tab.adId;d.push(e)}return a.inArray(parseInt(b,10),d)},windowResizeHandler:function(){var b=a(window).width(),c=a(window).height(),d=this.headerElem.height(),e=Math.abs(c-d)-7;this.panelElem.height(e);var f="";if(1e3>b){var g=555,h=16,i=45;f=Math.floor((b-g)/h)+i+"%"}else f=this.options.tabIncrement*this.options.maxTabDisplay+3,f+="px";this.container.css("width",f),this.setPopupWindowOptions(),this.container.trigger("tabBrowsing:windowResized")},setPopupWindowOptions:function(){var b="undefined"!=typeof window.screenY?window.screenY:window.screenTop,c="undefined"!=typeof window.screenX?window.screenX:window.screenLeft,d=0,e=0,f=a(document).height(),g=this.headerElem.height()+7,h=this.panelElem.height();if(stm.Browser.ie){var i=parseInt(stm.Browser.version,10);switch(i){case 7:case 8:e=73;break;case 11:e=58,d=window.outerHeight-window.innerHeight;break;case 9:default:e=80,d=window.outerHeight-f-5}}else stm.Browser.firefox?(e=58,d=window.outerHeight-f+27):(e=58,d=window.outerHeight-f-5);var j=a(window).width()+2,k=h-e,l=b+d+g,m=c,n={status:0,toolbars:0,location:1,menubar:0,resizable:1,scrollbars:1,height:k,width:j,top:l,left:m};stm.Browser.chrome&&(n.scrollbars=0),stm.Browser.ie&&stm.Browser.version>=9&&(n.resizable=0),this.windowOpts=a.param(n).replace(/&/g,",")},addTab:function(b){var d=this.adList[b],e={searchMode:this.searchMode,adHandlerUrl:this.adHandlerUrl,searchQueryString:this.searchQueryString,adURLAppendTracking:this.options.adURLAppendTracking,isSafariTablet:this.isSafariTablet,oneTab:this.options.oneTab?this.options.oneTab:null},f=new c(d,e);return f&&(this.tabContainer.append(f.getElem()),a.publish("/tabBrowsing/tabAdded",[f]),this.container.trigger("tabBrowsing:tabAddedToContainer")),f},loadTabEventHandler:function(){var b=this;b.tabContainer.delegate("li","click",function(c){var d=a(this).data("tabObj").tab;a(c.target).hasClass("delete")?b.removeTab(d):d.isActive()||b.displayTab(d)})},loadLogoHandler:function(){var b=this,c=b.options.logoLinkAffiliate,d=stm.affiliateOptions;if(b.options.logoLinkAffiliate){var e=-1===a.inArray(c,d.withTabBrowsingBbLogo)?".logo_link":"#tabPanel .logo_link";a(e).each(function(e,f){-1!==a.inArray(c,d.disabledTabBrowsingLogo)?(a(f).addClass("disabled_logo"),a(f).click(function(a){return a.preventDefault(),!1})):stm.pageData&&stm.pageData.affiliateHomePageUrl&&stm.pageData.affiliateHomePageUrl.length>5?f.href=stm.pageData.affiliateHomePageUrl:f.href=b.siteRedirectUrl+"&r=tabbed_"+c})}},fadeInTabs:function(b,c){var d,e=this,f=0,g=e.panelElem.find(".instructions_content h3 span.tab_count"),h=e.tabContainer.find("li"),i=function(a){if(a&&a.length){c&&g.text(++f);var d=b;a.offset().left>e.tabContainer.parent().width()&&(d=0),a.hide().css("visibility","visible"),a.fadeIn(d,function(){a.removeClass("hidden"),i(e.options.reverseFading?a.prev():a.next())})}};e.options.reverseFading?(h.show().css("visibility","hidden"),d=e.tabContainer.find("li:last")):d=e.tabContainer.find("li:first"),this.options.delayTabFadeIn?(h.show(),a.subscribe("/hide/TraqLander",function(){e.options.reverseFading?h.show().css("visibility","hidden"):h.hide(),e.isAdInLineup(e.options.selectedAdId)&&e.loadSelectedAd(),i(d)})):(c&&this.tabIds.length&&g.text("1"),i(d))},maximizeWindow:function(){if(!stm.pageData.queryString||"true"!==stm.pageData.queryString.iframe){var a=screen.availWidth,b=screen.availHeight,c=0,d=0;window.moveTo(c,d),window.resizeTo(a,b)}},loadFirstTab:function(){var a=this.tabContainer.find("li:first").data("tabObj").tab;this.displayTab(a)},loadSelectedAd:function(){var a=this.options.selectedAdId,b=this.tabContainer.find("li"),c=null,d=this;return _.every(b,function(b){return c=$j(b).data("tabObj").tab,c&&c.adId==a?(this.focusTab(c),c.shouldPopNewWindow?(this.loadFauxTabCallToAction(c),this.panelElem.one("click",function(a){a.preventDefault(),d.popNewWindowAd(c.adId,c.adUrl)})):this.displayTab(c),!1):!0},this),this},getTabCount:function(){return this.tabContainer.find("li").length},updateTabCount:function(){var b=this.getTabCount();a(".instructions .tab_count").text(b)},loadDropdown:function(){var b=this;if(b.dropdownElem[0]){var c=b.dropdownElem.data("dhtmlDropdown");if(c){c.reset();for(var d,e=b.adIds,f=b.tabIds,g=[],h=e.length;h--;)d=e[h],-1===a.inArray(d,f)&&(g.push(d),c.insert(d,!0));c.redraw(),b.dropdownElem.bind("DHTMLDropdown:select",function(){b.addTabFromDropdown(c)}),b.dropdownIds=g}}},addTabFromDropdown:function(b){var c=parseInt(b.val(),10);if(c){b.remove(c),b.val(null),b.redraw();var d=this.addTab(c);if(d){this.displayTab(d),this.focusTab(d),this.toggleDeleteButtons("show"),-1===a.inArray(c,this.tabIds)&&this.tabIds.push(c);var e=a.inArray(c,this.dropdownIds);-1!==e&&this.dropdownIds.splice(e,1),this.container.trigger("tabBrowsing:tabAddedFromDropdown")}}},addToDropdown:function(b){var c=this.dropdownElem.data("dhtmlDropdown");c&&(c.insert(b,!0).redraw(),-1===a.inArray(b,this.dropdownIds)&&this.dropdownIds.push(b))},toggleDeleteButtons:function(a){switch(a){case"hide":this.tabContainer.find(".delete").hide();break;case"show":default:this.tabContainer.find(".delete").show()}return this},removeTab:function(b){b.tabElem.hide();var c=b.adId;this.popupWindowNames[c]&&!this.popupWindowNames[c].closed&&this.popupWindowNames[c].close(),this.isSafariTablet&&stm.Browser.version<7&&this.stopCookieDropper(b);var d=a.inArray(c,this.tabIds);-1!==d&&this.tabIds.splice(d,1),1===b.tabElem.siblings().length&&this.toggleDeleteButtons("hide"),b.tabElem.remove(),b.tabIframe.remove(),b.popupHTML.remove(),b.isActive()&&this.showInstructionsHtml(),this.updateTabCount(),this.addToDropdown(c),this.container.trigger("tabBrowsing:tabMovedToDropdown")},showInstructionsHtml:function(){var b=this.panelElem,c=b.find(".instructions"),d="",e="instructions defaultContent";if(b.children().hide(),c[0])this.updateTabCount();else{var f=this.headerElem.find(".itinerary"),g={tab_count:this.getTabCount(),trip_details:f[0]?"<h5>Trip Details: <span>"+f.html()+"</span></h5>":""},h='<h3><span class="tab_count">#{tab_count}</span> Sites Found!</h3>';if(this.options.showHotelCount&&(h='<h3 class="with_hotels"><span class="hotel_count"></span> Properties Available on Your Dates. Compare <span class="tab_count">#{tab_count}</span> Sites!</h3>'),this.options.showDevilHorns?(d='<div class="left_arrow"></div><div class="instructions_content">'+h+'<span>#{trip_details}</span><h4>Click the logos above to compare prices.</h4><a href="/" class="logo_link"></a></div><div class="right_arrow"></div>',e+=" devilHorns"):(d='<div class="left"><div class="arrow_wrapper"><div class="animated_arrow"></div></div><div class="start_here">Start Here!</div></div><div class="instructions_content">'+h+'<span>#{trip_details}</span><h4>Click the logos above to compare prices.</h4><a href="/" class="logo_link"></a></div>',e+=" startHere"),this.options.showSearchTip){var i=this.options.isUKAffiliate?"travellers":"travelers",j="Tip! Most "+i+" click 4 or more tabs to find the best deal!";d+='<div class="searchTip"><img src="http://i.slimg.com/bookingbuddy/transparent.gif" alt="Tip" /><span>'+j+"</span></div>"}c=a("<div />",{"class":e,html:a.tmpl(d,g)}),b.prepend(c)}return b.find(".defaultContent").show(),this},createArrows:function(){var b,c,d=this,e=!1;b=a("<div />",{"class":"more left_arrow",click:function(a){e||d.tabContainer.position().left>=0||(e=!0,d.tabContainer.animate({left:"+="+d.options.tabIncrement},500,function(){e=!1}))}}).append(a("<div />",{"class":"gradient",id:"gradient_left"})),c=a("<div />",{"class":"more right_arrow",click:function(b){if(!e){var c=a(this).position().left,f=d.tabContainer.find("li:last").offset().left;c-f>d.options.tabIncrement+20||(e=!0,d.tabContainer.animate({left:"-="+d.options.tabIncrement},500,function(){e=!1}))}}}).append(a("<div />",{"class":"gradient",id:"gradient_right"})),d.container.before(b),d.container.after(c)},toggleArrows:function(){var a=this.getTabCount(),b=this.headerElem.find(".more"),c=b[0],d=c&&b.is(":hidden"),e=this.container.parents("#tabPageWrapper, .mvcView.tabSearch"),f=this.options.maxTabDisplay;f>a?c&&!d&&(b.hide(),this.tabContainer.animate({left:0},500),e.removeClass("arrows_shown")):(c?d&&b.show():this.createArrows(),e.addClass("arrows_shown")),this.container.trigger("tabBrowsing:toggleArrows")},focusTab:function(a){var b=this.tabContainer.find("li").length,c=this.options.maxTabDisplay;if(a.makeActive(),c>b)return this;var d=0,e=a.getElem().index();if(e>=c-1){var f=Math.abs(this.options.tabIncrement*(e-c+1));d=-(f+this.options.tabIncrement)}return this.tabContainer.animate({left:d},300),this},displayTab:function(a){a.makeActive(),this.panelElem.children().hide();try{a.shouldPopNewWindow?(this.loadingOverlay&&this.loadingOverlay.hide(),this.loadPopupForTab(a)):this.loadIframeForTab(a)}catch(b){}return this.container.trigger("tabBrowsing:tabDisplayed",this),a},loadIframeForTab:function(b){if(!b.tabIframe[0]){b.tabIframe=a("<iframe />",{frameborder:"0","class":"hidden white tabIframe",src:""}),this.panelElem.prepend(b.tabIframe);var c=[b.adId];a.publish("/page/featuredSearch",[c,this.options.bypassFSTracking])}return b.tabIframe.show(),""===b.tabIframe.attr("src")&&(this.isSafariTablet?(this.startCookieDropper(b),setTimeout(function(){b.tabIframe[0].src=b.adUrl},1e3)):(this.startInterstitial(b),b.tabIframe[0].src=b.adUrl)),b},loadPopupForTab:function(a){this.loadFauxTabCallToAction(a),this.popNewWindowAd(a.adId,a.adUrl)},loadFauxTabCallToAction:function(a){var b=this;a.tabIframe.hide(),b.panelElem.children().hide();var c=a.getWindowPoppedHTML();return c.find("span").click(function(c){c.preventDefault(),b.popNewWindowAd(a.adId,a.adUrl)}),b.panelElem.prepend(c),a.popupHTML.show(),this},popNewWindowAd:function(b,c){var d=this.popupWindowNames;if(!this.focusPopupAd(b)){var e="bb_search_"+b;if(d[b]=window.open("",e,this.windowOpts),!d[b])return!1;if(d[b].location.href=c,d[b].focus(),!this.options.bypassFSTracking){var f=[b];a.publish("/page/featuredSearch",[f])}}return!0},focusPopupAd:function(a){return this.popupWindowNames[a]&&!this.popupWindowNames[a].closed?(this.popupWindowNames[a].focus(),!0):!1},startCookieDropper:function(b){var c='<div class="interstitialTips"></div>';!this.loadingOverlay&&window.DHTMLPopup_Loader&&(this.loadingOverlay=new DHTMLPopup_Loader(this.panelElem),a(c).appendTo(this.loadingOverlay.overlay)),this.loadingOverlay&&(this.setInterstitialText(b),this.loadingOverlay.show());var d=document.createElement("a");d.href=b.searchAdapterUrl;var e=d.protocol+"//"+d.hostname,f="CookieWindow-"+b.adId;b.cookieWindow=window.open(e,f,"width=1,height=1,scrollbars=0");var g=window.name;g||(g="STMWindow"),window.name=g,window.open("",g,"width=1,height=1,scrollbars=0"),window.focus();var h=!0;b.tabIframe.load(a.proxy(function(){h||this.stopCookieDropper(b),h=!1},this)),setTimeout(a.proxy(function(){this.stopCookieDropper(b)},this),1e4)},stopCookieDropper:function(a){a.cookieWindow&&!a.cookieWindow.closed&&(this.mustFocusBeforeClose&&a.cookieWindow.focus(),a.cookieWindow.close()),this.loadingOverlay&&this.loadingOverlay.hide()},startInterstitial:function(b){var c='<div class="interstitialTips"></div>';!this.loadingOverlay&&window.DHTMLPopup_Loader&&(this.loadingOverlay=new DHTMLPopup_Loader(this.panelElem),a(c).appendTo(this.loadingOverlay.overlay)),this.loadingOverlay&&(this.setInterstitialText(b),this.loadingOverlay.show());var d=!0;b.tabIframe.load(a.proxy(function(){d||this.stopInterstitial(b),d=!1},this)),setTimeout(a.proxy(function(){this.stopInterstitial()},this),1e4)},setInterstitialText:function(b){var c=b.adDisplayName,d=["Travel Tip #1: Compare! Most travelers check more than one site and save.","Travel Tip #2: Be flexible! Prices can vary from one day to the next.","Travel Tip #3: Pack light! Skip checked-baggage fees with a carry-on.","Travel Tip #4: Do the math! Airlines charge different fees for different items.","Travel Tip #5: Explore all options! Not all prices and perks are created equal."],e=Math.floor(5*Math.random()),f="Loading prices from "+c,g="While you're waiting, start another tab loading and come right back.";this.loadingOverlay.overlay.find(".interstitialContent").length<1&&(this.loadingOverlay.overlay.wrapInner("<div class='interstitialContent' />"),a("<div class='interstitialCallout' />").text(g).insertAfter(this.loadingOverlay.overlay.find(".interstitialTitle"))),this.loadingOverlay.overlay.find(".interstitialTitle").text(f),this.loadingOverlay.overlay.find(".interstitialTips").text(d[e])},stopInterstitial:function(){this.loadingOverlay&&this.loadingOverlay.hide()}}}),a.extend(c,{prototype:{getElem:function(){if(this.tabElem[0])return this.tabElem;var b=this,c=b.adDisplayName.length>12?b.adDisplayName.substring(0,9)+"...":b.adDisplayName;return this.tabElem=a("<li />",{title:"Search "+b.adDisplayName,"class":"hidden"}).data("tabObj",{tab:b}).append(a("<div />",{"class":"tab",html:"<span>"+c+"</span>"})).append(a("<div />",{"class":"delete",title:"Remove "+b.adDisplayName})),b.adLogo?b.tabElem.find(".tab").css("background-image","url(' "+b.adLogo+" ')"):b.tabElem.find(".tab").addClass("generic"),b.tabElem},getWindowPoppedHTML:function(){return this.popupHTML[0]||(this.popupHTML=a("<h2 />",{"class":"popup_html",html:"Sending your search to <span>"+this.adDisplayName+"</span>. Click to get started."})),this.popupHTML},isActive:function(){return this.tabElem.hasClass("active")},makeActive:function(){return this.tabElem.siblings().removeClass("active"),this.tabElem.addClass("active").removeClass("hidden"),this},sendTrackingImage:function(a){var b=new Image;b.src=a}}}),a.fn.tabBrowsing=function(c,d){return this.each(function(){var e=a(this);if(!e.data("tabBrowsing")){var f=new b(this,c,d);e.data("tabBrowsing",f),f.container.trigger("tabBrowsing:loaded")}})}}(jQuery);
//# sourceMappingURL=STMTabBrowsing.nano.js.map
!function(a){BookingBuddy.TabbedWindowHandler={win:null,winProperties:{},winSettings:{},tabbed:!stm.Browser.ie||6!=stm.Browser.version,searchUrl:"/tabsearches.php",mode:null,openTabbedWindow:function(b){-1===b.indexOf("?")&&(b="?"+b),b=BookingBuddy.TabbedWindowHandler.searchUrl+b;var c=BookingBuddy.TabbedWindowHandler.win;if(c&&!c.closed&&b)return c.location.href=b,c.focus(),c;var d=BookingBuddy.TabbedWindowHandler.getWindowOptions(BookingBuddy.TabbedWindowHandler.getMode());a.isNullOrUndefined(b)&&(b="");var e=new Date,f=window.open("","bb_tabbed_window"+e.getTime(),d);return f?(b||(f.blur(),window.focus()),f.location.href=b,BookingBuddy.TabbedWindowHandler.win=f,f):null},resizeTabbedWindow:function(){var a=BookingBuddy.TabbedWindowHandler.getMode(),b=BookingBuddy.TabbedWindowHandler.getWindowProperties(a),c=BookingBuddy.TabbedWindowHandler.win?BookingBuddy.TabbedWindowHandler.win:window;return c.moveTo(b.top,b.left),c.resizeTo(b.width,b.height),c},getMode:function(){var a=BookingBuddy.TabbedWindowHandler.mode;return a?a:(a=stm.Browser.chrome?"standard":stm.Browser.ie?"fullscreen":"cover",BookingBuddy.TabbedWindowHandler.mode=a,a)},setMode:function(a){BookingBuddy.TabbedWindowHandler.mode=a},getWindowProperties:function(b){if(BookingBuddy.TabbedWindowHandler.winProperties[b])return BookingBuddy.TabbedWindowHandler.winProperties[b];var c,d,e,f,g,h=a.isUndefined(window.screenY)?window.screenTop:window.screenY,i=a.isUndefined(window.screenX)?window.screenLeft:window.screenX;stm.Browser.firefox?55:stm.Browser.ie?65:90;switch(b){case"cover":f=stm.Browser.firefox?screen.availHeight-h:a(window).height()+10,g=a(window).width()+10,1e3>g&&(g=1e3),d=h,e=i,c="status=0,toolbar=0,location=1,menubar=0,resizable=1,scrollbars=0,height="+f+",width="+g+",top="+d+",left="+e;break;case"fullscreen":f=screen.availHeight,g=screen.availWidth,d=0,e=0,c="fullscreen=1,status=0,toolbar=0,location=1,menubar=0,resizable=1,scrollbars=0";break;case"standard":default:f=1e3,g=1040,d=h+60,e=i+20,c="status=1,toolbar=1,location=1,menubar=1,resizable=1,scrollbars=1,height="+f+",width="+g+",top="+d+",left="+e}var j={options:c,height:f,width:g,top:d,left:e};return BookingBuddy.TabbedWindowHandler.winProperties[b]=j,BookingBuddy.TabbedWindowHandler.winProperties[b]},getWindowOptions:function(a){if(BookingBuddy.TabbedWindowHandler.winSettings[a])return BookingBuddy.TabbedWindowHandler.winSettings[a];var b=BookingBuddy.TabbedWindowHandler.getWindowProperties(a),c=b.options;return BookingBuddy.TabbedWindowHandler.winSettings[a]=c,BookingBuddy.TabbedWindowHandler.winSettings[a]}}}(jQuery);
//# sourceMappingURL=BBTabbedWindowHandler.nano.js.map

!function(a){function b(c,d){this.options=a.extend({},b.defaults,d),this.wrapper=a(c),this.propertyId=a(this.options.propertyIdSelector,this.wrapper).first().text(),this.selectedEvent=this.options.selectedEvent,this.$attractionsTab=a(this.options.attractionContainer,this.wrapper),this.$reviewsTab=a(this.options.reviewContainer,this.wrapper),this.$mapTab=a(this.options.mapContainer,this.wrapper),this.$defaultTab=a("li.tab_nav.selected",this.wrapper),this.init()}b.defaults={attractionContainer:"#attractions_tab_content",reviewContainer:"#reviews_tab_content",mapContainer:"#map_tab_content",mapContent:".google_map",propertyIdSelector:".property_id",selectedEvent:"BBPropertyDetailTabs::selected",templates:{attraction:'<li><span class="ta_rating no_xs no_xs#{rating}"></span> #{distance} mi &mdash; #{name}</li>',review:'<div class="review #{hideReview}"> <div class="review_title">"#{title}"</div><div class="review_content"><div class="summary">#{summary}<span class="ellipsis #{noSummary}">&#8230;</span> <a href="#" class="#{noSummary}"> more &raquo;</a></div><div class="full hide">#{fullContent} <a href="#">&laquo; less</a></div><div class="review_byline">#{date} - #{author}</div> </div> </div>'},tabOptions:{attraction:{types:["Attraction","Eatery"],radius:75},reviews:{numVisible:3},map:{zoom:14,mapTypeControl:!1}}},b.prototype.init=function(){var b=this;a(".tab_nav",b.wrapper).click(a.proxy(b.tabClicked,b)),b.$attractionsTab.one(b.selectedEvent,a.proxy(b.loadAttractions,b)),b.$reviewsTab.one(b.selectedEvent,a.proxy(b.loadReviews,b)),b.$mapTab.one(b.selectedEvent,a.proxy(b.loadMap,b)),a(window).load(function(){b.$defaultTab.click()})},b.prototype.tabClicked=function(b){b.preventDefault(),b.stopPropagation(),a(".tab_nav, .tab",this.wrapper).removeClass("selected");var c=a(b.currentTarget),d=c.attr("id"),e=a("#"+d+"_content",this.wrapper);c.addClass("selected"),e.addClass("selected"),e.trigger(this.selectedEvent)},b.prototype.loadAttractions=function(){var b=this,c=b.buildAttractionTabOptions(),d=b.options.templates.attraction;a.bbget("Locs.getMultipleInRadius",c,function(c){if(a.isNullOrUndefined(c)||0===c.length)return b.$attractionsTab.children().hide(),void b.$attractionsTab.find(".error_message").show();var e,f,g;a.each(c,function(c,h){e=a("."+c+"_list",b.wrapper),f="<ul>",a.each(h,function(b,c){g={name:c.name,distance:Math.round(10*c.distance)/10,rating:c.rating},f+=a.tmpl(d,g)}),f+="</ul>",e.html(f)})})},b.prototype.loadReviews=function(){var b=this,c=b.options.templates.review,d=b.options.tabOptions.reviews.numVisible-1;a.bbget("HotelReviews.getFullReviews",{ta_hotel_id:b.propertyId},function(e){var f=a(".review_list",b.wrapper);if(!e||!e.reviews||0===e.reviews.length)return b.$reviewsTab.children().hide(),void b.$reviewsTab.find(".error_message").show();var g="",h=35;a.each(e.reviews,function(b,e){var f=e.reviewText.split(/\s+/),i=f.slice(0,h).join(" "),j=e.reviewText,k=f.length<=h?"hide":"",l=b>d?" hide":"",m={title:e.reviewTitle,summary:i,fullContent:j,date:e.reviewPublishDate,author:e.reviewer,noSummary:k,hideReview:l};g+=a.tmpl(c,m)}),f.html(g),$moreReviews=b.$reviewsTab.find(".more_reviews");var i="";e.location&&e.location.url&&(i=e.location.url,BookingBuddy.taReviewsMCID&&(i=i.replace("-Reviews","-m"+BookingBuddy.taReviewsMCID+"-Reviews")),"bookingbuddy_co_uk"==BookingBuddy.affiliateName&&(i=i.replace("tripadvisor.com","tripadvisor.co.uk"))),$moreReviews.one("click",function(b){if(b.stopPropagation(),b.preventDefault(),a(".review:hidden",f).slideDown(),$moreReviews.hasClass("popup")&&i){new ExternalPopup({url:i,location:ExternalPopup.LOCATIONS.ABOVE,type:ExternalPopup.TYPES.EVERYCLICK,placement:ExternalPopup.PLACEMENTS.CENTER,width:1e3,height:600,triggerElement:"#"+$moreReviews.attr("id")})}$moreReviews.click(function(){a.publish("/click/TAHotelReview",[this])})}),i&&($moreReviews.hasClass("popup")||$moreReviews.attr("href",i),$moreReviews.show()),b.$reviewsTab.find(".review a").click(function(b){b.preventDefault();var c=a(this).closest(".review_content"),d=c.find(".full").first(),e=c.find(".summary").first();d.toggle(),e.toggle()})})},b.prototype.loadMap=function(){var b=this,c=b.options.tabOptions.map,d=a(".latitude",b.$mapTab).text(),e=a(".longitude",b.$mapTab).text(),f={latitude:d,longitude:e},g=a(b.options.mapContent,b.mapContainer).googleMapFactory(f,c);BookingBuddy.Maps.createMarkerType("basicHotel"),g.addMarker(b.propertyId,{type:"basicHotel"},{coords:f},{clickable:!1}),g.toggleMarkersByType(!0)},b.prototype.buildAttractionTabOptions=function(){var a=this.options.tabOptions&&this.options.tabOptions.attraction?this.options.tabOptions.attraction:null,b=a&&a.types?a.types:["Attraction","Eatery"];radius=a&&a.radius?a.radius:20;var c={};for(type in b)c[b[type].toLowerCase()]={id:this.propertyId,radius:radius,type_filter:b[type]};return{requests:c}},a.fn.propertyDetailTabs=function(c){return this.each(function(){var d=a(this);if(!d.data("propertyDetailTabs")){var e=new b(this,c);d.data("propertyDetailTabs",e)}})}}(jQuery);
//# sourceMappingURL=BBPropertyDetailTabs.nano.js.map
!function(a){function b(c,d){this.options=a.extend({},b.defaults,d),this.element=a(c),this.listingWrapper=a(this.options.listingWrapper),this.listingPanel=a(this.options.listingPanel),this.results_container=a(this.options.results_container,this.listingWrapper),this.results_list=this.options.results_list?a(this.options.results_list,this.listingWrapper):a("<ul/>"),this.results_counters=a(this.options.results_counters,this.listingWrapper),this.results_container.append(this.results_list),this.message_container=a(this.options.message_container,this.listingWrapper),this.matching_results_message_container=a(this.options.matching_results_message_container,this.listingWrapper),this.selectorScrollToTop=a(this.options.selectorScrollToTop),this.header_message_container=a(this.options.header_message_container),this.csaEnabled=this.options.csaEnabled,this.hacReloadCounter=this.options.maxHACReloads,this.loader=null,this.controls=[],this.radius=this.options.defaultRadius,this.lastInteractedHotelId,this.initial_ta_id,this.forcedUserCountryCode,this.featured_property=null,this.property_container=a(this.options.property_container),this.formElements={},this.hotelCount=0,this.init()}b.defaults={animation_speed:500,listingWrapper:"#hotel_listing_results",listingPanel:".hotel_listing_panel",results_container:"#hotel_results",mini_listing_results_container:".hotelMiniListingResultsContainer",message_container:"#hotel_message",matching_results_message_container:"#results_message",property_container:".featured_hotel",selectorHACRefreshForm:"form.updateHotelListing",matching_results_message:"#{count} Hotels match your search criteria",matching_results_message_radius:"#{count} Hotels within #{radius} miles of #{location}",message_error:"Sorry, but an error has occurred",message_no_results:"No Hotels were found matching your criteria.  Please broaden your search.",message_no_results_for_dates:"Try changing your dates and search again.",header_message_container:"#header_title",header_message:"#{location} Hotels: #{count} Hotels Found",header_message_hac:"#{totalCount} #{location} Properties, #{count} Available On Your Dates!",dhtml_loader:"hotel_listing_loader",initial_ta_id:0,loader_left_offset:170,maxHACReloads:4,refreshingHAC:!1,csaEnabled:!1,defaultRadius:30,reloadPath:"/hotel_listings.php",controls:{city:{input:".hotel_listing .destination_city",type:"textbox",hide:!1,options:{locs_field:"city",apply_object:"#btn_update_id"}},hotel:{input:"#hotel_arrival_name",type:"textbox",hide:!1,options:{locs_field:"hotel_name"}},star_rating:{input:"#hotel_star_rating",type:"checkbox",hide:!1,options:{}},ta_rating:{input:"#hotel_ta_rating",type:"slider",hide:!1,options:{message:"#{low} - #{high}",locs_field:"rating",has_image:!1,slider_options:{min:1,max:5,step:.5,values:[1,5],range:!0}}},avg_price:{input:"#hotel_avg_price",type:"slider",hide:!1,options:{message:"$#{low} - $#{high}",locs_field:"avg_price",has_image:!1,slider_options:{min:10,max:500,step:10,values:[10,500],range:!0}}},amenities:{input:"#hotel_amenities",type:"checkbox",hide:!1,options:{locs_field:"amenities",collapsable:!0,startCollapsed:!0}},pager_top:{input:"#hotel_pager_top",type:"pager",hide:!1,options:{results_limit:10,locs_field:"offset"}},pager_bottom:{input:"#hotel_pager_bottom",type:"pager",hide:!1,options:{results_limit:10,locs_field:"offset"}},sorter:{input:"#hotel_sorter",type:"sorter",hide:!1,options:{fields:{star_rating:{text:"Star Rating",order:"desc"},revenue2:{text:"Popularity",order:"desc"},price_avg:{text:"Price",order:"asc"}}}}}},b.prototype.init=function(){var b=this;a.publish("BBHotelListing:hotelsFetched"),this.updateMessagingForNewHotelList(stm.pageData.hotelMetaData);var c=a.extend({},BookingBuddy.queryString);"radius"in c&&(this.radius=c.radius),this.options.initial_ta_id?this.initial_ta_id=this.options.initial_ta_id:"tid"in c?this.initial_ta_id=c.tid:"cityId"in c?this.initial_ta_id=c.cityId:stm.pageData.tid&&(this.initial_ta_id=stm.pageData.tid),"icak"in c&&(this.forcedUserCountryCode=c.icak),this.property_container.length>0&&(this.featured_property=this.property_container.find(".hotel_id").first().text()),this.initLoader(),this.featured_property&&(this.lastInteractedHotelId=this.featured_property),$j(document).on("mouseover",".metaWidget",function(a){b.captureInteractedHotelId(a.currentTarget)}),$j(document).on("mouseover",'form[data-stm-role="stm.bb.Views.searchForm.HotelListingFilter"]',function(a){b.clearInteractedHotelId()}),$j(".updateHotelListing").submit(function(a){a.preventDefault(),b.onHotelListFormSubmit(b)}),$j(document).on("click",".reset",function(a){a.preventDefault(),b.reset()}),a.each(this.options.controls,function(c,d){d.hide?a(d.input).hide():b.addControl(j.create(d.input,d.options,d.type))}),a.publish("/submit/hotelListingFilter",[stm.pageData.hotelMetaData]),this.originalLocationId=null;var d=stm.searchData;d&&d.getLocation2City()&&(this.originalLocationId=d.getLocation2City().id),a.subscribe("MetaWidget:searchCriteriaChanged",function(){b.populate()}),b.csaEnabled&&b.loadCSA(stm.pageData.hotelMetaData.city_name)},b.prototype.addControl=function(b){var c=this;a(b).bind("HotelListingControl:update",function(a,b){c.populate()}),c.controls.push(b)},b.prototype.captureInteractedHotelId=function(b){this.lastInteractedHotelId=a(b).data("hotelId")},b.prototype.clearInteractedHotelId=function(){this.lastInteractedHotelId=0},b.prototype.reset=function(){a.each(this.controls,function(a,b){b.reset()}),this.hacFormDisabled=!0,this.populate(),this.hacFormDisabled=!1},b.prototype.handleError=function(a,b){b&&this.header_message_container.text(b),this.message_container.html(a).show(),this.results_container.hide()},b.prototype.populate=function(){var b=this,c=(this.options,this.getFilterParams());c.action="fetchListings",this.initial_ta_id&&(c.tid=this.initial_ta_id),this.forcedUserCountryCode&&(c.icak=this.forcedUserCountryCode),a.ajax({type:"GET",url:b.options.reloadPath,data:c,error:function(a){b.handleHotelListRetrievalError()},beforeSend:function(){b.message_container.hide(),b.results_container.show(),b.showLoading()},complete:function(){},success:function(a){b.handleHotelListRetrievalSuccess(a)}})},b.prototype.handleHotelListRetrievalError=function(){var a=this;a.handleError(a.options.message_error),a.hideLoading(),a.hacReloadCounter=a.options.maxHACReloads},b.prototype.handleHotelListRetrievalSuccess=function(c){var d=this,e=stm.parseJSON(c);if(e&&e.success&&e.metaData){var f=e.metaData,g=f.count;d.refreshingHAC=f.auto_reload&&d.hacReloadCounter>0,a.publish("/submit/hotelListingFilter",[f]),g&&f.city_name&&d.updateMessagingForNewHotelList(f),0===g?d.handleNoHotelsResult(f):d.handleHotelsResult(e)}else d.handleError(d.options.message_error),d.hideLoading(),d.hacReloadCounter=d.options.maxHACReloads,d.refreshingHAC=!1,d.property_container[0]&&b.initHotelImages()},b.prototype.updateMessagingForNewHotelList=function(b){var c=this,d=b.count,e="";e=b.using_hac?a.tmpl(c.options.header_message_hac,{count:d,totalCount:b.total_count,location:b.city_name}):a.tmpl(c.options.header_message,{location:b.city_name,count:d}),c.header_message_container.text(e);var f=a.tmpl(c.options.matching_results_message,{count:d});c.matching_results_message_container.text(f)},b.prototype.handleNoHotelsResult=function(c){var d=this;if(d.refreshingHAC)d.hacReloadCounter--,setTimeout(function(){d.populate()},1e3);else{d.hideLoading(),d.results_list.find("li").fadeOut(d.options.animation_speed).remove();var e='<a href="#" class="reset clearForm">view all hotels</a>',f=d.isFilteringActive()?d.options.message_no_results:d.options.message_no_results_for_dates;d.handleError(a.tmpl(f,{reset:e}),d.options.header_message_no_results),d.hacReloadCounter=d.options.maxHACReloads,c.using_hac&&a.publish("/submit/HACSearch"),d.property_container[0]&&b.initHotelImages()}},b.prototype.handleHotelsResult=function(b){var c=this,d=b.metaData,e=d.count;c.refreshingHAC&&c.hotelCount==e||!b.html||c.displayNewHotels(b),c.hotelCount=e,c.updateFeaturedPropertyPrice(d),c.refreshingHAC?(c.hacReloadCounter--,setTimeout(function(){c.populate()},1e3)):(c.hideLoading(),c.hacReloadCounter=c.options.maxHACReloads,d.using_hac&&a.publish("/submit/HACSearch"))},b.prototype.displayNewHotels=function(c){var d=this,e=c.metaData;if(a.support.opacity){var f=d.results_container.height();d.results_container.animate({opacity:0},200,"linear",function(){d.results_container.height(f).empty().append(c.html),d.csaEnabled&&!d.refreshingHAC&&"0"===e.offset&&d.loadCSA(e.city_name),d.refreshingHAC||(b.initHotelImages(),a.publish("BBHotelListing:hotelsFetched")),d.results_container.animate({opacity:1},200,"linear",function(){d.results_container.css("height","auto")})})}else d.results_container.empty().append(c.html),d.csaEnabled&&!d.refreshingHAC&&"0"===e.offset&&d.loadCSA(e.city_name),d.refreshingHAC||(b.initHotelImages(),a.publish("BBHotelListing:hotelsFetched"));$j(d.options.mini_listing_results_container).hide().html(c.miniListingHtml)},b.prototype.updateFeaturedPropertyPrice=function(a){var b=this;if(a.show_price&&b.property_container[0]){var c=b.property_container.find(".hotel_price");a.property_price?(a.using_hac?c.addClass("show_best"):c.removeClass("show_best"),c.find(".price_number").text(a.property_price)):c.removeClass("show_best"),c.show()}},b.prototype.maskElement=function(b){var c=b.find(".mask");c[0]||(c=a('<div class="mask"></div>').hide(),b.append(c)),c.is(":hidden")&&(b.addClass("masked"),c.show())},b.prototype.unmaskElement=function(a){a.find(".mask").hide(),a.removeClass("masked")},b.prototype.initLoader=function(){this.loader=DHTMLPopup_Factory.create({type:"layer",id:this.options.dhtml_loader});var b=this.results_container.offset();a("#"+this.options.dhtml_loader).css({left:b.left+this.options.loader_left_offset+"px"}),this.loader.addElement(this.options.dhtml_loader),this.loader.hide()},b.prototype.showLoading=function(){var b=this;a("#"+this.options.dhtml_loader).css({top:a(window).scrollTop()+a(window).height()/3+"px"}),b.loader.show(),b.maskElement(b.listingPanel)},b.prototype.hideLoading=function(){var a=this;a.loader.hide(),a.unmaskElement(a.listingPanel)},b.initHotelImages=function(){var a=new BBHotelImages;a.loadHotelImages()},b.prototype.setTaId=function(a){this.options.initial_ta_id=a},b.prototype.onHotelListFormSubmit=function(b){var c=$j('input[data-stm-role="location2"]').val();c&&a.ajax({url:b.options.reloadPath,data:{action:"getTAIdFromName",name:c},success:function(d){var e=stm.parseJSON(d);if(e.success&&e.id){var f=BookingBuddy.queryString;f.arrival_city=c,f.tid=e.id,a(location).attr("href",b.options.reloadPath+"?"+a.toQueryString(f))}}})},b.prototype.getFilterParams=function(){var b={now:(new Date).getTime(),mcid:BookingBuddy.taCheckRatesMCID},c=this;this.radius&&(b.radius=this.radius),this.initial_ta_id&&(b.location=this.initial_ta_id);var d=stm.searchData;return d&&!this.hacFormDisabled&&(b.inDate=d.getDate1()?d.getDate1().getTime()/1e3:0,b.outDate=d.getDate2()?d.getDate2().getTime()/1e3:0,b.guests=d.getTravelers()),this.featured_property&&(b.featured_property_id=this.featured_property),this.controls&&a.each(c.controls,function(c,d){d&&a.extend(!0,b,d.getParams())}),b},b.prototype.isFilteringActive=function(){var b=this,c=!1;return b.controls&&a.each(b.controls,function(a,b){return b&&b.isFilteringActive()?(c=!0,!1):void 0}),c},b.prototype.loadCSA=function(b){if(!a.isFunction(_googCsa)||a.isNullOrUndefined(adblock1)||a.isNullOrUndefined(adblock2))return this;var c=this.results_container.find("#results_list > li").length,d=this.results_container.find("#results_list > li:nth(2)");return c>=10&&d.length?(a(d).after(a("<li>").append('<div class="mvcView googleCSA uk"><div class="csaAdBlockTitle"><span>'+b+' Hotels</span> sponsored links</div><div class="clear"></div><div class="csaAdBlock" id="csaContainer2"></div></div>')).addClass("noBorder"),_googCsa("ads",pageOptions,adblock1,adblock2)):_googCsa("ads",pageOptions,adblock1),this};var c=Object.subClass({init:function(b,c){this.element=a(b),this.options=a.extend({},this.defaults,c),this.element.data("HotelListingControl",this),a.subscribe("/submit/hotelListingFilter",a.proxy(this.hostUpdated,this))},defaults:{},hostUpdated:function(a){},getParams:function(){},reset:function(){},isFilteringActive:function(){}}),d=c.subClass({init:function(b,c){this._super(b,c),this.value=this.options.default_key,this.sort_order=this.options.default_sort_order;var d=this;this.prices_active=!1,d.element.append(a("<label />",{text:d.options.label_text})),a.each(this.options.fields,function(b,c){var e=b==d.options.default_key;d.element.append(a("<a />",{href:"#",text:c.text,"class":e?"active "+c.order:c.order,click:function(c){c.preventDefault();var e=a(this);b==d.value?e.hasClass("desc")?(e.removeClass("desc").addClass("asc"),e.next(".arrow.active").removeClass("desc").addClass("asc"),d.sort_order="asc"):e.hasClass("asc")&&(e.removeClass("asc").addClass("desc"),e.next(".arrow.active").removeClass("asc").addClass("desc"),d.sort_order="desc"):(d.value=b,d.sort_order=e.hasClass("desc")?"desc":"asc",e.siblings("a.active").removeClass("active"),e.addClass("active"),e.siblings(".arrow.active").removeClass("active"),e.next(".arrow").addClass("active")),"price_avg"==b&&(d.prices_active=!0),a(d).trigger("HotelListingControl:update",d)}})),d.element.append(a("<span />",{"class":"arrow "+c.order+(e?" active":"")})),d.element.append(a("<span />",{"class":"delimeter",html:d.options.delimiter}))}),d.element.find("span.delimeter").last().remove()},defaults:{label_text:"Sort by:",locs_field:"sort_field",delimiter:"|",default_key:"revenue2",default_sort_order:"desc",fields:{star_rating:{text:"Star Rating",order:"desc"},revenue2:{text:"Popularity",order:"desc"},price_avg:{text:"Price",order:"desc"}}},getParams:function(){var a={filter:{}};return this.value&&(a.filter[this.options.locs_field]=this.value),this.sort_order&&(a.filter.sort_order=this.sort_order),this.prices_active&&(a.filter.prices_active=this.prices_active),a},reset:function(){},isFilteringActive:function(){return!1}}),e=c.subClass({init:function(b,c){this._super(b,c),this.page_number=0,this.pages=0,this.isReset=!1;var d=this;a(document).bind("HotelListingControl:pagerUpdated",function(a,b){d.updateDisplay(b)}),this.buildControl()},defaults:{results_limit:10,message:"Page #{low} of #{high}",selectorScrollToTop:"#hotel_listing_results"},buildControl:function(){this.element.hide();var b=this,c=this.element.attr("id");this.first=a("<a />",{id:c+"_first","class":"first pointer",text:"    ",target:"_blank",click:function(){b.clickHandler(0)}}),this.prev=a("<a />",{id:c+"_prev","class":"previous pointer",text:"   ",target:"_blank",click:function(){b.clickHandler(b.page_number-1)}}),this.message=a("<span />",{id:c+"_message"}),this.next=a("<a />",{id:c+"_next","class":"next pointer",text:"   ",target:"_blank",click:function(){b.clickHandler(b.page_number+1)}}),this.last=a("<a />",{id:c+"_last","class":"last pointer",text:"    ",target:"_blank",click:function(){b.clickHandler(b.pages)}}),this.element.append(b.first),this.element.append(b.prev),this.element.append(b.message),this.element.append(b.next),this.element.append(b.last)},hostUpdated:function(a){var b=this;this.pages=Math.ceil(a.count/b.options.results_limit)-1,(this.page_number<0||this.page_number>this.pages)&&(this.page_number=0),this.updateDisplay(b.page_number),this.pages<=0?this.element.hide():this.element.show()},clickHandler:function(b){if(!(this.page_number==b||0>b||b>this.pages)){if(this.element.hasClass("pager_bottom")){var c=$j(this.options.selectorScrollToTop).position().top;$j("html, body").animate({scrollTop:c},"slow")}a(document).trigger("HotelListingControl:pagerUpdated",b),this.isReset||a(this).trigger("HotelListingControl:update",this)}},updateDisplay:function(b){this.page_number=b,this.message.text(a.tmpl(this.options.message,{low:this.page_number+1,high:this.pages+1}))},getParams:function(){return{limit:this.options.results_limit,offset:this.page_number*this.options.results_limit}},reset:function(){this.isReset=!0,this.clickHandler(0),this.isReset=!1},isFilteringActive:function(){return!1}}),f=c.subClass({init:function(b,c){var d=this;this._super(b,c),this.textbox=this.element.find("input:text"),this.location_suggest=function(a){return"location2"==a.attr("data-stm-role")||a.hasClass("locationSuggest")}(this.textbox),this.options.apply_object?this.apply_object=a(this.options.apply_object):this.apply_object=this.element.find(".apply"),this.apply_object.bind(this.options.apply_trigger,function(){return d.location_suggest?void a.ajax({url:d.options.reloadPath,data:{action:"getTAIdFromName",name:d.textbox.val()},success:function(b){var c=stm.parseJSON(b);if(c.success&&c.id){var e=BookingBuddy.queryString;e.tid=c.id,a(location).attr("href",d.options.reloadPath+"?"+a.toQueryString(e))}}}):void a(d).trigger("HotelListingControl:update",d)})},hostUpdated:function(a){this.location_suggest&&"city_display_text"in a&&this.textbox.val(a.city_display_text)},defaults:{reloadPath:"/hotel_listings.php",default_value:"",locs_field:"",apply_trigger:"click",apply_object:null},getParams:function(){var a={filter:{}};return a.filter[this.options.locs_field]=this.textbox.val(),a},reset:function(){},isFilteringActive:function(){return this.textbox.val()!=this.options.default_value}}),g=c.subClass({init:function(b,c){this._super(b,c),this.checkboxes=this.element.find("input:checkbox"),this.nondefault_checkboxes=this.element.find("input:checkbox.nondefault"),this.initial_load=!0;var d=this;a(".apply",this.element).click(function(){a(this).is(":checked")&&(a(this).hasClass("default")?d.nondefault_checkboxes.prop("checked",!1):a("input.default",d.element).prop("checked",!1)),a(d).trigger("HotelListingControl:update",d)}),this.reset()},defaults:{locs_field:"star_rating",collapsable:!1,showMoreText:"Show more &#187;",showLessText:"Show less &#171;",collapseMoreClass:"collapseMore",collapseLessClass:"collapseLess",startCollapsed:!1,minCollapsed:10},getHeights:function(a){for(var b=0,c=this.element.find("ul li"),d=a;d--;)c[d]&&(b+=c.eq(d).outerHeight(!0));return b},updateHeights:function(){},initCollapsable:function(){var b=this.options.startCollapsed?this.options.showMoreText:this.options.showLessText;this.collapseLink=a("<div />",{"class":"show_more_less pointer",html:b}),this.element.after(this.collapseLink),this.minHeight=function(a){return a.getHeights(a.options.minCollapsed)}(this),this.maxHeight=function(a){return a.getHeights(a.checkboxes.length)}(this),this.options.startCollapsed&&(this.element.height(this.minHeight+"px"),this.element.addClass(this.options.collapseMoreClass)),this.collapseLink.click(a.proxy(this.collapseClickHandler,this))},collapseClickHandler:function(){var a=this.collapseLink;this.element.hasClass(this.options.collapseMoreClass)?(this.element.animate({height:this.maxHeight+"px"},500),this.element.removeClass(this.options.collapseMoreClass).addClass(this.options.collapseLessClass),a.html(this.options.showLessText)):(this.element.animate({height:this.minHeight+"px"},500),this.element.removeClass(this.options.collapseLessClass).addClass(this.options.collapseMoreClass),a.html(this.options.showMoreText))},hostUpdated:function(b){if(b&&this.options.locs_field in b){for(var c=null,d=null,e=b[this.options.locs_field],f=this.checkboxes.length,g=null,h=f;h--;)g=a(this.checkboxes[h]),c=g.nextAll("span.value").text(),d=g.nextAll("span.count"),c in e?(d.text(" ("+e[c]+")"),g.prop("disabled",!1)):(d.text(" (0)"),g.is(":checked")||g.prop("disabled",!0));this.options.collapsable&&this.initial_load&&this.initCollapsable()}this.initial_load=!1},getCheckedValues:function(){var b=[];return a("input:checked",this.element).each(function(){b.push(a(this).nextAll("span.value").text())}),b},getParams:function(){var a={filter:{}};return a.filter[this.options.locs_field]=this.getCheckedValues(),a},reset:function(){this.element.find("input:checked").prop("checked",!1),a("input.default",this.element).prop("checked",!0)},isFilteringActive:function(){var a=this.getCheckedValues();return 1!=a.length||"All"!=a[0]}}),h=c.subClass({init:function(b,c){this._super(b,c),this.isReset=!1;var d=this;this.prices_active=!1,this.is_range=function(a){return a.options.slider_options.range===!0}(this),this.default_value=function(a){var b=[];return b.push(a.options.slider_options.min),a.is_range&&b.push(a.options.slider_options.max),b}(this),this.currentValues=this.default_value,this.message_container=this.options.message?a("<div />",{"class":this.options.message_class}):null,this.image_container=this.options.has_image?a("<span />",{"class":this.options.image_class}):null,this.slider=a("<div />",{"class":"slider"}).slider(this.options.slider_options),this.element.append(this.image_container),this.element.append(this.slider),this.element.append(this.message_container),this.reset(),this.slider.slider("option","slide",function(a,b){d.slide(b.values||[b.value])}),this.slider.slider("option","change",function(b,c){"avg_price"!=d.options.locs_field||d.isReset||(d.prices_active=!0);var e=c.values||[c.value],f=!1;for(i in e)f=f||e[i]!=d.currentValues[i];d.currentValues=e,f&&!d.isReset&&a(d).trigger("HotelListingControl:update",d)})},defaults:{message:"#{low} stars & above",message_all:"All",message_class:"slider_message",has_image:!0,image_class:"",image_prefix:"s",locs_field:"star_rating",slider_options:{min:0,max:5,step:.5,range:"max"}},templatize_value:function(a){var b={};return void 0!==a[0]&&(b.low=a[0]),void 0!==a[1]&&(b.high=a[1]),b},slide:function(b){this.value=b;var c=this.templatize_value(b);if(this.image_container){this.image_container[0].className=this.image_container[0].className.replace(/ s\d{1,2}/g,"");var d=10*c.low;10>d&&(d="0"+d),this.image_container.addClass(this.options.image_prefix+d)}this.message_container&&this.message_container.text(void 0!==c.low&&void 0===c.high&&0===c.low?this.options.message_all:a.tmpl(this.options.message,c))},getParams:function(){var a={filter:{}};return a.filter[this.options.locs_field]=this.value,this.prices_active&&(a.filter.prices_active=this.prices_active),a},reset:function(){this.isReset=!0,this.slider.slider(this.is_range?"values":"value",this.default_value),this.slide(this.default_value),this.isReset=!1},isFilteringActive:function(){return this.value!=this.default_value}}),j={types:{slider:h,textbox:f,sorter:d,pager:e,checkbox:g},create:function(a,b,c){var d=null;if(c&&c in this.types){var e=this.types[c];d=new e(a,b)}return d}};a.fn.hotelListing=function(c){return this.each(function(){var d=a(this);if(!d.data("hotelListing")){var e=new b(this,c);d.data("hotelListing",e)}})}}(jQuery);
//# sourceMappingURL=BBHotelListing.nano.js.map
var BBHotelImages=Object.subClass({hotelIDs:[],hotelIDElms:[],imgSize:"thumbnail",init:function(){var a=$j("div.hotel_img > span.hotel_id:not(.loaded)"),b=this;return 0===a.length?this:(b.hotelIDs=[],b.hotelIDElms=[],a.each(function(a,c){b.hotelIDs.push($j(c).text()),b.hotelIDElms.push($j(c))}),this)},loadHotelImages:function(){var a=this.hotelIDs,b=this.hotelIDElms,c=this;if(0===a.length||0===b.length)return this;return stm.shared.models.hotelImageGallery.getInstance().findImages(a,function(d){if(d){for(var e,f,g,h,i=!1,j=null,k=a.length,l=c.imgSize,m="bookingbuddy_co_uk"===BookingBuddy.affiliateName,n=!1,o=k;o--;)if(j=a[o],e=b[o],f=e.parent(),g=e.siblings(".default_hotel_img").first(),0!==g.length){var p=f.attr("data-image-size");if(p||(p=l),i=d[j]&&d[j][0],i&&(h=$j("<img />",{"class":"hotel_img hotel_photo",src:d[j][0][p]}),g.replaceWith(h),e.addClass("loaded"),f.parents(".j-center-image").length&&h.on("load",$j.proxy(function(){if(this.image.height()<125&&this.image.width()<125&&!this.container.parent().hasClass("j-allow-tiny-images"))return this.container.hide(),void(this.container.parents(".bbs2786")&&(this.container.parent().hide(),$j(".ta_rating_title").show()));var a="hidden"===this.container.css("overflow");a&&this.image.height()>this.container.height()&&this.image.css("margin-top",(this.image.height()-this.container.height())/-2),a&&this.image.width()>this.container.width()&&this.image.css("margin-left",(this.image.width()-this.container.width())/-2)},{container:f,image:h}))),f.parents(".j-more-hotel-links").length){var q=$j('<div class="more_links" />');if(f.after(q),i);else f.hide()}m&&(n=f.parent().hasClass("property_lefthand"),n&&(i?f.parent().show():(f.parent().hide(),$j(".ta_rating_title").show()))),e=null}stm.AutoResizeImage&&stm.autoInitialize.loadClass(stm.AutoResizeImage,"check-rates-resize-image",!1)}}),this}});
//# sourceMappingURL=BBHotelImages.nano.js.map

BookingBuddy.Deals={pubIDS:{tiphero:69,travelmuse_v2:65,trazzler:23,frommers:68,nileguide:67,canuckabroad:73,travelation:36},dealsArray:[],feedUrl:null,init:function(a){$j.each(a,function(a,b){BookingBuddy.Deals[a]=b}),$j.each(BookingBuddy.Deals.dealsArray,function(a,b){$j("#"+b.displayConfig.target_input).length>0&&("select"===$j("#"+b.displayConfig.target_input).get(0).tagName?$j("#"+b.displayConfig.target_input).change(function(){b.options.arrival_city=$j(this).val(),BookingBuddy.Deals.fetchBBDeals(b)}):$j("#"+b.displayConfig.target_input).hasClass("locationSuggest")?$j("#"+b.displayConfig.target_input).bind("LocationSuggest:valid",function(){b.options.arrival_city=$j(this).val(),BookingBuddy.Deals.fetchBBDeals(b)}):$j("#"+b.displayConfig.target_input).blur(function(){b.options.arrival_city=$j(this).val(),BookingBuddy.Deals.fetchBBDeals(b)})),BookingBuddy.Deals.fetchBBDeals(b)}),BookingBuddy.Deals.dealsArray=[]},register:function(a,b,c){var d={insertType:"update",divDealsHeader:"BB-deals-header",headerMsg:" Deals",divDeals:"BB-deals-section",divErrorMsg:"BB-deals-error-msg",errorMsg:"No deals available at this time.",onError:null,onSuccess:null,dealTemplate:BookingBuddy.Strings.Deals.DefaultTemplate,cityName:null,target_input:void 0};$j.isNullOrUndefined(b)||$j.extend(d,b);var e={no_ads:"5",deal_type:"vacation_rental"==BookingBuddy.searchMode?"car":"air"==BookingBuddy.searchMode?"vacation":BookingBuddy.searchMode};$j.extend(e,a),"undefined"!=typeof this.pubIDS[BookingBuddy.affiliateName]&&(a.publisher_id=this.pubIDS[BookingBuddy.affiliateName]),BookingBuddy.Deals.dealsArray.push({options:e,displayConfig:d,type:c})},addDealTracking:function(a,b){return a.click(function(a){a.preventDefault(),$j.publish("/click/bbdeal",[b,this])}),a},fetchBBDeals:function(a){$j.bbget(BookingBuddy.Deals.feedUrl,a.options,function(b){if(!$j.isNullOrUndefined(b))switch(b.errorstr||(b[0].destination?(a.displayConfig.cityName=b[0].destination,b.splice(0,1)):a.displayConfig.cityName=null),a.type){case"targeted_deals":BookingBuddy.Deals.View.targetedDeals(b,a.displayConfig);break;case"split_deals":BookingBuddy.Deals.View.splitDeals(b,a.displayConfig);break;case"top_deals":default:BookingBuddy.Deals.View.topDeals(b,a.displayConfig)}},"json")}},BookingBuddy.Deals.View={targetedDeals:function(a,b){$targetedDiv=b.containerDivs,$targetedDiv[0]&&(a.errorstr?"function"==typeof b.onError&&b.onError():($j.each(a,function(a,c){var d=$j.tmpl(b.dealTemplate,c),e=BookingBuddy.Deals.addDealTracking($j(d),c.obj);$targetedDiv.append(e)}),"function"==typeof b.onSuccess&&b.onSuccess()))},splitDeals:function(a,b){if($splitDivs=b.containerDivs,$splitDivs[0])if(a.errorstr)"function"==typeof b.onError&&b.onError();else{var c=$splitDivs.size(),d=$j.getSize(a),e=Math.ceil(d/c);$j.each(a,function(a,c){a=Math.floor(a/e);var d=$j.tmpl(b.dealTemplate,c),f=BookingBuddy.Deals.addDealTracking($j(d),c.obj);$j($splitDivs[a]).append(f)}),"function"==typeof b.onSuccess&&b.onSuccess()}},topDeals:function(a,b){if($topDealsDiv=b.containerDivs,$topDealsDiv[0])if($contentDiv=$topDealsDiv.find("#"+b.divDeals),$contentDiv[0]||($contentDiv=$topDealsDiv),a.errorstr){"function"==typeof b.onError&&b.onError();var c='<span id="'+b.divErrorMsg+'">'+b.errorMsg+"</span>";$j("#"+b.divDeals).html(c),$j("#"+b.divErrorMsg).length>0&&$j("#"+b.divErrorMsg).show()}else{if(b.cityName){var d=$topDealsDiv.find("."+b.divDealsHeader);d[0]&&d.html(b.cityName+b.headerMsg)}var e=0;"update"==b.insertType&&$j("#"+b.divDeals).html(""),$j.each(a,function(a,c){if(e%2===0&&(c.row_type="odd"),c.dollar="",void 0!==b.priceNoDollarSymbol&&"$"===c.price.charAt(0)&&(c.dollar="$",c.price=c.price.substring(1)),b.fold_destination){var d=c.destination_name.indexOf(",");d>0?c.destination_name_folded=c.destination_name.replace(/, /i,",<br />"):c.destination_name_folded=c.destination_name}b.fold_price&&c.price.toLowerCase().indexOf("off")>0&&(c.price=c.price.replace(/ off/i,"<br />off"));var f=$j.tmpl(b.dealTemplate,c),g=BookingBuddy.Deals.addDealTracking($j(f),c.obj);$contentDiv.append(g),e++}),$j("#"+b.divErrorMsg)[0]&&$j("#"+b.divDeals).hide(),"function"==typeof b.onSuccess&&b.onSuccess()}}};
//# sourceMappingURL=Deals.nano.js.map
var SortableFareListing=Object.subClass({fare_table:null,fare_row_template:null,fares:[],sort_field:"",sort_asc:!0,sort_headers:[],filters:[],init:function(a,b){this.fare_table=$j("#"+a),this.fare_row_template=b},addFare:function(a){this.fares.push(a)},addFares:function(a){$j.each(a,$j.proxy(function(a,b){this.addFare(b)},this))},clearTable:function(){var a=$j(".sortable_fare_listing_row");a.length>0&&($j.each(a,function(a,b){$j(b).hide().addClass("sortable_fare_listing_garbage_collect")}),setTimeout(function(){$j(".sortable_fare_listing_garbage_collect").remove()},1500))},display:function(){this.clearTable();var a=$j(this.fare_table).find("tbody"),b="";$j.each(this.filterFares(),$j.proxy(function(a,c){b+='<tr class="sortable_fare_listing_row ',a%2&&(b+=" odd"),b+='">'+$j.tmpl(this.fare_row_template,c)+"</tr>"},this)),$j(a).append(b)},addFilterToggle:function(a,b,c){var d=$j("#"+a);d.length>0&&(this.filters.push({input:d,field:b,container:$j("#"+c)}),d.bind("change",$j.proxy(this.display,this)))},filterFares:function(){var a=[];$j.each(this.filters,function(b,c){var d=$j(c.input),e=d.val();0!==e.length&&d.is(":checked")&&a.push({field:c.field,value:e})});var b=[];return $j.each(this.fares,function(c,d){display_fare=!0,$j.each(a,function(a,b){d[b.field]!=b.value&&(display_fare=!1)}),display_fare&&b.push(d)}),$j.each(this.filters,function(a,c){var d=!1;$j.each(b,function(a,b){b[c.field]==c.input.val()&&(d=!0)}),d?c.input.removeAttr("disabled"):c.input.prop("disabled",!0),c.container.length>0&&(d?c.container.removeClass("filter_disabled"):c.container.addClass("filter_disabled"))}),b},addSortableColumn:function(a,b){var c=$j("#"+a);return c.length>0?(this.sort_headers.push(c),c.addClass("sortable"),c.bind("click",$j.proxy(function(){this.sortTable(a,b)},this)),!0):!1},clearSortHeaders:function(){$j.each(this.sort_headers,function(a){$j(a).removeClass("asc desc")})},sortTable:function(a,b){var c=$j("#"+a);c.length>0&&(this.clearSortHeaders(),b==this.sort_field?this.sort_asc=!this.sort_asc:(this.sort_field=b,this.sort_asc=!0),c.addClass(this.sort_asc?"asc":"desc"),this.fares.sort($j.proxy(this.sortHelper,this)),this.display())},sortHelper:function(a,b){var c=a[this.sort_field],d=b[this.sort_field];"price"===this.sort_field&&(c=this.sanitizeFare(""+c),d=this.sanitizeFare(""+d));var e;return e=c>d?1:c===d?0:-1,this.sort_asc||(e=-e),e},sanitizeFare:function(a){var b=a.replace(",","");return parseInt(b,10)}});
//# sourceMappingURL=SortableFareListing.nano.js.map
!function(a){a(document).ready(function(){a("form#change_prefs_form").length>0&&(a("#edit_prefs_section_initial").bind("STMToggle:initialStateShow",function(b){var c=a.trim(a("#email_initial").html()),d=a.trim(a("#zip_us_initial").html()),e=a.trim(a("#zip_other_initial").html()),f=a.trim(a("#airport_initial").html());a("#change_prefs_new_email").val(c),a("#change_prefs_new_email_verify").val(c),a("#change_prefs_postalcode_us").val(d),a("#change_prefs_postalcode_other").val(e),a("#change_prefs_preferred_airport").val(f),a("#change_prefs_form").data("smartForm").clearErrors()}),a("#edit_prefs_section_initial").bind("STMToggle:initialStateHide",function(b){var c=a.trim(a("#email_initial").html()),d=(a.trim(a("#zip_us_initial").html()),a.trim(a("#zip_other_initial").html()),a.trim(a("#airport_initial").html()));a("#change_prefs_new_email").val(c),a("#change_prefs_new_email_verify").val(""),a("#change_prefs_postalcode").val(_initial_zip),a("#change_prefs_preferred_airport").val(d)}),a("#change_prefs_form").smartFormFactory(),a("#change_prefs_form").bind("SmartForm:invalid",function(b){a("#basic_content").position().top&&window.scrollTo(0,a("#basic_content").position().top)}))}),SubPrefsPane=Object.subClass({checkbox:null,prefs_pane:null,subscription_count:0,subscriptions_index:0,max_subscriptions:-1,subscriptions_div:null,add_buttons:[],route_prefix:"",subscription_row_template:"",init:function(b,c,d){this.checkbox=a("#"+b),this.prefs_pane=a("#"+c),this.subscriptions_div=a("#"+d),this.checkbox.change(a.proxy(this.toggleDisplay,this)),this.checkbox.click(a.proxy(this.toggleDisplay,this)),this.toggleDisplay()},toggleDisplay:function(){this.checkbox.is(":checked")?this.prefs_pane.show():this.prefs_pane.hide()},addSubscriptionRow:function(b){b||(b={}),this.subscription_count++,this.subscriptions_index++;var c=this.subscriptions_index;b.id=c;var d=$j.tmpl(this.subscription_row_template,b);return this.subscriptions_div.append(d),this.subscription_count>=this.max_subscriptions&&a.each(this.add_buttons,function(){a(this).hide()}),a("#remove_subscription_"+this.id_prefix+c).click(a.proxy(function(){this.removeSubscriptionRow(c)},this)),c},removeSubscriptionRow:function(b){var c=a("#subscription_row_"+this.id_prefix+b);c&&(this.subscription_count--,c.remove(),0===this.subscription_count&&(this.checkbox.prop("checked",!1),this.toggleDisplay(),this.addSubscriptionRow()),this.subscription_count<this.max_subscriptions&&a.each(this.add_buttons,function(){a(this).show()}))},createAddRowButton:function(b){var c=a("#"+b);this.add_buttons.push(c),c.click(a.proxy(this.addSubscriptionRow,this))}}),DeparturePrefsPane=SubPrefsPane.subClass({subscription_row_template:"<div id='subscription_row_departure_#{id}' class='departure_city_sub'><input type='text' id='departure_city_#{id}' name='departure_city[]' value='#{city}' /><select id='departure_frequency_#{id}' class='departure_nl_frequency' name='departure_frequency[]'><option value='daily'>Daily (up to 7 times per week)</option><option value='frequent'>Frequent</option><option value='weekly'>Weekly</option></select><div id='remove_subscription_departure_#{id}' class='remove_departure_city'>remove</div></div>",max_subscriptions:5,id_prefix:"departure_",addSubscriptionRow:function(b,c){a.isString(b)||(b=""),a.isString(c)||(c="frequent");var d=this._super({city:b,frequency:c});$j("#"+this.id_prefix+"frequency_"+d).val(c);new LocationSuggest("departure_city_"+d,["airport"])}}),RoutePrefsPane=SubPrefsPane.subClass({subscription_row_template:"<div id='subscription_row_route_#{id}' class='route_sub'><div class='route_inputs'><input type='text' id='route_departure_city_#{id}' name='route_departure_city[]' value='#{departure_city}' /> to <input type='text' id='route_arrival_city_#{id}' name='route_arrival_city[]' value='#{arrival_city}' /></div><div id='remove_subscription_route_#{id}' class='remove_route'>remove</div></div>",max_subscriptions:25,id_prefix:"route_",addSubscriptionRow:function(b,c){a.isString(b)||(b=""),a.isString(c)||(c="");var d=this._super({departure_city:b,arrival_city:c});new LocationSuggest("route_departure_city_"+d,["airport"]),new LocationSuggest("route_arrival_city_"+d,["airport"])}}),HotelWatchPrefsPane=SubPrefsPane.subClass({subscription_row_template:"<div id='subscription_row_hotel_watch_#{id}' class='hotel_watch_city_sub'><input type='text' id='hotel_watch_city_#{id}' name='hotel_watch_city[]' value='#{city}' /><select id='hotel_watch_frequency_#{id}' class='hotel_watch_frequency' name='hotel_watch_frequency[]'><option value='daily'>Daily (up to 7 times per week)</option><option value='frequent'>Frequent</option><option value='weekly'>Weekly</option></select><div id='remove_subscription_hotel_watch_#{id}' class='remove_hotel_watch_city'>remove</div></div>",max_subscriptions:10,id_prefix:"hotel_watch_",addSubscriptionRow:function(b,c){a.isString(b)||(b=""),a.isString(c)||(c="frequent");var d=this._super({city:b});$j("#"+this.id_prefix+"frequency_"+d).val(c);new LocationSuggest("hotel_watch_city_"+d,["city"])}})}(jQuery);
//# sourceMappingURL=SubPrefsPane.nano.js.map
var ContentFrame=Object.subClass({elm:null,data_sel:".meta_data",data:null,endpoint:"",init:function(a){this.elm=$j(a),this.elm.length&&(this.data={},this._loadMetaData())},load:function(a){if(!this.endpoint||!this.elm.length)return!1;var b=this._buildFrame();return b?(this.elm.html(b),a!==!1&&this.elm.show(),!0):!1},_loadMetaData:function(){var a=$j(this.data_sel,this.elm);a.length&&(this.data=$j.parseJSON(a.text()),this.data.endpoint&&(this.endpoint=this.data.endpoint,delete this.data.endpoint))},_buildFrame:function(){var a=$j("<iframe />").attr({src:this._getFrameSrc(),scrolling:"no",frameborder:"0"});return this.data.width&&a.attr("width",this.data.width),this.data.height&&a.attr("height",this.data.height),a},_getFrameSrc:function(){var a=this.endpoint;return-1===this.endpoint.search(/\?/)&&(a+="?"),$j.isEmptyObject(this.data)||(a+=Object.toQueryString(this.data)),a}});
//# sourceMappingURL=ContentFrame.nano.js.map
!function(a){BookingBuddy.Maps={locationData:{},markerDefaults:{icon:{image:"http://i.slimg.com/bookingbuddy/geo/attraction-pin.png",activeImage:null,size:[27,31],origin:[0,0],anchor:[11,27]},shape:{coord:[0,0,23,0,23,22,17,22,12,27,6,22,0,22],type:"poly"}},markerIcons:{attraction:{icon:{image:"http://i.slimg.com/bookingbuddy/geo/attraction-pin.png",activeImage:"http://i.slimg.com/bookingbuddy/geo/attraction-pin-on.png"}},hotel:{icon:{image:"http://i.slimg.com/bookingbuddy/geo/hotel-pin.png",activeImage:"http://i.slimg.com/bookingbuddy/geo/hotel-pin-on.png"}},basicHotel:{icon:{image:"http://i.slimg.com/bookingbuddy/geo/hotel-pin-on.png"}}},loadLocationData:function(b,c,d){var e={};return a.each(c,function(c,f){if(a.isUndefined(BookingBuddy.Maps.locationData[c]))a.isUndefined(e[f])&&(e[f]=[]),e[f].push(c);else{var g=BookingBuddy.Maps.locationData[c].type;b.toggleMarkersByType(d,g,c)}}),a.getSize(e)<=0?void b.resize():void a.each(e,function(c,d){b.element.trigger(GoogleMap.constants.EVENT_LOADING);c.split("_")[0];a.bbget("Locs."+c,{ids:d},function(c){if(a.isNullOrUndefined(c)||a.isNullOrUndefined(c.success))return void b.element.trigger(GoogleMap.constants.EVENT_LOADED);c=c.success;var d=c.type;a.each(c.data,function(c,e){BookingBuddy.Maps.locationData[c]={type:d,data:e},a.each(e,function(a,e){b.addMarker(a,{type:d,subType:c},e,{})}),b.toggleMarkersByType(!0,d,c)}),b.resize(),b.element.trigger(GoogleMap.constants.EVENT_LOADED)})})},loadPOIs:function(b,c,d){a.isNullOrUndefined(c)||(a.each(c,function(c,e){a.each(e,function(a,d){d&&d.coords&&b.addMarker(a,{type:c},d,{})}),b.toggleMarkersByType(d,c)}),b.resize())},createMarkerType:function(b){if(!a.isUndefined(window.google)){var c=GoogleMap.MarkerType.singleton(b),d=a.extend(!0,{},BookingBuddy.Maps.markerDefaults,BookingBuddy.Maps.markerIcons[b]),e={image:d.icon.image,size:new google.maps.Size(d.icon.size[0],d.icon.size[1]),origin:new google.maps.Point(d.icon.origin[0],d.icon.origin[1]),anchor:new google.maps.Point(d.icon.anchor[0],d.icon.anchor[1])},f=new google.maps.MarkerImage(e.image,e.size,e.origin,e.anchor);if(!a.isNullOrUndefined(d.icon.activeImage)){e.image=d.icon.activeImage;var g=new google.maps.MarkerImage(e.image,e.size,e.origin,e.anchor)}c.setOptions({icon:f,shape:d.shape});var h={};switch(b){case"hotel":c.createInfoWindow("hotel_check_rates_map"),h.mouseover=function(b,c,d){if(!b.currentMarker||b.currentMarker.id!=c.id){c.googleMarker.setZIndex(1e4),c.googleMarker.setIcon(g);var e=GoogleMap.MarkerType.singleton(c.type),f=function(){var b=a(this);b.find(".hotel_search_title").html(d.name);var c=b.find("input[name=provider]");c.val(d.name),c.data("hotel_id",d.id),c.change()};e.updateInfoWindow(f),e.showInfoWindow(b,c,{left:-40,top:-3})}},h[GoogleMap.constants.EVENT_BLUR]=function(a,b,c){var d=GoogleMap.MarkerType.singleton(b.type);b.googleMarker.setZIndex(null),b.googleMarker.setIcon(f),d.hideInfoWindow()};break;case"attraction":var i='<div class="map_attraction">   <div class="top"><div class="closePopup"></div></div>   <div class="middle">       <div class="contents">           <div class="ta_rating s00"></div>           <div class="title"></div>           <div class="address"></div>       </div>   </div>    <div class="bottom"></div></div>';c.createInfoWindow("map_attraction_popup",i),h.mouseover=function(b,c,d){if(!b.currentMarker||b.currentMarker.id!=c.id){c.googleMarker.setZIndex(1e4),c.googleMarker.setIcon(g);var e=GoogleMap.MarkerType.singleton(c.type),f=function(){var b=parseInt(d.rating,10);b=b+""=="NaN"?0:b,b=10>b?"0"+b:b;var c=a(this);c.find(".address").html(d.address),c.find(".title").html(d.name),c.find(".ta_rating").removeClass().addClass("ta_rating s"+b)};e.updateInfoWindow(f),e.showInfoWindow(b,c,{left:-40,top:-3})}},h[GoogleMap.constants.EVENT_BLUR]=function(a,b,c){var d=GoogleMap.MarkerType.singleton(b.type);b.googleMarker.setZIndex(null),b.googleMarker.setIcon(f),d.hideInfoWindow()}}c.setTriggerEvents(h)}}},BookingBuddy.Maps.Data=function(a){this.id=a,this.centerPoint={},this.options,this.events,this.pointsOfInterest={},this.locations={},this.mapData={id:a}},a.extend(BookingBuddy.Maps.Data,{pool:{},singleton:function(b){return a.isUndefined(BookingBuddy.Maps.Data.pool[b])&&(BookingBuddy.Maps.Data.pool[b]=new BookingBuddy.Maps.Data(b)),BookingBuddy.Maps.Data.pool[b]},prototype:{getId:function(){return this.id},getCenterPoint:function(){return this.centerPoint},getOptions:function(){return this.options},getEvents:function(){return this.events},getPOIs:function(){return this.pointsOfInterest},getPOIsByType:function(b){if(a.isUndefined(this.pointsOfInterest[b]))return null;var c={};return c[b]=this.pointsOfInterest[b],c},getLocations:function(){return this.locations},getLocation:function(b){if(a.isUndefined(this.locations[b]))return null;var c={};return c[b]=this.locations[b],c},setCenterPoint:function(a){this.centerPoint=a},setOptions:function(a){this.options=a},setEvents:function(a){this.events=a},addPOI:function(b,c,d){a.isUndefined(this.pointsOfInterest[c])&&(this.pointsOfInterest[c]={}),this.pointsOfInterest[c][b]=d},setPOIs:function(a){this.pointsOfInterest=a},addLocation:function(a,b){this.locations[a]=b},setLocations:function(a){this.locations=a}}})}(jQuery);
//# sourceMappingURL=Maps.nano.js.map

!function(a){a.smartFormMap={},a.commonInputsMap={},a.extend(a.fn,{smartFormFactory:function(b,c){if(!this.length)return null;var d=a.data(this[0],"smartForm");return d?(c||(d.settings=a.extend(d.settings,b),d.settings.message_overrides&&a.extend(!0,d.settings.messages,d.settings.message_overrides)),d):(d=new a.smartForm(b,this[0]),a.data(this[0],"smartForm",d),a.smartFormMap[d.id]=d,this.hasClass("sf-leave-me-alone")||(this.submit(a.proxy(function(b){if(d.submit(),this.settings.debug&&this.debug(),this.valid){if(this.cleanForSubmit(),this.settings.submitHandler){this.submitHandlerData={};var c=this.settings.submitHandler(this.currentForm[0],this.settings.submitTarget,b);return this.settings.debug&&BBDebug.dir(this.submitHandlerData),c}return!this.settings.debug}var e=[];return a.each(this.invalidElements,function(b,c){if(c){var d=c.elementId+"='"+c.value()+"' ",f=", failed:",g="";a.each(c.ruleStatus,function(a,b){b||(f=f+g+a,g=", ")}),e.push(d+f)}}),BBDebug.log("Invalid form submission: "+this.id+", values: "+e.join(" :: ")+", "+window.location.href),b.stopPropagation(),b.preventDefault(),!1},d)),this.trigger("SmartForm:ready")),d)}}),a.smartFormsBBSavedSearchData=null,a.smartFormsDebug=function(){a.each(a.smartFormMap,function(a,b){b.debug()})},a.smartForm=function(b,c){var d=a(c).attr("target");a.emptyString(d)||(b.submitTarget=d,"_self"===b.submitTarget&&(b.submitTarget="_top")),this.settings=a.extend({},a.smartForm.defaults,b),this.currentForm=$j(c),this.currentForm.keypress(function(b){return a.data(this,"smartForm").settings.keyPress(b)}),this.id=a(c).attr("id"),this.searchForm=!1,this.validators=[],this.submitHandlerData={},this.init()},a.extend(a.smartForm,{dateFormats:{DEFAULT:"mm/dd/yy",DEFAULT_REGEX:/^\d{2}[\/-]\d{2}[\/-]\d{4}$/,UK:"dd/mm/yy",UK_REGEX:/^\d{2}[\/-]\d{2}[\/-]\d{4}$/,ISO:"yy/mm/dd",ISO_REGEX:/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/},constants:{SMART_FORM:"smartForm",SMART_ELEMENT:"smartElement",SEARCH_FORM:"searchForm",NOT_VALIDATED:"noValidation",COMMON:"common",REQUIRED:"required",ZIP:"zip",EMAIL:"emailCheck",EMAIL_VERIFY:"emailVerify",DATE:"date",ARRIVAL_CITY_CONTEXT_ID:"_arrival_city",DEPARTURE_CITY_CONTEXT_ID:"_departure_city",DEPARTURE_DATE:"departureDate",RETURN_DATE:"returnDate",PRINT_DATE_TO_TEXT:"printDateToText",LS:"locationSuggest",LS_COUNTRY:"country",LS_REGION:"region",LS_STATE:"state",LS_CITY:"city",LS_AIRPORT:"airport",LS_VALID:"LSValid",LS_INVALID:"LSInvalid",LS_UNSUPPORTED_LOCATION:"LSUnsupportedLocation",LS_WARNING_PREFIX:"LocationWarning_",LS_AWD_DEP_CITY:"awdDepartureCity",LOCATION_SELECT:"locationSelect",NO_SAVED_DATA:"noSavedData",INVALID:"invalid",CALENDAR:"calendarUI",DEFAULT_CLEAR:"defaultClear",RECENT_SEARCHES_DIV:"recent_searches",DELAYED_LOAD:"delayedLoad",ERROR_MSG_CLASS:"smartFormErrorMessages",UK_LOCALE_CLASS:"UKLocale"},messages:{required:"'#{field_name}' is a required field.",date:"Please enter a valid '#{field_name}'.",dateNotPast:"Please enter a '#{field_name}' date that is not in the past.",departureDate:"Please enter a '#{field_name}' date that is not in the past.",dateInRange:"#{booking} are only available up to 330 days in advance",returnDate:"Please enter a '#{field_name_1}' date that is not earlier than the '#{field_name_2}' date.",ls_invalid:"Please enter a valid #{location_type} in the '#{field_name}' field to continue.",ls_required:"Please enter a location in the '#{field_name}' field to continue.",ls_departure_required:"Please enter a departure #{location_type} in the '#{field_name}' field to continue.",ls_arrival_required:"Please enter an arrival #{location_type} in the '#{field_name}' field to continue.",ls_multiple_suggestions:"There may be more than one option for the #{location_type} you entered in the '#{field_name}' field.",ls_unsupported_location:"We're sorry, we do not currently support searches within #{location}",zip:"Please enter a valid zip code - leave blank for Non-US/Canadian codes",email:"Please enter a valid Email address in the '#{field_name}' field to continue.",emailVerify:"The Email addresses do not match",arrivalCity:"Please enter different '#{field_name_1}' and '#{field_name_2}' locations to continue.",holiday_departure_required:"Please select an airport from the '#{field_name}' field to continue.",holiday_arrival_required:"Please select a destination from the '#{field_name}' field to continue."}}),a.extend(a.smartForm,{defaults:{messages:a.smartForm.messages,locale:"DEFAULT",dateFormat:a.smartForm.dateFormats.DEFAULT,dateFormatRegex:a.smartForm.dateFormats.DEFAULT_REGEX,debug:!1,calNumMonths:2,departureDateOffset:21,returnDateOffset:7,noDefaultDates:!1,defaultDatesOnEmptyOnly:!1,locationSuggest:LocationSuggest,locationSuggestMax:!1,submitHandler:null,submitTarget:"_top",keyPress:function(a){var b=window.event?a.keyCode:a.which;return 13!=b}},prototype:{init:function(){this.elements={},this.invalidElements={},this.valid=!0,this.submitting=!1,this.isValidated=!this.currentForm.hasClass(a.smartForm.constants.NOT_VALIDATED);var b=this,c=$j(this.currentForm).attr("data-mode");if(this.mode=c?c:this.id.split("_")[0],b.settings.message_overrides&&a.extend(!0,b.settings.messages,b.settings.message_overrides),"vacation"===this.mode&&"rental"===this.id.split("_")[1]&&(this.mode="vacation_rental"),this.bbsearchmode=this.mode,/^hotelcheckrates/.test(this.bbsearchmode)&&(this.bbsearchmode="hotel"),this.currentForm.hasClass(a.smartForm.constants.UK_LOCALE_CLASS)&&(this.settings.locale="UK",this.settings.dateFormat=a.smartForm.dateFormats.UK,this.settings.dateFormatRegex=a.smartForm.dateFormats.UK_REGEX),this.currentForm.find("."+a.smartForm.constants.SMART_ELEMENT).each(function(){var c=new a.smartElement(this,b);b.elements[c.formContextId]=c}),BBDebug.log(this.id+": Initialized all smart elements..."),this.searchForm=this.currentForm.hasClass(a.smartForm.constants.SEARCH_FORM),this.searchForm){a.smartFormsBBSavedSearchData=BBSavedSearchData.singleton(),this.bbSearchData=a.smartFormsBBSavedSearchData,this.currentForm.hasClass(a.smartForm.constants.DELAYED_LOAD)||this.loadCurrentBBSearchData();var d=this;this.currentForm.bind("STMToggle:show",function(a){"form"===a.target.tagName.toLowerCase()&&d.loadCurrentBBSearchData()})}$j(document).on("click","#"+this.id+" .submitTrigger",a.proxy(function(b){return this.submitTrigger=b.currentTarget,this.currentForm.submit(),a(b.currentElement).blur(),b.stopPropagation(),b.preventDefault(),!1},this))},loadCurrentBBSearchData:function(){a.each(this.elements,a.proxy(function(a,b){b.isLocationSuggestElement?this.loadLocationSuggestCurrentSearchData(b):b.isLocationSelectElement?this.loadLocationSelectCurrentSearchData(b):this.loadBasicCurrentSearchData(b)},this)),a.each(this.elements,a.proxy(function(a,b){b.isDateElement()&&b.dateUpdate()},this)),BBDebug.log(this.id+": Loaded current BBSearch data...")},loadLocationSuggestCurrentSearchData:function(b){if(!b.currentElement.hasClass(a.smartForm.constants.NO_SAVED_DATA)){var c=this.bbSearchData.getLocationSuggestTypesByMode(this.bbsearchmode),d=null,e=null,f=null;if(b.formContextId===a.smartForm.constants.ARRIVAL_CITY_CONTEXT_ID?(d="l2",e="prevl2"):b.formContextId===a.smartForm.constants.DEPARTURE_CITY_CONTEXT_ID&&(d="l1",e="prevl1"),!d)return;f=this.bbSearchData.getCurrentState().getLocation(d,c),f?b.setSTMLocation(f):(f=this.bbSearchData.getCurrentState().getLocation(d),prevLocation=this.bbSearchData.getCurrentState().getLocation(e,["airport"]),f&&b.loadSTMLocation(f.id,prevLocation,c))}},loadLocationSelectCurrentSearchData:function(b){var c=this.bbSearchData.getCurrentSearchData(b.name,this.bbsearchmode);if(c&&!b.currentElement.hasClass(a.smartForm.constants.NO_SAVED_DATA)){var d=null,e=[];try{e=b.currentElement.data("locationTypes")}catch(f){e=["airport"]}for(type in c)-1!==a.inArray(type,e)&&(d=c[type]);d&&b.currentElement.find('option[data-location-id="'+d.id+'"]').prop("selected",!0)}},loadBasicCurrentSearchData:function(b){var c=this.bbSearchData.getCurrentSearchData(b.name,this.bbsearchmode);a.emptyString(c)||b.currentElement.hasClass(a.smartForm.constants.NO_SAVED_DATA)?"hidden"!==b.type&&b.updateCurrentSearchData():(BBDebug.log("Setting element value from current search:	 ["+this.bbsearchmode+"]["+b.name+"] = "+c),b.value(c))},reset:function(){this.clearErrors(),this.clearValues(),this.settings.submitHandler&&(this.submitHandlerData={})},preValidate:function(){this.submit()},submit:function(){this.submitting=!0,this.checkForm(),this.submitting=!1},checkForm:function(){this.clearErrors(),this.isValidated&&a.each(this.elements,a.proxy(function(a,b){b.isValidated&&(b.check()||(this.invalidElements[b.formContextId]=b,this.valid=!1))},this)),this.valid&&a.each(this.validators,a.proxy(function(a,b){b.doValidation(this)||(this.messages[b.name]=b.message,this.valid=!1)},this));var b=this.valid?"SmartForm:valid":"SmartForm:invalid";this.currentForm.trigger(b),this.showErrors()},invalidateElement:function(b,c){if(a.isString(b)&&(b=this.getElementById(b)),!a.isNullOrUndefined(b)&&!a.isNullOrUndefined(c))if("locationSuggest"===c)b.locationSuggest.validate();else{this.valid=!1;var d=b.getRule(c);b.valid=!1,this.invalidElements[b.formContextId]=b,a.isNullOrUndefined(d)?(_msg=$j.tmpl(this.smartForm.settings.messages[c],{field_name:b.title}),a.isNullOrUndefined(_msg)||(b.messages[c]=_msg)):b.messages[c]=d.getMessage(b)}return b},hasErrors:function(){return!this.valid},showErrors:function(){var b=this.currentForm.find(".smartFormErrorMessages:first");if(b[0]||(b=a("#"+this.id+"_errorMessages")),b.hide(),b.find("ul").remove(),!this.valid){var c=a("<ul />");a.each(this.invalidElements,function(b,d){d&&(d.showError(),a.each(d.messages,function(b,e){a.emptyString(e)||a("<li />",{id:d.elementId+"_"+b+"_msg",text:e}).appendTo(c)}))}),a.each(this.messages,a.proxy(function(b,d){BBDebug.log(d),a.emptyString(d)||a("<li />",{text:d}).appendTo(c)},this)),c.appendTo(b),b.find("ul li").length>0&&b.show()}},clearErrors:function(){a.each(this.invalidElements,function(a,b){b&&b.clearError()}),this.invalidElements={},this.messages={},a("#"+this.id+"_errorMessages").hide(),this.valid=!0},clearError:function(b,c){a("#"+b.elementId+"_"+c+"_msg").remove(),a("#"+this.id+"_errorMessages ul li").length<1&&a("#"+this.id+"_errorMessages").hide()},clearValues:function(){a.each(this.elements,function(a,b){b.clear()})},getElement:function(a){a=/^_/.test(a)?a:"_"+a;var b=this.elements[a];return b},getElementById:function(b){var c=null,d=this.currentForm.find("#"+b);return d.length>0&&(c=a.data(d[0],"smartElement")),c},getElementByClass:function(b){var c=null,d=this.currentForm.find("."+b);return d.length>0&&(c=a.data(d[0],"smartElement")),c},getLSElements:function(){var a=this.currentForm.find(".locationSuggest");return a},cleanForSubmit:function(){a.each(this.elements,function(b,c){if(!c.isDateElement()){var d=c.value(),e=c.defaultVal;d===e&&a(c.currentElement).val("")}})},addValidator:function(a){this.validators.push(a)},isOneWaySearch:function(){return a("#"+this.mode+"_date2_block").togglerHidden()},debug:function(){var b=this.hasErrors()?"INVALID":"VALID";BBDebug.group("Smart Form: "+this.currentForm.id+" : "+b,!0),BBDebug.dir(this),BBDebug.groupEnd(),BBDebug.group(this.currentForm.id+" Elements: ",!0),a.each(this.elements,function(){this.debug()}),BBDebug.groupEnd()}}}),a.smartElement=function(b,c){if(this.currentElement=a(b),this.smartForm=c,this.elementId=this.currentElement.attr("id"),this.name=this.currentElement.attr("name"),this.title=this.currentElement.attr("title"),this.type=this.currentElement[0].tagName.toLowerCase(),"input"==this.type){var d=this.currentElement.attr("type");this.type=d?d.toLowerCase():""}var e="";if(this.elementId){var f=this.elementId.split("_");if(f&&f.length>1){var g="vacation_rental"===this.smartForm.bbsearchmode?2:1;f.splice(0,g),e="_"+f.join("_")}}this.formContextId=/^_/.test(e)?e:"_"+e,this.isValidated=!this.currentElement.hasClass(a.smartForm.constants.NOT_VALIDATED),this.label=null,this.rules=[],this.ruleStatus={},this.messages={},this.init(),this.rules.length>0&&a.emptyString(this.title)&&BBDebug.log("Warning: "+this.elementId+" should have a 'title' set if it is going to display error messages, please fix"),a.data(b,"smartElement",this)},a.extend(a.smartElement,{prototype:{init:function(){if(this.valid=!0,this.label=$j(this.currentElement[0].form).find("label[for="+this.currentElement.attr("id")+"]"),this.currentElement.hasClass(a.smartForm.constants.DEFAULT_CLEAR)&&(this.defaultVal=this.value(),this.currentElement.focus(a.proxy(function(){this.value()===this.defaultVal&&this.value("")},this)),this.currentElement.blur(a.proxy(function(){""===this.value()&&this.value(this.defaultVal)},this))),this.currentElement.hasClass(a.smartForm.constants.LS)){var b=[];this.currentElement.hasClass(a.smartForm.constants.LS_COUNTRY)&&(b[b.length]="country"),this.currentElement.hasClass(a.smartForm.constants.LS_REGION)&&(b[b.length]="region"),this.currentElement.hasClass(a.smartForm.constants.LS_STATE)&&(b[b.length]="state"),this.currentElement.hasClass(a.smartForm.constants.LS_CITY)&&(b[b.length]="city"),this.currentElement.hasClass(a.smartForm.constants.LS_AIRPORT)&&(b[b.length]="airport"),this.currentElement.attr("title",""),this.currentElement.attr("autocomplete","off");var c=this.currentElement.attr("data-id-field-selector"),d=c?this.smartForm.currentForm.find(c):null;this.currentElement.hasClass(a.smartForm.constants.LS_AWD_DEP_CITY)?this.locationSuggest=new AWDLocationSuggest(this.elementId,b,this.elementId+"_hidden","departure",d):this.locationSuggest=new LocationSuggest(this.elementId,b,this.elementId+"_hidden",{},d),this.smartForm.settings.locationSuggestMax&&this.locationSuggest.setMaxSuggestions(this.smartForm.settings.locationSuggestMax),a.emptyString(this.defaultVal)||(this.locationSuggest.defaultText=this.defaultVal),this.smartForm.isValidated&&(this.invalidLocationDropDown=new InvalidLocationDropdown(this.elementId)),this.lsValidationCallbacks=[],this.currentElement.bind("LocationSuggest:valid",a.proxy(function(){BBDebug.log(" LocationSuggest:valid triggered on "+this.elementId),this.smartForm.isValidated&&this.invalidLocationDropDown.removeSelect(),this.currentElement.addClass(a.smartForm.constants.LS_VALID).removeClass(a.smartForm.constants.LS_INVALID),this.smartForm.searchForm&&this.updateCurrentSearchDataLocationSuggest(),this.updateCommon()},this)),this.currentElement.bind("LocationSuggest:invalid",a.proxy(function(b,c){BBDebug.log(" LocationSuggest:invalid triggered on "+this.elementId),a.emptyString(this.value())||(this.locationSuggest.airportsOnly||this.currentElement.hasClass(a.smartForm.constants.LS_UNSUPPORTED_LOCATION)?this.currentElement.removeClass(a.smartForm.constants.LS_VALID).addClass(a.smartForm.constants.LS_INVALID):this.currentElement.trigger("LocationSuggest:valid"))},this)),this.isLocationSuggestElement=!0}this.currentElement.hasClass(a.smartForm.constants.LOCATION_SELECT)&&(this.isLocationSelectElement=!0),this.currentElement.hasClass(a.smartForm.constants.COMMON)&&(a.commonInputsMap[this.formContextId]||(a.commonInputsMap[this.formContextId]=[]),a.commonInputsMap[this.formContextId].push(this.elementId),this.currentElement.blur(a.proxy(function(){!this.isLocationSuggestElement&&this.check()&&this.updateCommon()},this))),this.currentElement.change(a.proxy(function(){this.smartForm.searchForm&&(this.isLocationSuggestElement?this.updateCurrentSearchDataLocationSuggest():this.isLocationSelectElement?this.updateCurrentSearchDataLocationSelect():this.updateCurrentSearchData())},this));var e=new Date;if(this.isDateElement()&&(this.defaultVal=this.value()),this.currentElement.hasClass(a.smartForm.constants.CALENDAR)&&this.attachCalendar(),this.currentElement.hasClass(a.smartForm.constants.DEPARTURE_DATE)?(this.currentElement.change(a.proxy(function(){this.dateUpdate()},this)),this.smartForm.settings.noDefaultDates||this.smartForm.settings.defaultDatesOnEmptyOnly&&"mm/dd/yyyy"!==this.defaultVal?this.currentElement.val(this.defaultVal):(e.setDate(e.getDate()+this.smartForm.settings.departureDateOffset),this.setElementFromDate(e)),this.defaultVal=this.value()):this.currentElement.hasClass(a.smartForm.constants.RETURN_DATE)&&(this.smartForm.settings.noDefaultDates||this.smartForm.settings.defaultDatesOnEmptyOnly&&"mm/dd/yyyy"!==this.defaultVal?this.currentElement.val(this.defaultVal):(e.setDate(e.getDate()+this.smartForm.settings.departureDateOffset+this.smartForm.settings.returnDateOffset),this.setElementFromDate(e)),this.defaultVal=this.value()),this.isValidated){if(this.currentElement.hasClass(a.smartForm.constants.REQUIRED)&&this.rules.push(a.smartValidators.required),this.currentElement.hasClass(a.smartForm.constants.ZIP)&&this.rules.push(a.smartValidators.zip),this.currentElement.hasClass(a.smartForm.constants.EMAIL)&&this.rules.push(a.smartValidators.email),this.currentElement.hasClass(a.smartForm.constants.EMAIL_VERIFY)&&this.rules.push(a.smartValidators.emailVerify),this.currentElement.hasClass(a.smartForm.constants.DATE)&&this.rules.push(a.smartValidators.date),this.currentElement.hasClass(a.smartForm.constants.DEPARTURE_DATE)&&(this.rules.push(a.smartValidators.date),this.rules.push(a.smartValidators.dateNotPast)),this.currentElement.hasClass(a.smartForm.constants.RETURN_DATE)){this.rules.push(a.smartValidators.date),this.rules.push(a.smartValidators.dateNotPast),this.rules.push(a.smartValidators.returnDate);var f=["vacation","air","hotel","car"];a.inArray(this.smartForm.mode,f)>-1&&this.rules.push(a.smartValidators.dateInRange)}this.currentElement.hasClass(a.smartForm.constants.LS)&&this.rules.push(a.smartValidators.locationSuggest),this.formContextId===a.smartForm.constants.ARRIVAL_CITY_CONTEXT_ID&&this.rules.push(a.smartValidators.arrivalCity)}},getRule:function(b){var c=null;return a.each(this.rules,function(){return this.name===b?(c=this,!1):void 0}),c},value:function(b){if(a.isNullOrUndefined(b))return this.currentElement.val();if(this.isDateElement()){if(!isNaN(b))return this.setElementFromTimeStamp(b),this.currentElement.val();try{var c=stm.dates.parseDate(this.smartForm.settings.dateFormat,b);this.setElementFromDate(c)}catch(d){BBDebug.log("Bad date string passed in date element value() call: "+b)}return this.currentElement.val()}switch(this.type){case"select":this.currentElement.find("option").each(function(){a().prop("selected",!1)});var e=this.currentElement.find("option[value='"+b+"']");e.length>0&&(e.prop("selected",!0),this.currentElement.val(b));break;case"checkbox":this.currentElement.val()==b?(this.currentElement.click(),this.currentElement[0].checked=!0):this.currentElement[0].checked=!1;break;case"radio":this.currentElement.val()==b?(this.currentElement.click(),this.currentElement[0].checked=!0):this.currentElement[0].checked=!1;break;default:this.isLocationSuggestElement&&(b=this.cleanLSValue(b)),this.currentElement.val(b)}return this.currentElement.val()},loadSTMLocation:function(b,c,d){if(b){var e={id:b};a.bbget("LocationSuggest.loadSTMLocation",e,a.proxy(function(b){if(b){var e=b.city?b.city.id:null,f=c?c.id:null;e&&f&&e==f&&(b.airport=c);var g=null;for(var h in b)if(-1!==a.inArray(h,d)){g=b[h];break}g&&(this.currentElement.data("location-data",b),this.setSTMLocation(g))}},this))}},setSTMLocation:function(a){this.value(a.name),this.locationSuggest.hiddenIdTarget&&this.locationSuggest.hiddenIdTarget.val(a.id),a.country&&this.currentElement.data("country",a.country),this.currentElement.trigger("LocationSuggest:valid")},check:function(){var b=this;return this.valid=!0,a.each(this.rules,function(){if(b.valid){var a=this.apply(b),c=this.name;b.ruleStatus[c]=a,a?b.messages[c]=null:(b.messages[c]=this.getMessage(b),b.valid=!1)}}),this.valid&&this.clearError(),this.valid},showError:function(){if(!this.valid){if(this.currentElement.addClass(a.smartForm.constants.INVALID),this.label){a(this.label).addClass(a.smartForm.constants.INVALID);var b="",c="";a.each(this.messages,function(d,e){a.emptyString(e)||(b+=c+e,c=" -- ")}),a(this.label).attr("title",b)}this.locationSuggest&&!this.ruleStatus.locationSuggest&&(a(this.element).addClass(a.smartForm.constants.LS_INVALID),a.isNullOrUndefined(this.invalidLocationDropDown.select)||a(this.invalidLocationDropDown.select).show()),this.isDateElement()&&a("#"+this.elementId+"_icon_div").length>0&&a("#"+this.elementId+"_icon_div").addClass(a.smartForm.constants.INVALID)}},clearError:function(){this.locationSuggest&&this.currentElement.hasClass(a.smartForm.constants.LS_INVALID)||(this.valid=!0,a.each(this.messages,a.proxy(function(a,b){this.smartForm.clearError(this,a)},this)),this.messages={},a.each(this.ruleStatus,a.proxy(function(a,b){this.ruleStatus[a]=!0},this)),this.smartForm.invalidElements[this.formContextId]=null,this.currentElement.removeClass(a.smartForm.constants.LS_UNSUPPORTED_LOCATION),this.currentElement.removeClass(a.smartForm.constants.INVALID),this.label&&(a(this.label).removeClass(a.smartForm.constants.INVALID),a(this.label).attr("title","")),this.isDateElement()&&a("#"+this.elementId+"_icon_div").length>0&&a("#"+this.elementId+"_icon_div").removeClass(a.smartForm.constants.INVALID))},clear:function(){switch(this.type){case"select":var b=this.currentElement.find("option");b.length>0&&(b.prop("selected",!1),a(b.get(0)).prop("selected",!0),this.currentElement.val(a(b.get(0)).val()));break;case"checkbox":this.currentElement.prop("checked",!1);break;case"radio":this.currentElement.prop("checked",!1);break;default:this.value(this.defaultVal?this.defaultVal:"")}},debug:function(){var a="ID: "+this.elementId+" / NAME: "+this.name+" = "+this.value();("checkbox"==this.currentElement.attr("type")||"radio"==this.currentElement.attr("type"))&&(a+=" - "+this.currentElement.prop("checked")),BBDebug.log(a)},updateCommon:function(){if(this.currentElement.hasClass(a.smartForm.constants.COMMON)&&this.value()!==this.defaultVal){var b=this.elementId,c=/^hotelcheckrates/.test(this.smartForm.mode);a.each(a.commonInputsMap[this.formContextId],a.proxy(function(d,e){if(e==b)return!0;var f=this.value(),g=a("#"+e).get(0);if(g&&a(g).hasClass(a.smartForm.constants.COMMON)){var h=a.data(g,"smartElement");a.emptyString(f)?BBDebug.log("Not moving common value from "+this.smartForm.id+"::"+this.formContextId+" to incompatible field "+h.smartForm.id+"::"+h.formContextId):c&&a(h.smartForm.currentForm).hasClass("bbSearch")||(h.isLocationSuggestElement&&(f=h.cleanLSValue(f)),BBDebug.log("Setting common values for "+h.smartForm.id+"::"+h.formContextId+" - "+f),a(h.currentElement).val(f),a(h.currentElement).trigger("commonInput:Updated"))}return!0},this))}},cleanLSValue:function(a){var b=a;return this.isLocationSuggestElement&&this.locationSuggest.citiesOnly&&(b=this.locationSuggest.convertAirportToCity(b)),b},updateCurrentSearchData:function(){if(this.smartForm.searchForm&&this.check()){var b="";if(this.isDateElement())b=this.getTimeStampFromElement();else switch(this.type){case"checkbox":this.currentElement.prop("checked")&&(b=this.value());break;case"radio":b=this.currentElement.prop("checked")?this.value():null;break;case"select":var c=this.currentElement.children(":selected");if(c.hasClass("storeText")){var d=c.text().replace(/^\-*\s*/,"");b=d}else b=this.value();break;default:b=this.value()}a.isNull(b)||a.emptyString(b)||(BBDebug.log("Setting current search value ["+this.smartForm.bbsearchmode+"]["+this.name+"] to "+b+" -- "+this.value()),this.smartForm.bbSearchData.addCurrentSearchData(this.name,b,this.smartForm.bbsearchmode))}},updateCurrentSearchDataLocationSuggest:function(){if(this.isLocationSuggestElement){var a=this.currentElement.data("location-data");a&&this.smartForm.bbSearchData.addCurrentSearchData(this.name,a,this.smartForm.bbsearchmode)}},updateCurrentSearchDataLocationSelect:function(){if(this.isLocationSelectElement){var a=this.currentElement.val(),b=this.currentElement.find("option:selected"),c=b.attr("data-location-id"),d=b.attr("data-location-type");if(a&&c&&d){var e={};e[d]={id:c,name:a},this.smartForm.bbSearchData.addCurrentSearchData(this.name,e,this.smartForm.bbsearchmode)}}},isDateElement:function(){return this.currentElement.hasClass(a.smartForm.constants.DATE)||this.currentElement.hasClass(a.smartForm.constants.DEPARTURE_DATE)||this.currentElement.hasClass(a.smartForm.constants.RETURN_DATE)},attachCalendar:function(){var b=a("#"+this.elementId);return b.bind("cut copy paste keypress",function(a){return"keypress"==a.type&&9==a.keyCode?!0:(a.stopPropagation(),a.preventDefault(),!1)}),b.bind("click",function(a){this.blur()}),b.datepicker({dayNamesMin:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],minDate:new Date,beforeShow:a.proxy(function(b,c){var d=a(b);if(d.hasClass(a.smartForm.constants.RETURN_DATE)){var e=this.smartForm.getElementByClass(a.smartForm.constants.DEPARTURE_DATE).currentElement,f=this.value();d.datepicker("option","minDate",a(e).datepicker("getDate")),d.val(f)}},this),onClose:function(a,c){b.blur()}}),b.datepicker("option","dateFormat",this.smartForm.settings.dateFormat),b},getDateString:function(a){var b=[],c=[],d=[];return c[0]="Jan",c[1]="Feb",c[2]="Mar",c[3]="Apr",c[4]="May",c[5]="Jun",c[6]="Jul",c[7]="Aug",c[8]="Sept",c[9]="Oct",c[10]="Nov",c[11]="Dec",b[0]="Sun",b[1]="Mon",b[2]="Tue",b[3]="Wed",b[4]="Thu",b[5]="Fri",b[6]="Sat",d[0]=b[a.getDay()],d[1]=c[a.getMonth()],d[2]=a.getDate(),d.join(" ")},setElementFromDate:function(a){if(this.isDateElement())if(this.currentElement.hasClass($j.smartForm.constants.PRINT_DATE_TO_TEXT))this.currentElement.text(this.getDateString(a));else{var b=a.getMonth()+1;10>b&&(b="0"+b);var c=a.getDate();10>c&&(c="0"+c);var d=a.getFullYear(),e=b+"/"+c+"/"+d;"UK"===this.smartForm.settings.locale&&(e=c+"/"+b+"/"+d),/Invalid|NaN/.test(e)||this.currentElement.val(e)}},setElementFromTimeStamp:function(a){if(this.isDateElement()){var b=new Date(a),c=!1;if("[object Date]"===Object.prototype.toString.call(b)&&!isNaN(b.getTime())){c=!0;var d=new Date;d.setHours(0,0,0,0),d>b||b.getFullYear()>d.getFullYear()+2?BBDebug.log("Date out of range in date element value() call: "+a):this.setElementFromDate(b)}c||BBDebug.log("Invalid timestamp in date date element setElementFromTimeStamp() call: "+a)}},getDateFromElement:function(){if(this.isDateElement()){var a=this.value(),b=a.split("/"),c=b[0],d=b[1],e=b[2];return"UK"===this.smartForm.settings.locale&&(d=b[0],c=b[1]),c=parseInt(c,10)-1,new Date(e,c,d)}return null},getTimeStampFromElement:function(){if(this.isDateElement()){var a=this.getDateFromElement();return a.getTime()}return null},dateUpdate:function(){var b=this.smartForm.getElementByClass(a.smartForm.constants.RETURN_DATE),c=this.smartForm.getElementByClass(a.smartForm.constants.DEPARTURE_DATE);if(b&&c){c.check()||c.value(c.defaultVal);var d=c.getDateFromElement(),e=b.getDateFromElement();(a.isNullOrUndefined(e)||d>e)&&(e=d,e.setDate(d.getDate()+1),b.value(e),b.currentElement.change(),b.updateCommon(),b.updateCurrentSearchData())}}}}),a.smartValidator={name:"base validator",doValidation:function(){},getMessage:function(a){return $j.tmpl(a.smartForm.settings.messages[this.name],{field_name:a.title.toLowerCase()})},message:null},a.smartElementValidator=a.extend(a.smartValidator,{apply:function(a){return this.doValidation(a)},getFormElementValue:function(b){var c=b.currentElement;return a(c).val()}}),a.smartValidators={required:a.extend({},a.smartElementValidator,{name:"required",doValidation:function(b){var c=!0;if(b.smartForm.submitting)if("checkbox"==a(b.currentElement).attr("type"))c=a(b.currentElement).prop("checked");else{var d=this.getFormElementValue(b);c=a.trim(d).length>0}return c},getMessage:function(b){var c="";if("air"!==b.smartForm.mode&&"vacation"!==b.smartForm.mode||!b.isLocationSuggestElement)"car"!==b.smartForm.mode&&"hotel"!==b.smartForm.mode||b.formContextId!==a.smartForm.constants.ARRIVAL_CITY_CONTEXT_ID?"vacation_rental"===b.smartForm.mode&&b.formContextId===a.smartForm.constants.ARRIVAL_CITY_CONTEXT_ID?c=$j.tmpl(b.smartForm.settings.messages.required,{field_name:b.title}):"holiday"===b.smartForm.mode?b.formContextId===a.smartForm.constants.DEPARTURE_CITY_CONTEXT_ID?c=$j.tmpl(b.smartForm.settings.messages.holiday_departure_required,{field_name:b.title}):b.formContextId===a.smartForm.constants.ARRIVAL_CITY_CONTEXT_ID&&(c=$j.tmpl(b.smartForm.settings.messages.holiday_arrival_required,{field_name:b.title})):c=$j.tmpl(b.smartForm.settings.messages[this.name],{field_name:b.title.toLowerCase()}):c=$j.tmpl(b.smartForm.settings.messages.required,{field_name:b.title});else{var d="ls_required";b.formContextId===a.smartForm.constants.DEPARTURE_CITY_CONTEXT_ID&&a(b.currentElement).hasClass("airport")?d="ls_departure_required":b.formContextId===a.smartForm.constants.ARRIVAL_CITY_CONTEXT_ID&&a(b.currentElement).hasClass("airport")&&(d="ls_arrival_required"),c=a.smartValidators.locationSuggest.getLSMessage(b,d)}return c}}),zip:a.extend({},a.smartElementValidator,{name:"zip",doValidation:function(b){var c=!0,d=this.getFormElementValue(b);if(!a.emptyString(d)){var e=/(^\d{5})(-\d{4})?|(^[a-zA-Z][0-9][a-zA-Z] ?[0-9][a-zA-Z][0-9])$/;c=e.test(d)}return c}}),email:a.extend({},a.smartElementValidator,{name:"email",doValidation:function(b){var c=!0,d=this.getFormElementValue(b);if(!a.emptyString(d)){var e=/[A-Za-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[A-Za-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[A-Za-z0-9](?:[A-Za-z0-9-]*[A-Za-z0-9])?\.)+(?:[A-Za-z]{2}|com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|museum)/;c=e.test(d)}return c}}),emailVerify:a.extend({},a.smartElementValidator,{name:"emailVerify",doValidation:function(b){var c=!0,d=this.getFormElementValue(b),e=a("#"+b.elementId+"_verify"),f=e.val();return c=d.toLowerCase()==f.toLowerCase()}}),date:a.extend({},a.smartElementValidator,{name:"date",doValidation:function(a){var b=this.getFormElementValue(a),c=!0;if(b){var d=a.smartForm.settings.dateFormatRegex;c=d.test(b)}return c}}),dateNotPast:a.extend({},a.smartElementValidator,{name:"dateNotPast",doValidation:function(b){if(b.smartForm.isOneWaySearch()&&b.currentElement.hasClass(a.smartForm.constants.RETURN_DATE))return!0;var c=this.getFormElementValue(b);if(!c)return!0;var d=stm.dates.parseDate(b.smartForm.settings.dateFormat,c);return stm.dates.todayUTC()<=d?!0:!1}}),departureDate:a.extend({},a.smartElementValidator,{name:"departureDate",doValidation:function(b){var c=this.getFormElementValue(b),d=!0;if(!b.smartForm.isOneWaySearch()&&!a.emptyString(c)){var e=b.smartForm.getElementByClass(a.smartForm.constants.RETURN_DATE);if(e){var f=b.getDateFromElement(),g=e.getDateFromElement();a.isNullOrUndefined(g)||(d=g>=f)}}return d}}),dateInRange:a.extend({},a.smartElementValidator,{name:"dateInRange",doValidation:function(a){var b=this.getFormElementValue(a);if(b){var c=stm.dates.todayUTC(),d=stm.dates.parseDate(a.smartForm.settings.dateFormat,b);if(d.getTime()-c.getTime()>28512e6)return!1}return!0},getMessage:function(a){var b;switch(a.smartForm.mode){case"hotel":case"vacation":b="Hotel rooms";break;case"air":b="Flights";break;case"car":b="Cars"}return $j.tmpl(a.smartForm.settings.messages.dateInRange,{booking:b})}}),returnDate:a.extend({},a.smartElementValidator,{name:"returnDate",doValidation:function(b){var c=this.getFormElementValue(b),d=!0;if(!b.smartForm.isOneWaySearch()&&!a.emptyString(c)){var e=b.smartForm.getElementByClass(a.smartForm.constants.DEPARTURE_DATE);if(e){var f=b.getDateFromElement(),g=e.getDateFromElement();a.isNullOrUndefined(g)||(d=f>=g)}}return d},getMessage:function(b){var c=b.smartForm.getElementByClass(a.smartForm.constants.DEPARTURE_DATE);return $j.tmpl(b.smartForm.settings.messages[this.name],{field_name_1:b.title.toLowerCase(),field_name_2:c.title.toLowerCase()})}}),locationSuggest:a.extend({},a.smartElementValidator,{name:"locationSuggest",doValidation:function(b){var c=!0;if(b.smartForm.submitting){c=!a(b.currentElement).hasClass(a.smartForm.constants.LS_INVALID);var d=this.getFormElementValue(b);c&&d.length<2&&(c=!1,a(b.currentElement).addClass(a.smartForm.constants.LS_INVALID))}return c;
},getMessage:function(b){var c="ls_invalid";return a.isNullOrUndefined(b.invalidLocationDropDown.select)||(c="ls_multiple_suggestions"),b.currentElement.hasClass(a.smartForm.constants.LS_UNSUPPORTED_LOCATION)&&(c="ls_unsupported_location"),this.getLSMessage(b,c)},getLSMessage:function(b,c){var d="";switch(c){case"required":d=$j.tmpl(b.smartForm.settings.messages[this.name],{field_name:b.title.toLowerCase()});break;case"ls_multiple_suggestions":case"ls_departure_required":case"ls_arrival_required":case"ls_invalid":default:var e="location";a(b.currentElement).hasClass("airport")&&!a(b.currentElement).hasClass("city")?e="airport":!a(b.currentElement).hasClass("airport")&&a(b.currentElement).hasClass("city")&&(e="city");var f={location_type:e,field_name:b.title.toLowerCase(),location:b.currentElement.val()};d=$j.tmpl(b.smartForm.settings.messages[c],f)}return d}}),arrivalCity:a.extend({},a.smartElementValidator,{name:"arrivalCity",doValidation:function(b){var c=!0,d=b.smartForm.getElement(a.smartForm.constants.DEPARTURE_CITY_CONTEXT_ID);if(!a.isNullOrUndefined(d)&&!a.emptyString(this.getFormElementValue(b))){var e=this.getFormElementValue(b),f=this.getFormElementValue(d);c=e!==f}return c},getMessage:function(b){var c=b.smartForm.getElement(a.smartForm.constants.DEPARTURE_CITY_CONTEXT_ID);return $j.tmpl(b.smartForm.settings.messages[this.name],{field_name_1:c.title.toLowerCase(),field_name_2:b.title.toLowerCase()})}})}}(jQuery);
//# sourceMappingURL=stm_smart_form.nano.js.map
!function(a){a.fn.googleMapFactory=function(b,c,d){if(!this.length)return null;var e=a.data(this[0],"googleMap");return e?e:(a.isNullOrUndefined(b)&&(b={latitude:0,longitude:0}),e=new GoogleMap(this[0],b,c,d),a.data(this[0],"googleMap",e),e.element.trigger(GoogleMap.constants.EVENT_READY),e)},GoogleMap=function(b,c,d,e){this.element=a(b),this.markers={},this.markersByType={},this.currentMarker=null,this.visibleMarkers={},this.popupDelay=250,this.popupTimeout=null,this.overlay=null,this.coords=c;var f=new google.maps.LatLng(this.coords.latitude,this.coords.longitude);this.options=a.extend({},GoogleMap.defaults,d,{center:f}),this.map=new google.maps.Map(this.element[0],this.options);var g=function(){};if(g.prototype=google.maps.OverlayView.prototype,g.prototype.classname="STMOverlay",g.prototype.draw=function(){},g.prototype.onAdd=function(){},g.prototype.onRemove=function(){},this.overlay=new g,this.overlay.setMap(this.map),e){var h=this;e.map&&a.each(e.map,function(b,c){google.maps.event.addListener(h.map,b,function(){a.proxy(c,h)()})})}},a.extend(GoogleMap,{constants:{EVENT_READY:"GoogleMap:ready",EVENT_BLUR:"GoogleMap:blur",EVENT_LOADING:"GoogleMap:loading",EVENT_LOADED:"GoogleMap:loaded",EVENT_SCRIPT_LOADED:"GoogleMap:script_loaded",CLASS_MAIN:"google_map_display",CLASS_INFO_WINDOW:"map_info_window",ZOOM_CITY:13,ZOOM_STATE:6},markerTypes:{},defaults:{mapTypeId:"roadmap",zoom:6},prototype:{addMarker:function(b,c,d,e){var f=this;if(d&&d.coords&&a.isUndefined(f.markers[b])){var g=new google.maps.LatLng(d.coords.latitude,d.coords.longitude);e.position=g;var h=c.type,i=c.subType;a.isUndefined(i)&&(i="_undefined");var j=GoogleMap.MarkerType.singleton(h);a.extend(e,j.getOptions());var k=new google.maps.Marker(e),l={id:b,type:h,googleMarker:k};f.markers[b]=l,a.each(j.getTriggerEvents(),function(a,b){google.maps.event.addListener(k,a,function(){b(f,l,d)})}),a.isUndefined(f.markersByType[h])&&(f.markersByType[h]={}),a.isUndefined(f.markersByType[h][i])&&(f.markersByType[h][i]=[]),f.markersByType[h][i].push(b)}},displayMarker:function(b,c){var d=this.markers[b];a.isUndefined(d)||(c?(d.googleMarker.setMap(this.map),this.visibleMarkers[b]=!0):(d.googleMarker.setMap(null),delete this.visibleMarkers[b]))},toggleMarkersByType:function(b,c,d){var e=this,f=b?e.map:null;if(a.isUndefined(c))return void a.each(e.markers,function(a,c){c.googleMarker.setMap(f),b?e.visibleMarkers[a]=!0:delete e.visibleMarkers[a]});if(e.markersByType[c])if(a.isUndefined(d))a.each(e.markersByType[c],function(a,d){for(index in d){var g=e.markersByType[c][a][index];e.markers[g].googleMarker.setMap(f),b?e.visibleMarkers[g]=!0:delete e.visibleMarkers[g]}});else if(!a.isUndefined(e.markersByType[c][d]))for(index in e.markersByType[c][d]){var g=e.markersByType[c][d][index];e.markers[g].googleMarker.setMap(f),b?e.visibleMarkers[g]=!0:delete e.visibleMarkers[g]}},blur:function(){a("."+GoogleMap.constants.CLASS_INFO_WINDOW).hide(),this.currentMarker&&(google.maps.event.trigger(this.currentMarker.googleMarker,GoogleMap.constants.EVENT_BLUR),this.currentMarker=null)},resize:function(b){if(a.isNullOrUndefined(b)){var c=new google.maps.LatLngBounds,d=0,e=this;a.each(e.visibleMarkers,function(a){var b=e.markers[a].googleMarker.getPosition();c.extend(b),d++}),d>0&&this.map.fitBounds(c),1==d&&this.resize(GoogleMap.constants.ZOOM_CITY)}else this.map.setZoom(b)},delayAction:function(a){this.popupTimeout&&clearTimeout(this.popupTimeout),this.popupTimeout=setTimeout(a,this.popupDelay)},setPopupDelay:function(a){return this.popupDelay=a,this}}}),GoogleMap.MarkerType=function(a){this.id=a,this.infoWindow=null,this.options={},this.triggerEvents={},this.init()},GoogleMap.MarkerType.singleton=function(b){return a.isUndefined(GoogleMap.markerTypes[b])&&(GoogleMap.markerTypes[b]=new GoogleMap.MarkerType(b)),GoogleMap.markerTypes[b]},a.extend(GoogleMap.MarkerType,{prototype:{init:function(){GoogleMap.markerTypes[this.id]=this},createInfoWindow:function(b,c){a("#"+b).length?a("#"+b).addClass(GoogleMap.constants.CLASS_INFO_WINDOW).hide():a(c).attr("id",b).addClass(GoogleMap.constants.CLASS_INFO_WINDOW).appendTo("body").hide(),this.infoWindow=DHTMLPopup_Factory.create({id:b});var d=this;this.infoWindow.popup.bind("dhtmlpopup:hide",function(a){var b=d.infoWindow.popup.data("map");b&&b.blur()})},updateInfoWindow:function(b){a.isNull(this.infoWindow)||a.proxy(b,this.infoWindow.popup)()},showInfoWindow:function(b,c,d){if(!a.isNull(this.infoWindow)&&b){b.blur(),this.infoWindow.popup.data("map",b);var e=b.element.offset();if(c){b.currentMarker=c;var f=b.overlay.getProjection().fromLatLngToContainerPixel(c.googleMarker.getPosition());e.top+=f.y,e.left+=f.x}d&&(e.top=Math.max(e.top+d.top,0),e.left=Math.max(e.left+d.left,0));var g=this;b.delayAction(function(){g.infoWindow.show(!0,e)})}},hideInfoWindow:function(){this.infoWindow&&this.infoWindow.popup.hide()},getOptions:function(){return this.options},getTriggerEvents:function(){return this.triggerEvents},setOptions:function(b){return a.extend(this.options,b),this},setTriggerEvents:function(b){return a.extend(this.triggerEvents,b),this}}})}(jQuery);
//# sourceMappingURL=stm_google_maps.nano.js.map
!function(a){a.toggleGroups={},a.toggleGroupsDebug=function(){BBDebug.group("Toggle Groups",!0),BBDebug.dir(a.toggleGroups),BBDebug.groupEnd()},a.extend(a.fn,{togglerHidden:function(){return!a(this[0]).is(":visible")},togglerVisible:function(){return a(this[0]).is(":visible")},toggler:function(){a(this).each(function(){if(!a(this).hasClass("toggleActive")){var b=a(this).attr("id"),c=b.substring(0,b.lastIndexOf("_")),d=b.substring(b.lastIndexOf("_")+1).split("-"),e=d[0],f=d[1]?d[1]:!1,g=a("#"+c).hasClass("dhtml_popup"),h=a(this).hasClass("tabbed"),i=this.tagName.toLowerCase();"input"==i&&(i=a(this).attr("type").toLowerCase()),f&&(a.toggleGroups[f]||(a.toggleGroups[f]=[],a.data(this,"group_ids",a.toggleGroups[f])),a.toggleGroups[f][a.toggleGroups[f].length]=c),a(this).click(function(){if(g){var b=a("#"+c).get(0);if(b){var d=a.data(b,"dhtmlpopup");if(d||(d=new DHTMLPopup(c)),"hide"==e)d.hide();else if("show"==e){var j=null;a("#"+c+"_offset").length>0&&(j=c+"_offset"),d.show(j)}}}else{f&&a.each(a.toggleGroups[f],function(b,c){a("#"+c).hide(),h&&(a("."+c+"_tab").removeClass("selected"),a("."+c+"_tab").parent(".toggle_tabs").removeClass(c+"_tab_active"))}),h&&(a("."+c+"_tab").parent(".toggle_tabs").addClass(c+"_tab_active"),a("."+c+"_tab").addClass("selected"));var k=a("#"+c);"radio"==i?"hide"==e?k.is(":visible")&&(k.hide(),k.trigger("STMToggle:hide")):"show"==e&&k.is(":hidden")&&(k.show(),k.trigger("STMToggle:show")):"checkbox"==i?k.is(":hidden")?(k.show(),k.trigger("STMToggle:show")):(k.hide(),k.trigger("STMToggle:hide")):a("#"+c+":visible").length?(a(this).find(".close").hide(),a(this).find(".open").show(),a("#"+c).hide(),"swap"==e&&(a("#"+c+"_initial").show(),a("#"+c+"_initial").trigger("STMToggle:initialStateShow"))):(a(this).find(".close").show(),a(this).find(".open").hide(),a("#"+c).show(),"swap"==e&&(a("#"+c+"_initial").hide(),a("#"+c+"_initial").trigger("STMToggle:initialStateHide")))}a(this).blur(),a(this).trigger("STMToggle:complete")}),a(this).addClass("toggleActive")}})}})}(jQuery);
//# sourceMappingURL=stm_toggle.nano.js.map
!function(a){AjaxSubscriptionLocation=Object.subClass({departure:"",arrival:"",departureIsDomestic:!1,element:null,email_element:null,init:function(b){this.element=a(b),this.element.length&&(this.email_element=a(".nl_sub_inline_e1_div",this.element),this._saCallback())},bind:function(b){if(this.element.length){var c=a(this.element).closest(".smartForm");c.length&&a(b,c).each(a.proxy(function(b,c){a(c).bind("LocationSuggest:valid LocationSuggest:valid:quickcheck",a.proxy(this._validationCallback,this))},this))}},_saCallback:function(b){if(!BookingBuddy.getCookie("rico_invite")){var c=BookingBuddy.Strings.NL.inlineSATeaser;a(".nl_sub_inline_sa_desc",this.element).html($j.tmpl(c,{})),this._showInlineInput(".nl_sub_inline_sa")}},_validationCallback:function(b){var c=BookingBuddy.Strings.NL,d=c.inlineDepTeaser,e=c.inlineRouteTeaser,f=a(b.target);if(f[0])if(this._setLocations(f),"departure_city"===f.attr("name"))this.departure&&this.departureIsDomestic?(a(".nl_sub_inline_departure_desc",this.element).html($j.tmpl(d,{dep_airport:this.departure})),this._showInlineInput(".nl_sub_inline_departure"),this.arrival&&(a(".nl_sub_inline_route_desc",this.element).html($j.tmpl(e,{dep_airport:this._getAirportCode(this.departure),arr_airport:this._getAirportCode(this.arrival)})),this._showInlineInput(".nl_sub_inline_route"))):this._hideInputs();else if("arrival_city"===f.attr("name")&&(this.departure&&this.departureIsDomestic&&this.arrival&&(a(".nl_sub_inline_route_desc",this.element).html($j.tmpl(e,{dep_airport:this._getAirportCode(this.departure),arr_airport:this._getAirportCode(this.arrival)})),this._showInlineInput(".nl_sub_inline_route")),this.arrival)){var g=a(".nl_sub_inline_hotel_watch_desc",this.element),h=g.hasClass("existing")?c.inlineHotelWatchAddTeaser:c.inlineHotelWatchTeaser;g.html($j.tmpl(h,{arrival_city:this.arrival})),this._showInlineInput(".nl_sub_inline_hotel_watch")}},_showInlineInput:function(b){a(b,this.element).length&&(this.element.show(),a("input",b).prop("checked")&&this.email_element.fadeIn(),a(b,this.element).fadeIn())},_hideInputs:function(){this.element.is(":visible")&&this.element.fadeOut()},_getAirportCode:function(a){var b=a.match(/\(([\w]{3})\)/);return b?b[1]:""},_setLocations:function(a){"departure_city"===a.attr("name")?(this.departure=a.val(),this.departureIsDomestic=this.isDomestic(a.data("country"))):"arrival_city"===a.attr("name")&&(this.arrival=a.val())},isDomestic:function(a){return"US"===a||"CA"===a}}),AjaxSubscription=function(a,b){this.id=a,this.popup=null,this.popupPos=null,this.form=null,this.init(b)},a.extend(AjaxSubscription,{options:{offset:{left:0,top:-50},useIframe:!1},prototype:{init:function(b){this.options=a.extend({},AjaxSubscription.options,b),this.$wrapper=a("#"+this.id),this.popupPos=a("#"+this.id+"_marker").length>0?this.id+"_marker":null,this.popup=DHTMLPopup_Factory.create({id:this.id,type:"sub",use_iframe:this.options.useIframe}),this.form=a("#"+this.id+"_form"),this.departure=a('input[name="ac1"]',this.form).val(),this.departureCity=a(".departure_name",this.form).text(),this.arrivalCity=a(".arrival_name",this.form).text(),a(".locationSuggest",this.$wrapper).keypress(BookingBuddy.handleEnterKey),a(".closeSub",this.$wrapper).click(a.proxy(function(a){this.$wrapper.trigger("dhtmlpopup:sub:closed"),this.popup.hide(a)},this));var c=this,d=c.id;a('input[type="text"]',this.form).focus(function(b){a("#"+d+"_msg").hide().html("")});var e=this.$wrapper.find("form.step1bForm");e[0]?this.initializeStep1BForm(e):this.$wrapper.bind("dhtmlpopup:sub:success",a.proxy(function(a,b){this.step2(b)},this)),this.$wrapper.bind("dhtmlpopup:sub:error",a.proxy(function(a,b){this.showError(b)},this)),this.form.smartFormFactory({submitHandler:function(b,d,e){var f=a(b).find(".autoConfirmEmail").get(0);if(f){var g=a(b).find(" input[name=e1]");a(f).val(g.val())}return b.departure_city&&b.ac1&&(b.ac1.value=b.departure_city.value),c.popup.submit(),e.stopPropagation(),e.preventDefault(),!1}}),a.data(this.$wrapper.get(0),"ajaxSub",this)},initializeStep1BForm:function(b){var c=b.find("input.toggleValidation"),d=b.find("input.toggleValidationTarget");c.change(function(a){d.prop("disabled",!this.checked)});var e=this;this.$wrapper.one("dhtmlpopup:sub:success",a.proxy(function(c,d){this.step1b(b,d),this.$wrapper.unbind("dhtmlpopup:sub:error"),this.$wrapper.bind("dhtmlpopup:sub:error",a.proxy(function(a,b){this.showStep1bError(b)},this)),this.form.smartFormFactory({submitHandler:function(a,b,c){return a.arrival_city&&a.cid&&(a.cid.value=a.arrival_city.value),e.popup.submit(),c.stopPropagation(),c.preventDefault(),!1}}),this.$wrapper.bind("dhtmlpopup:sub:success",a.proxy(function(a,b){b.existing=!1,this.step2(b)},this))},this))},_getNLProducts:function(){if(1!=this.form.length)return[];var b=[];return a.each(this.form.serializeArray(),function(a,c){"nlp[]"==c.name&&b.push(c.value)}),b},_isSubSelected:function(b){var c=this._getNLProducts(),d=!1;return a.each(b,function(b,e){return-1!=a.inArray(e,c)&&(d=!0),!d}),d},_isFareAlertSubDeparture:function(){return this._isSubSelected(["nl_product_bb_departure"])},_isFareAlertSubroute:function(){return this._isSubSelected(["nl_product_bb_route"])},_isDefaultSub:function(){return this._isSubSelected(["default","nl_product_bbtd"])},_isSASub:function(){return this._isSubSelected(["nl_product_sa"])},_isHotelWatchSub:function(){return this._isSubSelected(["nl_product_bb_hotel_watch"])},_isSTDealAlertSub:function(){return this._isSubSelected(["nl_product_dealalert"])},_isTopDealsSub:function(){return this._isSubSelected(["nl_product_bb_top_deals"])},step1:function(){this.$wrapper.trigger("dhtmlpopup:sub:step1"),this.popup.show(this.popupPos,this.options.offset),a(".step1",this.$wrapper).show(),a(".step1b",this.$wrapper).hide(),a(".step2",this.$wrapper).hide()},step1b:function(b,c){this.showSuccess(c);var d=this.form,e=d.find('input[name="e1"]').val();this.form=b,d.data("smartForm").reset(),this.popup.popup_form=b,b.find('input[name="e1"]').val(e),b.find('input[name="e2"]').val(e),b.find(".showStep2").click(a.proxy(function(a){b.find('input[name="nlp[]"]').each(function(a,b){b.removeAttribute("checked")}),this.step2({}),a.preventDefault()},this)),new LocationSuggest(this.form.find(".destination").attr("id"),["city"],null,{use_id:!0}),a(".step1",this.$wrapper).hide(),a(".step1b",this.$wrapper).show(),a(".step2",this.$wrapper).hide(),this.$wrapper.trigger("dhtmlpopup:sub:step1b")},step2:function(b){a(".step1",this.$wrapper).hide(),a(".step1b",this.$wrapper).hide(),"dhtmlsignup_uk"!==this.id&&(a("#not_you").hide(),a("#username_block").html("Back")),b.email=this.form.find("#sub_e1").val(),b.fare_alerts=this.form.find("#sub_nlp").prop("checked"),this.form.data("smartForm").reset(),this.showSuccess(b),a(".step2",this.$wrapper).show();var c=a(".step2 .title",this.$wrapper).html();this.$wrapper.parents(".inline_subs_module").find(".title").html(c),"dhtmlsignup_uk"!==this.id&&("dealssub"!==this.id||b.existing||a("#user_area .user_welcome").text("Welcome!"),a("#billboard").hide(),a("#user_area").show()),this.$wrapper.trigger("dhtmlpopup:sub:step2",[b])},showError:function(b){var c=b.message||a("#"+this.id+" .sub_error_msg").html();a("#"+this.id+" .step1").show(),a("#"+this.id+"_form_errorMessages").html(c).show()},showStep1bError:function(a){var b=a.message||"There was an error processing your request. Please try again later.";this.form.find(".smartFormErrorMessages").html(b).show()},showSuccess:function(b){var c=[],d=a("#"+this.id),e=a("#"+this.id+"_wrapup_header"),f=a("#"+this.id+"_wrapup_sub"),g=a("#"+this.id+"_wrapup_sub_2"),h=a("#"+this.id+" .welcome_back_msg"),i=BookingBuddy.Strings.NL,j=stm&&stm.pageData?stm.pageData.mode:null;this._isFareAlertSubDeparture()&&c.push("Fare Alert Departure"),this._isFareAlertSubroute()&&c.push("Fare Alert Route"),this._isDefaultSub()&&c.push("Default"),this._isSASub()&&c.push("Snique Away"),this._isHotelWatchSub()&&c.push("Hotel Watch"),this._isSTDealAlertSub()&&c.push("ST Deal Alert"),this._isHotelWatchSub()&&this._isSASub()?(e.html(i.inlineSAPlusHWWrapupHeader),f.html(i.inlineSAPlusHWWrapupMsg),g.html(a.tmpl(i.inlineSAPlusHWWrapupMsgSubText,{arrival_city:this.arrivalCity}))):this._isHotelWatchSub()?(e.html(a.tmpl(i.inlineHotelWatchWrapupHeader,{arrival_city:this.arrivalCity})),f.html(a.tmpl(i.inlineHotelWatchWrapupMsg,{arrival_city:this.arrivalCity}))):!this._isSASub()||this._isFareAlertSubDeparture()||this._isFareAlertSubroute()||this._isDefaultSub()?"car"===j&&this._isTopDealsSub()||"vacation"===j&&this._isFareAlertSubDeparture()?(c.push("Default"),c.push("BookingBuddy Top Travel Deals"),c.push("BookingBuddy This Just In"),"car"===j?f.html(i.inlineTTDWrapupMsg):f.html($j.tmpl(i.inlineWrapupMsg,{dep_airport:this.departure}))):f.html($j.tmpl(i.inlineWrapupMsg,{dep_airport:this.departure})):(e.html(i.inlineSAWrapupHeader),f.html(i.inlineSAWrapupMsg),g.hide()),!c.length||b.existing&&b.existing_default&&!this._isSASub()?(e.html(h.html()),a.publish("/sub/login",[d,c])):(e.html(i.inlineWrapupHeader),a.publish("/sub/new",[d,c]))}}})}(jQuery),$j(document).ready(function(){var a=$j("#topjoin_form").length>0,b=$j("#dhtmlsignup_uk").length>0,c=$j("#nl_sub_step2").length>0,d=$j("#sub_form").length>0,e=$j("#dealssub_form"),f=2610404,g=2609433;if(a&&$j("#topjoin_form").smartFormFactory({submitHandler:function(a,b,c){return $j.asyncLoad("#dhtmlsignup","topjoin",function(a){$j("#topjoin_e1").blur(),$j("#dhtmlsignup_e1").val($j("#topjoin_e1").val());var b=new AjaxSubscription($j(a).attr("id"),{offset:{top:0,left:-5},cookie_name:null});b.step1()}),c.stopPropagation(),c.preventDefault(),!1}}),e[0]){new AjaxSubscription("dealssub",{offset:{top:0,left:0},cookie_name:null})}var h=$j("#hotelwatch_signup_form");if(h[0]){new AjaxSubscription("hotelwatch_signup",{offset:{top:0,left:0},cookie_name:null})}if(b){var i=new AjaxSubscription("dhtmlsignup_uk",{offset:{top:0,left:0}});f=2617144,g=2617145,$j("#traveldeals").click(function(){i.popup.setCookieName(null),i.step1()}),$j(".smartForm.BBUKSearch").bind("bbuk:submit",function(){i.popup.setCookieName("BBDHTMLPopup_Sub"),i.step1()})}if($j(document).on("click",".terms",function(){openInfoPopup(f,"BookingBuddy+Terms+of+Use","bb_terms","scrollbars=1,resizable=1,width=460,height=500")}),$j(document).on("click",".privacy",function(){openInfoPopup(g,"BookingBuddy+Privacy+Policy","bb_privacy_policy","scrollbars=1,resizable=1,width=460,height=500")}),d){BBDebug.log("Sub Join form"),$j("#sub").bind("dhtmlpopup:sub:step2",function(a,b){var c="?lightbox=new_sub&user="+encodeURIComponent(b.email?b.email:"")+"&existing="+(b.existing?"true":"false")+"&existing_default="+(b.existing_default?"true":"false")+"&fare_alerts="+(b.fare_alerts?"true":"false");setTimeout("window.location.href = '/"+c+"'",1500)});new AjaxSubscription("sub",{})}if(c){BBDebug.log("Found step 2 newsletter signup");var j=new AjaxSubscription("nl_sub_step2",{cookie_name:null}),k=$j("#nl_sub_step2_e1").data("smartElement"),l=k.value(),m=!$j.emptyString(l);k.defaultVal&&l==k.defaultVal&&(m=!1),m===!0&&"enter your email address"==l.toLowerCase()&&(m=!1);var n=$j("#nl_sub_step2_hotel_watch").is(":checked"),o=$j("#nl_sub_step2_dep").is(":checked"),p=$j("#nl_sub_step2_route").is(":checked"),q=$j("#nl_sub_step2_sa").is(":checked"),r=$j("#nl_sub_step2_top_deals").is(":checked");BBDebug.log("Departure checked: "+o+" - Route checked: "+p),j.step1(),m&&(n||o||p||q||r)&&$j(j.form).submit()}$j(".smartForm .nl_sub_inline").each(function(a,b){var c=new AjaxSubscriptionLocation(b);c.bind(".ajaxLocationSignup"),$j("input[type=checkbox]",b).change(function(){var a=0;$j(b).find("input[type=checkbox]").each(function(b,c){$j(c).prop("checked")&&a++}),a>0?c.email_element.fadeIn():c.email_element.hide()})})});
//# sourceMappingURL=stm_ajax_subscriptions.nano.js.map
var BBInit={all:function(){this.forms(),this.deals(),this.fareEntries(),this.taCheckRates();var a=new BBHotelImages;a.loadHotelImages(),this.googleMaps(),this.openLocationDetails(),this.affiliateLanding(),this.traqLander(),this.launchDHTMLSub(),this.hotelListing(),this.semBlurbPopup(),this.bbs2342(),this.crm59413(),this.tabBrowsing(),this.clickCapping(),this.setupGroupLink()},crm59413:function(){var a=$j("#dhtml_confirm");if(a.length>0){var b=DHTMLPopup_Factory.create({id:"dhtml_confirm",type:"base"});b.setPageMask("page_mask");var c={left:220,top:25};b.show("basic_content",c)}},bbs2342:function(){var a=$j("#nav a.navtab.news");a.length>0&&a.click(function(a){a.stopPropagation();new ExternalPopup({url:"http://www.jetsetter.com/",width:1020,height:730,placement:ExternalPopup.PLACEMENTS.PARENT});return!1})},traqLander:function(){if("traqLander"in stm.pageData){var a=stm.pageData.traqLander.ctm,b=stm.pageData.traqLander.maximizeOnTraqClose,c=BookingBuddy.abTests;if(c.bbs1705){var d={a:"A1",b:"B1",c:"C1",d:"A1B1",e:"B1C1",f:"A1C1",g:"A1B1C1",h:""};2===c.bbs1705.length&&c.bbs1705.charAt(0)in d&&(a=d[c.bbs1705.charAt(0)])}var e=new stm.TraqLander({params:a,splash_container:"splash_container",page_mask:"traq_lander_page_mask",maximizeOnTraqClose:b});e.display()}},deals:function(){var a={},b={};if($j(".deals_module")[0]){var c=BookingBuddy.searchMode,d=BBSavedSearchData.singleton();if("cruise"==c)a.arrival_city=d.getCurrentSearchData("destination",c);else{var e=d.getCurrentState().getLocation1(["city"]);e&&(a.stm_origin_id=e.id);var f=d.getCurrentState().getLocation2(["city"]);f&&(a.stm_destination_id=f.id)}("air"==BookingBuddy.searchMode||"home"==BookingBuddy.searchMode)&&(a.deal_type="");var g="car"==BookingBuddy.searchMode?"pickup_city":"cruise"==BookingBuddy.searchMode?"destination":"arrival_city",h=$j(".deals_module.top_deals");if(h[0]){var i=$j("#top_deals_box"),j=i.hasClass("narrowDealsLayout")?BookingBuddy.Strings.Deals.RevNarrowTemplate:BookingBuddy.Strings.Deals.RevSpanTemplate;a.placement="BBS_rr_"+BookingBuddy.searchMode,b={containerDivs:h.first(),fold_price:!0,fold_destination:!0,target_input:g,search_mode:BookingBuddy.search_mode,dealTemplate:j,onSuccess:function(){i.show(),$j.publish("/load/module/bbdeal",["top_deals"])},onError:function(){i.hide()}},BookingBuddy.Deals.register(a,b),BookingBuddy.Deals.init({feedUrl:"BBDeals.getTopDeals"})}var k=$j(".deals_module.split_deals");if(k[0]){var l=k.size(),m=3;a.no_ads=l*m,a.placement="BBS_sp_"+BookingBuddy.searchMode,b={containerDivs:k,search_mode:BookingBuddy.search_mode,dealTemplate:BookingBuddy.Strings.Deals.SponsoredTemplate,onSuccess:function(){k.show()},onError:function(){k.hide()}},BookingBuddy.Deals.register(a,b,"split_deals"),BookingBuddy.Deals.init({feedUrl:"BBDeals.getTopDeals"})}var n=$j(".deals_module.targeted_deals");if(n[0]){var o=n.find(".property_id").text(),p={hotel_id:o,no_ads:1,placement:"BBS_targeted_"+BookingBuddy.searchMode};b={containerDivs:n.first(),search_mode:BookingBuddy.search_mode,dealTemplate:BookingBuddy.Strings.Deals.TargetedHotelTemplate,onSuccess:function(){n.show()},onError:function(){n.hide()}},BookingBuddy.Deals.register(p,b,"targeted_deals"),BookingBuddy.Deals.init({feedUrl:"BBDeals.getTargetedDeals"})}}},fareEntries:function(){function a(a){var b=a.split(",");return b&&b.length>0?b[0]:""}$j("a.populate",".sample_fares_module").click(function(b){b.preventDefault(),b.stopPropagation();var c=$j(this).parents("tr"),d=$j(".step_1_widget:first"),e={};e.from=c.find(".departure_name").text(),e.to=c.find(".arrival_name").text(),e.dep_date=c.find(".departure_date").text(),e.ret_date=c.find(".return_date").text(),e.price=c.find(".fare_price").text(),e.omniture_desc="Find this fare|From-"+a(e.from)+"|To-"+a(e.to)+"|Dpt Date-"+e.dep_date.replace(/\//g,"")+"|Rtn Date-"+e.ret_date.replace(/\//g,"")+"|Prx-"+e.price.replace(/[^0-9]/g,""),e.page_type=c.find(".page_type").text(),c.hasClass("populates_step1")&&d[0]?$j.publish("/click/FindFare/step1",[d,e]):$j.publish("/click/FindFare/tabbedSearch",[e])})},taCheckRates:function(){var a=$j(".check_rates_wrapper:not(.loaded)");if(0!==a.length){var b={},c={ids:[],inputs:[],type:"ta"},d={ids:[],inputs:[],type:"stm"},e=null,f=function(a){var c=$j(this),d=c.parents(".check_rates_wrapper"),e=c.siblings(".check_rates_providers"),f=c.data("hotel_id");e.html(""),f in b?e.html(b[f]):(j(d,f),c.data("loaded_hotels",b))};$j.each(a,function(a,b){e=$j(this).find(".hotel_id").first().text(),$input=$j(this),e||(e=$input.find("[data-hotel-id]").attr("data-hotel-id")),$input.hasClass("showNow")?$input.hasClass("use_taid")?(c.ids.push(e),c.inputs.push($input)):(d.ids.push(e),d.inputs.push($input)):$input.find('input[name="provider"]').change(f)});var g=function(a){$j(a).find(".check_rates_providers").html("We were unable to load providers at this time")},h=function(a,b,c){var d=a.vendor.replace(/_/,"-"),e=b+"_"+d+"_"+a.code,f=TACheckRates.singleton(e),g={author_name:a.author,provider_key:a.provider_key,display_name:a.vendor,external_url:a.url};f.setMetaDataMulti(g);var h={name:e,vendor:a.vendor,checked:a.checked?"checked":"",code:a.code};$j(c).prepend($j.tmpl(BookingBuddy.Strings.CheckRates.DefaultTemplate,h)),g.id=b+"_"+d,g.tracking_id=e,g._checked=a.checked;var i=new stm.Models.CheckRates.Ad(g);return i},i=function(a){if(0!==a.ids.length){var b={ids:a.ids,type:a.type,mcid:BookingBuddy.taCheckRatesMCID};$j.bbget("TACheckRates.fetchMultiple",b,function(b){var c=null,d=null,e=null;!b||b.error?$j.each(a.inputs,function(){g(this)}):$j.each(a.ids,function(f,i){if(i in b){var j=$j(a.inputs[f]);e=j.find(".check_rates_providers"),e.html(""),c=b[i],d=c.length;for(var k=[],l=null,m=d;m--;)l=h(c[m],i,e),k.push(l),$j(a.inputs[f]).addClass("loaded");var n=stm.CheckRates.hotelCollection.get(i);n||(n=stm.CheckRates.hotelCollection.create({id:i})),n.addAdsToCollection(k.reverse())}else g(a.inputs[f])})})}},j=function(a,c){var d="",e={id:c,type:a.hasClass("use_taid")?"ta":"stm"};void 0!==BookingBuddy.taCheckRatesMCID&&$j.extend(e,{mcid:BookingBuddy.taCheckRatesMCID}),$j.bbget("TACheckRates.fetch",e,function(e){!e||e.error?d="We were unable to load providers at this time":$j.each(e,function(a,b){var e=b.vendor.replace(/_/,"-"),f=c+"_"+e+"_"+b.code,g=TACheckRates.singleton(f);g.setMetaDataMulti({author_name:b.author,display_name:b.vendor,external_url:b.url});var h={name:f,vendor:b.vendor,checked:b.checked?"checked":"",code:b.code};d+=$j.tmpl(BookingBuddy.Strings.CheckRates.DefaultTemplate,h)}),a.find(".check_rates_providers").html(d),b[c]=d})};i(c),i(d)}},googleMaps:function(){if($j("#dhtml_gmap_wrapper").length){var a=DHTMLPopup_Factory.create({id:"dhtml_gmap_wrapper",type:"googleMap"});a.popup.on("dhtmlpopup:show",function(){$j.publish("/dhtmlPopup/googleMap")})}var b=$j(".google_map");b.length&&(BookingBuddy.Maps.googleMapLoaded=function(){b.trigger(GoogleMap.constants.EVENT_SCRIPT_LOADED)},$j.getScript("http://maps.google.com/maps/api/js?v=3.2&sensor=false&client=gme-expedia&callback=BookingBuddy.Maps.googleMapLoaded"))},affiliateLanding:function(){var a=$j(".become_affiliate");if(a[0]){var b=DHTMLPopup_Factory.create({id:"dest_360_popup",type:"base"});b.setPageMask("page_mask"),b.maskClick("page_mask");var c=DHTMLPopup_Factory.create({id:"nydn_popup",type:"base"});c.setPageMask("page_mask"),c.maskClick("page_mask"),a.find(".white_label.dest_360").click(function(a){a.preventDefault(),a.stopPropagation(),b.show()}),a.find(".white_label.daily_news").click(function(a){a.preventDefault(),a.stopPropagation(),c.show()})}},forms:function(){var a=BookingBuddy.submitHandlers,b=BookingBuddy.bbSubmitHandlers,c=$j(".hotel_listing")[0];$j(".smartForm.oneSearch").each(function(){$j(this).smartFormFactory({noDefaultDates:c,submitTarget:"_blank",submitHandler:function(a,c,d){b.submitForm(a,c,d)}})}),$j(".smartForm.classicSearch").each(function(){$j.dhtmlDropdown.utils.classicSearch($j(this),$j("#BBAdDropdown")),$j("#BBAdDropdown").dhtmlDropdownFactory(BookingBuddy.dropdownOptions,{tpt_premium:BookingBuddy.Strings.DHTMLDropdown.PremiumAdTemplate,tpt_basic:BookingBuddy.Strings.DHTMLDropdown.BasicAdTemplate,tpt_placeholder:BookingBuddy.Strings.DHTMLDropdown.PlaceholderAdTemplate,list_position:"top"}),$j(this).smartFormFactory({noDefaultDates:c,submitHandler:function(a,c,d){b.submitForm(a,c,d)}})}),$j("#search_widget input").each(function(){$j(this).is(":checked")&&$j(this).parent("label").addClass("on")}),$j("#search_widget label input").change(function(){$j(this).is(":checked")?($j(this).parent("label").addClass("on"),$j(this).parents().hasClass("radio_bttn")&&$j(this).parents().siblings().removeClass("on")):($j(this).parents().removeClass("on"),$j(this).parent("label").hasClass("radio_bttn")&&$j(this).parent("label").siblings().addClass("on"))}),$j(".section_searchtype > label").click(function(){$j(".book_together label").removeClass("on")}),$j(".smartForm.noHandler").each(function(){$j(this).smartFormFactory({noDefaultDates:c,submitHandler:function(b,c,d){return a.noHandler(b,c,d)}})}),$j("#dhtml_hotel_search").length>0&&DHTMLPopup_Factory.create({id:"dhtml_hotel_search",type:"checkRates"}),$j(".smartForm.checkHotelRates").each(function(){$j(this).smartFormFactory({noDefaultDates:c,submitHandler:function(a,c,d){b.submitForm(a,c,d)}})}),$j("#hotel_reviews_container:not(.ta_id)").length>0&&$j("#hotel_reviews_container:not(.ta_id) .review_blurb").each(function(){var a=$j(this).attr("id"),b=a.substr(a.lastIndexOf("_")+1);$j.bbget("HotelReviews.reviews",{hotel_id:b,num_reviews:1},function(a){if($j.isNullOrUndefined(a)||0===a.length)return void $j("#review_blurb_"+b).html("");try{$j("#review_blurb_"+b+" .review_title a").attr("href",a[0].review_url),$j("#review_blurb_"+b+" .review_title span.review_title").html(a[0].title),"0"==a[0].author?$j("#review_blurb_"+b+" .pub_info span.author_section").remove():$j("#review_blurb_"+b+" .pub_info span.review_author").html(a[0].author),$j("#review_blurb_"+b+" .summary span.review_summary").html(a[0].review),$j("#review_blurb_"+b+" .summary a").attr("href",a[0].review_url),$j("#review_blurb_"+b).show()}catch(c){BBDebug.log("Error getting hotel review: "+b,c),$j("#review_blurb_"+b).html("")}})}),$j("#hotel_reviews_container.ta_id").length>0&&$j("#hotel_reviews_container.ta_id .review_blurb").each(function(){var a=$j(this).attr("id"),b=a.substr(a.lastIndexOf("_")+1);$j.bbget("HotelReviews.reviewsByTAId",{ta_hotel_id:b,num_reviews:1},function(a){if($j.isNullOrUndefined(a)||0===a.length)return void $j("#review_blurb_"+b).html("");try{var c=a[0].date.split("T"),d=c[0].split("-"),e=new Date(d[0],d[1]-1,d[2]),f=e.toDateString().substring(4);$j("#review_blurb_"+b+" .review_title a").attr("href",a[0].url),$j("#review_blurb_"+b+" .review_title span.review_title").html(a[0].title),"0"==a[0].author?$j("#review_blurb_"+b+" .pub_info span.author_section").remove():$j("#review_blurb_"+b+" .pub_info span.review_author").html(a[0].author),$j("#review_blurb_"+b+" .pub_info span.pub_date").html(f),$j("#review_blurb_"+b+" .summary span.review_summary").html(a[0].summary),$j("#review_blurb_"+b+" .summary a").attr("href",a[0].url),$j("#review_blurb_"+b).show()}catch(g){BBDebug.log("Error getting hotel review: "+b,g),$j("#review_blurb_"+b).html("")}})}),$j(".smartForm.skipStep2").each(function(){$j(this).smartFormFactory({noDefaultDates:c,submitHandler:function(a,c,d){return b.skipStep2(a,c,d)}})}),$j(".smartForm.openTabbedBrowsing").each(function(){stm.Browser.ie6?$j(this).smartFormFactory({noDefaultDates:c,submitHandler:function(a,c,d){return b.SkipStep2(a,c,d)}}):$j(this).smartFormFactory({noDefaultDates:c,submitHandler:function(a,c,d){return b.bbsToTabbed(a,c,d)}})}),$j(".smartForm.tabSearch").each(function(){$j(this).on("SmartForm:invalid",function(a){$j("a.edit_details").click()}),$j(this).on("SmartForm:ready",function(a){var b=function(a){$j(a.currentTarget).data("smartElement").smartForm.preValidate(),$j(a.currentTarget).unbind("LocationSuggest:invalid:quickcheck",b)};$j(this).data("smartForm").getLSElements().on("LocationSuggest:invalid:quickcheck",b),$j(this).data("smartForm").getLSElements().on("LocationSuggest:valid:quickcheck",function(a){$j(a.currentTarget).unbind("LocationSuggest:invalid:quickcheck",b)}),$j(this).data("smartForm").preValidate()})}),$j(".smartForm.bbSearch").each(function(){var a=$j(this);a.on("SmartForm:invalid",function(a){$j("a.edit_details").click()}),a.on("SmartForm:ready",function(b){var c=$j("#invalidLSFields").html();if(!$j.emptyString(c)){var d=$j.data(this,"smartForm"),e=c.split(",");$j.each(e,$j.proxy(function(a,b){var c=this.invalidateElement(b,"locationSuggest");$j.isNullOrUndefined(c)||$j(c.currentElement).on("LocationSuggest:invalid",function(a){$j("a.edit_details").click()})},d))}var f=function(a){$j(a.currentTarget).data("smartElement").smartForm.preValidate(),$j(a.currentTarget).unbind("LocationSuggest:invalid:quickcheck",f)};a.data("smartForm").getLSElements().on("LocationSuggest:invalid:quickcheck",f),a.data("smartForm").getLSElements().on("LocationSuggest:valid:quickcheck",function(a){$j(a.currentTarget).unbind("LocationSuggest:invalid:quickcheck",f)})}),$j(this).smartFormFactory({noDefaultDates:c,submitHandler:function(a,c,d){b.submitForm(a,c,d),$j.publish("/submit/step2")}});var d=$j("#"+$j(this).attr("id")+"_select_all");if(d.change($j.proxy(function(a){var b=$j(a.currentTarget).is(":checked");$j(this).find(".adIdCheckBox").prop("checked",b)},this)),$j(this).find(".BBInputImage.toggleAdCheck").click(function(a){var b=$j(this).find("span.adId").html();$j.emptyString(b)&&(b=$j(this).parent().find("span.adId").html());var c=$j("#check_"+b);return c.prop("checked",!c.is(":checked")),c.change(),a.preventDefault(),a.stopPropagation(),!1}),$j(this).find(".BBInputCheckBox.toggleAdCheck").change(function(a){var b=$j(".BBInputCheckBox.toggleAdCheck").length,c=$j(".BBInputCheckBox.toggleAdCheck:checked").length;d[0]&&(d.get(0).checked=b==c)}),$j.dhtmlDropdown.utils.revSearch($j(this),$j("#BBAdDropdown")),$j("#BBAdDropdown").dhtmlDropdownFactory(BookingBuddy.dropdownOptions,{tpt_premium:BookingBuddy.Strings.DHTMLDropdown.PremiumAdTemplate,tpt_basic:BookingBuddy.Strings.DHTMLDropdown.BasicAdTemplate,tpt_placeholder:BookingBuddy.Strings.DHTMLDropdown.PlaceholderAdTemplate}),BookingBuddy.getQSParam("placeFirst")){var e=BookingBuddy.getQSParam("placeFirst"),f=$j("#BBAdDropdown").data("dhtmlDropdown");f&&f.updateCurrent(e)}d.prop("checked",!0).change(),$j("#"+BookingBuddy.searchMode+"_more_options").removeAttr("checked")}),$j("#hotel_listing_filter").hotelListing(),$j("#hotel_details_tabs").propertyDetailTabs();var d=$j(".bbdn_deal_click");d[0]&&d.click(function(a){a.preventDefault();var b={},c=$j(this).closest(".deal_container").find(".omniture_bbd");c[0]&&(b=stm.parseJSON(c.text())),$j.publish("/click/bbdeal",[b,this])})},openLocationDetails:function(){$j(".step_2_ads .toggle_edit").click(function(a){a.preventDefault(),$j(".step_2_ads #edit_details_tagline, .step_2_ads #dhtml_edit_step2").slideToggle()}),$j(".step_2_ads .toggle_edit").hasClass("openOnLoad")&&$j(".step_2_ads .toggle_edit").click();var a=$j(".step_2_ads.air.classic");if(a[0]){var b=a.find(".toggle_more a");b.click(function(c){c.preventDefault(),a.find(".more_options").slideToggle("fast",function(){$j(this).is(":visible")?b.text("more options-"):b.text("more options+")})})}},launchDHTMLSub:function(){$j(document).ready(function(){var a;1==$j("#hotel_watch_dhtml").length?(a=new AjaxSubscription("hotel_watch_dhtml",{offset:{left:0,top:50},cookie_name:null}),a.popup.setPageMask("page_mask")):1==$j("#dhtmlsignup_inline").length&&(a=new AjaxSubscription("dhtmlsignup_inline")),a&&a.step1()})},hotelListing:function(){var a={};$j("#hotel_results_filters").hotelListing(a)},setupGroupLink:function(){var a=stm.pageData.adHandlerUrl?stm.pageData.adHandlerUrl:"http://r.bookingbuddy.com/go?",b=$j(".group_link a");$j.each(b,function(b,c){var d=$j(c),e=d.data("trackingInfo");d.on("click",function(){var b=new stm.Popup(a+"&"+$j.param(e));return b.useOptimalDimensions(),b.tryPop(),!1})})},tabBrowsing:function(){var a=stm.pageData.tabBrowsing;if(a){var b={};for(adId in a.ads)b[adId]=BBAd.singleton(adId).setMetaDataMulti(a.ads[adId]);var c=$j("#BBAdDropdown");c.dhtmlDropdownFactory(a.dropdownAdIds,{tpt_premium:BookingBuddy.Strings.DHTMLDropdown.PremiumAdTemplate,tpt_basic:BookingBuddy.Strings.DHTMLDropdown.BasicAdTemplate,tpt_placeholder:BookingBuddy.Strings.DHTMLDropdown.PlaceholderAdTemplate,list_position:"bottom"});var d={searchMode:stm.pageData.mode,siteRedirectUrl:BookingBuddy.redirectUrl,adHandlerUrl:stm.pageData.adHandlerUrl,headerElem:$j("#tabHeader"),panelElem:$j("#tabPanel"),dropdownElem:c,tabIds:a.tabAdIds,adList:b,searchParams:stm.pageData.queryString},e={delayTabFadeIn:a.traqEnabled,suppressInstructionsHTML:!a.displayInstructions,loadFirstTab:!a.displayInstructions,showHotelCount:!1,maximizeOnLoad:a.maximizeOnLoad,showDevilHorns:a.devilHorns,oneTab:a.oneTab,reverseFading:!!a.reverseFading,showAlertOnClose:a.alertOnClose,selectedAdId:a.selectedAdId},f=BookingBuddy.affiliateName;f&&"bookingbuddy_com"!==f&&(e.logoLinkAffiliate=f),$j("#tabsContainer").tabBrowsing(d,e),a.linkshareEnabled&&BookingBuddy.Tracking.trackLinkShareClick("search")}},clickCapping:function(){BookingBuddy.clickCapping=new stm.ClickCapping},semBlurbPopup:function(){var a=$j(".semblurb.dhtml_popup");a[0]&&($j("body").append(a),$j(".blurb_clicky").click(function(){var a=$j(this).attr("data-blurbid"),b=new DHTMLPopup("full_text_dhtml_"+a,!1);b.setPageMask("page_mask"),b.show();var c=10;return $j("#full_text_dhtml_"+a).css({top:c,position:"fixed"}),!1}))}};
//# sourceMappingURL=bb-init.nano.js.map
BBAffInit={all:function(){this.forms(),this.targeting(),this.deals()},allUK:function(){switch(BookingBuddy.UK.init(),BookingBuddy.searchMode){case"hotel":BBUKInit.affiliate_hotel_listing(),BBUKInit.targeting(),BBUKInit.forms(),BBUKInit.hotel(),BBUKInit.taCheckRates();break;case"holiday":BBUKInit.targeting(),BBUKInit.forms(),BBUKInit.holiday();break;case"air":default:BBUKInit.targeting(),BBUKInit.forms()}},targeting:function(){var a=[];$j(".BBTargeting.smartElement").each(function(){a.push(this.id)});new BBTargeting(a)},deals:function(){var a=$j("#BB-deals-sidecar-deals-section");if(a[0]){var b={placement:"bbdn_"+BookingBuddy.affiliateName+"_wlabelside"},c={target_input:"car"==BookingBuddy.searchMode?"pickup_city":"cruise"==BookingBuddy.searchMode?"destination":"arrival_city",divDealsHeader:"BB-deals-sidecar-header",containerDivs:a.first(),onSuccess:function(){this.cityName?$j("#BB-deals-sidecar-header").show():$j("#BB-deals-sidecar-header").hide(),$j("#BB-deals-sidecar").show()},onError:function(){$j("#BB-deals-sidecar-header").hide()}};"undefined"!=typeof BookingBuddy.loadAffiliateDeals&&(BookingBuddy.Deals.register(b,c),BookingBuddy.Deals.init({feedUrl:"BBDeals.getTopDeals"}))}},forms:function(){$j(".smartForm.bbSearch").each(function(){$j(this).smartFormFactory({submitTarget:"_blank",submitHandler:function(a,b,c){BookingBuddy.bbSubmitHandlers.submitForm(a,b,c)}}),$j.dhtmlDropdown.utils.oneSearch($j(this),$j("#BBAdDropdown")),$j("#BBAdDropdown").dhtmlDropdownFactory(BookingBuddy.dropdownOptions,{tpt_premium:BookingBuddy.Strings.DHTMLDropdown.PremiumAdTemplate,tpt_basic:BookingBuddy.Strings.DHTMLDropdown.BasicAdTemplate,tpt_placeholder:BookingBuddy.Strings.DHTMLDropdown.PlaceholderAdTemplate})})}};
//# sourceMappingURL=aff-init.nano.js.map
$j(document).ready(function(){var a={};switch(a.searchMode=$j("#searchModeName")[0]?$j("#searchModeName").html():"",a.domain=$j("#siteDomainBase")[0]?$j("#siteDomainBase").html():"",a.affiliateName=$j("#affiliateName")[0]?$j("#affiliateName").html():"",a.allowFramed=$j("#allow_framed").length>0,a.redirectUrl=$j("#siteRedirectUrl")[0]?$j("#siteRedirectUrl").text():"",a.taCheckRatesMCID=$j("#TACheckRatesMCID")[0]?$j("#TACheckRatesMCID").text():"",a.taHotelPhotosMCID=$j("#TAHotelPhotosMCID")[0]?$j("#TAHotelPhotosMCID").text():"",a.taReviewsMCID=$j("#TAReviewsMCID")[0]?$j("#TAReviewsMCID").text():"",BookingBuddy.init(a),BookingBuddy.User.init(),$j.smartFormsBBSavedSearchData=BBSavedSearchData.singleton(),$j(".toggle").toggler(),$j(document).on("click",".stopClick",function(a){return a.stopPropagation(),a.preventDefault(),$j(a.currentElement).blur(),!1}),$j(document).on("cut copy paste",".noCopy",function(a){return a.stopPropagation(),a.preventDefault(),!1}),BookingBuddy.affiliateName){case"bookingbuddy_com":case"cheapflightsomg_com":case"cheaphotelsomg_com":case"cheapoair_com":case"vayama_com":case"tripzen":case"bootsnall":case"skyauction":case"ifly_com":case"travelmath":case"webjet":case"onetravel":case"airticketsdirect":case"dealbase":case"flightstats":case"destination360_com":case"usnews":case"cruise_deals":case"budgetair_com":case"flightnetwork":case"easytobook":case"huno":case"flighthub":case"independent_traveler":case"airfaresflights_blacklabel":case"fodors_com":BBInit.all();break;case"bookingbuddy_co_uk":case"holidayweatherguide":case"uk_holiday_weather":case"jetcost":case"easytobook_uk":case"uk_airfaresflights_blacklabel":case"top_rated_travel":case"bargain_travel_4_u":stm&&stm.pageData&&(stm.pageData.isUKAffiliate=!0),BBUKInit.all();break;case"world_travel_guide":case"uk_airfaresflights":case"holidaywatchdog":stm&&stm.pageData&&(stm.pageData.isUKAffiliate=!0),BBAffInit.allUK();break;default:BBInit.all()}$j(".smartForm").each(function(){$j(this).smartFormFactory({submitHandler:function(a,b,c){BookingBuddy.submitHandlers.defaultHandler(a,b,c)}},!0)}),$j("input.ipLocAirport:visible").each(function(){BBIPLocation.populate("airport",$j(this).attr("id"),!1)}),$j("#hotel_reviews_container.hotel_listings").length>0&&$j("#hotel_arrival_city").val($j("#hotelcheckrates_arrival_city").val());new stm.shared.controllers.dealsPopunder($j("html"),{holdingWindowUrl:"about:blank"})}),$j(function(){$j(".ad_frame").each(function(a,b){var c=new ContentFrame(b);c.load(!1)}),$j(".ad_frame iframe").load(function(a){var b=$j(a.currentTarget);stm.shared.views.dartAd.showAdIfValid(b,function(a){if(a){_.delay(function(){var a=b.contents().find("body").height();a>0&&b.attr("height",a)},500);var c=b.closest(".dart_ad");c.length>0&&c.show()}})})});
//# sourceMappingURL=bookingbuddy-init.nano.js.map

$j(function(){$j(".sampleNL").click(function(){return new stm.Popup("http://i.slimg.com/bookingbuddy/BB-email-example.png",{height:1488,width:560}).tryPop(),!1})});
//# sourceMappingURL=SampleNL.nano.js.map
